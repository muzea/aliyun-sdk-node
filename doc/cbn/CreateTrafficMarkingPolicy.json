{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"create"},"parameters":[{"name":"ClientToken","in":"query","schema":{"description":"客户端Token，用于保证请求的幂等性。\n\n从您的客户端生成一个参数值，确保不同请求间该参数值唯一。ClientToken只支持ASCII字符。\n\n> 若您未指定，则系统自动使用API请求的**RequestId**作为**ClientToken**标识。每次API请求的**RequestId**可能不一样。","type":"string","required":false,"example":"123e4567-e89b-12d3-a456-426****"}},{"name":"DryRun","in":"query","schema":{"description":"是否只预检此次请求。取值：\n\n- **true**：发送检查请求，不会创建流量标记策略。检查项包括是否填写了必需参数、请求格式、业务限制等。如果检查不通过，则返回对应错误。如果检查通过，则返回错误码`DryRunOperation`。\n- **false**（默认值）：发送正常请求，通过检查后直接创建流量标记策略。","type":"boolean","required":false,"example":"false"}},{"name":"TransitRouterId","in":"query","schema":{"description":"转发路由器实例ID。","type":"string","required":true,"docRequired":true,"example":"tr-8vbuqeo5h5pu3m01d****"}},{"name":"TrafficMarkingPolicyName","in":"query","schema":{"description":"流量标记策略的名称。\n\n名称可以为空或长度为1～128个字符，不能以http://或https://开头。","type":"string","required":false,"example":"nametest"}},{"name":"TrafficMarkingPolicyDescription","in":"query","schema":{"description":"流量标记策略的描述信息。\n\n描述可以为空或长度为1～256个字符，不能以http://或https://开头。","type":"string","required":false,"example":"desctest"}},{"name":"Priority","in":"query","schema":{"description":"流量标记策略的优先级。取值范围：**1**~**100**。\n\n一个转发路由器实例下，每个流量标记策略的优先级需保证唯一。数字越小，优先级越高。","type":"integer","format":"int32","required":true,"docRequired":true,"example":"5"}},{"name":"MarkingDscp","in":"query","schema":{"description":"为符合流分类规则的流量报文添加DSCP（Differentiated Services Code Point）值。取值范围：**0**~**63**。\n\n一个转发路由器实例下，每个流量标记策略的DCSP值需保证唯一。","type":"integer","format":"int32","required":true,"docRequired":true,"example":"5"}},{"name":"TrafficMatchRules","in":"query","style":"repeatList","schema":{"description":"流量标记策略的流分类规则列表。\n\n符合流分类规则的流量报文将被添加流量策略的DSCP值。\n\n一次最多支持创建50个流分类规则。","type":"array","items":{"description":"流分类规则信息。","type":"object","properties":{"MatchDscp":{"description":"流量报文的DSCP值。取值范围：**0**~**63**。\n\n流分类规则匹配包含指定DSCP值的流量，如果不设置则代表使流分类规则匹配任意DSCP值的流量。\n\n> 当前DSCP值是指流量报文进入跨地域连接前已携带的DSCP值。\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定匹配一个DSCP值。","type":"integer","format":"int32","required":false,"example":"6"},"DstCidr":{"description":"流量报文的目的网段。\n\n流分类匹配目的IP地址在目的网段中的流量，如果不设置则代表使流分类规则匹配任意目的IP地址的流量。\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定一个目的网段。","type":"string","required":false,"example":"10.10.10.0/24"},"TrafficMatchRuleDescription":{"description":"流分类规则的描述信息。\n\n一次最多支持创建50个流分类规则，每个流分类规则可添加一个描述信息。\n\n描述可以为空或长度为1～256个字符，不能以http://或https://开头。","type":"string","required":false,"example":"desctest"},"Protocol":{"description":"流量报文的协议类型。\n\n流量标记策略支持匹配**HTTP**、**HTTPS**、**TCP**、**UDP**、**SSH**、**Telnet**等多种协议类型的流量。更多协议类型，请登录[云企业网管理控制台](https://cen.console.aliyun.com/cen/list)查看。\n<details>\n<summary>部分协议拥有固定的端口。单击查看端口详情。</summary>\n\n- 协议类型为**ICMP**时，目的端口号需指定为-**1**。\n- 协议类型为**GRE**时，目的端口号需指定为-**1**。\n- 协议类型为**SSH**时，目的端口号需指定为**22**。\n- 协议类型为**Telnet**时，目的端口号需指定为**23**。\n- 协议类型为**HTTP**时，目的端口号需指定为**80**。\n- 协议类型为**HTTPS**时，目的端口号需指定为**443**。\n- 协议类型为**MS SQL** 时，目的端口号需指定为**1443**。\n- 协议类型为**Oracle**时，目的端口号需指定为**1521**。\n- 协议类型为**Mysql**时，目的端口号需指定为**3306**。\n- 协议类型为**RDP**时，目的端口号需指定为**3389**。\n- 协议类型为**Postgre SQL**时，目的端口号需指定为**5432**。\n- 协议类型为**Redis**时，目的端口号需指定为**6379**。\n\n</details>\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定匹配一个协议类型。","type":"string","required":false,"example":"HTTP"},"DstPortRange":{"description":"流量报文的目的端口。取值范围：**-1**、**1**~**65535**。\n\n流分类规则匹配目的端口号在目的端口范围中的流量，如果不设置则代表使流分类规则匹配任意目的端口号的流量。\n\n当前参数最多支持输入两个端口号。输入格式说明如下：\n\n- 如果您只输入一个端口号，例如1，则系统默认匹配目的端口为1的流量。如果为-1，则表示匹配任意目的端口。\n- 如果您输入了两个端口号，例如1和200，则系统默认匹配目的端口处于1至200范围内的流量。\n- 如果您输入了两个端口号且其中一个端口号为-1，则另一个端口也必须为-1，表示匹配任意目的端口。\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定一个目的端口范围。","type":"array","items":{"description":"流量报文的目的端口。取值范围：**-1**、**1**~**65535**。\n\n流分类规则匹配目的端口号在目的端口范围中的流量，如果不设置则代表使流分类规则匹配任意目的端口号的流量。\n\n当前参数最多支持输入两个端口号。输入格式说明如下：\n\n- 如果您只输入一个端口号，例如1，则系统默认匹配目的端口为1的流量。\n- 如果您输入了两个端口号，例如1和200，则系统默认匹配目的端口处于1至200范围内的流量。\n- 如果您输入了两个端口号且其中一个端口号为-1，则另一个端口也必须为-1，表示匹配任意目的端口。\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定一个目的端口范围。","type":"integer","format":"int32","required":false,"example":"80"},"required":false,"maxItems":2},"SrcCidr":{"description":"流量报文的源网段。\n\n流分类规则匹配源IP地址在源网段中的流量，如果不设置则代表使流分类规则匹配任意源IP地址的流量。\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定匹配一个源网段。","type":"string","required":false,"example":"192.168.10.0/24"},"SrcPortRange":{"description":"流量报文的源端口。取值范围：**-1**、**1**~**65535**。\n\n流分类规则匹配源端口号在源端口范围中的流量，如果不设置则代表使流分类规则匹配任意源端口。\n\n当前参数最多支持输入两个端口号。输入格式说明如下：\n\n- 如果您只输入一个端口号，例如1，则系统默认匹配源端口为1的流量。如果为-1，则表示匹配任意源端口。\n- 如果您输入了两个端口号，例如1和200，则系统默认匹配源端口处于1至200范围内的流量。\n- 如果您输入了两个端口号且其中一个端口号为-1，则另一个端口也必须为-1，表示匹配任意源端口。\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定一个源端口范围。","type":"array","items":{"description":"流量报文的源端口。取值范围：**-1**、**1**~**65535**。\n\n流分类规则匹配源端口号在源端口范围中的流量，如果不设置则代表使流分类规则匹配任意源端口。\n\n当前参数最多支持输入两个端口号。输入格式说明如下：\n\n- 如果您只输入一个端口号，例如1，则系统默认匹配源端口为1的流量。\n- 如果您输入了两个端口号，例如1和200，则系统默认匹配源端口处于1至200范围内的流量。\n- 如果您输入了两个端口号且其中一个端口号为-1，则另一个端口也必须为-1，表示匹配任意源端口。\n\n一次最多支持创建50个流分类规则，每个流分类规则可指定一个源端口范围。","type":"integer","format":"int32","required":false,"example":"1"},"required":false,"maxItems":2},"TrafficMatchRuleName":{"description":"流分类规则的名称。\n\n一次最多支持创建50个流分类规则，每个流分类规则可添加一个名称。\n\n名称可以为空或长度为1～128个字符，不能以http://或https://开头。","type":"string","required":false,"example":"nametest"}},"required":false},"required":false,"maxItems":50}}],"responses":{"200":{"schema":{"description":"返回结果。","type":"object","properties":{"TrafficMarkingPolicyId":{"description":"流量标记策略ID。","type":"string","example":"tm-u9nxup5kww5po8****"},"RequestId":{"description":"请求ID。","type":"string","example":"0876E54E-3E36-5C31-89F0-9EE8A9266F9A"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidTransitRouterId.NotFound","errorMessage":"TransitRouterId is not found."},{"errorCode":"IllegalParam.Protocol","errorMessage":"Protocol is illegal."},{"errorCode":"OperationFailed.TransitRouterType","errorMessage":"Operation failed because The Basic TransitRouter does not support this action."},{"errorCode":"IllegalParam.Priority","errorMessage":"Priority is illegal."},{"errorCode":"IllegalParam.MarkingDscp","errorMessage":"MarkingDscp is illegal."},{"errorCode":"IllegalParam.SrcCidr","errorMessage":"SrcCidr is illegal."},{"errorCode":"IllegalParam.DstCidr","errorMessage":"DstCidr is illegal."},{"errorCode":"Duplicated.Priority","errorMessage":"The parameter Priority is duplicated."},{"errorCode":"Duplicated.MarkingDscp","errorMessage":"The parameter MarkingDscp is duplicated."},{"errorCode":"Duplicated.TrafficMatchRules","errorMessage":"The parameter TrafficMatchRules are duplicated."},{"errorCode":"QuotaExceeded.TrafficMatchRule","errorMessage":"The maximum number of TrafficMatchRule per Transit Router is exceeded."},{"errorCode":"IllegalParam.MatchDscp","errorMessage":"MarkingDscp is invalid."},{"errorCode":"IllegalParam.SrcPortRange","errorMessage":"The specified SrcPortRange is illegal."},{"errorCode":"IllegalParam.DstPortRange","errorMessage":"The specified DstPortRange is illegal."},{"errorCode":"AttrMismatching.CidrAddressFamily","errorMessage":"Attribute SrcCidr or DstCidr of TrafficMarkRule does not match AddressFamily."},{"errorCode":"IllegalParam.AddressFamily","errorMessage":"AddressFamily is illegal."},{"errorCode":"AttrMismatching.SrcCidrDstCidr","errorMessage":"Attribute SrcCidr of TrafficMarkRule does not match DstCidr."},{"errorCode":"AttrMismatching.CidrProtocol","errorMessage":"Attribute SrcCidr or DstCidr of TrafficMarkRule does not match Protocol."},{"errorCode":"InvalidTransitRouterMode.NeedUpgrade","errorMessage":"TransitRouter need to upgrade."},{"errorCode":"InvalidParameter","errorMessage":"Invalid parameter."},{"errorCode":"Unauthorized","errorMessage":"The AccessKeyId is unauthorized."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"TrafficMarkingPolicyId\\\": \\\"tm-u9nxup5kww5po8****\\\",\\n  \\\"RequestId\\\": \\\"0876E54E-3E36-5C31-89F0-9EE8A9266F9A\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateTrafficMarkingPolicyResponse>\\n    <TrafficMarkingPolicyId>tm-u9nxup5kww5po8****</TrafficMarkingPolicyId>\\n    <RequestId>0876E54E-3E36-5C31-89F0-9EE8A9266F9A</RequestId>\\n</CreateTrafficMarkingPolicyResponse>\",\"errorExample\":\"\"}]","title":"创建流量标记策略","summary":"流量标记策略通过流分类规则捕获符合规则的流量，捕获后，您可以为流量添加DSCP（Differentiated Services Code Point）值作为标记。您可以通过调用CreateTrafficMarkingPolicy创建流量标记策略。","description":"- 仅企业版转发路由器支持创建流量标记策略。\n- **CreateTrafficMarkingPolicy**接口属于异步接口，即系统会先返回一个流量标记策略ID，但该流量标记策略并未创建完成，系统后台的创建任务仍在进行。您可以调用**ListTrafficMarkingPolicies**接口查询流量标记策略的状态。 \n\n    - 当流量标记策略处于**Creating**状态时，表示流量标记策略正在创建中，在该状态下，您只能对流量标记策略执行查询操作，不能执行其他操作。\n    - 当流量标记策略处于**Active**状态时，表示流量标记策略创建完成。"}