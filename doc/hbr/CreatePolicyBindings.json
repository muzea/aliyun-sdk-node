{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"create"},"parameters":[{"name":"PolicyId","in":"formData","schema":{"description":"策略ID。","type":"string","required":false,"example":"po-000************8ep"}},{"name":"PolicyBindingList","in":"query","style":"json","schema":{"description":"策略绑定列表。","type":"array","items":{"description":"策略绑定详情。","type":"object","properties":{"PolicyBindingDescription":{"description":"策略绑定描述。","type":"string","required":false,"example":"这是一个策略绑定的描述。"},"DataSourceId":{"description":"数据源ID，根据**SourceType**字段表示不同含义：\n- **UDM_ECS**：ECS实例ID。\n- **OSS**：OSS bucket名称。\n- **NAS**：阿里云NAS文件系统ID。\n- **COMMON_NAS**：本地NAS实例ID。\n- **ECS_FILE**：ECS实例ID。\n- **File**：云备份客户端ID。","type":"string","required":false,"example":"i-bp1************dl8"},"Disabled":{"description":"策略对该数据源是否暂停生效。\n- true：暂停\n- false：未暂停","type":"string","required":false,"example":"true"},"SourceType":{"description":"数据源类型。取值范围：\n- **UDM_ECS**：表示ECS整机备份。\n- **OSS**：表示OSS备份。\n- **NAS**：表示阿里云NAS备份。\n- **COMMON_NAS**：表示本地NAS备份。\n- **ECS_FILE**：表示ECS文件备份。\n- **File**：表示本地文件备份。","type":"string","required":false,"example":"UDM_ECS"},"Source":{"description":"- 当SourceType取值为**OSS**时，表示备份某个prefix，如果不指定，则表示备份整个Bucket根目录。\n- 当SourceType取值为**ECS_FILE**或**File**时，表示备份的文件目录，如果不指定，则表示备份全部目录。","type":"string","required":false,"example":"backup/"},"Include":{"description":"仅当**SourceType**取值为**ECS_FILE**或**File**时，需要配置该参数。表示要进行备份的文件类型，这些类型的所有文件都备份。最多支持255个字符。","type":"string","required":false,"example":"[\\\"*.doc\\\",\\\"*.xltm\\\"]"},"Exclude":{"description":"仅当**SourceType**取值为**ECS_FILE**或**File**时，需要配置该参数。表示不需要进行备份的文件类型，该类型的所有文件都不备份。最多支持255个字符。","type":"string","required":false,"example":"[\\\"*.doc\\\",\\\"*.xltm\\\"]"},"SpeedLimit":{"description":"仅当**SourceType**取值为**ECS_FILE**或**File**时，需要配置该参数。表示备份流量控制。格式为`{start}{end}{bandwidth}`。多个流量控制配置使用分隔，并且配置时间不允许有重叠。\n\n- **start**：起始小时。\n- **end**：结束小时。\n- **bandwidth**：限制速率，单位KB/s。","type":"string","required":false,"example":"0:24:1024"},"AdvancedOptions":{"description":"高级选项。","type":"object","properties":{"UdmDetail":{"description":"ECS整机备份高级选项。","type":"object","properties":{"ExcludeDiskIdList":{"description":"不需要保护的云盘ID列表。当DiskIdList不为空时，将忽略该参数。","type":"array","items":{"description":"无需保护的云盘ID。","type":"string","required":false,"example":"d-bp1************apo"},"required":false},"DiskIdList":{"description":"需要保护的云盘ID列表。保护所有云盘时，该值为空。","type":"array","items":{"description":"需要保护的云盘ID。","type":"string","required":false,"example":"d-bp1************apo"},"required":false},"SnapshotGroup":{"description":"是否创建快照一致性组。仅云盘类型全部为ESSD时，支持创建快照一致性组。","type":"boolean","required":false,"example":"true"},"AppConsistent":{"description":"是否创建应用一致性。仅云盘类型全部为ESSD时，支持创建快照应用一致性。","type":"boolean","required":false,"example":"false"},"RamRoleName":{"description":"仅当**AppConsistent**为**true**时，需要配置该参数。创建应用一致性快照需要配置的RAM角色名称。","type":"string","required":false,"example":"AliyunECSInstanceForHbrRole"},"PreScriptPath":{"description":"仅当**AppConsistent**为**true**时，需要配置该参数。创建应用一致性快照前执行的冻结脚本路径。","type":"string","required":false,"example":"/tmp/prescript.sh"},"PostScriptPath":{"description":"仅当**AppConsistent**为**true**时，需要配置该参数。创建应用一致性快照后执行的解冻脚本路径。","type":"string","required":false,"example":"/tmp/postscript.sh"},"EnableFsFreeze":{"description":"仅当**AppConsistent**为**true**时，需要配置该参数。是否在创建应用一致性快照前使用Linux的FsFreeze机制确保文件系统处于只读一致性。默认为true。","type":"boolean","required":false,"example":"true"},"TimeoutInSeconds":{"description":"仅当**AppConsistent**为**true**时，需要配置该参数。IO冻结超时时间。默认为30秒。","type":"integer","format":"int64","required":false,"example":"30"},"EnableWriters":{"description":"仅当**AppConsistent**为**true**时，需要配置该参数。是否设置应用一致性快照：\n- true：创建应用一致性快照\n- false：创建文件系统一致性快照\n\n默认为true。","type":"boolean","required":false,"example":"true"}},"required":false},"OssDetail":{"description":"OSS备份高级选项。","type":"object","properties":{"InventoryId":{"description":"OSS清单名称，该值不为空时将使用OSS清单用于性能调优。\n- 建议备份1亿以上OSS对象采用清单提升增量性能，由清单文件产生的存储费用由OSS服务单独收取。\n- OSS清单文件生成需要时间，在OSS清单文件生成完成之前可能会备份失败，可以等待下个周期执行。","type":"string","required":false,"example":"oss-inventory-default"},"InventoryCleanupPolicy":{"description":"备份后是否删除清单文件。仅当使用OSS清单时有效。支持：\n- **NO_CLEANUP**：不删除。\n- **DELETE_CURRENT**：删除当前文件。\n- **DELETE_CURRENT_AND_PREVIOUS**：删除所有文件。","type":"string","required":false,"example":"NO_CLEANUP"}},"required":false},"FileDetail":{"description":"文件备份高级选项。","type":"object","properties":{"UseVSS":{"description":"是否启用VSS（Windows）功能。取值：\n- **true**：启用。\n- **false**：不启用。","type":"boolean","required":false,"example":"true"},"AdvPolicy":{"description":"是否使用高级策略。取值：\n- **true**：使用。\n- **false**：不适用。","type":"boolean","required":false,"example":"true"}},"required":false},"CommonNasDetail":{"description":"本地NAS备份高级选项。","type":"object","properties":{"FullOnIncrementFail":{"description":"增量备份失败时是否转为全量备份。取值：\n- **true**：失败时转为全量备份。\n- **false**：失败时不转为全量备份。","type":"boolean","required":false,"example":"true"},"FetchSliceSize":{"description":"备份分片大小（文件数）。","type":"integer","format":"int64","required":false,"example":"100000"},"ClusterId":{"description":"备份客户端组ID。本地NAS备份将从备份客户端组中挑选客户端进行备份。","type":"string","required":false,"example":"cl-000**************ggu"}},"required":false},"CommonFileSystemDetail":{"description":"大规模文件系统备份高级选项。","type":"object","properties":{"FullOnIncrementFail":{"description":"增量备份失败时是否转为全量备份。取值：\n- **true**：失败时转为全量备份。\n- **false**：失败时不转为全量备份。","type":"boolean","required":false,"example":"true"},"FetchSliceSize":{"description":"备份分片大小（文件数）。","type":"integer","format":"int64","required":false,"example":"100000"}},"required":false}},"required":false},"CrossAccountType":{"description":"跨账号备份类型，默认值为SELF_ACCOUNT。支持： \n- **SELF_ACCOUNT**：本账号备份。\n- **CROSS_ACCOUNT**：跨账号备份。","type":"string","required":false,"example":"SELF_ACCOUNT"},"CrossAccountUserId":{"description":"用于跨账号备份的原账号阿里云UID。","type":"integer","format":"int64","required":false,"example":"144**********732"},"CrossAccountRoleName":{"description":"用于跨账号备份的原账号RAM中创建的角色名。","type":"string","required":false,"example":"hbrcrossrole"}},"required":false},"required":false}}],"responses":{"200":{"schema":{"title":"CreatePolicyBindingsResponse","description":"返回数据。","type":"object","properties":{"Success":{"description":"请求是否成功。\n\n- true：成功\n- false：失败","type":"boolean","example":"true"},"Code":{"description":"返回码，200表示成功。","type":"string","example":"200"},"Message":{"description":"返回信息描述，成功一般返回successful，错误时会返回相应错误信息。","type":"string","example":"successful"},"RequestId":{"description":"请求ID。","type":"string","example":"82CC5B6C-72F7-5D39-92F6-67887DF9AD46"}}}}},"errorCodes":{"400":[{"errorCode":"PolicyAlreadyBoundWithThisDataSource","errorMessage":"This datasource has already been bound with the policy, please use another one."}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"Success\\\": true,\\n  \\\"Code\\\": \\\"200\\\",\\n  \\\"Message\\\": \\\"successful\\\",\\n  \\\"RequestId\\\": \\\"82CC5B6C-72F7-5D39-92F6-67887DF9AD46\\\"\\n}\",\"type\":\"json\"}]","title":"创建策略与数据源关联","summary":"将一个或多个数据源绑定到某个策略。","description":"- 每次调用仅支持将相同类型的数据源绑定到同一个策略。\n- ECS整机仅支持绑定到一个策略。"}