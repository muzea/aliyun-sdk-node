{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{},"parameters":[{"name":"PlanId","in":"query","schema":{"description":"备份计划ID。","type":"string","required":true,"docRequired":true,"example":"plan-20211***735"}},{"name":"PlanName","in":"query","schema":{"description":"备份计划名称。","type":"string","required":false,"example":"planname","maxLength":64,"minLength":1}},{"name":"Schedule","in":"query","schema":{"description":"备份策略。可选格式：`I|{startTime}|{interval}`。表示从`{startTime}`开始每隔`{interval}`的时间执行一次备份任务。不会补偿已过去时间的备份任务。如果上一次备份任务没有完成，不会触发下一次备份任务。例如`I|1631685600|P1D`表示从2021-09-15 14:00:00开始每隔一天备份一次。\n\n- **startTime**：备份起始时间，UNIX时间，单位秒。\n- **interval**： ISO8601时间间隔。例如：PT1H表示间隔一小时。P1D表示间隔一天。","type":"string","required":false,"example":"I|1602673264|P1D"}},{"name":"Retention","in":"query","schema":{"description":"备份保留天数，最小值为1天。","type":"integer","format":"int64","required":false,"docRequired":true,"example":"7"}},{"name":"Prefix","in":"query","schema":{"description":"仅当**SourceType**取值为**OSS**时，需要配置该参数。表示备份前缀。指定后，仅备份前缀相匹配的对象。","type":"string","required":false,"example":"oss-prefix"}},{"name":"VaultId","in":"query","schema":{"description":"备份仓库ID。","type":"string","required":false,"docRequired":true,"example":"v-0006******q"}},{"name":"Detail","in":"query","style":"json","schema":{"description":"整机备份详情，类型为JSON字符串。\n\n* snapshotGroup：是否使用一致性快照组（仅实例所有云盘均为ESSD时有效）。\n* appConsistent：是否使用应用一致性（需要搭配参数preScriptPath和postScriptPath使用）。\n* preScriptPath：冻结脚本路径。\n* postScriptPath：解冻脚本路径。","type":"object","required":false,"example":"{\\\"EnableFsFreeze\\\":true,\\\"appConsistent\\\":false,\\\"postScriptPath\\\":\\\"\\\",\\\"preScriptPath\\\":\\\"\\\",\\\"snapshotGroup\\\":true,\\\"timeoutInSeconds\\\":60}"}},{"name":"SourceType","in":"query","schema":{"description":"数据源类型，取值范围：\n\n- **ECS_FILE**：备份ECS文件\n- **OSS**：备份阿里云OSS\n- **NAS**：备份阿里云NAS\n- **OTS**：备份阿里云表格存储\n- **UDM_ECS**：备份阿里云ECS整机","type":"string","required":false,"example":"ECS_FILE"}},{"name":"SpeedLimit","in":"query","schema":{"description":"仅当**SourceType**取值为**ECS_FILE**时，需要配置该参数。表示备份流量控制。流量控制可以帮助您在业务高峰期，控制备份文件的流量，以免影响正常业务。格式为`{start}|{end}|{bandwidth}`。多个流量控制配置使用|分隔，并且配置时间不允许有重叠。\n\n- **start**：起始小时\n- **end**：结束小时\n- **bandwidth**：限制速率，单位KB/s。","type":"string","required":false,"example":"0:24:5120"}},{"name":"Include","in":"formData","schema":{"description":"仅当**SourceType**取值为**ECS_FILE**时，需要配置该参数。表示需要备份的路径，该路径下所有文件都备份。最多支持255个字符。","type":"string","required":false,"example":"[\"/home/alice/*.pdf\", \"/home/bob/*.txt\"]"}},{"name":"Exclude","in":"formData","schema":{"description":"仅当**SourceType**取值为**ECS_FILE**时，需要配置该参数。表示不需要进行备份的路径，该路径下所有文件都不备份。最多支持255个字符。","type":"string","required":false,"example":"[\"/var\", \"/proc\"]"}},{"name":"Options","in":"formData","schema":{"description":"仅当**SourceType**取值为**ECS_FILE**时，需要配置该参数。表示是否使用Windows系统VSS定义备份路径。\n\n- 此功能仅支持Windows类型ECS实例。\n- 如果备份源中有数据更改，需要确保备份数据与源数据的一致时，才可配置为`[\"UseVSS\":true]`。\n- 选择使用VSS后，不支持多个文件目录同时备份。","type":"string","required":false,"example":"{\"UseVSS\":false}"}},{"name":"UpdatePaths","in":"query","schema":{"description":"当备份路径为空时，是否更新备份路径。\n\n- true：按照该接口中定义路径更新备份路径。\n- false：不更新备份路径，按照创建备份计划时路径继续备份。","type":"boolean","required":false,"example":"false"}},{"name":"Path","in":"query","style":"repeatList","schema":{"description":"备份路径。","type":"array","items":{"description":"备份路径。最多65536个字符。\n备份路径规则如下：\n\n- 无通配符（*）的情况下，可以输入20行路径。\n- 使用通配符（*）时，只能输入1行路径，支持形如`/*/*`的通配符。\n- 每行只支持绝对路径。\n- 使用VSS时，不支持多个路径、UNC路径、通配符、排除文件。\n- 使用UNC时，不支持VSS、通配符、排除文件。当备份源包含UNC路径时，将不会对Windows ACL进行备份。","type":"string","required":false,"example":"[\"/home\"]"},"required":false,"maxItems":20}},{"name":"Rule","in":"formData","style":"repeatList","schema":{"description":"备份计划规则","type":"array","items":{"type":"object","properties":{"DestinationRetention":{"description":"异地备份保留天数。","type":"integer","format":"int64","required":false,"example":"7"},"Schedule":{"description":"备份策略。可选格式：I|{startTime}|{interval}。表示从{startTime}开始每隔{interval}的时间执行一次备份任务。不会执行已过去时间的备份任务。如果上一次备份任务没有完成，不会触发下一次备份任务。例如I|1631685600|P1D表示从2021-09-15 14:00:00开始每隔一天备份一次。\n\nstartTime：备份起始时间，UNIX时间，单位为秒。 interval： ISO8601时间间隔。例如：PT1H表示间隔一小时。P1D表示间隔一天。","type":"string","required":false,"example":"I|1631685600|P1D"},"Disabled":{"description":"策略是否禁用。","type":"boolean","required":false,"example":"false"},"Retention":{"description":"备份保留天数，最小值为1天。","type":"integer","format":"int64","required":false,"example":"7"},"DoCopy":{"description":"是否开启异地复制。","type":"boolean","required":false,"example":"false"},"DestinationRegionId":{"description":"异地备份地域ID。","type":"string","required":false,"example":"cn-shanghai"},"RuleName":{"description":"策略名称。","type":"string","required":false,"example":"rule-test-name"},"BackupType":{"description":"备份类型。取值为**COMPLETE**，表示全量备份。","type":"string","required":false,"example":"COMPLETE"}},"required":false},"required":false,"maxItems":64}},{"name":"OtsDetail","in":"formData","style":"json","schema":{"description":"表格存储实例详情。","required":false,"$ref":"#/components/schemas/OtsDetail"}},{"name":"KeepLatestSnapshots","in":"query","schema":{"description":"是否开启保留至少一个备份版本。\n- 0 - 不保留\n- 1 - 保留","type":"integer","format":"int64","required":false,"example":"1"}},{"name":"ChangeListPath","in":"query","schema":{"description":"增量文件同步列表的配置。（仅同步需要）","type":"string","required":false,"example":"{\"dataSourceId\": \"ds-123456789\", \"path\": \"/changelist\"}"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"返回码，200表示成功。","type":"string","example":"200"},"Message":{"description":"返回信息描述，成功一般返回successful，错误时会返回相应错误信息。","type":"string","example":"successful"},"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E"},"Success":{"description":"请求是否成功。\n\n- true：成功。\n- false：失败。","type":"boolean","example":"true"}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Code\\\": \\\"200\\\",\\n  \\\"Message\\\": \\\"successful\\\",\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E\\\",\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<UpdateBackupPlanResponse>\\n    <Code>200</Code>\\n    <Message>successful</Message>\\n    <RequestId>473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E</RequestId>\\n    <Success>true</Success>\\n</UpdateBackupPlanResponse>\",\"errorExample\":\"\"}]","title":"更新备份计划","summary":"更新一个备份计划。"}