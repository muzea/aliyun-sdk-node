{"methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","systemTags":{"operationType":"create"},"parameters":[{"name":"PolicyId","in":"formData","schema":{"description":"防护策略ID。","type":"integer","format":"int64","required":true,"example":"1000001"}},{"name":"RuleConfigs","in":"formData","schema":{"description":"防护规则配置。","type":"string","required":true,"example":"{\"name\":\"ttttt\",\"action\":\"monitor\",\"conditions\":[{\"key\":\"URL\",\"opValue\":\"match-one\",\"values\":\"1,2,3,4,5\"},{\"key\":\"Header\",\"opValue\":\"contain-one\",\"subKey\":\"testheader\",\"values\":\"6,7,8,9,10\"}],\"ratelimit\":{\"target\":\"header\",\"interval\":10,\"threshold\":5,\"ttl\":1800,\"subKey\":\"testheadercc\",\"status\":{\"code\":\"502\",\"count\":5}},\"ccStatus\":\"on\",\"effect\":\"rule\",\"status\":\"on\"}"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"CB1A380B-09F0-41BB-280B-72F8FD6DA2FE"},"RuleIds":{"type":"object","properties":{"RuleId":{"type":"array","items":{"description":"创建的规则ID列表。","type":"string","example":"100001,200002"}}}}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParameter","errorMessage":"The specified parameter is invalid."},{"errorCode":"Policy.NotExist","errorMessage":"The specified policy does not exist."},{"errorCode":"RuleConfigs.Malformed","errorMessage":"The specified RuleConfigs format is invalid."},{"errorCode":"RuleName.AlreadyExists","errorMessage":"Rule name already exists in specified policy."},{"errorCode":"Rule.QuantityOverflow","errorMessage":"Rules are overflowed quantity in specified policy."}],"403":[{"errorCode":"%s.NotSupport","errorMessage":"The specified resource type %s is not supported."},{"errorCode":"%s.OverQuota","errorMessage":"The quantity of %s exceeds the quota."}],"500":[{"errorCode":"InternalError","errorMessage":"An internal error occurred; please try again later."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"CB1A380B-09F0-41BB-280B-72F8FD6DA2FE\\\",\\n  \\\"RuleIds\\\": {\\n    \\\"RuleId\\\": [\\n      \\\"100001,200002\\\"\\n    ]\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<BatchCreateDcdnWafRulesResponse>\\n    <RequestId>CB1A380B-09F0-41BB-280B-72F8FD6DA2FE</RequestId>\\n    <RuleIds>100001,200002</RuleIds>\\n</BatchCreateDcdnWafRulesResponse>\",\"errorExample\":\"\"}]","title":"配置防护规则","summary":"调用BatchCreateDcdnWafRules设置WAF防护规则。","description":"> 单用户调用频率：20次/秒。","requestParamsDescription":"## RuleConfigs取值说明\n\n- RuleConfigs为列表切片，其中每个结构体代表一条规则。\n- 根据PolicyId对应的防护策略类型不同，RuleConfigs的格式也不同。\n\n### 防护场景1：Web正则防护（waf_group）\n\n| 参数   | 类型   | 必要 | 示例值 | 描述                       |\n| ------ | ------ | ---- | ------|-------------------- |\n| status | String | 否   | on|防护规则开关，取值：on（开启），off（关闭）。默认为on。 |\n| action | String | 是   | block|规则动作，取值：block（拦截），monitor（观察）。   |\n| wafGroupIds  | String | 否   | 1012| WAF规则组ID，默认为\"1012\"，多个ID使用半角逗号（,）分隔。   |\n\nwaf_group配置示例：\n```\n// Web正则防护目前仅支持一条策略下配置一条规则。\n[\n  {\n    \"status\": \"on\",\n    \"action\": \"block\"\n  }\n]\n```\n\n### 防护场景2：自定义规则（custom_acl）\n\n| 名称  | 类型|是否必选| 示例值| 描述|\n|------|-----|--------|-------|-----|\n| name| string|是| acl_1| 防护规则名称，支持输入英文字符（大小写）、数字（0~9）及下划线（_），最大输入64个字符。|\n| status| string|否| on| 取值：on（开启），off（关闭）。默认为on。|\n| conditions|Condition|是|  [ {\"key\": \"URI\", \"subKey\": \"\",\"opValue\": \"contain\",  \"values\": \"/login.php\" }]| 触发规则条件，具体参数请参考**表1 Condition参数说明**。|\n| ccStatus| string|是| off| 频次控制开关，on（开启），off（关闭）。|\n| rateLimit| RateLimit|否| { \"target\": \"Header\", \"subKey\": \"User-Agent\", \"interval\": 5, \"threshold\": 2, \"ttl\": 1800}| 具体的频次控制规则，当ccStatus为on时必填。具体参数请参考**表2 RateLimit参数说明**。|\n| effect| string|否| service| 频次控制黑名单的生效范围，当ccStatus为on时必填，取值：rule（当前规则生效），service（全局生效）。|\n| action| string|是| deny| 规则动作，取值：deny（拦截）、js（JS验证）、monitor（观察）。|\n\n表1 Condition参数说明\n\n| 名称  | 类型|是否必选| 示例值| 描述|\n|------|-----|--------|--------|-----|\n| Key| string|是| Query String Parameter| 匹配字段，具体请参考[DescribeDcdnWafFilterInfo](~~423285~~)。|\n| subKey| string|否| action| 匹配子字段，具体请参考[DescribeDcdnWafFilterInfo](~~423285~~)。|\n| opValue|String|是|  eq| 逻辑符，具体请参考[DescribeDcdnWafFilterInfo](~~423285~~)。|\n| values|String|否|  js| 匹配内容，多值使用英文逗号（,）分隔，具体值参考[DescribeDcdnWafFilterInfo](~~423285~~)。|\n\n表2 RateLimit参数说明\n\n| 名称  | 类型|是否必选| 示例值| 描述|\n|------|-----|---------|--------|-----|\n| target| string|是| Header|频次控制的统计字段，取值：IP：表示统计同一个IP发起请求的频率。Header：表示统计包含指定Header的请求的频率。Query String Parameter：表示统计包含指定参数的请求的频率。Cookie Name：表示统计包含指定Cookie的请求的频率。Session：表示统计来自同一个会话发起请求的频率。|\n| subKey| string|否| User-Agent|统一字段的子字段，当target为Header、Query String Parameter或Cookie Name时必填。|\n| Interval|Integer|是|  5| 统计时长。取值范围：5~1800。单位：秒。|\n| threshold|Integer|是|  2| 统计阈值。取值范围：2~500000。单位：次。|\n| ttl|Integer|是|  1800| 黑名单超时时间。取值范围：60~86400。单位：秒。|\n| status|RateLimitStatus|否| {\"code\": \"404\", \"ratio\": 10} | 响应码统计。具体参数请参考**表3 RateLimitStatus参数说明**。|\n\n表3 RateLimitStatus参数说明\n\n| 名称  | 类型|是否必选| 示例值| 描述|\n|------|-----|--------|-------|-----|\n| codet| string|是| 404|HTTP状态码。|\n|ratio| Integer|否| 10|按比例（%）统计。取值：1~100，与count字段二选一。|\n|count| Integer|否| 10|按数量统计。取值：2~50000，与ratio字段二选一。|\n\ncustom_acl配置示例：\n```\n[\n  // 访问控制\n  {\n    \"name\": \"acl_1\",\n    \"status\": \"off\",\n    \"conditions\":\n    [\n      {\n        \"key\": \"Query String Parameter\",\n        \"subKey\": \"action\",\n        \"opValue\": \"eq\",\n        \"values\": \"js\"\n      }\n    ],\n    \"ccStatus\": \"off\",\n    \"action\": \"js\"\n  },\n  // 频次控制\n  {\n    \"name\": \"cc_1\",\n    \"status\": \"on\",\n  \t\"conditions\": \n    [\n      {\n        \"key\": \"URI\",\n        \"subKey\": \"\",\n        \"opValue\": \"contain\",\n        \"values\": \"/login.php\"\n      },\n      {\n        \"key\": \"IP\",\n        \"subKey\": \"\",\n        \"opValue\": \"ip-contain\",\n        \"values\": \"192.168.0.1/24\"\n      }\n    ],\n    \"ccStatus\": \"on\",\n    \"ratelimit\":\n    {\n      \"target\": \"Header\",\n      \"subKey\": \"User-Agent\",\n      \"interval\": 5,\n      \"threshold\": 2,\n      \"ttl\": 1800,\n      \"status\":\n      {\n        \"code\": \"404\",\n        \"ratio\": 10\n      }\n    },\n    \"effect\": \"service\",\n    \"action\": \"deny\"\n  }\n]\n```\n\n\n### 防护场景3：白名单（whitelist）\n\n| 名称  | 类型|是否必选| 示例值| 描述|\n|------|-----|---------|-------|----|\n| name| string|是| on| 防护规则名称，支持输入英文字符（大小写）、数字（0~9）及下划线（_），最大输入64个字符。|\n| status| string|否| on| 防护规则开关，取值：on（默认）：开启。off：关闭。|\n| conditions| Condition|是|    [{ \"key\": \"Http-Method\",\"subKey\": \"\",\"opValue\": \"match-one\", \"values\": \"GET,POST,DELETE\"  }]| 触发规则的条件。具体参数请参考**表1 Condition参数说明**。|\n| tags| String|是|   [ \"waf\\_group\",  \"custom\\_acl\"]| 防护策略类型列表。|\n| regularTypes| String|否|   [  [ \"sqli\", \"xss\",\"code_exec\", \"crlf\", \"lfilei\",  \"rfilei\", \"webshell\",\"vvip\", \"other\"]| 正则规则类型，当tags中出现waf\\_group时，此值可填，可选值：[\"sqli\", \"xss\", \"code_exec\", \"crlf\", \"lfilei\", \"rfilei\", \"webshell\", \"vvip\", \"other\"]。|\n| regularRules| String|否|   [   \"100001\", \"100002\", \"100003\"]| 正则规则，当tags中出现waf\\_group时，此值可填，且与regularTypes只能出现一个，值为字符串格式的六位数字组成的列表。|\n\nwhitelist配置示例：\n\n```\n[\n  // 跳过全部场景\n  {\n    \"name\": \"wl_all\",\n    \"status\": \"on\",\n    \"conditions\":\n    [\n      {\n        \"key\": \"Http-Method\",\n        \"subKey\": \"\",\n        \"opValue\": \"match-one\",\n        \"values\": \"GET,POST,DELETE\"\n      }\n    ],\n    \"tags\":\n    [\n      \"waf_group\",\n      \"custom_acl\",\n      \"ip_blacklist\",\n      \"region_block\"\n    ]\n  },\n  // 跳过waf_group的指定规则id\n  {\n    \"name\": \"wl_waf_id\",\n    \"status\": \"off\",\n    \"conditions\":\n    [\n      {\n        \"key\": \"Cookie Name\",\n        \"subKey\": \"cdn-sec\",\n        \"opValue\": \"prefix-match\",\n        \"values\": \"a7sdsa9dsa8d8sa\"\n      },\n      {\n        \"key\": \"Referer\",\n        \"subKey\": \"\",\n        \"opValue\": \"none\",\n        \"values\": \"\"\n      }\n    ],\n    \"tags\":\n    [\n      \"waf_group\"\n    ],\n    \"regularRules\":\n    [\n      \"100001\",\n      \"100002\",\n      \"100003\"\n    ]\n  },\n  {\n  // 跳过waf_group的指定规则类型\n    \"name\": \"wl_waf_type\",\n    \"status\": \"on\",\n    \"conditions\":\n    [\n      {\n        \"key\": \"Query String\",\n        \"subKey\": \"\",\n        \"opValue\": \"exists\",\n        \"values\": \"\"\n      }\n    ],\n    \"tags\":\n    [\n      \"waf_group\"\n    ],\n    \"regularTypes\":\n    [\n      \"sqli\",\n      \"xss\",\n      \"code_exec\",\n      \"crlf\",\n      \"lfilei\",\n      \"rfilei\",\n      \"webshell\",\n      \"vvip\",\n      \"other\"\n    ]\n  },\n  // 跳过自定义规则\n  {\n    \"name\": \"wl_custom_acl\",\n    \"status\": \"on\",\n    \"conditions\":\n    [\n      {\n        \"key\": \"Http-Method\",\n        \"subKey\": \"\",\n        \"opValue\": \"match-one\",\n        \"values\": \"GET,POST,DELETE\"\n      }\n    ],\n    \"tags\":\n    [\n      \"custom_acl\"\n    ]\n  },\n  // 跳过IP黑名单\n  {\n    \"name\": \"wl_ip_blacklist\",\n    \"status\": \"on\",\n    \"conditions\":\n    [\n      {\n        \"key\": \"Http-Method\",\n        \"subKey\": \"\",\n        \"opValue\": \"match-one\",\n        \"values\": \"GET,POST,DELETE\"\n      }\n    ],\n    \"tags\":\n    [\n      \"ip_blacklist\"\n    ]\n  },\n  // 跳过区域封禁\n  {\n    \"name\": \"wl_region_block\",\n    \"status\": \"on\",\n    \"conditions\":\n    [\n      {\n        \"key\": \"Http-Method\",\n        \"subKey\": \"\",\n        \"opValue\": \"match-one\",\n        \"values\": \"GET,POST,DELETE\"\n      }\n    ],\n    \"tags\":\n    [\n      \"region_block\"\n    ]\n  }\n]\n```\n### 防护场景4：IP黑名单（ip_blacklist）\n| 名称  | 类型|是否必选| 示例值| 描述|\n|------|-----|--------|-------|------|\n| name| string|是| ipblacklist|防护规则名称，支持输入英文字符（大小写）、数字（0~9）及下划线（_），最大输入64个字符。|\n|status|string|否| on|防护规则开关，取值：取值：on（开启），off（关闭）。默认为on。|\n|remoteAddr|\t[]String|是| [\"192.168.0.1\",\"10.10.10.10/24\",\"::1\",\"abcd::abcd\",\"BCDE::BCDE\"]|按IP地址过滤，具体请参见[DescribeDcdnWafFilterInfo](~~423285~~)。|\n|action|string|是| deny|规则动作，取值：deny（拦截），monitor（观察）。|\n\n\nipblacklist配置示例：\n```\n[\n    {\n    \"name\": \"ipblacklist\",\n    \"status\": \"on\",\n    \"remoteAddr\": [\"192.168.0.1\",\"10.10.10.10/24\",\"::1\",\"abcd::abcd\",\"BCDE::BCDE\"],\n    \"action\": \"deny\"\n  }\n]\n```\n\n### 防护场景5：区域封禁（region_block）\n| 名称  | 类型|是否必选| 示例值| 描述|\n|------|-----|--------|-------|-----|\n| status| string|否| on|防护规则开关，取值：on（开启），off（关闭）。默认为on。|\n|cnRegionList|string| 否|110000,TW,MO|中国境内封禁区域，逗号分隔。支持封禁的地区请参见[DescribeDcdnWafGeoInfo](~~433207~~)。|\n|otherRegionList|string|否| JP,GB|中国境外封禁区域，逗号分隔。支持封禁的地区请参见[DescribeDcdnWafGeoInfo](~~433207~~)。|\n|action|string|是| deny|规则动作，取值：deny（拦截），monitor（观察）。|\n\n> cnRegionList和otherRegionList至少填写其中一个。\n\nregion_block配置示例：\n```\n[\n    {\n    \"status\": \"on\",\n    \"cnRegionList\": \"110000,TW,MO\",\n    \"otherRegionList\": \"JP,GB\",\n    \"action\": \"deny\"\n  }\n]\n```\n### 防护场景6：Bot管理（bot）\n**规则模板**\n\n所有的规则参数都是以下四个，具体值参见具体规则分类。\n| 参数   | 类型       | 必要 | 描述                         |\n| ------ | ---------- | ---- | ---------------------------- |\n| type   | String     | 是   | 规则类型，参见具体规则分类。       |\n| status | String     | 是   |规则状态，取值：on（开启），off（关闭）。|\n| config | TargetType | 否   | 规则配置，参见具体规则分类。 |\n| action | String     | 否   |规则动作，参见具体规则分类。    |\n\n**规则分类一：防护目标类型**\n\n| 参数   | 类型       | 必要 | 示例值|描述                         |\n| ------ | ---------- | ---- | ------|---------------------- |\n| type   | String     | 是   | target_type |规则类型，取值：target_type。       |\n| status | String     | 是   |on| 规则开关，取值：on（开启）。|\n| config | TargetType | 否   | {\"target\":\"app\"}|规则配置。格式如下：<br>target：防护目标类型，必填。取值范围包含web（网页/浏览器）和app（APP）。 |\n| action | String     | 否   |置空| 规则动作，此处不涉及，置为空值。    |\n\n防护目标类型配置示例：\n```\n[\n  {\n    \"type\":\"target_type\",\n    \"status\":\"on\",\n    \"config\":{\"target\":\"app\"},\n    \"action\":\"\"\n  }\n]\n```\n**规则分类二：Web SDK集成**\n\n| 参数   | 类型   | 必要 | 示例值 | 描述                         |\n| ------ | ------ | ---- | ------|---------------------- |\n| type   | String | 是   | web_sdk|规则类型，取值：web_sdk。        |\n| status | String | 是   | on|规则开关，取值：on（开启）。              |\n| config | WebSdk | 否   | {\"mode\":\"automatic\",\"crossDomain\":\"example.com\"}|规则配置。格式如下：<br>mode ：Web SDK集成方式，必填。取值范围包含automatic（自动集成）和manual（手动集成）。<br>crossDomain：跨域的域名调用，选填，仅当mode取值为automatic时生效。 |\n| action | String | 否   | 置空|规则动作，此处不涉及，置为空值。      |\n\nWeb SDK集成配置示例：\n```\n[\n  {\n    \"type\":\"web_sdk\",\n    \"status\":\"on\",\n    \"config\":{\"mode\":\"automatic\",\"crossDomain\":\"example.com\"},\n    \"action\":\"\"\n  }\n]\n```\n**规则分类三：防护目标特征**\n\n| 参数   | 类型           | 必要 | 示例值 | 描述                         |\n| ------ | ---------- | ---- | -------|--------------------- |\n| type   | String         | 是   | traffic_feature|规则类型，取值：traffic_feature。    |\n| status | String         | 是   | on|规则开关，取值：on（开启）。             |\n| config | TrafficFeature | 是   | {\"conditions\":[{\"key\":\"Header\",\"subKey\":\"User-Agent\",\"opValue\":\"contain\",\"values\":\"Chrome\"},{\"key\":\"IP\",\"subKey\":\"\",\"opValue\":\"ip-contain\",\"values\":\"192.168.0.1/24\"}]}|规则配置。具体请参见**condition**。 |\n| action | String         | 否   |置空| 规则动作，此处不涉及，置为空值。   |\n\n**condition**（匹配条件）\n| 参数    | 类型   | 必要 | 示例值|描述                                                         |\n| ------- | ------ | ---- | ------|----------------------- |\n| key     | String | 是   | Header|匹配字段，具体值请参见[DescribeDcdnWafFilterInfo](~~423285~~)。                |\n| subKey  | String | 否   | User-Agent|匹配子字段，具体值请参见[DescribeDcdnWafFilterInfo](~~423285~~)。               |\n| opValue | String | 是   | contain|操作符，具体值请参见[DescribeDcdnWafFilterInfo](~~423285~~)。                   |\n| values  | String | 否   | Chrome|匹配内容，多值使用英文逗号分隔，具体值请参见[DescribeDcdnWafFilterInfo](~~423285~~)。  |\n\n防护目标特征配置示例：\n```\n[\n  {\n    \"type\":\"traffic_feature\",\n    \"status\":\"on\",\n    \"config\":{\"conditions\":[{\"key\":\"Header\",\"subKey\":\"User-Agent\",\"opValue\":\"contain\",\"values\":\"Chrome\"},{\"key\":\"IP\",\"subKey\":\"\",\"opValue\":\"ip-contain\",\"values\":\"192.168.0.1/24\"}]},\n    \"action\":\"\"\n  }\n]\n```\n**规则分类四：合法Bot管理**\n\n| 参数   | 类型                | 必要 | 示例值|描述                           |\n| ------ | -------------|------ | ---- | ------------------------------ |\n| type   | String              | 是   | intelligence_crawler|规则类型，取值：intelligence_crawler。|\n| status | String              | 是   | on|规则开关，取值：on（开启）。                  |\n| config | IntelligenceCrawler | 否   | {\"name\":\"intelligence_crawler_baidu\"}|规则配置。取值请参见**name（搜索引擎蜘蛛白名单）**。 |\n| action | String              | 是   | bypass|规则动作，取值：bypass（放行）。               |\n\n**name（搜索引擎蜘蛛白名单）**\n| 参数值            | 含义                  |\n| ----------------- | ------------------------ |\n| intelligence_crawler_all   | 合法搜索引擎白名单（Google、Bing、百度、搜狗、360、Yandex）  |\n| intelligence_crawler_baidu   | 百度蜘蛛白名单  |\n| intelligence_crawler_sogou   | 搜狗蜘蛛白名单  |\n|  intelligence_crawler_360  |360蜘蛛白名单  |\n| intelligence_crawler_google   |Google蜘蛛白名单 |\n| intelligence_crawler_bing   |Bing蜘蛛白名单 |\n| intelligence_crawler_yandex    |andex蜘蛛白名单 |\n\n合法Bot管理配置示例：\n```\n[\n  {\n    \"type\":\"intelligence_crawler\",\n    \"status\":\"on\",\n    \"config\":{\"name\":\"intelligence_crawler_baidu\"},\n    \"action\":\"bypass\"\n  },\n  {\n    \"type\":\"intelligence_crawler\",\n    \"status\":\"on\",\n    \"config\":{\"name\":\"intelligence_crawler_google\"},\n    \"action\":\"bypass\"\n  }\n]\n```\n**规则分类五：简单脚本过滤（JavaScript挑战）**\n\n| 参数   | 类型   | 必要 | 示例值|描述               |\n| ------ | ------ | ---- | ------|------------ |\n| type   | String | 是   | js|规则类型，取值：js。       |\n| status | String | 是   | on|规则开关，取值：on（开启），off（关闭）。   |\n| config | Js     | 否   |置空| 规则配置，此处不涉及，置为空值。 |\n| action | String | 是   | js|规则动作，取值：js（JS校验）。       |\n\n简单脚本过滤（JavaScript挑战）配置示例：\n```\n[\n  {\n    \"type\":\"js\",\n    \"status\":\"on\",\n    \"config\":{},\n    \"action\":\"js\"\n  }\n]\n```\n**规则分类六：高级Bot防御（动态令牌挑战）**\n\n| 参数   | 类型   | 必要 | 示例值|描述                         |\n| ------ | ------ | ---- | -------|--------------------- |\n| type   | String | 是   | sigchl|规则类型，取值：sigchl。             |\n| status | String | 是   | on|规则开关，取值：on（开启），off（关闭）。             |\n| config | Sigchl | 否   | {\"sigchl\":[\"sig\",\"replay\",\"driver\"]}|规则配置，格式如下：<br>sigchl ：请求数据签名验证，必填。取值范围包含sig（签名验证异常），replay（签名时间戳异常），driver（WebDriver攻击）。 |\n| action | String | 是   | sigchl|规则动作，取值：sigchl（拦截）。             |\n\n高级Bot防御（动态令牌挑战）配置示例：\n```\n[\n  {\n    \"type\":\"sigchl\",\n    \"status\":\"on\",\n    \"config\":{\"sigchl\":[\"sig\",\"replay\",\"driver\"]},\n    \"action\":\"sigchl\"\n  }\n]\n```\n**规则分类七：AI智能防护**\n\n| 参数   | 类型      | 必要 | 示例值|描述                                      |\n| ------ | --------- | ---- | ------|----------------------------------- |\n| type   | String    | 是   | algorithm|规则类型，取值：algorithm。                       |\n| status | String    | 是   | on|规则开关，取值：on（开启），off（关闭）。                         |\n| config | Algorithm | 否   | 置空|规则配置，此处不涉及，置为空值。                        |\n| action | String    | 是   |captcha| 规则动作，取值：monitor（观察），captcha（滑块校验）。 |\n\nAI智能防护配置示例：\n```\n[\n  {\n    \"type\":\"algorithm\",\n    \"status\":\"on\",\n    \"config\":{},\n    \"action\":\"captcha\"\n  }\n]\n```\n **规则分类八：IP限速**\n\n| 参数   | 类型       | 必要 | 示例值|描述                                                    |\n| ------ | ---------- | ---- | ---------------|-------------- |\n| type   | String     | 是   | custom_cc_ip|规则类型，取值：custom_cc_ip。                                  |\n| status | String     | 是   | on|规则开关，取值：on（开启），off（关闭）。                                       |\n| config | CustomCcIp | 是   | {\"interval\":20,\"target\":\"IP\",\"threshold\":50,\"ttl\":2800}|规则配置，具体请参见**IP限速config参数说明** 。                           |\n| action | String     | 是   | monitor|规则动作，deny（拦截），monitor（观察），captcha（滑块，仅涉及Web) 。|\n\n**IP限速config参数说明**\n\n| 参数      | 类型    | 必要 |示例值| 描述                          |\n| --------- | ------- | ---- | -----|------------------------ |\n| target    | String  | 是   | IP|频次控制的统计字段，取值：IP。 |\n| subKey    | String  | 否   | 置空|统一字段的子字段，此处不涉及，置为空值。    |\n| Interval  | Integer | 是   | 20|统计时长，取值：5~1800，单位：秒。            |\n| threshold | Integer | 是   | 50|统计阈值，取值：2~50000，单位：次。          |\n| ttl       | Integer | 是   | 2800|黑名单超时时间，取值：60~86400，单位：秒。    |\n\nIP限速配置示例：\n```\n[\n  {\n    \"type\":\"custom_cc_ip\",\n    \"status\":\"on\",\n    \"config\":{\"interval\":20,\"target\":\"IP\",\"threshold\":50,\"ttl\":2800},\n    \"action\":\"monitor\"\n  },\n  {\n    \"type\":\"custom_cc_ip\",\n    \"status\":\"on\",\n    \"config\":{\"interval\":10,\"target\":\"IP\",\"threshold\":30,\"ttl\":1800},\n    \"action\":\"monitor\"\n  }\n]\n```\n**规则分类九：设备限速**\n\n| 参数   | 类型        | 必要 | 示例值|描述                               |\n| ------ | ----------- | ---- | ----|------------------------------ |\n| type   | String      | 是   | custom_cc_dev|规则类型，取值：custom_cc_dev。            |\n| status | String      | 是   | on|规则开关，取值：on（开启），off（关闭）。                 |\n| config | CustomCcDev | 是   |{\"interval\":20,\"target\":\"Header\",\"subKey\":\"aliwaf_wxbb_umid\",\"threshold\":50,\"ttl\":2800}| 配置规则，具体请参见**设备限速config参数说明** 。 |\n| action | String      | 是   |monitor| 规则动作，deny（拦截），monitor（观察）。 |\n\n**设备限速config参数说明**\n\n| 参数      | 类型    | 必要 |示例值| 描述                          |\n| --------- | ------- | ---- | ----|------------------------- |\n| target    | String  | 是   | Header|频次控制的统计字段，取值：Header。 |\n| subKey    | String  | 否   | aliwaf_wxbb_umid|统一字段的子字段，取值：aliwaf_wxbb_umid。    |\n| Interval  | Integer | 是   | 20|统计时长，取值：5~1800，单位：秒。            |\n| threshold | Integer | 是   | 50|统计阈值，取值：2~50000，单位：次。          |\n| ttl       | Integer | 是   | 2800|黑名单超时时间，取值：60~86400，单位：秒。    |\n\n设备限速配置示例：\n```\n[\n  {\n    \"type\":\"custom_cc_dev\",\n    \"status\":\"on\",\n    \"config\":{\"interval\":20,\"target\":\"Header\",\"subKey\":\"aliwaf_wxbb_umid\",\"threshold\":50,\"ttl\":2800},\n    \"action\":\"monitor\"\n  },\n  {\n    \"type\":\"custom_cc_dev\",\n    \"status\":\"on\",\n    \"config\":{\"interval\":20,\"target\":\"Header\",\"subKey\":\"aliwaf_wxbb_umid\",\"threshold\":50,\"ttl\":2800},\n    \"action\":\"deny\"\n  }\n]\n```\n**规则分类十：自定义会话限速**\n\n| 参数   | 类型       | 必要 | 示例值|描述                                                    |\n| ------ | ---------- | ---- | ----|----------------- |\n| type   | String     | 是   | custom_cc|规则类型，取值：custom_cc。                                  |\n| status | String     | 是   | on|规则开关，取值：on（开启），off（关闭）。                                      |\n| config | CustomCcIp | 是   | {\"interval\":10,\"target\":\"Query String Parameter\",\"subKey\":\"arg\",\"threshold\":30,\"ttl\":1800}|规则配置，具体请参见**自定义会话限速config参数说明** 。                           |\n| action | String     | 是   | monitor|规则动作，deny（拦截），monitor（观察），captcha（滑块，仅涉及Web) 。|\n\n**自定义会话限速config参数说明**\n| 参数      | 类型    | 必要 |示例值| 描述                          |\n| --------- | ------- | ---- | ---|-------------------------- |\n| target    | String  | 是   | Query String Parameter|频次控制的统计字段，取值：Header（表示统计包含指定Header的请求的频率），Query String Parameter（表示统计包含指定参数的请求的频率），Cookie Name（表示统计包含指定Cookie的请求的频率）和Session（表示统计来自同一个会话发起请求的频率）。 |\n| subKey    | String  | 否   | arg|统一字段的子字段，用户自定义。    |\n| Interval  | Integer | 是   | 10|统计时长，取值：5~1800，单位：秒。            |\n| threshold | Integer | 是   | 30|统计阈值，取值：2~50000，单位：次。          |\n| ttl       | Integer | 是   | 2800|黑名单超时时间，取值：60~86400，单位：秒。    |\n\n自定义会话限速配置示例：\n```\n[\n  {\n    \"type\":\"custom_cc\",\n    \"status\":\"on\",\n    \"config\":{\"interval\":10,\"target\":\"Query String Parameter\",\"subKey\":\"arg\",\"threshold\":30,\"ttl\":1800},\n    \"action\":\"deny\"\n  },\n  {\n    \"type\":\"custom_cc\",\n    \"status\":\"on\",\n    \"config\":{\"interval\":10,\"target\":\"Query String Parameter\",\"subKey\":\"arg\",\"threshold\":30,\"ttl\":1800},\n    \"action\":\"captcha\"\n  }\n]\n```\n**规则分类十一：爬虫威胁情报库**\n\n| 参数   | 类型         | 必要 | 示例值|描述                                      |\n| ------ | ------------ | ---- | -----|------------------------------------ |\n| type   | String       | 是   | intelligence|规则类型，取值：intelligence。                    |\n| status | String       | 是   | on|规则开关，取值：on（开启），off（关闭）。                         |\n| config | Intelligence | 否   |置空| 规则配置，此处不涉及，置为空值。                       |\n| action | String       | 是   |captcha| 规则动作，取值：monitor（观察），captcha（滑块校验）。 |\n\n爬虫威胁情报库配置示例：\n```\n[\n  {\n    \"type\":\"intelligence\",\n    \"status\":\"on\",\n    \"config\":{},\n    \"action\":\"captcha\"\n  }\n]\n```\n\n**规则分类十二：IDC黑名单封禁**\n\n| 参数   | 类型            | 必要 | 示例值|描述                                                 |\n| ------ | ----------- | ---- | -------|------------------------------ |\n| type   | String          | 是   |intelligence_idc |规则类型，取值：intelligence_idc。                           |\n| status | String          | 是   |on| 规则开关，取值：on（开启），off（关闭）。                                     |\n| config | IntelligenceIdc | 是   |{\"name\":\"intelligence_idc_alibaba\"}| 规则配置，取值请参见**name参数说明**。                       |\n| action | String          | 是   |captcha| 规则动作，取值：deny（拦截），monitor（观察），captcha（滑块校验）。 |\n\n**name参数说明**\n\n| 参数值            | 含义                  |\n| ----------------- | ------------------------ |\n| intelligence_idc_alibaba  | IDC IP库-阿里云 |\n| intelligence_idc_tencent  | IDC IP库-腾讯云 |\n| intelligence_idc_mtyun  | IDC IP库-美团云 |\n| intelligence_idc_vnet  |IDC IP库-世纪互联 |\n| intelligence_idc_other  |IDC IP库-其他 |\n\nIDC黑名单封禁配置示例：\n```\n[\n  {\n    \"type\":\"intelligence_idc\",\n    \"status\":\"on\",\n    \"config\":{\"name\":\"intelligence_idc_alibaba\"},\n    \"action\":\"captcha\"\n  },\n  {\n    \"type\":\"intelligence_idc\",\n    \"status\":\"on\",\n    \"config\":{\"name\":\"intelligence_idc_tencent\"},\n    \"action\":\"captcha\"\n  }\n]\n```\n**规则分类十三：伪造蜘蛛拦截**\n\n| 参数   | 类型                    | 必要 |示例值| 描述                                |\n| ------ | ---------------|-------- | ---- | --------- |\n| type   | String                  | 是   |intelligence_fake_crawler| 规则类型，取值：intelligence_fake_crawler。 |\n| status | String                  | 是   |on| 规则开关，取值：on（开启），off（关闭）。                   |\n| config | IntelligenceFakeCrawler | 否   |置空| 规则配置，此处不涉及，置为空值。                  |\n| action | String                  | 是   |deny| 规则动作，取值：deny（拦截）。                      |\n\n伪造蜘蛛拦截配置示例：\n```\n[\n  {\n    \"type\": \"intelligence_fake_crawler\",\n    \"status\": \"on\",\n    \"config\":{},\n    \"action\": \"deny\"\n  }\n]\n```\n**规则分类十四：Bot特征识别**\n\n| 参数   | 类型   | 必要 |示例值| 描述                               |\n| ------ | ------ | ---- | -----|----------------------------- |\n| type   | String | 是   |app_sdk| 规则类型，取值：app_sdk。                  |\n| status | String | 是   |on| 规则开关，取值：on（开启）。                    |\n| config | AppSdk | 是   |{\"featureAbnormal\":[\"simulator\",\"proxy\",\"root\",\"debugged\",\"hook\",\"virtual\",\"antiReplay\",\"signInvalid\"],\"customSignStatus\":\"on\",\"customSign\":{\"key\":\"header\",\"value\":\"ua\"}}| 规则配置，具体请参见**Bot特征识别config参数说明** 。     |\n| action | String | 是   |monitor| 规则动作，取值：deny（拦截），monitor（观察）。 |\n\n**Bot特征识别config参数说明**\n| 参数             | 类型       | 必要|示例值 | 描述                                                         |\n| ------------ | ------- | ---- | -------|---------------------------------- |\n| featureAbnormal  | []String   | 是   | simulator|signInvalid：APP签名异常。<br>antiReplay：签名过期。<br>simulator：使用模拟器<br>proxy：使用代理<br>root：Root设备<br>debugged：调试模式。<br>hook：APP被hook。<br>virtual ：APP多开。 |\n| customSignStatus | String     | 否   |on| 自定义加签字段开关，取值：on（开启），off（关闭）。                                   |\n| customSign       | CustomSign | 否   |{\"key\":\"header\",\"value\":\"ua\"}| 自定义加签字段，格式如下：  <br>  key ：字段名，必填。取值为header、arg、cookie。 <br> value：字段值，必填。                                      |\n\nBot特征识别配置示例：\n```\n[\n  {\n    \"type\": \"app_sdk\",\n    \"status\": \"on\",\n    \"config\": {\"featureAbnormal\":[\"simulator\",\"proxy\",\"root\",\"debugged\",\"hook\",\"virtual\",\"antiReplay\",\"signInvalid\"],\"customSignStatus\":\"on\",\"customSign\":{\"key\":\"header\",\"value\":\"ua\"}},\n    \"action\": \"monitor\"\n  }\n]\n```\n**规则分类十五：高级防护（二次打包检测）**\n\n| 参数   | 类型       | 必要 |示例值| 描述                               |\n| ------ | ---------- | ---- | ----|------------------------------ |\n| type   | String     | 是   |app_package| 规则类型，取值：app_package。              |\n| status | String     | 是   |on| 规则开关，取值：on（开启）。                       |\n| config | AppPackage | 否   |{\"packageSigns\":[{\"name\":\"aaaaa\",\"sign\":\"bbbb\"},{\"name\":\"cccc\",\"sign\":\"dddd\"}]}| 规则配置，具体请参见**packageSigns参数说明**。|\n| action | String     | 是   | monitor| 规则动作，取值：deny（拦截），monitor（观察）。|\n\n**packageSigns参数说明**\n| 参数 | 类型   | 必要 |示例值| 描述         |\n| ---- | ------ | ---- | ------|------ |\n| name | String | 是   |aaaaa| 指定合法包名。 |\n| sign | String | 否   |bbbb| 包签名。       |\n\n高级防护（二次打包检测）配置示例：\n```\n[\n  {\n    \"type\": \"app_package\",\n    \"status\": \"on\",\n    \"config\": {\"packageSigns\":[{\"name\":\"aaaaa\",\"sign\":\"bbbb\"},{\"name\":\"cccc\",\"sign\":\"dddd\"}]},\n    \"action\": \"deny\"\n  }\n]\n```\n**Bot管理网页/浏览器防护组合参数配置示例**\n```\n[\n    {\n        \"type\": \"target_type\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"target\": \"web\"\n        },\n        \"action\": \"\"\n    },\n    {\n        \"type\": \"web_sdk\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"mode\": \"automatic\",\n            \"crossDomain\": \"example.com\"\n        },\n        \"action\": \"\"\n    },\n    {\n        \"type\": \"traffic_feature\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"conditions\":\n            [\n                {\n                    \"key\": \"Header\",\n                    \"subKey\": \"User-Agent\",\n                    \"opValue\": \"contain\",\n                    \"values\": \"Chrome\"\n                },\n                {\n                    \"key\": \"IP\",\n                    \"subKey\": \"\",\n                    \"opValue\": \"ip-contain\",\n                    \"values\": \"192.168.0.1/24\"\n                }\n            ]\n        },\n        \"action\": \"\"\n    },\n    {\n        \"type\": \"intelligence_crawler\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"name\": \"intelligence_crawler_baidu\"\n        },\n        \"action\": \"bypass\"\n    },\n    {\n        \"type\": \"intelligence_crawler\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"name\": \"intelligence_crawler_google\"\n        },\n        \"action\": \"bypass\"\n    },\n    {\n        \"type\": \"js\",\n        \"status\": \"on\",\n        \"config\":\n        {},\n        \"action\": \"js\"\n    },\n    {\n        \"type\": \"sigchl\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"sigchl\":\n            [\n                \"sig\",\n                \"replay\",\n                \"driver\"\n            ]\n        },\n        \"action\": \"sigchl\"\n    },\n    {\n        \"type\": \"algorithm\",\n        \"status\": \"on\",\n        \"config\":\n        {},\n        \"action\": \"captcha\"\n    },\n    {\n        \"type\": \"custom_cc_ip\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 20,\n            \"target\": \"IP\",\n            \"threshold\": 50,\n            \"ttl\": 2800\n        },\n        \"action\": \"monitor\"\n    },\n    {\n        \"type\": \"custom_cc_ip\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 10,\n            \"target\": \"IP\",\n            \"threshold\": 30,\n            \"ttl\": 1800\n        },\n        \"action\": \"monitor\"\n    },\n    {\n        \"type\": \"custom_cc\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 10,\n            \"target\": \"Query String Parameter\",\n            \"subKey\": \"arg\",\n            \"threshold\": 30,\n            \"ttl\": 1800\n        },\n        \"action\": \"deny\"\n    },\n    {\n        \"type\": \"custom_cc\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 10,\n            \"target\": \"Query String Parameter\",\n            \"subKey\": \"arg\",\n            \"threshold\": 30,\n            \"ttl\": 1800\n        },\n        \"action\": \"captcha\"\n    },\n    {\n        \"type\": \"intelligence\",\n        \"status\": \"on\",\n        \"config\":\n        {},\n        \"action\": \"captcha\"\n    },\n    {\n        \"type\": \"intelligence_idc\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"name\": \"intelligence_idc_alibaba\"\n        },\n        \"action\": \"captcha\"\n    },\n    {\n        \"type\": \"intelligence_idc\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"name\": \"intelligence_idc_tencent\"\n        },\n        \"action\": \"captcha\"\n    },\n    {\n        \"type\": \"intelligence_fake_crawler\",\n        \"status\": \"on\",\n        \"config\":\n        {},\n        \"action\": \"deny\"\n    }\n]\n```\n**Bot管理APP防护组合参数配置示例**\n```json\n[\n    {\n        \"type\": \"target_type\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"target\": \"app\"\n        },\n        \"action\": \"\"\n    },\n    {\n        \"type\": \"traffic_feature\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"conditions\":\n            [\n                {\n                    \"key\": \"Header\",\n                    \"subKey\": \"User-Agent\",\n                    \"opValue\": \"contain\",\n                    \"values\": \"Chrome\"\n                },\n                {\n                    \"key\": \"IP\",\n                    \"subKey\": \"\",\n                    \"opValue\": \"ip-contain\",\n                    \"values\": \"192.168.0.1/24\"\n                }\n            ]\n        },\n        \"action\": \"\"\n    },\n    {\n        \"type\": \"custom_cc_ip\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 20,\n            \"target\": \"IP\",\n            \"threshold\": 50,\n            \"ttl\": 2800\n        },\n        \"action\": \"monitor\"\n    },\n    {\n        \"type\": \"custom_cc_ip\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 10,\n            \"target\": \"IP\",\n            \"threshold\": 30,\n            \"ttl\": 1800\n        },\n        \"action\": \"monitor\"\n    },\n    {\n        \"type\": \"custom_cc_dev\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 20,\n            \"target\": \"Header\",\n            \"subKey\": \"aliwaf_wxbb_umid\",\n            \"threshold\": 50,\n            \"ttl\": 2800\n        },\n        \"action\": \"monitor\"\n    },\n    {\n        \"type\": \"custom_cc_dev\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 20,\n            \"target\": \"Header\",\n            \"subKey\": \"aliwaf_wxbb_umid\",\n            \"threshold\": 50,\n            \"ttl\": 2800\n        },\n        \"action\": \"deny\"\n    },\n    {\n        \"type\": \"custom_cc\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 10,\n            \"target\": \"Query String Parameter\",\n            \"subKey\": \"arg\",\n            \"threshold\": 30,\n            \"ttl\": 1800\n        },\n        \"action\": \"monitor\"\n    },\n    {\n        \"type\": \"custom_cc\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"interval\": 10,\n            \"target\": \"Query String Parameter\",\n            \"subKey\": \"arg\",\n            \"threshold\": 30,\n            \"ttl\": 1800\n        },\n        \"action\": \"deny\"\n    },\n    {\n        \"type\": \"app_sdk\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"featureAbnormal\":\n            [\n                \"simulator\",\n                \"proxy\",\n                \"root\",\n                \"debugged\",\n                \"hook\",\n                \"virtual\",\n                \"antiReplay\",\n                \"signInvalid\"\n            ],\n            \"customSignStatus\": \"on\",\n            \"customSign\":\n            {\n                \"key\": \"header\",\n                \"value\": \"ua\"\n            }\n        },\n        \"action\": \"monitor\"\n    },\n    {\n        \"type\": \"app_package\",\n        \"status\": \"on\",\n        \"config\":\n        {\n            \"packageSigns\":\n            [\n                {\n                    \"name\": \"aaaaa\",\n                    \"sign\": \"bbbb\"\n                },\n                {\n                    \"name\": \"cccc\",\n                    \"sign\": \"dddd\"\n                }\n            ]\n        },\n        \"action\": \"deny\"\n    }\n]\n```\n\n### 防护场景7：扫描防护（anti_scan）\n\n**规则模板**\n\n所有的规则参数都是以下四个，具体值请参见对应规则分类。\n\n| 参数   | 类型   | 是否必选 | 描述                 |\n| ------ | ------ | ---- | -------------------- |\n| type   | String | 是   | 规则类型：参见对应规则分类。 |\n| status | String | 否   | 规则状态，取值：on（开启），off（关闭）。     |\n| config | Type   | 否   | 规则配置：参见对应规则分类。 |\n| action | String | 否   | 规则动作：参见对应规则分类。 |\n\n**规则分类一：高频扫描封禁**\n\n| 参数   | 类型          | 是否必选 | 示例值| 描述                               |\n| ------ | ------------- | ---- | ----------|------------------------ |\n| type   | String        | 是   | high_frequency| 规则类型，取值：high_frequency 。          |\n| status | String        | 是   | on| 规则开关，取值：on（开启），off（关闭）。默认为on。                   |\n| config | HighFrequency | 否   | {\"target\":\"IP\",\"interval\":20,\"wafBlockThreshold\":20,\"ttl\":1800,\"distinctWafRuleThreshold\":2}| 规则配置，具体请参见下方结构体字符串。      |\n| action | String        | 否   | deny| 规则动作，取值：deny（拦截），moniter（观察）。 |\n\n* HighFrequency说明\n\n| 参数                     | 类型    | 是否必选 | 示例值| 描述         |\n| ----------------- | ------| -------- | -------|----------------- |\n| target                   | String  | 是   | IP| 频次控制的统计字段，取值：IP（IP地址），Session（会话），Header（自定义Header），Query String Parameter（自定义参数），Cookie Name（自定义Cookie）。 |\n| subKey                   | String  | 否   | yoursubKey| 统计字段的子字段，选择自定义时有效。例如：如果target是自定义Header时，这个subKey就是Header的key。                           |\n| interval                 | Integer | 是   | 20| 检测时间范围，取值：5~1800，单位：秒。                                       |\n| wafBlockThreshold        | Integer | 是   | 20| 基础防护规则触发次数，取值：3~50000。                              |\n| ttl                      | Integer | 是   | 1800| 封禁时间，取值：60~86400，单位：秒。                                         |\n| distinctWafRuleThreshold | Integer | 是   | 2| 触发规则数大于，取值：1~50。                                       |\n\n```json\n[\n  {\n    \"type\":\"high_frequency\",\n    \"status\":\"on\",\n    \"config\":{\"target\":\"IP\",\"interval\":20,\"wafBlockThreshold\":20,\"ttl\":1800,\"distinctWafRuleThreshold\":2},\n    \"action\":\"deny\"\n  }\n]\n```\n\n**规则分类二：目录遍历封禁**\n\n| 参数   | 类型               | 是否必选 | 示例值| 描述                               |\n| ------ | ------------- | -------- | ------|----------------------- |\n| type   | String             | 是   | directory_traversal| 规则类型，取值：directory_traversal。      |\n| status | String             | 是   | on| 规则开关，取值：on（开启），off（关闭）。默认为on。                   |\n| config | DirectoryTraversal | 否   | {\"target\":\"IP\",\"interval\":10,\"threshold\":50,\"status\":{\"code\":\"404\",\"ratio\":70,\"count\":50},\"ttl\":1800}| 规则配置，具体请参见下方结构体字符串。       |\n| action | String             | 否   | deny| 规则动作，取值：deny（拦截），moniter（观察）。 |\n\n* DirectoryTraversal说明\n\n| 参数      | 类型            | 是否必选 | 示例值| 描述    |\n| --------| ---------- | ---- | -------|------------------------- |\n| target    | String          | 是   | IP| 频次控制的统计字段，取值：IP（IP地址），Session（会话），Header（自定义Header），Query String Parameter（自定义参数），Cookie Name（自定义Cookie）。 |\n| subKey    | String          | 否   | yoursubKey| 统计字段的子字段，选择自定义时有效。例如：如果target是自定义Header时，这个subKey就是Header的key。                          |\n| interval  | Integer         | 是   | 10| 检测时间范围，取值：5~1800，单位：秒。                                  |\n| threshold | Integer         | 是   | 50| 针对当前防护对象请求次数超过，取值：2~50000。                      |\n| status    | RateLimitStatus | 是   | {\"code\":\"404\",\"ratio\":70,\"count\":50}| 响应码。                                                       |\n| ttl       | Integer         | 是   | 1800| 封禁时间，取值：60~86400，单位：秒。                                       |\n\n* RateLimitStatus说明\n\n| 参数  | 类型    | 是否必选 | 示例值| 描述                            |\n| ----- | ------- | ---- | -----------|-------------------- |\n| code  | String  | 是   | 示例值| HTTP状态码，取值：404。           |\n| ratio | Integer | 是   | 示例值| 404响应码占比，取值：1~100。      |\n| count | Integer | 是   | 示例值| 不存在的目录数量，取值：2~50000。 |\n\n```json\n[\n  {\n    \"type\":\"directory_traversal\",\n    \"status\":\"on\",\n    \"config\":{\"target\":\"IP\",\"interval\":10,\"threshold\":50,\"status\":{\"code\":\"404\",\"ratio\":70,\"count\":50},\"ttl\":1800},\n    \"action\":\"deny\"\n  }\n]\n```\n\n**规则分类三：扫描工具封禁**\n\n| 参数   | 类型      | 是否必选 | 示例值| 描述                               |\n| ------ | --------- | ---- | ----------|------------------------ |\n| type   | String    | 是   | scan_tools| 规则类型，取值：scan_tools。               |\n| status | String    | 是   | on| 规则开关，取值：on（开启），off（关闭）。默认为on。                |\n| config | ScanTools | 否   | 空| 规则配置，这里不填。                 |\n| action | String    | 否   | deny| 规则动作，取值：deny（拦截），moniter（观察）。 |\n\n```json\n[\n  {\n    \"type\":\"scan_tools\",\n    \"status\":\"on\",\n    \"config\":{},\n    \"action\":\"deny\"\n  }\n]\n```\n\n**最终组合参数**\n\n```json\n[\n    {\n    \"type\":\"high_frequency\",\n    \"status\":\"on\",\n    \"config\":{\"target\":\"IP\",\"interval\":20,\"wafBlockThreshold\":20,\"ttl\":1800,\"distinctWafRuleThreshold\":2},\n    \"action\":\"deny\"\n  },\n  {\n    \"type\":\"directory_traversal\",\n    \"status\":\"on\",\n    \"config\":{\"target\":\"IP\",\"interval\":10,\"threshold\":50,\"status\":{\"code\":\"404\",\"ratio\":70,\"count\":50},\"ttl\":1800},\n    \"action\":\"deny\"\n  },\n  {\n    \"type\":\"scan_tools\",\n    \"status\":\"on\",\n    \"config\":{},\n    \"action\":\"deny\"\n  }\n]\n```"}