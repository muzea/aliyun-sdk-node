{"path":"/openapi/collectors","methods":["get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"resId","in":"query","schema":{"description":"采集器ID。","type":"string","required":false,"docRequired":false,"example":"ct-cn-77uqof2s7rg5c****"}},{"name":"name","in":"query","schema":{"description":"采集器名称。","type":"string","required":false,"example":"collectorName1"}},{"name":"instanceId","in":"query","schema":{"description":"采集器关联的实例ID。","type":"string","required":false,"example":"es-cn-nif1q8auz0003****"}},{"name":"page","in":"query","schema":{"description":"返回结果的分页数。默认值：1，最小值：1，最大值：200。","type":"integer","format":"int32","required":false,"maximum":"200","minimum":"1","example":"1"}},{"name":"size","in":"query","schema":{"description":"每页的结果数。默认值：20，最小值：1，最大值：500。","type":"integer","format":"int32","required":false,"maximum":"500","minimum":"1","example":"10"}},{"name":"sourceType","in":"query","schema":{"description":"指定采集器部署机器的类型，不填返回全部类型。可选值：\n\n- ECS：ECS实例\n\n- ACK：容器Kubernetes集群","type":"string","required":false,"example":"ECS"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"5FFD9ED4-C2EC-4E89-B22B-1ACB6FE1****"},"Headers":{"description":"返回头信息。","type":"object","properties":{"X-Total-Count":{"description":"返回的记录数。","type":"integer","format":"int32","example":"5"}}},"Result":{"description":"返回结果。","type":"array","items":{"type":"object","properties":{"resId":{"description":"采集器实例ID。","type":"string","example":"ct-cn-0v3xj86085dvq****"},"gmtUpdateTime":{"description":"采集器更新时间。","type":"string","example":"2020-08-18T09:40:43.000+0000"},"dryRun":{"description":"是否校验并创建采集器。支持：\n\n- true：只校验不创建\n- false：校验并创建","type":"boolean","example":"false"},"ownerId":{"description":"账号ID。","type":"string","example":"168520994880****"},"vpcId":{"description":"采集器所在的专有网络ID。","type":"string","example":"vpc-bp16k1dvzxtma*****"},"resType":{"description":"采集器类型。支持fileBeat、metricBeat、heartBeat和auditBeat。","type":"string","example":"fileBeat"},"resVersion":{"description":"采集器版本。","type":"string","example":"6.8.5_with_community"},"gmtCreatedTime":{"description":"采集器创建时间。","type":"string","example":"2020-08-18T02:06:12.000+0000"},"status":{"description":"采集器状态。支持：\n\n- activing：生效中\n\n- active：已生效","type":"string","example":"active"},"name":{"description":"采集器名称。","type":"string","example":"FileBeat001"},"configs":{"description":"采集器的配置文件信息。","type":"array","items":{"type":"object","properties":{"content":{"description":"文件内容。","type":"string","example":"- key: log\\n title: Log file content\\n description: >\\n Contains log file lines.\\n ...."},"fileName":{"description":"文件名称。","type":"string","example":"fields.yml"}}}},"extendConfigs":{"description":"扩展参数信息。","type":"array","items":{"type":"object","properties":{"successPodsCount":{"description":"ACK集群所有成功采集的Pod节点数。当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时显示。","type":"string","example":"8"},"protocol":{"description":"传输协议，需要与采集器Output指定实例的访问协议保持一致。支持HTTP、HTTPS。当**configType**为**collectorTargetInstance**时显示。\n","type":"string","example":"HTTP"},"userName":{"description":"采集器Output指定实例的访问用户名，默认为elastic。当**configType**为**collectorTargetInstance**或**collectorElasticsearchForKibana**时显示。\n","type":"string","example":"elastic"},"totalPodsCount":{"description":"ACK集群所有采集的Pod节点数。当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时显示。","type":"string","example":"10"},"type":{"description":"采集器部署的机器类型，当**configType**为**collectorDeployMachine**时显示。支持：\n\n- ECSInstanceId：ECS\n\n- ACKCluster：容器Kubernetes","type":"string","example":"ECSInstanceId"},"kibanaHost":{"description":"启用Kibana Dashboard后，Kibana的公网访问地址。当**configType**为**collectorElasticsearchForKibana**时显示。","type":"string","example":"https://es-cn-nif1z89fz003i****.kibana.elasticsearch.aliyuncs.com:5601"},"enableMonitoring":{"description":"是否启用Monitoring，当**configType**为**collectorTargetInstance**，且**instanceType**为**elasticsearch**时显示。支持：\n\n- true：启用\n\n- false：不启用","type":"boolean","example":"true"},"configType":{"description":"配置类型。支持：\n\n- collectorTargetInstance：采集器Output\n- collectorDeployMachine：采集器的部署机器\n- collectorElasticsearchForKibana：支持Kibana仪表盘的Elasticsearch实例信息\n","type":"string","example":"collectorDeployMachine"},"instanceType":{"description":"采集器Output指定的实例类型。支持elasticsearch、logstash。当**configType**为**collectorTargetInstance**时显示。\n\n","type":"string","example":"elasticsearch"},"groupId":{"description":"机器组ID。当**configType**为**collectorDeployMachine**时显示。","type":"string","example":"default_ct-cn-5i2l75bz4776****"},"host":{"description":"启用Kibana Dashboard后，Kibana的私网访问地址。当**configType**为**collectorElasticsearchForKibana**时显示。","type":"string","example":"es-cn-n6w1o1x0w001c****-kibana.internal.elasticsearch.aliyuncs.com:5601"},"instanceId":{"description":"采集器关联的实例ID。当**configType**为**collectorTargetInstance**时，为采集器Output的实例ID；当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时，为ACK（容器Kubernetes）集群ID。\n\n","type":"string","example":"es-cn-nif1z89fz003i****"},"machines":{"description":"采集器所部署的ECS机器列表信息。当**configType**为**collectorDeployMachines**，且**type**为**ECSInstanceId**时显示。\n","type":"array","items":{"type":"object","properties":{"agentStatus":{"description":"ECS上各采集器的状态。支持：\n\n- heartOk：心跳正常\n- heartLost：心跳异常\n- uninstalled：未安装\n- failed：安装失败\n","type":"string","example":"heartOk"},"instanceId":{"description":"ECS机器ID列表。\n","type":"string","example":"i-bp13y63575oypr9d****"}}}},"hosts":{"type":"array","items":{"description":"采集器Output指定实例的访问地址列表。当**configType**为**collectorTargetInstance**时显示。","type":"string","example":"[\"es-cn-n6w1o1x*****.elasticsearch.aliyuncs.com:9200\"]"}}}}},"collectorPaths":{"type":"array","items":{"description":"Filebeat的采集路径。","type":"string","example":"[\"/var/log\"]"}}}}}}}},"5XX":{"schema":{"type":"object","properties":{"Code":{"type":"string"},"Message":{"type":"string"},"RequestId":{"type":"string"}}}},"4XX":{"schema":{"type":"object","properties":{"Code":{"type":"string"},"Message":{"type":"string"},"RequestId":{"type":"string"}}}}},"errorCodes":{"400":[{"errorCode":"ComponentCodeValueError","errorMessage":"component value is disable"}],"401":[{"errorCode":"UserNotOpen","errorMessage":"Aliyun account is not open elasticsearch"},{"errorCode":"StsRoleAccountNoPermission","errorMessage":"Role account has no permission or expired"},{"errorCode":"SubAccountNoPermission","errorMessage":"Aliyun sub account has no permission, please authorize your sub account in Aliyun RAM"},{"errorCode":"UserUnauthorized","errorMessage":"Authentication required"}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"5FFD9ED4-C2EC-4E89-B22B-1ACB6FE1****\\\",\\n  \\\"Headers\\\": {\\n    \\\"X-Total-Count\\\": 5\\n  },\\n  \\\"Result\\\": [\\n    {\\n      \\\"resId\\\": \\\"ct-cn-0v3xj86085dvq****\\\",\\n      \\\"gmtUpdateTime\\\": \\\"2020-08-18T09:40:43.000+0000\\\",\\n      \\\"dryRun\\\": false,\\n      \\\"ownerId\\\": \\\"168520994880****\\\",\\n      \\\"vpcId\\\": \\\"vpc-bp16k1dvzxtma*****\\\",\\n      \\\"resType\\\": \\\"fileBeat\\\",\\n      \\\"resVersion\\\": \\\"6.8.5_with_community\\\",\\n      \\\"gmtCreatedTime\\\": \\\"2020-08-18T02:06:12.000+0000\\\",\\n      \\\"status\\\": \\\"active\\\",\\n      \\\"name\\\": \\\"FileBeat001\\\",\\n      \\\"configs\\\": [\\n        {\\n          \\\"content\\\": \\\"- key: log\\\\\\\\n title: Log file content\\\\\\\\n description: >\\\\\\\\n Contains log file lines.\\\\\\\\n ....\\\",\\n          \\\"fileName\\\": \\\"fields.yml\\\"\\n        }\\n      ],\\n      \\\"extendConfigs\\\": [\\n        {\\n          \\\"successPodsCount\\\": \\\"8\\\",\\n          \\\"protocol\\\": \\\"HTTP\\\",\\n          \\\"userName\\\": \\\"elastic\\\",\\n          \\\"totalPodsCount\\\": \\\"10\\\",\\n          \\\"type\\\": \\\"ECSInstanceId\\\",\\n          \\\"kibanaHost\\\": \\\"https://es-cn-nif1z89fz003i****.kibana.elasticsearch.aliyuncs.com:5601\\\",\\n          \\\"enableMonitoring\\\": true,\\n          \\\"configType\\\": \\\"collectorDeployMachine\\\",\\n          \\\"instanceType\\\": \\\"elasticsearch\\\",\\n          \\\"groupId\\\": \\\"default_ct-cn-5i2l75bz4776****\\\",\\n          \\\"host\\\": \\\"es-cn-n6w1o1x0w001c****-kibana.internal.elasticsearch.aliyuncs.com:5601\\\",\\n          \\\"instanceId\\\": \\\"es-cn-nif1z89fz003i****\\\",\\n          \\\"machines\\\": [\\n            {\\n              \\\"agentStatus\\\": \\\"heartOk\\\",\\n              \\\"instanceId\\\": \\\"i-bp13y63575oypr9d****\\\"\\n            }\\n          ],\\n          \\\"hosts\\\": [\\n            \\\"[\\\\\\\"es-cn-n6w1o1x*****.elasticsearch.aliyuncs.com:9200\\\\\\\"]\\\"\\n          ]\\n        }\\n      ],\\n      \\\"collectorPaths\\\": [\\n        \\\"[\\\\\\\"/var/log\\\\\\\"]\\\"\\n      ]\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"\",\"errorExample\":\"\"}]","title":"采集器列表信息","summary":"获取采集器列表信息。","requestParamsDescription":" ","responseParamsDescription":" **extendConfigs**中包括3种configType，分别为collectorTargetInstance、collectorElasticsearchForKibana、collectorDeployMachine，部署机器不同，返回的参数不同，具体组合方式如下：\n- collectorTargetInstance\n    - ECS\n      configType、instanceId、instanceType、hosts、userName、password、protocol、enableMonitoring\n    - ACK\n      configType、instanceId、instanceType、userName、password、protocol、enableMonitoring\n\n- collectorElasticsearchForKibana\n    - ECS\n      configType、instanceId、host、kibanaHost、userName、password、protocol\n    - ACK\n      configType\n   \n- collectorDeployMachine\n    - ECS\n      configType、type、machines、groupId\n    - ACK\n      configType、type、instanceId、totalPodsCount、successPodsCount","extraInfo":" "}