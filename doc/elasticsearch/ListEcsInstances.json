{"path":"/openapi/ecs","methods":["get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"page","in":"query","schema":{"description":"返回结果页数。最大值500。","type":"integer","format":"int32","required":false,"maximum":"200","minimum":"1","example":"1"}},{"name":"size","in":"query","schema":{"description":"每页包含的结果数。默认值10，最大值500。","type":"integer","format":"int32","required":false,"maximum":"500","minimum":"1","example":"10"}},{"name":"ecsInstanceIds","in":"query","schema":{"description":"ECS实例ID列表。取值可以由多个实例ID组成一个JSON数组，最多支持100个ID，ID之间用半角逗号（,）隔开。","type":"string","required":false,"example":"[\"i-bp13y63575oypr9d****\",\"i-bp1gyhphjaj73jsr****\"]"}},{"name":"ecsInstanceName","in":"query","schema":{"description":"ECS实例名称。","type":"string","required":false,"example":"test"}},{"name":"tags","in":"query","schema":{"description":"ECS实例标签，必须包含：\n\n- tagKey：标签键\n- tagValue：标签值","type":"string","required":false,"example":"[{ \"tagKey\":\"a\",\"tagValue\":\"b\"}]"}},{"name":"vpcId","in":"query","schema":{"description":"ECS实例所在的VPC ID。","type":"string","required":false,"example":"vpc-bp16k1dvzxtmagcva****"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"5FFD9ED4-C2EC-4E89-B22B-1ACB6FE1D***"},"Headers":{"description":"返回头信息。","type":"object","properties":{"X-Total-Count":{"description":"返回的记录数。","type":"integer","format":"int32","example":"11"}}},"Result":{"description":"返回结果。","type":"array","items":{"type":"object","properties":{"cloudAssistantStatus":{"description":"云助手安装状态，支持：\n\n- true：已安装\n- false：未安装","type":"string","example":"true"},"ecsInstanceName":{"description":"ECS实例名称。","type":"string","example":"ecsTestName"},"ecsInstanceId":{"description":"ECS实例ID。","type":"string","example":"i-bp14ncqge8wy3l3d****"},"tags":{"description":"ECS实例的标签信息。","type":"string","example":"[ { \"tagKey\": \"a\", \"tagValue\": \"b\" } ]"},"osType":{"description":"ECS实例的操作系统类型。支持：\n\n- windows：Windows操作系统\n- linux：Linux操作系统","type":"string","example":"linux"},"status":{"description":"ECS实例的状态。支持：\n\n- running：运行中\n- starting：启动中\n- stopping：停止中\n- stopped：已停止","type":"string","example":"running"},"ipAddress":{"description":"ECS实例的IP地址信息。\n","type":"array","items":{"type":"object","properties":{"ipType":{"description":"IP地址类型。支持：\n\n- public：公网地址\n- private：私网地址","type":"string","example":"private"},"host":{"description":"IP地址。","type":"string","example":"172.16.xx.xx"}}}},"collectors":{"description":"该ECS实例上，采集器信息列表。","type":"array","items":{"type":"object","properties":{"resId":{"description":"采集器实例ID。","type":"string","example":"ct-cn-0v3xj86085dvq****"},"gmtUpdateTime":{"description":"采集器更新时间。","type":"string","example":"2020-06-20T07:26:47.000+0000"},"dryRun":{"description":"是否校验并创建采集器。支持：\n\n- true：只校验不创建\n- false：校验并创建","type":"boolean","example":"false"},"ownerId":{"description":"账号ID。","type":"string","example":"16852***488*****"},"vpcId":{"description":"采集器所在的专有网络ID。\n\n","type":"string","example":"vpc-bp16k1dvzxtm******"},"resType":{"description":"采集器类型。支持fileBeat、metricBeat、heartBeat和auditBeat。","type":"string","example":"fileBeat"},"resVersion":{"description":"采集器版本。采集器部署的机器类型为ECS时，只支持**6.8.5_with_community**。","type":"string","example":"6.8.5_with_community"},"gmtCreatedTime":{"description":"采集器创建时间。","type":"string","example":"2020-06-20T07:26:47.000+0000"},"status":{"description":"采集器状态。支持：\n\n- activing：生效中\n- active：已生效","type":"string","example":"activing"},"name":{"description":"采集器名称。\n\n","type":"string","example":"ct-testAbc"},"configs":{"description":"采集器的配置文件信息。\n","type":"array","items":{"type":"object","properties":{"content":{"description":"文件内容。\n","type":"string","example":"- key: log\\n title: Log file content\\n description: >\\n Contains log file lines.\\n ...."},"fileName":{"description":"文件名称。","type":"string","example":"fields.yml"}}}},"extendConfigs":{"description":"扩展参数信息。","type":"array","items":{"type":"object","properties":{"enableMonitoring":{"description":"是否启用Monitoring，当**configType**为**collectorTargetInstance**，且**instanceType**为**elasticsearch**时显示。支持：\n\n- true：启用\n- false：不启用","type":"boolean","example":"true"},"groupId":{"description":"机器组ID。当**configType**为**collectorDeployMachine**时显示。","type":"string","example":"default_ct-cn-5i2l75bz4776****"},"configType":{"description":"配置类型。支持：\n\n- collectorTargetInstance：采集器Output\n- collectorDeployMachine：采集器的部署机器\n- collectorElasticsearchForKibana：支持Kibana仪表盘的Elasticsearch实例信息","type":"string","example":"collectorDeployMachine"},"instanceType":{"description":"采集器Output指定的实例类型。支持elasticsearch、logstash。当**configType**为**collectorTargetInstance**时显示。","type":"string","example":"elasticsearch"},"protocol":{"description":"传输协议，需要与采集器Output指定实例的访问协议保持一致。支持HTTP、HTTPS。当**configType**为**collectorTargetInstance**时显示。","type":"string","example":"HTTP"},"userName":{"description":"采集器Output指定实例的访问用户名，默认为elastic。当**configType**为**collectorTargetInstance**或**collectorElasticsearchForKibana**时显示。","type":"string","example":"elastic"},"type":{"description":"采集器部署的机器类型，当**configType**为**collectorDeployMachine**时显示。支持：\n\n- ECSInstanceId：ECS\n- ACKCluster：容器Kubernetes","type":"string","example":"ECSInstanceId"},"instanceId":{"description":"采集器关联的实例ID。当**configType**为**collectorTargetInstance**时，为采集器Output的实例ID；当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时，为ACK（容器Kubernetes）集群ID。","type":"string","example":"es-cn-nif1z89fz003i****"},"machines":{"description":"采集器所部署的ECS机器列表信息。当**configType**为**collectorDeployMachines**，且**type**为**ECSInstanceId**时显示。","type":"array","items":{"type":"object","properties":{"agentStatus":{"description":"ECS上各采集器的状态。支持：\n\n- heartOk：心跳正常\n- heartLost：心跳异常\n- uninstalled：未安装\n- failed：安装失败","type":"string","example":"heartOk"},"instanceId":{"description":"ECS机器ID列表。","type":"string","example":"i-bp13y63575oypr9d****"}}}},"hosts":{"type":"array","items":{"description":"采集器Output指定实例的访问地址列表。当**configType**为**collectorTargetInstance**时显示。","type":"string","example":"[\"es-cn-n6w1o1x*****.elasticsearch.aliyuncs.com:9200\"]"}}}}},"collectorPaths":{"type":"array","items":{"description":"Filebeat的采集路径。","type":"string","example":"[\"/var/log\"]"}}}}}}}}}}},"5XX":{"schema":{"type":"object","properties":{"Code":{"type":"string"},"Message":{"type":"string"},"RequestId":{"type":"string"}}}},"4XX":{"schema":{"type":"object","properties":{"Code":{"type":"string"},"Message":{"type":"string"},"RequestId":{"type":"string"}}}}},"errorCodes":{"400":[{"errorCode":"ComponentCodeValueError","errorMessage":"component value is disable"}],"401":[{"errorCode":"UserNotOpen","errorMessage":"Aliyun account is not open elasticsearch"},{"errorCode":"StsRoleAccountNoPermission","errorMessage":"Role account has no permission or expired"},{"errorCode":"SubAccountNoPermission","errorMessage":"Aliyun sub account has no permission, please authorize your sub account in Aliyun RAM"},{"errorCode":"UserUnauthorized","errorMessage":"Authentication required"}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"5FFD9ED4-C2EC-4E89-B22B-1ACB6FE1D***\\\",\\n  \\\"Headers\\\": {\\n    \\\"X-Total-Count\\\": 11\\n  },\\n  \\\"Result\\\": [\\n    {\\n      \\\"cloudAssistantStatus\\\": \\\"true\\\",\\n      \\\"ecsInstanceName\\\": \\\"ecsTestName\\\",\\n      \\\"ecsInstanceId\\\": \\\"i-bp14ncqge8wy3l3d****\\\",\\n      \\\"tags\\\": \\\"[ { \\\\\\\"tagKey\\\\\\\": \\\\\\\"a\\\\\\\", \\\\\\\"tagValue\\\\\\\": \\\\\\\"b\\\\\\\" } ]\\\",\\n      \\\"osType\\\": \\\"linux\\\",\\n      \\\"status\\\": \\\"running\\\",\\n      \\\"ipAddress\\\": [\\n        {\\n          \\\"ipType\\\": \\\"private\\\",\\n          \\\"host\\\": \\\"172.16.xx.xx\\\"\\n        }\\n      ],\\n      \\\"collectors\\\": [\\n        {\\n          \\\"resId\\\": \\\"ct-cn-0v3xj86085dvq****\\\",\\n          \\\"gmtUpdateTime\\\": \\\"2020-06-20T07:26:47.000+0000\\\",\\n          \\\"dryRun\\\": false,\\n          \\\"ownerId\\\": \\\"16852***488*****\\\",\\n          \\\"vpcId\\\": \\\"vpc-bp16k1dvzxtm******\\\",\\n          \\\"resType\\\": \\\"fileBeat\\\",\\n          \\\"resVersion\\\": \\\"6.8.5_with_community\\\",\\n          \\\"gmtCreatedTime\\\": \\\"2020-06-20T07:26:47.000+0000\\\",\\n          \\\"status\\\": \\\"activing\\\",\\n          \\\"name\\\": \\\"ct-testAbc\\\",\\n          \\\"configs\\\": [\\n            {\\n              \\\"content\\\": \\\"- key: log\\\\\\\\n title: Log file content\\\\\\\\n description: >\\\\\\\\n Contains log file lines.\\\\\\\\n ....\\\",\\n              \\\"fileName\\\": \\\"fields.yml\\\"\\n            }\\n          ],\\n          \\\"extendConfigs\\\": [\\n            {\\n              \\\"enableMonitoring\\\": true,\\n              \\\"groupId\\\": \\\"default_ct-cn-5i2l75bz4776****\\\",\\n              \\\"configType\\\": \\\"collectorDeployMachine\\\",\\n              \\\"instanceType\\\": \\\"elasticsearch\\\",\\n              \\\"protocol\\\": \\\"HTTP\\\",\\n              \\\"userName\\\": \\\"elastic\\\",\\n              \\\"type\\\": \\\"ECSInstanceId\\\",\\n              \\\"instanceId\\\": \\\"es-cn-nif1z89fz003i****\\\",\\n              \\\"machines\\\": [\\n                {\\n                  \\\"agentStatus\\\": \\\"heartOk\\\",\\n                  \\\"instanceId\\\": \\\"i-bp13y63575oypr9d****\\\"\\n                }\\n              ],\\n              \\\"hosts\\\": [\\n                \\\"[\\\\\\\"es-cn-n6w1o1x*****.elasticsearch.aliyuncs.com:9200\\\\\\\"]\\\"\\n              ]\\n            }\\n          ],\\n          \\\"collectorPaths\\\": [\\n            \\\"[\\\\\\\"/var/log\\\\\\\"]\\\"\\n          ]\\n        }\\n      ]\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"\",\"errorExample\":\"\"}]","title":"获取 ECS 实例列表","summary":"获取当前用户vpc和vswitch下的ECS 实例列表。","description":"><notice> 接口前置需要创建AliyunElasticsearchAccessingOOSRole和AliyunOOSAccessingECS4ESRole的系统服务角色，用于Elasticsearch服务账号获取主账号的ECS访问权限等，详细信息请参见[采集ECS服务日志](~~146446~~)。\n></notice>","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}