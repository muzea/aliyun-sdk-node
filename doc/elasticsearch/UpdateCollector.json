{"path":"/openapi/collectors/{ResId}","methods":["put"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"update"},"parameters":[{"name":"ResId","in":"path","schema":{"description":"采集器实例ID。\n\n","type":"string","required":true,"docRequired":true,"example":"ct-cn-77uqof2s7rg5c****"}},{"name":"ClientToken","in":"query","schema":{"description":"用于保证请求的幂等性。由客户端生成该参数值，要保证在不同请求间唯一，最大不超过64个ASCII字符。\n","type":"string","required":false,"example":"5A2CFF0E-5718-45B5-9D4D-70B3FF****"}},{"name":"body","in":"body","schema":{"type":"string","required":false,"docRequired":false}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"5FFD9ED4-C2EC-4E89-B22B-1ACB6FE1D***"},"Result":{"description":"返回结果。","type":"object","properties":{"resId":{"description":"采集器实例ID。\n","type":"string","example":"ct-cn-0v3xj86085dvq****"},"gmtUpdateTime":{"description":"采集器更新时间。","type":"string","example":"2020-06-20T07:26:47.000+0000"},"dryRun":{"description":"是否校验并创建采集器。支持：\n\n- true：只校验不创建\n- false：校验并创建\n","type":"boolean","example":"false"},"ownerId":{"description":"账号ID。\n","type":"string","example":"16852099488*****"},"vpcId":{"description":"采集器所在的专有网络ID。\n","type":"string","example":"vpc-bp16k1dvzxtma*****"},"resType":{"description":"采集器类型。支持fileBeat、metricBeat、heartBeat和auditBeat。\n","type":"string","example":"fileBeat"},"resVersion":{"description":"采集器版本。\n","type":"string","example":"6.8.5_with_community"},"gmtCreatedTime":{"description":"采集器创建时间。\n","type":"string","example":"2020-06-20T07:26:47.000+0000"},"status":{"description":"采集器状态。支持：\n\n- activing：生效中\n\n- active：已生效\n","type":"string","example":"active"},"name":{"description":"采集器名称。\n","type":"string","example":"ct-test"},"configs":{"description":"采集器的配置文件信息。","type":"array","items":{"type":"object","properties":{"content":{"description":"文件内容\n","type":"string","example":"filebeat.inputs:xxx"},"fileName":{"description":"文件名称\n","type":"string","example":"filebeat.yml"}}}},"extendConfigs":{"description":"扩展参数信息。","type":"array","items":{"type":"object","properties":{"successPodsCount":{"description":"ACK集群所有成功采集的Pod节点数。当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时显示。","type":"string","example":"8"},"protocol":{"description":"传输协议，需要与采集器Output指定实例的访问协议保持一致。支持HTTP、HTTPS。当**configType**为**collectorTargetInstance**时显示。\n\n","type":"string","example":"HTTP"},"userName":{"description":"采集器Output指定实例的访问用户名，默认为elastic。当**configType**为**collectorTargetInstance**或**collectorElasticsearchForKibana**时显示。\n\n","type":"string","example":"elastic"},"totalPodsCount":{"description":"ACK集群所有采集的Pod节点数。当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时显示。","type":"string","example":"10"},"type":{"description":"采集器部署的机器类型，当**configType**为**collectorDeployMachine**时显示。支持：\n\n- ECSInstanceId：ECS\n\n- ACKCluster：容器Kubernetes\n","type":"string","example":"ECSInstanceId"},"kibanaHost":{"description":"启用Kibana Dashboard后，Kibana的公网访问地址。当**configType**为**collectorElasticsearchForKibana**时显示。","type":"string","example":"https://es-cn-nif1z89fz003i****.kibana.elasticsearch.aliyuncs.com:5601"},"enableMonitoring":{"description":"是否启用Monitoring，当**configType**为**collectorTargetInstance**，且**instanceType**为**elasticsearch**时显示。支持true（启用）、false（不启用）。\n\n","type":"boolean","example":"true"},"configType":{"description":"配置类型。支持：\n\n- collectorTargetInstance：采集器Output\n- collectorDeployMachine：采集器的部署机器\n- collectorElasticsearchForKibana：支持Kibana仪表盘的Elasticsearch实例信息\n","type":"string","example":"collectorDeployMachine"},"instanceType":{"description":"采集器Output指定的实例类型。支持elasticsearch、logstash。当**configType**为**collectorTargetInstance**时显示。\n\n","type":"string","example":"elasticsearch"},"groupId":{"description":"机器组ID。当**configType**为**collectorDeployMachine**时显示。\n","type":"string","example":"default_ct-cn-5i2l75bz4776****"},"host":{"description":"启用Kibana Dashboard后，Kibana的私网访问地址。当**configType**为**collectorElasticsearchForKibana**时显示。","type":"string","example":"es-cn-n6w1o1x0w001c****-kibana.internal.elasticsearch.aliyuncs.com:5601"},"instanceId":{"description":"采集器关联的实例ID。当**configType**为**collectorTargetInstance**时，为采集器Output的实例ID；当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时，为ACK（容器Kubernetes）集群ID。\n\n","type":"string","example":"es-cn-nif1z89fz003i****"},"machines":{"description":"collectorDeployMachine类型专用：\n\n部署ECS机器/ACK集群信息\n\n","type":"array","items":{"type":"object","properties":{"agentStatus":{"description":"ECS上各采集器的状态。支持：\n\n- heartOk：心跳正常\n- heartLost：心跳异常\n- uninstalled：未安装\n- failed：安装失败\n\n","type":"string","example":"heartOk"},"instanceId":{"description":"ECS机器ID列表。\n","type":"string","example":"i-bp13y63575oypr9d****"}}}},"hosts":{"type":"array","items":{"description":"采集器Output指定实例的访问地址列表。当**configType**为**collectorTargetInstance**时显示。\n\n","type":"string","example":"[\"es-cn-n6w1o1x*****.elasticsearch.aliyuncs.com:9200\"]"}}}}},"collectorPaths":{"type":"array","items":{"description":"Filebeat的采集路径。\n","type":"string","example":"[\"/var/log\"]"}}}}}}},"5XX":{"schema":{"type":"object","properties":{"Code":{"type":"string"},"Message":{"type":"string"},"RequestId":{"type":"string"}}}},"4XX":{"schema":{"type":"object","properties":{"Code":{"type":"string"},"Message":{"type":"string"},"RequestId":{"type":"string"}}}}},"errorCodes":{"400":[{"errorCode":"ComponentCodeValueError","errorMessage":"component value is disable"}],"401":[{"errorCode":"UserNotOpen","errorMessage":"Aliyun account is not open elasticsearch"},{"errorCode":"StsRoleAccountNoPermission","errorMessage":"Role account has no permission or expired"},{"errorCode":"SubAccountNoPermission","errorMessage":"Aliyun sub account has no permission, please authorize your sub account in Aliyun RAM"},{"errorCode":"UserUnauthorized","errorMessage":"Authentication required"}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"5FFD9ED4-C2EC-4E89-B22B-1ACB6FE1D***\\\",\\n  \\\"Result\\\": {\\n    \\\"resId\\\": \\\"ct-cn-0v3xj86085dvq****\\\",\\n    \\\"gmtUpdateTime\\\": \\\"2020-06-20T07:26:47.000+0000\\\",\\n    \\\"dryRun\\\": false,\\n    \\\"ownerId\\\": \\\"16852099488*****\\\",\\n    \\\"vpcId\\\": \\\"vpc-bp16k1dvzxtma*****\\\",\\n    \\\"resType\\\": \\\"fileBeat\\\",\\n    \\\"resVersion\\\": \\\"6.8.5_with_community\\\",\\n    \\\"gmtCreatedTime\\\": \\\"2020-06-20T07:26:47.000+0000\\\",\\n    \\\"status\\\": \\\"active\\\",\\n    \\\"name\\\": \\\"ct-test\\\",\\n    \\\"configs\\\": [\\n      {\\n        \\\"content\\\": \\\"filebeat.inputs:xxx\\\",\\n        \\\"fileName\\\": \\\"filebeat.yml\\\"\\n      }\\n    ],\\n    \\\"extendConfigs\\\": [\\n      {\\n        \\\"successPodsCount\\\": \\\"8\\\",\\n        \\\"protocol\\\": \\\"HTTP\\\",\\n        \\\"userName\\\": \\\"elastic\\\",\\n        \\\"totalPodsCount\\\": \\\"10\\\",\\n        \\\"type\\\": \\\"ECSInstanceId\\\",\\n        \\\"kibanaHost\\\": \\\"https://es-cn-nif1z89fz003i****.kibana.elasticsearch.aliyuncs.com:5601\\\",\\n        \\\"enableMonitoring\\\": true,\\n        \\\"configType\\\": \\\"collectorDeployMachine\\\",\\n        \\\"instanceType\\\": \\\"elasticsearch\\\",\\n        \\\"groupId\\\": \\\"default_ct-cn-5i2l75bz4776****\\\",\\n        \\\"host\\\": \\\"es-cn-n6w1o1x0w001c****-kibana.internal.elasticsearch.aliyuncs.com:5601\\\",\\n        \\\"instanceId\\\": \\\"es-cn-nif1z89fz003i****\\\",\\n        \\\"machines\\\": [\\n          {\\n            \\\"agentStatus\\\": \\\"heartOk\\\",\\n            \\\"instanceId\\\": \\\"i-bp13y63575oypr9d****\\\"\\n          }\\n        ],\\n        \\\"hosts\\\": [\\n          \\\"[\\\\\\\"es-cn-n6w1o1x*****.elasticsearch.aliyuncs.com:9200\\\\\\\"]\\\"\\n        ]\\n      }\\n    ],\\n    \\\"collectorPaths\\\": [\\n      \\\"[\\\\\\\"/var/log\\\\\\\"]\\\"\\n    ]\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"\",\"errorExample\":\"\"}]","title":"修改采集器","summary":"修改采集器配置。","requestParamsDescription":"## RequestBody\nRequestBody中还需填入以下参数，用来指定待更新采集器的配置信息。\n| 参数 | 类型 | 是否必选 | 示例值 | 描述 |\n| --- | --- | --- | --- | --- |\n| dryRun | boolean | 是 | false | 是否校验并更新采集器。可选值：true（只校验不更新）、false（校验并更新）。 |\n| name | String | 是 | ct-test | 采集器名称。 |\n| status | String | 是 | activing | 采集器状态。可选值：activing（生效中）、active（已生效）。 |\n| resType | String | 是 | fileBeat | 采集器类型。可选值：fileBeat、metricBeat、heartBeat、auditBeat。|\n| vpcId | String | 是  | vpc-bp16k1dvzxtma\\***** | 采集器所在的专有网络ID。|\n| resVersion | String | 是 | 6.8.5\\_with_community | 采集器版本。|\n| ownerId | String | 是 | 16852099488\\***** | 账号ID。 |\n| gmtCreatedTime | Date | 是 | 2020-06-20T07:26:47.000+0000 | 采集器创建时间。 |\n| gmtUpdateTime | Date | 是 | 2020-06-20T07:26:47.000+0000 | 采集器更新时间。 |\n| collectorPaths | List<String> | 否 | [\"/var/log\"] | Filebeat采集路径。|\n| configs | List | 是 |  | 采集器的配置文件信息。|\n| └fileName | String | 是 | filebeat.yml | 文件名称。|\n| └content | String | 是 | \"filebeat.inputs:xxx\" | 文件内容。|\n| extendConfigs | Array | 是 |  | 采集器扩展配置。|\n| └configType | String | 是 | collectorElasticsearchForKibana | 配置类型。可选值：collectorTargetInstance（采集器Output）、collectorDeployMachine（采集器的部署机器）、collectorElasticsearchForKibana（支持Kibana仪表盘的Elasticsearch实例信息）。|\n| └type | String | 是 | ECSInstanceId | 采集器部署的机器类型。可选值：ECSInstanceId（ECS）、ACKCluster（容器Kubernetes）。当**configType**为**collectorDeployMachine**时必填。|\n| └machines | Array | 否 |  | 采集器所部署的ECS机器列表信息。当**configType**为**collectorDeployMachines**，且**type**为**ECSInstanceId**时，必填。 |\n|   └└instanceId | String | 否 | i-bp13y63575oypr9d**** | ECS机器ID列表。|\n|   └└agentStatus | String | 否 | failed | ECS上各采集器的状态。可选值：heartOk（心跳正常）、heartLost（心跳异常）、uninstalled（未安装）、failed（安装失败）。|\n| └groupId | String |  | default_ct-cn-5i2l75bz4776**** | 机器组ID。当**configType**为**collectorDeployMachine**时，必填。 |\n| └instanceId | String | 是 | es-cn-nif1z89fz003i**** | 采集器关联的实例ID。当**configType**为**collectorTargetInstance**时，为采集器Output的实例ID；当**configType**为**collectorDeployMachines**，且**type**为**ACKCluster**时，为ACK集群ID。 |\n| └protocol | String | 是 | HTTP | 传输协议，需要与采集器Output指定实例的访问协议保持一致。可选值HTTP、HTTPS。当**configType**为**collectorTargetInstance**时必填。|\n| └userName | String | 是 | elastic | 采集器Output指定实例的访问用户名，默认为elastic。当**configType**为**collectorTargetInstance**或**collectorElasticsearchForKibana**时必填。|\n| └enableMonitoring | Boolean | 是 | true | 是否启用Monitoring，当**configType**为**collectorTargetInstance**，且**instanceType**为**elasticsearch**时必填。可选值：true（启用）、false（不启用）。|\n| └hosts | List<String> | 否 | [\"es-cn-n6w1o1x\\*****.elasticsearch.aliyuncs.com:9200\"] | 采集器Output指定实例的访问地址列表。当**configType**为**collectorTargetInstance**时必填。 |\n| └instanceType | String | 是 | elasticsearch | 采集器Output指定的实例类型。可选值：elasticsearch、logstash。当**configType**为**collectorTargetInstance**时必填。|\n| └host | String | 否 | es-cn-n6w1o1x0w001c****-kibana.internal.elasticsearch.aliyuncs.com:5601 | 启用Kibana Dashboard后，Kibana的私网访问地址。当**configType**为**collectorElasticsearchForKibana**时必填。 |\n| └kibanaHost | String | 否 | https://es-cn-nif1z89fz003i****.kibana.elasticsearch.aliyuncs.com:5601 | 启用Kibana Dashboard后，Kibana的公网访问地址。当**configType**为**collectorElasticsearchForKibana**时必填。|\n\n> └表示子参数。\n\n### 特殊参数说明\n**extendConfigs**中包括3种configType，分别为collectorTargetInstance、collectorElasticsearchForKibana、collectorDeployMachine，部署机器不同，需要配置的参数不同，具体组合方式如下：\n\n- collectorTargetInstance\n    - ECS\n      configType、instanceId、instanceType、hosts、userName、password、protocol、enableMonitoring\n    - ACK\n      configType、instanceId、instanceType、userName、password、protocol、enableMonitoring\n\n- collectorElasticsearchForKibana\n    - ECS\n      configType、instanceId、host、kibanaHost、userName、password、protocol\n    - ACK\n      configType\n   \n- collectorDeployMachine\n    - ECS\n      configType、type、machines、groupId\n    - ACK\n      configType、type、instanceId、totalPodsCount、successPodsCount\n\n\n","responseParamsDescription":" ","extraInfo":" "}