{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"DBInstanceId","in":"query","schema":{"description":"实例ID。\n> 当本参数传入的是分片集群实例ID时，还需要传入**NodeId**参数。","type":"string","required":true,"example":"dds-bp12c5b040dc****"}},{"name":"NodeId","in":"query","schema":{"description":"分片集群实例中Mongos节点ID或Shard节点ID。\n\n> 当**DBInstanceId**参数传入的是分片集群实例ID时，本参数才可用。","type":"string","required":false,"example":"d-bp128a003436****"}},{"name":"StartTime","in":"query","schema":{"description":"查询开始时间，格式为<i>yyyy-MM-dd</i>T<i>HH:mm:ss</i>Z（UTC时间）。","type":"string","required":true,"example":"2019-03-13T12:11:14Z"}},{"name":"EndTime","in":"query","schema":{"description":"查询结束时间，必须晚于查询开始时间，格式为<i>yyyy-MM-dd</i>T<i>HH:mm:ss</i>Z（UTC时间）。\n> 查询结束时间距查询开始时间不得超过24个小时，超过则调用失败。","type":"string","required":true,"example":"2019-03-13T13:11:14Z"}},{"name":"Database","in":"query","schema":{"description":"数据库名，默认为所有数据库。","type":"string","required":false,"example":"database****"}},{"name":"User","in":"query","schema":{"description":"数据库账号，默认为所有账号。","type":"string","required":false,"example":"test"}},{"name":"Form","in":"query","schema":{"description":"审计记录返回的展示类型，取值：\n- **File**：触发审计日志文件的生成，若传入这个值，只返回公共参数。\n- **Stream**（默认值）：返回数据流。","type":"string","required":false,"example":"Stream","default":"Stream","enum":["File","Stream"]}},{"name":"QueryKeywords","in":"query","schema":{"description":"关键字查询。多个关键字以空格分隔，不超过10个关键字。","type":"string","required":false,"example":"slow"}},{"name":"LogicalOperator","in":"query","schema":{"description":"关键字搜索的逻辑操作， 默认值为and。","type":"string","required":false,"example":"and","default":"and","enum":["and","or"]}},{"name":"PageSize","in":"query","schema":{"description":"每页记录数。取值：**30**（默认值）、**50**、**100**。","type":"integer","format":"int32","required":false,"example":"30","default":"30"}},{"name":"PageNumber","in":"query","schema":{"description":"页码。大于0，且不超过Integer的最大值，默认值为**1**。","type":"integer","format":"int32","required":false,"example":"1","default":"1"}},{"name":"OrderType","in":"query","schema":{"description":"按时间的升降序对查询到的慢日志进行排序。取值：\n- **asc**：按时间升序排序。\n- **desc**：按时间降序排序。","type":"string","required":false,"example":"asc","default":"desc","enum":["desc","asc"]}}],"responses":{"200":{"schema":{"description":"总记录数。","type":"object","properties":{"TotalRecordCount":{"description":"总记录数。","type":"integer","format":"int32","example":"40"},"PageRecordCount":{"description":"当前页最大记录数。","type":"integer","format":"int32","example":"30"},"RequestId":{"description":"请求ID。","type":"string","example":"3278BEB8-503B-4E46-8F7E-D26E040C9769"},"PageNumber":{"description":"页码。","type":"integer","format":"int32","example":"1"},"Items":{"type":"object","properties":{"SQLRecord":{"description":"审计日志详情列表。","type":"array","items":{"description":"实例信息。","type":"object","properties":{"HostAddress":{"description":"客户端IP地址。","type":"string","example":"11.xxx.xxx.xxx"},"TableName":{"description":"MongoDB的集合名称。","type":"string","example":"C1"},"ReturnRowCounts":{"description":"返回记录数。","type":"integer","format":"int64","example":"2"},"DBName":{"description":"数据库名。","type":"string","example":"test123"},"ExecuteTime":{"description":"该语句执行的时间，格式为<i>yyyy-MM-dd</i>T<i>HH:mm:ss</i>Z（UTC时间）。","type":"string","example":"2019-03-11T03:30:27Z"},"ThreadID":{"description":"线程ID。","type":"string","example":"140682188297984"},"TotalExecutionTimes":{"description":"消耗时间，单位为微秒。","type":"integer","format":"int64","example":"700"},"Syntax":{"description":"执行语句。","type":"string","example":"{ \\\"atype\\\" : \\\"createCollection\\\", \\\"param\\\" : { \\\"ns\\\" : \\\"123.test1\\\" }, \\\"result\\\": \\\"OK\\\" }"},"AccountName":{"description":"数据库账号名。","type":"string","example":"test"}}}}}}}}}},"errorCodes":{"400":[{"errorCode":"InvalidStartTime.Format","errorMessage":"Specified start time is not valid."},{"errorCode":"InvalidEndTime.Format","errorMessage":"Specified end time is not valid."},{"errorCode":"InvalidEndTime.Invalid","errorMessage":"Specified end time is before this service active time."},{"errorCode":"InvalidParameterCombination","errorMessage":"The end time must be greater than the start time."},{"errorCode":"InvalidQueryKeyword.Format","errorMessage":"Specified Query Keyword is not valid."},{"errorCode":"InvalidDatabase.Format","errorMessage":"Specified Database is not valid."},{"errorCode":"InvalidQueryTime.Format","errorMessage":"Specified query time is not valid."}],"403":[{"errorCode":"IncorrectSQLLogActiveStatus","errorMessage":"Current DB instance SQL log active status does not support this operation."},{"errorCode":"LogApiFrequencyExceeded","errorMessage":"Exceeding the allowed frequency of log api."},{"errorCode":"ConcurrentTaskExceeded","errorMessage":"Concurrent task exceeding the allowed amount."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"TotalRecordCount\\\": 40,\\n  \\\"PageRecordCount\\\": 30,\\n  \\\"RequestId\\\": \\\"3278BEB8-503B-4E46-8F7E-D26E040C9769\\\",\\n  \\\"PageNumber\\\": 1,\\n  \\\"Items\\\": {\\n    \\\"SQLRecord\\\": [\\n      {\\n        \\\"HostAddress\\\": \\\"11.xxx.xxx.xxx\\\",\\n        \\\"TableName\\\": \\\"C1\\\",\\n        \\\"ReturnRowCounts\\\": 2,\\n        \\\"DBName\\\": \\\"test123\\\",\\n        \\\"ExecuteTime\\\": \\\"2019-03-11T03:30:27Z\\\",\\n        \\\"ThreadID\\\": \\\"140682188297984\\\",\\n        \\\"TotalExecutionTimes\\\": 700,\\n        \\\"Syntax\\\": \\\"{ \\\\\\\\\\\\\\\"atype\\\\\\\\\\\\\\\" : \\\\\\\\\\\\\\\"createCollection\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"param\\\\\\\\\\\\\\\" : { \\\\\\\\\\\\\\\"ns\\\\\\\\\\\\\\\" : \\\\\\\\\\\\\\\"123.test1\\\\\\\\\\\\\\\" }, \\\\\\\\\\\\\\\"result\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"OK\\\\\\\\\\\\\\\" }\\\",\\n        \\\"AccountName\\\": \\\"test\\\"\\n      }\\n    ]\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\r\\n<DescribeAuditRecordsResponse>\\r\\n\\t<Items>\\r\\n\\t\\t<SQLRecord>\\r\\n\\t\\t\\t<TotalExecutionTimes>703</TotalExecutionTimes>\\r\\n\\t\\t\\t<Syntax>{ &quot;atype&quot; : &quot;command&quot;, &quot;param&quot; : { &quot;command&quot; : &quot;find&quot;, &quot;ns&quot; : &quot;123.test1&quot;, &quot;args&quot; : { &quot;find&quot; : &quot;test1&quot;, &quot;filter&quot; : { &quot;x&quot; : 1, &quot;y&quot; : 2 }, &quot;shardVersion&quot; : [ { &quot;$timestamp&quot; : { &quot;t&quot; : 0, &quot;i&quot; : 0 } }, { &quot;$oid&quot; : &quot;000000000000000000000000&quot; } ], &quot;$clusterTime&quot; : { &quot;clusterTime&quot; : { &quot;$timestamp&quot; : { &quot;t&quot; : 1552275017, &quot;i&quot; : 2 } }, &quot;signature&quot; : { &quot;hash&quot; : { &quot;$binary&quot; : &quot;9qfygDs61fKCvdXJqjq+f0zML0E=&quot;, &quot;$type&quot; : &quot;00&quot; }, &quot;keyId&quot; : { &quot;$numberLong&quot; : &quot;6666955498811555841&quot; } } }, &quot;$client&quot; : { &quot;application&quot; : { &quot;name&quot; : &quot;MongoDB Shell&quot; }, &quot;driver&quot; : { &quot;name&quot; : &quot;MongoDB Internal Client&quot;, &quot;version&quot; : &quot;3.4.10&quot; }, &quot;os&quot; : { &quot;type&quot; : &quot;Linux&quot;, &quot;name&quot; : &quot;Ubuntu&quot;, &quot;architecture&quot; : &quot;x86_64&quot;, &quot;version&quot; : &quot;16.04&quot; }, &quot;mongos&quot; : { &quot;host&quot; : &quot;rxxxxxx.cloud.cm10:3074&quot;, &quot;client&quot; : &quot;47.xxx.xxx.xx:53854&quot;, &quot;version&quot; : &quot;4.0.0&quot; } }, &quot;$configServerState&quot; : { &quot;opTime&quot; : { &quot;ts&quot; : { &quot;$timestamp&quot; : { &quot;t&quot; : 1552275017, &quot;i&quot; : 2 } }, &quot;t&quot; : { &quot;$numberLong&quot; : &quot;3&quot; } } }, &quot;$db&quot; : &quot;123&quot; } }, &quot;result&quot;: &quot;OK&quot; }</Syntax>\\r\\n\\t\\t\\t<HostAddress>11.xxx.xxx.xx</HostAddress>\\r\\n\\t\\t\\t<ExecuteTime>2019-03-11T03:30:27Z</ExecuteTime>\\r\\n\\t\\t\\t<ThreadID>139xxxxxxxx</ThreadID>\\r\\n\\t\\t\\t<AccountName>__system;</AccountName>\\r\\n\\t\\t\\t<DBName>local;</DBName>\\r\\n\\t\\t</SQLRecord>\\r\\n\\t\\t<SQLRecord>\\r\\n\\t\\t\\t<TotalExecutionTimes>0</TotalExecutionTimes>\\r\\n\\t\\t\\t<Syntax>{ &quot;atype&quot; : &quot;createIndex&quot;, &quot;param&quot; : { &quot;ns&quot; : &quot;123.test1&quot;, &quot;indexName&quot; : &quot;y_1&quot;, &quot;indexSpec&quot; : { &quot;v&quot; : 2, &quot;key&quot; : { &quot;y&quot; : 1 }, &quot;name&quot; : &quot;y_1&quot;, &quot;ns&quot; : &quot;123.test1&quot; } }, &quot;result&quot;: &quot;OK&quot; }</Syntax>\\r\\n\\t\\t\\t<HostAddress></HostAddress>\\r\\n\\t\\t\\t<ExecuteTime>2019-03-11T03:30:06Z</ExecuteTime>\\r\\n\\t\\t\\t<ThreadID>140xxxxxxxx</ThreadID>\\r\\n\\t\\t\\t<AccountName>__system;</AccountName>\\r\\n\\t\\t\\t<DBName>local;</DBName>\\r\\n\\t\\t</SQLRecord>\\r\\n\\t</Items>\\r\\n\\t<PageNumber>1</PageNumber>\\r\\n\\t<TotalRecordCount>2</TotalRecordCount>\\r\\n\\t<RequestId>3278BEB8-503B-4E46-8F7E-D26E040C9769</RequestId>\\r\\n\\t<PageRecordCount>30</PageRecordCount>\\r\\n</DescribeAuditRecordsResponse>\",\"errorExample\":\"\"}]","title":"查询实例的审计日志","summary":"查询MongoDB实例的审计日志。","description":"- 调用本接口时，实例的审计日志须处于开通状态，否则返回的审计日志内容为空。\n- 本接口适用于规格类型为**通用型本地盘版**和**独享型本地盘版**实例。\n- 本接口限制每分钟调用30次，如超过这个限制会被限流，请勿高频调用。如需高频调用，请使用Logstore，详情请参见[管理Logstore](~~48990~~)。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}