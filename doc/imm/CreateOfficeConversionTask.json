{"summary":"创建文档转换任务。支持文档格式转换，将存储在对象存储中的文档（Word、PPT、Excel、PDF）转成图片，文本，或者PDF。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"129600","abilityTreeNodes":["FEATUREimmV2RAAA"]},"parameters":[{"name":"ProjectName","in":"query","schema":{"title":"项目名称","description":"项目名称，获取方式请参见[创建项目](~~478153~~)。","type":"string","required":true,"example":"test-project"}},{"name":"SourceURI","in":"query","schema":{"title":"文档转换输入文件地址","description":"源数据的存储地址。\n\nOSS地址规则为oss://${Bucket}/${Object}，其中`${Bucket}`为和当前项目处于同一区域(Region)的OSS Bucket名称，`${Object}`为包含文件扩展名的文件完整路径。","type":"string","required":true,"example":"oss://test-bucket/test-object"}},{"name":"TargetURI","in":"query","schema":{"title":"文档转换输出地址模式","description":"文档转换输出地址模板。\n\n地址规则为`oss://{bucket}/{tags.custom}/{dirname}/{barename}.{autoext}`。更多信息，请参见[TargetURI模板](~~465762~~)。\n\n> 和 TargetURIPrefix 二者至少需要填一个。","type":"string","required":false,"example":"oss://{bucket}/{tags.custom}/{dirname}/{barename}.{autoext}"}},{"name":"TargetURIPrefix","in":"query","schema":{"title":"文档转换输出文件地址前缀","description":"文档转换后输出文件的存储地址前缀。\n\n规则为oss://${Bucket}/，其中`${Bucket}`为和当前项目处于同一区域(Region)的OSS Bucket名称。\n\n> 和 TargetURI 二者至少需要填一个。","type":"string","required":false,"example":"oss://test-bucket/"}},{"name":"SourceType","in":"query","schema":{"title":"输入文件格式，默认使用文件名后缀小写格式","description":"源数据的后缀类型。默认根据OSS对象的后缀名确定源数据的类型。当OSS对象没有后缀名时，可以设置此参数，可选值如下。\n\n- 文字文档（Word）：doc、docx、wps、wpss、docm、dotm、dot、dotx、html\n\n- 演示文档（PPT）：pptx、ppt、pot、potx、pps、ppsx、dps、dpt、pptm、potm、ppsm、dpss\n\n- 表格文档（Excel）：xls、xlt、et、ett、xlsx、xltx、csv、xlsb、xlsm、xltm、ets\n\n- PDF文档：pdf","type":"string","required":false,"example":"doc"}},{"name":"TargetType","in":"query","schema":{"title":"输出文件格式","description":"转换输出的目标文件类型。包括如下选项：\n\n- png：转换为PNG格式的图片文件。\n- jpg：转换为JPG格式的图片文件。\n- pdf：转换为PDF文件。\n- txt：转换为只包含文本内容的文件，主要用于提取文件的文本内容。源数据类型只支持演示文档、文字文档和表格文档。表格文档转换结果生成一个txt文件，sheet相关的变量设置不生效。","type":"string","required":true,"example":"png"}},{"name":"UserData","in":"query","schema":{"title":"用户自定义数据，在消息通知中返回","description":"用户自定义信息，在异步消息通知中会为您返回，用于方便您系统内对消息通知进行关联处理。最大长度为2048字节。","type":"string","required":false,"example":"{\n      \"id\": \"test-id\",\n      \"name\": \"test-name\"\n}"}},{"name":"Tags","in":"query","style":"json","schema":{"title":"用户自定义标签","description":"自定义标签信息，字典格式。用于搜索任务。","type":"object","required":false,"example":"{\n      \"key\": \"value\"\n}"}},{"name":"StartPage","in":"query","schema":{"title":"转换起始页，从 1 开始，包含起始页，默认从第一页开始转换，表格转图片时需要指定 SheetIndex 才有效","description":"文档转换的起始页，默认值为1。\n>如果源文件为表格文档需要指定工作表页码（SheetIndex）。","type":"integer","format":"int64","required":false,"example":"1"}},{"name":"EndPage","in":"query","schema":{"title":"转换终止页，包含终止页，默认转换到最后一页，表格转图片时需要指定 SheetIndex 才有效","description":"文档转换的结束页，默认值为-1，表示转换所有页。\n>- 如果源文件为表格文档需要指定工作表页码（SheetIndex）。\n>- 如果页码太多，建议分批转换，否则可能会导致转换超时。","type":"integer","format":"int64","required":false,"example":"-1"}},{"name":"Password","in":"query","schema":{"title":"文档密码","description":"文档的打开密码。如果需要转换有密码的文档，请设置此参数。","type":"string","required":false,"example":"123456"}},{"name":"ScalePercentage","in":"query","schema":{"title":"缩放参数，允许范围 20~200，100代表不缩放，小于100表示缩小，大于100表示放大，默认不缩放","description":"文档缩放比例，取值范围为20~200，默认值为100，表示不缩放。\n> 小于100表示缩小，大于100表示放大。","type":"integer","format":"int64","required":false,"example":"100"}},{"name":"Quality","in":"query","schema":{"title":"质量参数，范围是0-100，越大质量越好，默认系统自动选择适合的分辨率","description":"转换文件的质量，取值范围为0（质量最差，性能最好）~100（质量最好，性能最差）。默认情况下，系统会根据文档内容，在质量和性能中权衡，设置合适的值。","type":"integer","format":"int64","required":false,"example":"60"}},{"name":"Pages","in":"query","schema":{"title":"指定转换页码，优先级高于 StartPage/EndPage，格式：多个页码用 “,\" 拼接，连续页码用 \"-\" 连接，样例参考: 1,2-4,7","description":"指定转换页码。优先级高于参数StartPage和参数EndPage。格式如下：\n\n- 多个页码用半角逗号（,）隔开，例如1,2。\n\n- 连续页码用短划线（-）连接，例如1,2-4,7。","type":"string","required":false,"example":"1,2-4,7"}},{"name":"MaxSheetRow","in":"query","schema":{"title":"表格转图片的最大行数，在 LongPicture 为 true 时生效，默认转所有行","description":"表格文档转换为图片的最大行数，默认转换所有行。\n>当参数**LongPicture**取值为`true`时，此参数生效。","type":"integer","format":"int64","required":false,"example":"10"}},{"name":"MaxSheetColumn","in":"query","schema":{"title":"表格转图片的最大列数，在 LongPicture 为 true 时生效，默认转所有列","description":"表格文档转换为图片的最大列数，默认转换所有列。\n>当参数**LongPicture**取值为`true`时，此参数生效。","type":"integer","format":"int64","required":false,"example":"10"}},{"name":"SheetCount","in":"query","schema":{"title":"表格转图片参数，指定转换表格中的 sheet 数量，默认转换所有 sheet","description":"表格文档中转换为图片的工作表（sheet）的数量，默认转换所有工作表。","type":"integer","format":"int64","required":false,"example":"1"}},{"name":"SheetIndex","in":"query","schema":{"title":"表格转图片参数，指定转换哪一个 sheet，从 1 开始，默认从起始页开始转","description":"表格文档中转换为图片的工作表（sheet）的页码，取值范围为1~最后一个sheet页。默认转换起始页为1。","type":"integer","format":"int64","required":false,"example":"1"}},{"name":"FitToWidth","in":"query","schema":{"title":"表格转图片参数，是否将所有列输出到一张图片，默认为否","description":"表格文档转换为图片或者PDF文件时，是否将所有列输出到一张图片或者PDF页面。取值范围如下：\n\n- false（默认）：否。输出成多张图片，多张PDF页面。\n\n- true：是。输出成一张图片，一张PDF页面。","type":"boolean","required":false,"example":"false"}},{"name":"FitToHeight","in":"query","schema":{"title":"表格转图片参数，是否将所有行输出到一张图片，默认为否","description":"表格文档转换为图片或者PDF文件时，是否将所有行输出到一张图片或者PDF页面。取值范围如下：\n\n- false（默认）：否。输出成多张图片，多张PDF页面。\n\n- true：是。输出成一张图片，一张PDF页面。","type":"boolean","required":false,"example":"false"}},{"name":"FirstPage","in":"query","schema":{"title":"表格转图片参数，是否只返回表格的第一张图片，默认为否","description":"表格文档转换为图片时，是否只返回转换结果的第一张图片（图片包含的行数和列数为自动切割的结果）。取值范围如下：\n\n- false（默认）：否。返回所有图片。\n\n- true：是。只返回第一张图片（提取缩略图）。\n\n>仅当参数**LongPicture**取值为`true`时，此参数生效。","type":"boolean","required":false,"example":"false"}},{"name":"PaperSize","in":"query","schema":{"title":"表格转图片纸张大小，支持 A4/A2/A0，默认A4，配合 FitToHeight 或 FitToWidth 一起使用才有效","description":"表格文档转换为图片时的纸张大小（输出图片可以类比为在纸张上面打印）。取值范围如下：\n\n- A0\n\n- A2\n\n- A4（默认）\n\n> 需配合参数**FitToHeight**和参数**FitToWidth**一起使用，此参数才能生效。","type":"string","required":false,"example":"A4"}},{"name":"PaperHorizontal","in":"query","schema":{"title":"表格转图片纸张是否水平放置，默认为否","description":"表格文档转换为图片时纸张是否水平放置（输出图片可以类比为在纸张上面打印）。取值范围如下：\n\n- false（默认）：否。垂直放置。\n\n- true：是。水平放置。","type":"boolean","required":false,"example":"false"}},{"name":"TrimPolicy","in":"query","style":"json","schema":{"title":"表格瘦身","description":"表格文档转换的瘦身策略。比如表格中有很多没有内容的行列，在没有瘦身策略的情况下，可能会输出很多空白。","required":false,"$ref":"#/components/schemas/TrimPolicy"}},{"name":"ShowComments","in":"query","schema":{"title":"文字转图片，是否显示批注，目前只支持文字转图片时携带批注，默认不显示批注","description":"文字文档转换为图片时，是否显示批注。取值范围如下：\n\n- false（默认）：否。不显示批注。\n\n- true：是。显示批注。","type":"boolean","required":false,"example":"false"}},{"name":"LongPicture","in":"query","schema":{"title":"转图片时是否转换成一张长图，最多支持将 20 页合成一张长图，超过可能报错，默认为不转成长图","description":"文档转换为图片时是否转换为一张长图。取值范围如下：\n\n- false（默认）：否。转换成多张图。\n\n- true：是。转换成一张长图。\n\n> 最多支持将20页文档合成一张长图，超过该页数的转换任务可能会报错。","type":"boolean","required":false,"example":"false"}},{"name":"ImageDPI","in":"query","schema":{"title":"输出图片 DPI，允许范围 96-600，默认 96","description":"输出图片DPI，取值范围为96~600，默认值为96。","type":"integer","format":"int64","required":false,"example":"96"}},{"name":"LongText","in":"query","schema":{"title":"转文本时是否转换成长文本，默认每页是个独立的文本","description":"文档转换为文本时是否转换为长文本文件。取值范围如下：\n\n- false（默认）：否。每页文档转换为独立的文本文件。\n\n- true：是。所有内容都放到一个文本文件中。","type":"boolean","required":false,"example":"false"}},{"name":"HoldLineFeed","in":"query","schema":{"title":"转文本时是否保留文档中的换行符，默认不保留","description":"文档转换为文本时是否保留文档中的换行符。取值范围如下：\n\n- false（默认）：否。不保留换行符。\n\n- true：是。保留换行符。","type":"boolean","required":false,"example":"false"}},{"name":"CredentialConfig","in":"query","style":"json","schema":{"description":"链式授权配置，非必填。更多信息，请参见[使用链式授权访问其他实体资源](~~465340~~)。","required":false,"$ref":"#/components/schemas/CredentialConfig"}},{"name":"Notification","in":"query","style":"json","schema":{"description":"消息通知配置，详细内容请单击Notification查看，异步通知消息格式请参见[异步通知消息格式](~~471456~~)。","required":false,"$ref":"#/components/schemas/Notification"}}],"responses":{"200":{"schema":{"title":"文档转换任务","description":"异步任务响应。","type":"object","properties":{"RequestId":{"title":"请求 id","description":"请求ID。","type":"string","example":"FF3B7D81-66AE-47E0-BF69-157DCF18*****"},"TaskId":{"title":"任务 id","description":"任务ID。","type":"string","example":"formatconvert-00bec802-073a-4b61-ba3b-39bc2fdd*****"},"EventId":{"description":"事件ID。","type":"string","example":"2C2-1I0EG57VR37J4rQ8oKG6C9*****"}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"FF3B7D81-66AE-47E0-BF69-157DCF18*****\\\",\\n  \\\"TaskId\\\": \\\"formatconvert-00bec802-073a-4b61-ba3b-39bc2fdd*****\\\",\\n  \\\"EventId\\\": \\\"2C2-1I0EG57VR37J4rQ8oKG6C9*****\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"\",\"errorExample\":\"\"}]","title":"创建文档转换任务","description":"- **请确保在使用该接口前，已充分了解智能媒体管理产品的收费方式和[价格](~~477042~~)**\n- 支持的输入文件格式：\n    - 文字文档（Word）：doc、docx、wps、wpss、docm、dotm、dot、dotx、html。\n    - 演示文档（PPT）：pptx、ppt、pot、potx、pps、ppsx、dps、dpt、pptm、potm、ppsm、dpss。\n    - 表格文档（Excel）：xls、xlt、et、ett、xlsx、xltx、csv、xlsb、xlsm、xltm、ets。\n    - PDF 文档：pdf。\n- 支持的输出文件格式：\n    - 图片：png、jpg。\n    - 文本：txt。\n    - PDF：pdf。\n- 单文件大小限制200MB以内。\n- 支持最长的转换时间120秒，如果文件比较大或者文件内容本身比较复杂，可能会导致转换超时。\n\n- 任务开始执行后，任务信息只保存7天，超过7天则无法再获取。您可以通过以下几种方式及时获取任务信息：\n    - 调用[GetTask](~~GetTask~~)或[ListTasks](~~ListTasks~~)接口获取返回的`TaskId`，查看任务信息。\n    - 在与智能媒体管理相同的地域下开通MNS服务，并配置订阅关系，及时获取任务信息通知，异步通知消息格式请参见[异步通知消息格式](~~471456~~)。关于MNS SDK的更多信息，请参见[接收和删除消息](~~32449~~)。\n    - 在与智能媒体管理相同的地域下开通RocketMQ服务，并创建RocketMQ 4.0实例、Topic、Group，及时获取任务信息通知，异步通知消息格式请参见[异步通知消息格式](~~471456~~)。关于RocketMQ使用的更多信息，请参见[快速使用HTTP协议的SDK收发普通消息](https://help.aliyun.com/document_detail/169009.html)。\n    - 在与智能媒体管理相同的地域下开通并接入[事件总线EventBridge](https://www.aliyun.com/product/aliware/eventbridge)服务，及时获取任务信息通知。更多信息，请参见[智能媒体管理IMM事件](~~205730~~)。"}