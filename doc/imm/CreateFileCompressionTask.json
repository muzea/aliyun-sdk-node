{"summary":"文件压缩任务可以将您的多个文件，打包为zip等压缩包。您提交任务后会异步打包文件，将结果存储到指定位置。在打包时支持对文件进行重命名操作，您可以自定义文件打包规则以及输出的压缩包名称。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"156182","abilityTreeNodes":["FEATUREimmSETH07"]},"parameters":[{"name":"ProjectName","in":"query","schema":{"description":"项目名称，获取方式请参见[创建项目](~~478153~~)。","type":"string","required":true,"example":"test-project"}},{"name":"Sources","in":"query","style":"json","schema":{"description":"待压缩的文件列表和打包规则描述。\n\n\n> 与参数SourceManifestURI二选一。Sources支持最多100条打包规则，超长请使用参数SourceManifestURI。","type":"array","items":{"description":"待打包的文件的OSS地址和对应的打包规则描述。","type":"object","properties":{"URI":{"description":"待压缩的目录或文件的OSS地址。\n\nOSS地址规则为oss://${Bucket}/${Object}，其中`${Bucket}`为和当前项目处于同一区域(Region)的OSS Bucket名称，`${Object}` 说明如下：\n\n- 压缩目录时，`${Object}`为目录名称。\n\n- 压缩文件时，`${Object}`为包含文件扩展名的文件完整路径。","type":"string","required":false,"example":"oss://test-bucket/test-object"},"Alias":{"description":"重定向待压缩文件在压缩包中的文件路径或重命名文件。\n\n- 不填写该参数。保留源目录结构进行压缩，例如源文件地址为`oss://test-bucket/test-dir/test-object.doc`，则压缩包中文件路径为`/test-dir/test-object.doc`。\n\n- 重命名文件。重命名压缩包中的文件名称，例如源文件地址为`oss://test-bucket/test-object.jpg`，指定参数**Alias**为`test-rename-object.jpg`，则压缩包中文件名称为`test-rename-object.jpg`。\n\n- 重新指定源文件在压缩包中的文件路径。例如源目录地址为`oss://test-bucket/test-dir/`，指定参数**Alias**为`/new-dir/`，则源目录下所有文件都会被压缩到路径`/new-dir/`中。\n\n- 指定为`/`，去除源目录结构。\n\n>请避免在重命名过程中出现重名文件的情况，出现此情况时压缩包内的重名文件可能无法解压（取决于您使用的解压程序）。","type":"string","required":false,"example":"/new-dir/"},"Mode":{"description":"指定打包规则的匹配模式，包括`prefix`（表示前缀模式）和`fullname`（表示精准匹配），默认为`prefix`。\n\n+ `prefix`：前缀模式，解析该条打包规则时，前缀模式匹配所有符合规则的文件。\n+ `fullname`：精准匹配，按照规则精准匹配文件，只会匹配到一个文件。","type":"string","required":false,"enumValueTitles":{"prefix":"prefix","fullname":"fullname"},"example":"fullname"}},"required":false},"required":false}},{"name":"CredentialConfig","in":"query","style":"json","schema":{"description":"链式授权配置，非必填。更多信息，请参见[使用链式授权访问其他实体资源](~~465340~~)。","required":false,"$ref":"#/components/schemas/CredentialConfig"}},{"name":"SourceManifestURI","in":"query","schema":{"description":"文件清单存储的地址。文件清单将Sources结构以JSON格式存储在OSS上，适用于打包文件较多的情况。\n\n> 与参数`Sources`二选一。其中`URI`参数必填，`Alias`参数选填，该文件内部结构示例：\n```\n[{\"URI\":\"oss://<bucket>/<object>\", \"Alias\":\"/new-dir/new-name\"}]\n```","type":"string","required":false,"example":"oss://test-bucket/test-object.json"}},{"name":"TargetURI","in":"query","schema":{"description":"输出文件的OSS地址。压缩文件将以该路径中的文件名称命名，例如`name.zip`。\n\nOSS地址规则为oss://${Bucket}/${Object}，其中`${Bucket}`为和当前项目处于同一区域(Region)的OSS Bucket名称，`${Object}`为包含文件扩展名的文件完整路径。","type":"string","required":true,"example":"oss://test-bucket/test-target-object.zip"}},{"name":"CompressedFormat","in":"query","schema":{"description":"文件打包压缩类型，默认值为zip。\n\n> 目前仅支持zip格式。","type":"string","required":false,"enumValueTitles":{},"example":"zip"}},{"name":"UserData","in":"query","schema":{"description":"用户自定义信息，在异步消息通知中会为您返回，方便您系统内对消息通知进行关联处理。最大长度为2048字节。","type":"string","required":false,"example":"test-data"}},{"name":"Notification","in":"query","style":"json","schema":{"description":"消息通知配置，详细内容请单击Notification查看，异步通知消息格式请参见[异步通知消息格式](~~471456~~)。","required":false,"$ref":"#/components/schemas/Notification"}}],"responses":{"200":{"schema":{"title":"响应结构体","description":"响应结构体","type":"object","properties":{"RequestId":{"title":"请求 ID","description":"请求ID。","type":"string","example":"EC564A9A-BA5C-4499-A087-D9B9E76E*****"},"EventId":{"description":"事件ID。","type":"string","example":"0ED-1Bz8z71k5TtsUejT4UJ16Es*****"},"TaskId":{"description":"任务ID。","type":"string","example":"FileCompression-3579a380-6f7a-4a9d-b9d2-65996*****"}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"EC564A9A-BA5C-4499-A087-D9B9E76E*****\\\",\\n  \\\"EventId\\\": \\\"0ED-1Bz8z71k5TtsUejT4UJ16Es*****\\\",\\n  \\\"TaskId\\\": \\\"FileCompression-3579a380-6f7a-4a9d-b9d2-65996*****\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"\",\"errorExample\":\"\"}]","title":"创建文件压缩任务","description":"> 接口公测中，如有任何使用问题，请使用钉钉搜索钉钉群号 31690030817 加入钉钉群进行反馈。\n* **请确保在使用该接口前，已充分了解智能媒体管理产品的收费方式和[价格](~~477042~~)**。\n\n* 文件数量限制：最多支持打包8万个文件。\n\n* 文件大小限制：打包压缩前所有文件大小不超过200 GB。\n\n* 该功能支持OSS上的标准存储类型文件，如需要打包压缩其他类型文件，请先[转化文件的存储类型](~~90090~~)。\n\n*  该接口为异步接口，获取任务开始执行后，任务信息只保存7天，超过7天则无法再获取。调用[GetTask](~~GetTask~~)或[ListTasks](~~ListTasks~~)接口获取返回的`TaskId`，查看任务信息。也可以通过设置[Notification](~~611278~~)消息通知参数，通过消息通知获取任务信息。","requestParamsDescription":"#### 典型场景中打包规则举例\n\n对于如下示例的文件结构，对一些经典的场景示例说明：\n\n```\n（bucket）\n├── test-dir1\n│   ├── file1.txt\n│   ├── file2.doc\n│   ├── file3.png\n│   └── my-file.json\n└── test-dir2\n    ├── AAA\n    │   └── file.txt\n    ├── AAA\n    ├── file6.doc\n    ├── file7.doc\n    └── file8.doc\n```\n\n##### 对指定文件夹进行打包\n\n打包`test-dir1`下的所有文件打包到指定目录`test-dir`中，打包规则：\n\n```json\n[\n    {\n        \"URI\"   : \"oss://bucket/test-dir1/\",\n        \"Alias\" : \"/test-dir/\"\n    }\n]\n```\n\n生成的压缩包结构为：\n\n```\n.\n└── test-dir\n    ├── file1.txt\n    ├── file2.doc\n    ├── file3.png\n    └── my-file.json\n```\n\n##### 对指定前缀进行打包\n\n打包前缀为`test-dir1/file`下的所有文件打包到指定目录`test-dir`中，打包规则：\n\n```json\n[\n    {\n        \"URI\"   : \"oss://bucket/test-dir1/file\",\n        \"Alias\" : \"/test-dir/\"\n    }\n]\n```\n\n生成的压缩包结构为：\n\n```\n.\n└── test-dir\n    ├── file1.txt\n    ├── file2.doc\n    └── file3.png\n```\n\n注意，如果使用前缀模式进行打包，会将同名的文件夹/文件同时打包进压缩包，例如：\n\n```json\n[\n    {\n        \"URI\"   : \"oss://bucket/test-dir2/AAA\",\n        \"Alias\" : \"/AAA/\"\n    }\n]\n```\n\n生成的压缩包结构为：\n\n```\n.\n└── AAA\n    ├── AAA\n    └── file.txt\n```\n\n##### 对指定的文件进行打包\n\n如果不想使用前缀模式，可以通过设置`mode`参数准确的打包指定的文件：\n\n```json\n[\n    {\n        \"URI\"   : \"oss://bucket/test-dir2/AAA\",\n        \"Alias\" : \"AAA\",\n        \"mode\"  : \"fullname\",\n    },\n    {\n        \"URI\"   : \"oss://bucket/test-dir1/\",\n        \"Alias\" : \"/test-dir1/\",\n        \"mode\"  : \"fullname\",\n    }\n]\n```\n\n生成的压缩包结构为：\n\n```\n.\n├── AAA\n└── test-dir1\n```"}