{"summary":"为指定账号组创建投递渠道，将资源数据投递到日志服务SLS、对象存储OSS或消息服务MNS进行储存。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{},"parameters":[{"name":"AggregatorId","in":"query","schema":{"description":"账号组ID。\n\n关于如何获取账号组ID，请参见[ListAggregators](~~255797~~)。","type":"string","required":true,"example":"ca-a4e5626622af0079****"}},{"name":"DeliveryChannelName","in":"query","schema":{"description":"投递渠道名称。\n\n> 如果未设置该参数，默认为空。","type":"string","required":false,"docRequired":false,"example":"testoss"}},{"name":"DeliveryChannelType","in":"query","schema":{"description":"投递渠道类型。取值：\n- OSS：对象存储。\n- MNS：消息服务。\n- SLS：日志服务。","type":"string","required":true,"docRequired":true,"example":"OSS","enum":["OSS","MNS","SLS"]}},{"name":"DeliveryChannelTargetArn","in":"query","schema":{"description":"投递渠道目标地址的ARN。取值：\n\n- 当投递渠道为OSS时，格式为`acs:oss:{RegionId}:{accountId}:{bucketName}`，例如：`acs:oss:cn-shanghai:100931896542****:new-bucket`。\n\n- 当投递渠道为MNS时，格式为`acs:mns:{RegionId}:{accountId}:/topics/{topicName}`，例如：`acs:mns:cn-shanghai:100931896542****:/topics/topic1`。\n\n- 当投递渠道为SLS时，格式为`acs:log:{RegionId}:{accountId}:project/{projectName}/logstore/{logstoreName}`，例如：`acs:log:cn-shanghai:100931896542****:project/project1/logstore/logstore1`。","type":"string","required":true,"docRequired":true,"example":"acs:oss:cn-shanghai:100931896542****:new-bucket"}},{"name":"DeliveryChannelCondition","in":"query","schema":{"description":"投递渠道附加规则。当前支持MNS渠道的所有投递和SLS渠道的快照投递。\n\n- 如果您指定MNS订阅事件的最低风险等级和资源类型，具体如下：\n\n  - 订阅事件的最低风险等级为`{\"filterType\":\"RuleRiskLevel\",\"value\":\"1\",\"multiple\":false}`。\n\n     \n    `value`表示您需要过滤的风险等级。取值：1表示高风险，2表示中风险，3表示低风险。\n\n  - 订阅事件的资源类型为`{\"filterType\":\"ResourceType\",\"values\":[\"ACS::ACK::Cluster\",\"ACS::ActionTrail::Trail\",\"ACS::CBWP::CommonBandwidthPackage\"],\"multiple\":true}`。\n    \n      \n    `values`表示您需要订阅事件的资源类型，是一个资源类型的JSON数组。\n    例如：\n`[{\"filterType\":\"ResourceType\",\"values\":[\"ACS::ActionTrail::Trail\",\"ACS::CBWP::CommonBandwidthPackage\",\"ACS::CDN::Domain\",\"ACS::CEN::CenBandwidthPackage\",\"ACS::CEN::CenInstance\",\"ACS::CEN::Flowlog\",\"ACS::DdosCoo::Instance\"],\"multiple\":true}]`\n\n- 如果您指定SLS快照投递的资源类型，资源类型为`{\"filterType\":\"ResourceType\",\"values\":[\"ACS::ACK::Cluster\",\"ACS::ActionTrail::Trail\",\"ACS::CBWP::CommonBandwidthPackage\"],\"multiple\":true}`。\n    \n      \n    `values`表示您需要投递的资源类型，是一个资源类型的JSON数组。\n    例如：\n`[{\"filterType\":\"ResourceType\",\"values\":[\"ACS::ActionTrail::Trail\",\"ACS::CBWP::CommonBandwidthPackage\",\"ACS::CDN::Domain\",\"ACS::CEN::CenBandwidthPackage\",\"ACS::CEN::CenInstance\",\"ACS::CEN::Flowlog\",\"ACS::DdosCoo::Instance\"],\"multiple\":true}]`","type":"string","required":false,"docRequired":false,"example":"[{\"filterType\":\"ResourceType\",\"values\":[\"ACS::ActionTrail::Trail\",\"ACS::CBWP::CommonBandwidthPackage\",\"ACS::CDN::Domain\",\"ACS::CEN::CenBandwidthPackage\",\"ACS::CEN::CenInstance\",\"ACS::CEN::Flowlog\",\"ACS::DdosCoo::Instance\"],\"multiple\":true}]"}},{"name":"OversizedDataOSSTargetArn","in":"query","schema":{"description":"当投递数据超过投递渠道限制时，投递数据转存到对象存储OSS的目标存储空间。格式为`acs:oss:{RegionId}:{accountId}:{bucketName}`。\n\n如果您未设置该参数，配置审计仅投递概要信息。\n\n> 仅支持投递渠道SLS和MNS。日志服务SLS的投递渠道限制是1 MB，消息服务MNS的投递渠道限制是64 KB。","type":"string","required":false,"example":"acs:oss:cn-shanghai:100931896542****:new-bucket"}},{"name":"Description","in":"query","schema":{"description":"投递渠道描述。","type":"string","required":false,"example":"My OSS delivery."}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。\n\n`ClientToken`只支持ASCII字符，且不能超过64个字符。更多信息，请参见[如何保证幂等性](~~25693~~)。","type":"string","required":false,"example":"1594295238-f9361358-5843-4294-8d30-b5183fac****"}},{"name":"ConfigurationSnapshot","in":"query","schema":{"description":"是否接收资源定时快照。每天`04:00Z`和`16:00Z`（UTC时间），配置审计定时向对象存储OSS和消息服务SLS投递资源定时快照。取值：\n- true：接收资源定时快照。\n- false（默认值）：不接收资源定时快照。\n\n> - 当投递渠道为OSS时，`ConfigurationSnapshot`（资源定时快照）和`ConfigurationItemChangeNotification`（配置变更历史）至少二选一。\n\n>- 当投递渠道为SLS时，`ConfigurationSnapshot`（资源定时快照）、`ConfigurationItemChangeNotification`（配置变更历史）和`NonCompliantNotification`（资源不合规事件）至少三选一。","type":"boolean","required":false,"example":"true","default":"false"}},{"name":"ConfigurationItemChangeNotification","in":"query","schema":{"description":"是否接收资源配置变更历史。当资源配置变更时，配置审计向对象存储OSS、日志服务SLS或消息服务MNS投递资源配置变更历史。取值：\n- true：接收资源配置变更历史。\n- false（默认值）：不接收资源配置变更历史。\n\n> - 当投递渠道为OSS时，`ConfigurationSnapshot`（资源定时快照）和`ConfigurationItemChangeNotification`（配置变更历史）至少二选一。\n\n>- 当投递渠道为SLS时，`ConfigurationSnapshot`（资源定时快照）、`ConfigurationItemChangeNotification`（配置变更历史）和`NonCompliantNotification`（资源不合规事件）至少三选一。\n\n> - 当投递渠道为MNS时，`ConfigurationItemChangeNotification`（配置变更历史）和`NonCompliantNotification`（资源不合规事件）至少二选一。","type":"boolean","required":false,"example":"false","default":"false"}},{"name":"NonCompliantNotification","in":"query","schema":{"description":"是否接收资源不合规事件。当资源不合规时，配置审计向日志服务SLS或消息服务MNS投递资源不合规事件。取值： \n- true：接收资源不合规事件。\n- false（默认值）：不接收资源不合规事件。\n\n>- 当投递渠道为SLS时，`ConfigurationSnapshot`（资源定时快照）、`ConfigurationItemChangeNotification`（配置变更历史）和`NonCompliantNotification`（资源不合规事件）至少三选一。\n\n> - 当投递渠道为MNS时，`ConfigurationItemChangeNotification`（配置变更历史）和`NonCompliantNotification`（资源不合规事件）至少二选一。","type":"boolean","required":false,"example":"false","default":"false"}},{"name":"DeliverySnapshotTime","in":"query","schema":{"description":"资源定时快照每日开始投递的时间。\n\n格式为`HH:mmZ`（UTC时间）。\n\n> 当您开启资源定时快照投递时，可通过该参数自定义投递时间。如果您未设置该参数，则每天默认`04:00Z`和`16:00Z`开始投递。","type":"string","required":false,"example":"09:10Z"}}],"responses":{"200":{"schema":{"description":"无。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"A7A0FFF8-0B44-40C6-8BBF-3A185EFDERTHG"},"DeliveryChannelId":{"description":"投递渠道ID。","type":"string","example":"cdc-8e45ff4e06a3a8****"}}}}},"errorCodes":{"400":[{"errorCode":"DeliveryChannelNotExists","errorMessage":"The delivery channel does not exist."},{"errorCode":"Invalid.DeliveryChannelAssumeRoleArn.Format","errorMessage":"The specified format of DeliveryChannelAssumeRoleArn is invalid."},{"errorCode":"Invalid.DeliveryChannelTargetArn.Format","errorMessage":"The specified format of DeliveryChannelTargetArn is invalid."},{"errorCode":"Invalid.DeliveryChannelCondition.Format","errorMessage":"The specified format of DeliveryChannelCondition is invalid."},{"errorCode":"MemberNotBelongToMaster","errorMessage":"The specified member does not belong to your organization."},{"errorCode":"DeliveryChannelAccountNotSupport","errorMessage":"Cross-account delivery that is not in the RD is not supported."},{"errorCode":"DeliveryChannelMnsUnreachable","errorMessage":"The MNS topic is unreachable."},{"errorCode":"DeliveryChannelOssUnreachable","errorMessage":"The OSS bucket is unreachable."},{"errorCode":"DeliveryChannelSlsUnreachable","errorMessage":"SLS logstore is unreachable."}],"404":[{"errorCode":"AccountNotExisted","errorMessage":"Your account does not exist."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"A7A0FFF8-0B44-40C6-8BBF-3A185EFDERTHG\\\",\\n  \\\"DeliveryChannelId\\\": \\\"cdc-8e45ff4e06a3a8****\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateAggregateConfigDeliveryChannelResponse>\\n    <RequestId>A7A0FFF8-0B44-40C6-8BBF-3A185EFDERTHG</RequestId>\\n    <DeliveryChannelId>cdc-8e45ff4e06a3a8****</DeliveryChannelId>\\n</CreateAggregateConfigDeliveryChannelResponse>\",\"errorExample\":\"\"}]","title":"为指定账号组创建投递渠道","description":"### 背景信息\n\n- 投递到日志服务SLS\n\n  当您将资源的配置变更历史、不合规事件和定时快照投递到日志服务SLS的日志库时，需要先创建日志项目（Project）和日志库（Logstore），才能查询和分析日志。关于JSON格式文件的内容示例，请参见[资源配置变更历史内容示例](~~308347~~)、[资源不合规事件内容示例](~~307122~~)和[资源定时快照内容示例](~~611894~~)。\n  \n- 投递到对象存储OSS\n  \n  当您将资源的定时快照或配置变更历史投递到对象存储OSS的指定地址时，需要先创建存储空间（Bucket），才能查看或下载JSON格式文件。关于JSON格式文件的内容示例，请参见[资源定时快照内容示例](~~305669~~)和[资源配置变更历史内容示例](~~189738~~)。\n\n- 投递到消息服务MNS\n  \n  当您将资源配置变更历史和资源不合规事件投递到消息服务MNS的指定主题时，需要先创建主题，才能设置主题的推送方式和内容。关于JSON格式文件的内容示例，请参见[资源配置变更历史内容示例](~~309462~~)和[资源不合规事件内容示例](~~309463~~)。\n\n### 使用限制\n每个账号组中最多可以创建5个投递渠道。\n\n### 使用说明\n本文将提供一个示例，为账号组`ca-a4e5626622af0079****`创建一个投递渠道类型为`OSS`和投递渠道目标地址ARN为`acs:oss:cn-shanghai:100931896542****:new-bucket`的投递渠道。返回结果显示创建投递渠道成功，投递渠道ID为`cdc-8e45ff4e06a3a8****`。","requestParamsDescription":"关于公共请求参数的详情，请参见[公共参数](~~251751~~)。"}