{"summary":"为指定账号组基于模板创建规则或基于函数计算创建自定义规则，通过规则检测资源的合规性。新建规则后，规则会自动执行一次评估，后续配置审计将根据规则的触发机制自动触发评估，您也可以手动执行评估。","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"create","riskType":"none","chargeType":"free"},"parameters":[{"name":"ConfigRuleName","in":"formData","schema":{"description":"规则名称。\n\n","type":"string","required":true,"docRequired":true,"example":"存在所有指定标签"}},{"name":"Description","in":"formData","schema":{"description":"规则描述。\n\n","type":"string","required":false,"example":"最多可以定义6组标签。如果资源同时具有指定的所有标签，则视为“合规”。"}},{"name":"InputParameters","in":"formData","style":"json","schema":{"description":"规则参数。\n\n","type":"object","required":false,"example":"{\"tag1Key\":\"ECS\",\"tag1Value\":\"test\"}"}},{"name":"ConfigRuleTriggerTypes","in":"formData","schema":{"description":"规则触发机制。取值：\n- ConfigurationItemChangeNotification：配置变更。\n- ScheduledNotification：周期执行。","type":"string","required":true,"docRequired":true,"example":"ConfigurationItemChangeNotification"}},{"name":"MaximumExecutionFrequency","in":"formData","schema":{"description":"规则执行周期。取值：\n- One_Hour：1小时。\n- Three_Hours：3小时。\n- Six_Hours：6小时。\n- Twelve_Hours：12小时。\n- TwentyFour_Hours（默认值）：24小时。\n\n> 当`ConfigRuleTriggerTypes`设置为`ScheduledNotification`时，需要设置该参数。\n","type":"string","required":false,"example":"One_Hour","enum":["One_Hour","Three_Hours","Six_Hours","Twelve_Hours","TwentyFour_Hours"]}},{"name":"ResourceTypesScope","in":"formData","style":"simple","schema":{"description":"规则评估的资源类型。多个资源类型之间用半角逗号（,）分隔。","type":"array","items":{"description":"规则评估的资源类型。多个资源类型之间用半角逗号（,）分隔。","type":"string","required":false,"example":"ACS::ECS::Instance"},"required":true,"docRequired":true,"example":"ACS::ECS::Instance"}},{"name":"RiskLevel","in":"formData","schema":{"description":"规则风险等级。取值：\n- 1：高风险。\n- 2：中风险。\n- 3：低风险。","type":"integer","format":"int32","required":true,"docRequired":true,"example":"1","enum":["1","2","3"]}},{"name":"ClientToken","in":"formData","schema":{"description":"保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。`ClientToken`只支持ASCII字符，且不能超过64个字符。\n\n","type":"string","required":false,"example":"1594295238-f9361358-5843-4294-8d30-b5183fac****"}},{"name":"AggregatorId","in":"formData","schema":{"description":"账号组ID。\n\n关于如何获取账号组ID，请参见[ListAggregators](~~255797~~)。","type":"string","required":true,"docRequired":true,"example":"ca-a4e5626622af0079****"}},{"name":"RegionIdsScope","in":"formData","schema":{"description":"规则仅对指定地域ID中的资源生效。多个地域ID之间用半角逗号（,）分隔。\n\n> 仅适用于规则模板。","type":"string","required":false,"example":"cn-hangzhou"}},{"name":"ExcludeRegionIdsScope","in":"formData","schema":{"type":"string","required":false}},{"name":"ResourceIdsScope","in":"formData","schema":{"type":"string","required":false}},{"name":"ExcludeResourceIdsScope","in":"formData","schema":{"description":"规则对指定资源ID无效，即不对该资源执行评估。多个资源ID之间用半角逗号（,）分隔。\n\n> 仅适用于规则模板。","type":"string","required":false,"example":"lb-t4nbowvtbkss7t326****"}},{"name":"ResourceGroupIdsScope","in":"formData","schema":{"description":"规则仅对指定资源组ID中的资源生效。多个资源组ID之间用半角逗号（,）分隔。\n\n> 仅适用于规则模板。","type":"string","required":false,"example":"rg-aekzc7r7rhx****"}},{"name":"ExcludeResourceGroupIdsScope","in":"formData","schema":{"type":"string","required":false}},{"name":"TagKeyScope","in":"formData","schema":{"description":"规则仅对绑定指定标签的资源生效。多个标签之间用半角逗号（,）分隔。\n\n> 仅适用于规则模板，且`TagKeyScope`和`TagValueScope`必须同时设置。","type":"string","required":false,"example":"ECS"}},{"name":"TagValueScope","in":"formData","schema":{"description":"规则仅对绑定指定标签的资源生效。\n\n> 仅适用于规则模板，且`TagKeyScope`和`TagValueScope`必须同时设置。","type":"string","required":false,"example":"test"}},{"name":"TagKeyLogicScope","in":"formData","schema":{"description":"参数`TagKeyScope`取多值时的逻辑关系，例如：当参数`TagKeyScope`取值为`ECS,OSS`时，如果该参数为`AND`，则表示规则仅对同时绑定标签`ECS`和`OSS`的资源生效。取值：\n\n- AND：与。\n\n- OR：或。","type":"string","required":false,"enumValueTitles":{"OR":"OR","AND":"AND"},"example":"AND","enum":["AND","OR"]}},{"name":"TagsScope","in":"formData","style":"flat","schema":{"type":"array","items":{"type":"object","properties":{"TagKey":{"type":"string","required":false},"TagValue":{"type":"string","required":false}},"required":false},"required":true,"docRequired":true}},{"name":"ExcludeTagsScope","in":"formData","style":"flat","schema":{"type":"array","items":{"type":"object","properties":{"TagKey":{"type":"string","required":false},"TagValue":{"type":"string","required":false}},"required":false},"required":true,"docRequired":true}},{"name":"SourceOwner","in":"formData","schema":{"description":"规则类型。取值：\n- ALIYUN：规则模板。\n- CUSTOM_FC：自定义规则。","type":"string","required":true,"docRequired":true,"example":"ALIYUN","enum":["ALIYUN","CUSTOM_FC","CUSTOM_CONFIGURATION"]}},{"name":"SourceIdentifier","in":"formData","schema":{"description":"规则标识符。\n\n- 当`SourceOwner`为`ALIYUN`时，输入规则模板的标识符，例如：`required-tags`。\n\n  > 关于如何查询规则模板标识符，请参见[规则模板列表](~~127404~~)。\n\n- 当`SourceOwner`为`CUSTOM_FC`时，输入函数计算的函数ARN。\n\n  函数ARN格式为：`acs:fc:地域:账号ID:services/服务名称.LATEST/functions/函数名称`，例如：`acs:fc:cn-hangzhou:120886317861****:services/service-test.LATEST/functions/config-test`。\n\n  > 关于如何获取函数ARN，请参见[ListFunctions](~~415752~~)。","type":"string","required":true,"docRequired":true,"example":"required-tags"}},{"name":"FolderIdsScope","in":"formData","schema":{"description":"规则仅对指定资源目录ID中成员账号内的资源生效。\n\n> - 该参数仅作用于全局账号组的规则。\n> - 仅适用于规则模板。","type":"string","required":false,"example":"fd-ZtHsRH****"}},{"name":"ExcludeFolderIdsScope","in":"formData","schema":{"description":"规则对指定资源目录ID中成员账号内的资源无效，即不对该资源目录ID中成员账号内的资源执行评估。多个资源目录ID之间用半角逗号（,）分隔。\n\n> - 该参数仅作用于全局账号组的规则。\n> - 仅适用于规则模板。","type":"string","required":false,"example":"fd-pWmkqZ****"}},{"name":"ExcludeAccountIdsScope","in":"formData","schema":{"description":"规则对指定成员账号内的资源无效，即不对该账号内的资源执行评估。多个成员账号ID之间用半角逗号（,）分隔。\n\n> 仅适用于规则模板。","type":"string","required":false,"example":"120886317861****"}},{"name":"AccountIdsScope","in":"formData","schema":{"type":"string","required":false}}],"responses":{"200":{"schema":{"description":"无","type":"object","properties":{"ConfigRuleId":{"description":"规则ID。\n\n","type":"string","example":"cr-4e3d626622af0080****"},"RequestId":{"description":"请求ID。","type":"string","example":"5895065A-196C-4254-8AD8-14EFC31EEF50"}}}}},"errorCodes":{"400":[{"errorCode":"ExceedMaxRuleCount","errorMessage":"The maximum number of rules is exceeded."},{"errorCode":"ConfigRuleNotExists","errorMessage":"The ConfigRule does not exist."},{"errorCode":"ConfigRuleExists","errorMessage":"The ConfigRule already exists."},{"errorCode":"Invalid.AggregatorId.Value","errorMessage":"The specified AggregatorId is invalid."}],"403":[{"errorCode":"AggregatorMemberNoPermission","errorMessage":"The aggregator member is not authorized to perform the operation."}],"404":[{"errorCode":"AccountNotExisted","errorMessage":"Your account does not exist."}],"503":[{"errorCode":"ServiceUnavailable","errorMessage":"The request has failed due to a temporary failure of the server."}]},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"ConfigRuleId\\\": \\\"cr-4e3d626622af0080****\\\",\\n  \\\"RequestId\\\": \\\"5895065A-196C-4254-8AD8-14EFC31EEF50\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateAggregateConfigRuleResponse>\\n\\t<ConfigRuleId>cr-4e3d626622af0080****</ConfigRuleId>\\n\\t<RequestId>5895065A-196C-4254-8AD8-14EFC31EEF50</RequestId>\\n</CreateAggregateConfigRuleResponse>\\t\",\"errorExample\":\"\"}]","title":"创建账号组规则","description":"### 使用限制\n每个管理账号和委派管理员账号最多可以创建200条规则。\n\n### 背景信息\n\n配置审计支持通过以下方法创建规则：\n- 基于模板创建规则\n  \n  规则模板是配置审计已在函数计算中构建的规则函数，您可以通过规则模板快速创建规则。关于规则的更多信息，请参见[规则的定义及运行原理](~~128273~~)。\n\n- 基于函数计算创建规则\n\n  自定义函数规则是配置审计通过函数计算服务的函数来承载规则代码的自定义规则。当配置审计预置的规则模板不能满足检测资源合规性的需求时，您可以通过编写函数代码，完成复杂场景的合规检测。关于自定义函数规则的更多信息，请参见[自定义函数规则定义和运行原理](~~127405~~)。\n\n### 使用说明\n本文将提供一个示例，通过规则模板“存在所有指定标签”为账号组`ca-a4e5626622af0079****`创建一条规则。返回结果显示规则创建成功，规则ID为`cr-4e3d626622af0080****`。"}