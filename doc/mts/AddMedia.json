{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"create"},"parameters":[{"name":"FileURL","in":"query","schema":{"description":"输入文件的路径，可以通过MPS或OSS控制台获取。详细触发规则请参见下文中**工作流触发匹配规则**。\n\n- 仅支持OSS HTTP地址，不支持CDN地址和HTTPS地址。\n- 不超过3200字节。\n- URL遵循RFC 2396（UTF-8编码，并进行URLEncode）。更多信息，请参见[URLEncode说明](~~423796~~)。","type":"string","required":true,"example":"http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/C/test.mp4"}},{"name":"Title","in":"query","schema":{"description":"媒体标题。\n\n- 长度限制不超过128个字节。\n- UTF-8编码。","type":"string","required":false,"example":"mytest"}},{"name":"Description","in":"query","schema":{"description":"描述。\n\n- 长度限制不超过1024个字节。\n- UTF-8编码。","type":"string","required":false,"example":"A test video"}},{"name":"CoverURL","in":"query","schema":{"description":"封面URL。即您需要设置的封面的存储地址，可以通过**MPS控制台** > **工作流管理** > **媒体Bucket**或**OSS控制台** > **我的访问路径**获取。\n\n- 不超过3200字节。\n- URL遵循RFC 2396（UTF-8编码，并进行URLEncode）。更多信息，请参见[URLEncode说明](~~423796~~)。","type":"string","required":false,"example":"http://bucket.oss-cn-hangzhou.aliyuncs.com/example/1.png"}},{"name":"Tags","in":"query","schema":{"description":" 标签列表。\n\n> 媒体处理中，每个媒体的每个标签都是独立的，可以通过搜索媒体库来查找所有设置了相同标签的媒体。\n\n- 用半角逗号（,）分隔，不超过16个标签。\n- 单个标签不能超过32个字节。\n\n- UTF-8编码。","type":"string","required":false,"example":"tag1,tag2"}},{"name":"MediaWorkflowId","in":"query","schema":{"description":"媒体工作流ID。可通过MPS控制台或[新增媒体工作流](~~44437~~)接口获取。","type":"string","required":false,"example":"07da6c65da7f458997336e0de192****"}},{"name":"MediaWorkflowUserData","in":"query","schema":{"description":"媒体工作流用户自定义数据。\n\n- 不超过1024字节。\n- UTF-8编码。","type":"string","required":false,"example":"test"}},{"name":"InputUnbind","in":"query","schema":{"description":"是否检查指定的工作流支持输入路径。此处建议您选择检查（true），避免因路径出错而导致的错误。取值：\n\n- **true**：检查\n\n- **false**：不检查","type":"boolean","required":false,"example":"false"}},{"name":"CateId","in":"query","schema":{"description":"媒体所属类目ID。不允许为负数。","type":"integer","format":"int64","required":false,"example":"123"}},{"name":"OverrideParams","in":"query","schema":{"description":"覆盖参数。\n\n- 示例1：HLS打包字幕覆盖`{“WebVTTSubtitleOverrides”,[{“RefActivityName”:”subtitleNode”,”WebVTTSubtitleURL”:”http://test.oss-cn-hangzhou.aliyuncs.com/example1.vtt\"}]}`。\n- 示例2：DASH打包字幕覆盖` {“subtitleTransNodeName”:{“InputConfig”:{“Format”:”stl”,”InputFile”:{“URL”:”http://subtitleBucket.oss-cn-hangzhou.aliyuncs.com/package/example/CENG.stl\"}}}}`。","type":"string","required":false,"example":"{“subtitleTransNodeName”:{“InputConfig”:{“Format”:”stl”,”InputFile”:{“URL”:”http://exampleBucket.oss-cn-hangzhou.aliyuncs.com/package/example/CENG.stl\"}}}}"}}],"responses":{"200":{"schema":{"description":"返回参数。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"05F8B913-E9F3-4A6F-9922-48CADA0FFAAD"},"Media":{"description":"媒体信息。","type":"object","properties":{"CreationTime":{"description":"创建时间。","type":"string","example":"2016-09-20T03:02:40Z"},"CateId":{"description":"类目ID。","type":"integer","format":"int64","example":"1"},"Height":{"description":"媒体文件高度。","type":"string","example":"1280"},"CensorState":{"description":"视频审核状态。取值：\n\n- **Initiated**：初始（上传成功审核未完成）。\n\n- **Pass**：通过（上传成功审核已通过）。","type":"string","example":"Initiated"},"Tags":{"type":"object","properties":{"Tag":{"description":"标签。","type":"array","items":{"description":"标签列表。","type":"string","example":"tag,tag2"}}}},"Bitrate":{"description":"码率。","type":"string","example":"1148.77"},"MediaId":{"description":"媒体ID。","type":"string","example":"3e6149d5a8c944c09b1a8d2dc3e4****"},"File":{"description":"原文件。","type":"object","properties":{"State":{"description":"文件状态。此处默认为**Normal**（正常）。","type":"string","example":"Normal"},"URL":{"description":"文件URL。","type":"string","example":"http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/C/test.mp4"}}},"PublishState":{"description":"媒体发布状态，表示是否对外发布媒体。取值：\n\n- **Initiated**：初始。\n- **UnPublish**：未发布，OSS播放文件权限为Private。\n- **Published**：已发布，OSS播放文件权限为Default。","type":"string","example":"Published"},"Description":{"description":"描述。长度不超过1024个字节。","type":"string","example":"A test video"},"Width":{"description":"媒体文件宽度。","type":"string","example":"1280"},"Size":{"description":"媒体文件大小。","type":"string","example":"379860"},"CoverURL":{"description":"封面URL。","type":"string","example":"http://bucket.oss-cn-hangzhou.aliyuncs.com/example/1.png"},"RunIdList":{"type":"object","properties":{"RunId":{"description":"媒体工作流执行实例ID列表。","type":"array","items":{"description":"已执行的媒体工作流执行实例ID列表，半角逗号（,）分隔。","type":"string","example":"{\"RunId\":[\"cbad98d35629470fa05ff393d347****\"]}"}}}},"Duration":{"description":"媒体文件时长。","type":"string","example":"2.645333"},"Fps":{"description":"媒体文件帧率。","type":"string","example":"25.0"},"Title":{"description":"媒体标题。长度不超过128个字节。\n","type":"string","example":"mytest.mp4"},"Format":{"description":"格式。支持mov，mp4，m4a，3gp，3g2，mj2。","type":"string","example":"mp4"}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"05F8B913-E9F3-4A6F-9922-48CADA0FFAAD\\\",\\n  \\\"Media\\\": {\\n    \\\"CreationTime\\\": \\\"2016-09-20T03:02:40Z\\\",\\n    \\\"CateId\\\": 1,\\n    \\\"Height\\\": \\\"1280\\\",\\n    \\\"CensorState\\\": \\\"Initiated\\\",\\n    \\\"Tags\\\": {\\n      \\\"Tag\\\": [\\n        \\\"tag,tag2\\\"\\n      ]\\n    },\\n    \\\"Bitrate\\\": \\\"1148.77\\\",\\n    \\\"MediaId\\\": \\\"3e6149d5a8c944c09b1a8d2dc3e4****\\\",\\n    \\\"File\\\": {\\n      \\\"State\\\": \\\"Normal\\\",\\n      \\\"URL\\\": \\\"http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/C/test.mp4\\\"\\n    },\\n    \\\"PublishState\\\": \\\"Published\\\",\\n    \\\"Description\\\": \\\"A test video\\\",\\n    \\\"Width\\\": \\\"1280\\\",\\n    \\\"Size\\\": \\\"379860\\\",\\n    \\\"CoverURL\\\": \\\"http://bucket.oss-cn-hangzhou.aliyuncs.com/example/1.png\\\",\\n    \\\"RunIdList\\\": {\\n      \\\"RunId\\\": [\\n        \\\"{\\\\\\\"RunId\\\\\\\":[\\\\\\\"cbad98d35629470fa05ff393d347****\\\\\\\"]}\\\"\\n      ]\\n    },\\n    \\\"Duration\\\": \\\"2.645333\\\",\\n    \\\"Fps\\\": \\\"25.0\\\",\\n    \\\"Title\\\": \\\"mytest.mp4\\\",\\n    \\\"Format\\\": \\\"mp4\\\"\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<AddMediaResponse>\\n    <RequestId>05F8B913-E9F3-4A6F-9922-48CADA0FFAAD</RequestId>\\n    <Media>\\n        <CreationTime>2016-09-20T03:02:40Z</CreationTime>\\n        <CateId>1</CateId>\\n        <Height>1280</Height>\\n        <CensorState>Initiated</CensorState>\\n        <Tags>tag,tag2</Tags>\\n        <Bitrate>1148.77</Bitrate>\\n        <MediaId>3e6149d5a8c944c09b1a8d2dc3e4****</MediaId>\\n        <File>\\n            <State>Normal</State>\\n            <URL>http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/C/test.mp4</URL>\\n        </File>\\n        <PublishState>Published</PublishState>\\n        <Description>A test video</Description>\\n        <Width>1280</Width>\\n        <Size>379860</Size>\\n        <CoverURL>http://bucket.oss-cn-hangzhou.aliyuncs.com/example/1.png</CoverURL>\\n        <RunIdList>{\\\"RunId\\\":[\\\"cbad98d35629470fa05ff393d347****\\\"]}</RunIdList>\\n        <Duration>2.645333</Duration>\\n        <Fps>25.0</Fps>\\n        <Title>mytest.mp4</Title>\\n        <Format>mp4</Format>\\n    </Media>\\n</AddMediaResponse>\",\"errorExample\":\"\"}]","title":"新增媒体","summary":"提交新增媒体作业。","description":"- 当在OSS上有存量视频时，可以通过此接口处理存量视频，从而避免重新上传视频到OSS。如果已经配置过工作流，上传媒体文件到OSS后，OSS会自动通知MPS。根据设置的OSS Bucket，Object自动匹配处于激活状态的工作流自动执行，因此通常情况下不需要手动调用AddMedia接口处理文件。\n- 只有指定激活状态的工作流处理媒体文件时，才会自动获取媒体信息；不指定工作流或指定其他状态的工作流时，不会获取媒体信息。\n\n### QPS限制\n本接口的单用户QPS限制为100次/秒。超过限制，API调用会被限流，这可能会影响您的业务，请合理调用。更多信息，请参见[QPS限制](~~342832~~)。","requestParamsDescription":"**工作流触发匹配规则**\n\n 规则匹配执行策略如下：以新增文件的路径为基础，检查工作流绑定的位置，如果新增文件的路径中包含规则绑定的字符串则匹配，不包含则不匹配。例如：`http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/C/test1.flv`规则：\n\n   ```\n  1、http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/C/          匹配\n  2、http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/            匹配\n  3、http://bucket.oss-cn-hangzhou.aliyuncs.com/A/              匹配\n  4、http://bucket.oss-cn-hangzhou.aliyuncs.com/                匹配\n  5、http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/C/test.flv  匹配\n  6、http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B/CC/         不匹配\n  7、http://bucket.oss-cn-hangzhou.aliyuncs.com/A/B2/           不匹配\n  8、http://bucket.oss-cn-hangzhou.aliyuncs.com/A2/B/C/         不匹配\n  ```\n> 在新增媒体工作流时，请您不要配置一个工作流的输入路径为另外一个工作流的输入路径的前缀，否则会一个增量文件触发两次工作流执行实例。例如：两个工作流的输入路径分别配置test和test1，则当输入文件上传到test1文件夹下同样满足test前缀，因此会触发两次工作流执行实例。\n\n**匹配文件扩展名**\n\n触发要求必须是多媒体文件，媒体库服务是通过文件扩展名来判断的。文件或者没有扩展名（文件名中不包含扩展名分割符号“.”），或者扩展名符合下面的规则：\n> 对于swf，截图及转码服务质量不保障。\n\n|类型\t|扩展名|\n|:---------|:-------|\n|视频|\t3gp, asf, avi, dat, dv, flv, f4v, gif, m2t, m3u8, m4v, mj2, mjpeg, mkv, mov, mp4, mpe, mpg, mpeg, mts, ogg, qt, rm, rmvb, swf, ts, vob, wmv, webm|\n|音频|\taac, ac3, acm, amr, ape, caf, flac, m4a, mp3, ra, wav, wma, aiff|\n\n**媒体工作流消息**\n\n媒体工作流采用 [阿里云消息服务](https://www.aliyun.com/product/mns?spm=a2c4g.11186623.2.10.6c44478epkHm97) 发送消息给视频云服务接入方，媒体工作流会在（Start/Report）活动节点完成时发送消息，若需要接收消息，需要在Start活动上设置队列/通知名称，媒体工作流产生的消息存储在队列/通知中，可以使用 [消息服务SDK](~~27508~~) 获取消息，消息规格如下：\n\n|名称\t|类型\t|描述|\n|:---------|:-------|:---------|\n|RunId\t|String\t|工作流执行ID。|\n|Name\t|String\t|活动名称。|\n|Type\t|String\t|活动类型。范围：Report、Start|\n|State\t|String\t|活动状态。范围：Fail、Success|\n|Code\t|String\t|错误码。如果活动状态是Fail时，会给出具体的错误码。|\n|Message\t|String\t|错误消息。如果活动状态是Fail时，会给出详细的错误描述信息。|\n|MediaWorkflowExecution\t|MediaWorkflowExecution\t|媒体工作流执行信息。|","responseParamsDescription":" ","extraInfo":" "}