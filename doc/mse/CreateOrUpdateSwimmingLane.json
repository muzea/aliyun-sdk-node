{"summary":"用于创建或者更新全链路灰度泳道。","methods":["get","post"],"schemes":["http","https"],"tags":["msc"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create","riskType":"none","chargeType":"free","abilityTreeCode":"116127","abilityTreeNodes":["FEATUREmseCR8P7I"]},"parameters":[{"name":"RegionId","in":"query","schema":{"title":"region","description":"地域。","type":"string","required":false,"example":"cn-beijing"}},{"name":"Namespace","in":"query","schema":{"title":"MSE命名空间名字","description":"MSE命名空间名字","type":"string","required":false,"example":"default","maxLength":64}},{"name":"Id","in":"query","schema":{"title":"泳道ID。-1时为创建泳道，大于0时为修改指定泳道。","description":"主键ID。-1时为创建泳道，大于0时为修改指定泳道。","type":"integer","format":"int64","required":false,"example":"-1"}},{"name":"Name","in":"query","schema":{"title":"名称","description":"泳道名称。","type":"string","required":true,"example":"gray","maxLength":64}},{"name":"Tag","in":"query","schema":{"title":"匹配到后的目标机器标签","description":"标识。","type":"string","required":false,"example":"gray","maxLength":64}},{"name":"Enable","in":"query","schema":{"title":"是否开启。","description":"是否开启。","type":"boolean","required":false,"example":"true"}},{"name":"GroupId","in":"query","schema":{"title":"所属泳道组","description":"所属泳道组。","type":"integer","format":"int64","required":false,"example":"115"}},{"name":"EnableRules","in":"query","schema":{"title":"是否开启规则","description":"是否配置泳道的路由规则，Ingress为网关暂时不需要配置。","type":"boolean","required":false,"example":"false","default":"true"}},{"name":"PathIndependentPercentageEnable","in":"query","schema":{"type":"boolean","required":false}},{"name":"EntryRules","in":"formData","style":"repeatList","schema":{"title":"SwimmingLane","description":"SwimmingLane","type":"array","items":{"type":"object","properties":{"Paths":{"title":"路径列表","description":"路径列表","type":"array","items":{"description":"路径","type":"string","required":false,"example":"/"},"required":false,"maxItems":50},"Condition":{"title":"指示RestItems如何组合成最终的条件","description":"指示RestItems如何组合成最终的条件","type":"string","required":false,"example":"AND","default":"AND","enum":["AND","OR"]},"RestItems":{"title":"匹配列表","description":"匹配列表","type":"array","items":{"description":"Rest匹配信息","type":"object","properties":{"Type":{"title":"匹配类型","description":"匹配类型","type":"string","required":false,"example":"header"},"Name":{"title":"名称","description":"名称","type":"string","required":false,"example":"x-mse-tag"},"Operator":{"title":"操作符","description":"操作符","type":"string","required":false,"example":"rawvalue"},"NameList":{"title":"匹配列表","description":"匹配列表","type":"array","items":{"description":"名称","type":"string","required":false,"example":"test"},"required":false,"maxItems":10},"Datum":{"title":"数值","description":"数值","type":"string","required":false,"example":"x"},"Cond":{"title":"匹配符","description":"匹配符","type":"string","required":false,"example":"==\n"},"Divisor":{"title":"除数","description":"除数","type":"integer","format":"int32","required":false,"example":"10"},"Remainder":{"title":"余数","description":"余数","type":"integer","format":"int32","required":false,"example":"10"},"Rate":{"title":"百分比","description":"百分比","type":"integer","format":"int32","required":false,"example":"30"},"Value":{"title":"值","description":"值","type":"string","required":false,"example":"gray"}},"required":false},"required":false,"maxItems":10},"Priority":{"title":"优先级","description":"优先级","type":"integer","format":"int32","required":false,"example":"1","default":"0"}},"required":false},"required":false,"maxItems":10}},{"name":"EntryRule","in":"query","schema":{"title":"json string","description":"json string。","type":"string","deprecated":true,"required":false,"example":"[{\"Priority\":1,\"Paths\":[],\"Condition\":\"AND\",\"RestItems\":[{\"Type\":\"param\",\"Name\":\"name\",\"Value\":\"xiaoming\",\"Cond\":\"==\",\"Operator\":\"rawvalue\"}]}]"}},{"name":"GatewaySwimmingLaneRouteJson","in":"query","style":"json","schema":{"title":"网关路由信息（使用云原生网关为入口时使用）","description":"网关路由信息（使用云原生网关为入口时使用）","type":"object","properties":{"GatewayId":{"title":"网关ID","description":"网关ID","type":"integer","format":"int64","required":false,"example":"1"},"GatewayUniqueId":{"title":"网关唯一ID","description":"网关唯一ID","type":"string","required":false,"example":"gw-84efde2ee1464260bdb17a5b****"},"RouteIdList":{"title":"路由ID列表","description":"路由ID列表","type":"array","items":{"description":"路由ID","type":"integer","format":"int64","required":false,"example":"1"},"required":false},"CanaryModel":{"title":"全链路灰度模式：\n\n- 0: 按请求内容路由\n\n- 1: 按比例路由","description":"全链路灰度模式：\n\n- 0: 按请求内容路由\n\n- 1: 按比例路由","type":"integer","format":"int32","required":false,"example":"0"},"Conditions":{"title":"匹配条件列表（按内容路由使用）","description":"匹配条件列表","type":"array","items":{"title":"","description":"条件项","type":"object","properties":{"Name":{"title":"参数名称","description":"参数名称","type":"string","required":false,"example":"name"},"Value":{"title":"参数值","description":"参数值","type":"string","required":false,"example":"xiaoming"},"Type":{"title":"参数类型：\n- header：Header\n- param：Parameter","description":"参数类型：\n- header：Header\n- param：Parameter","type":"string","required":false,"example":"header"},"Cond":{"title":"条件：\n- PRE：前缀匹配\n- EQUAL：精确匹配\n- ERGULAR：正则匹配","description":"条件：\n- PRE：前缀匹配\n- EQUAL：精确匹配\n- ERGULAR：正则匹配","type":"string","required":false,"example":"PRE"}},"required":false},"required":false},"Percentage":{"title":"流量比例（按比例路由使用，取值0-100）","description":"流量比例（按比例路由使用，取值0-100）","type":"integer","format":"int32","required":false,"example":"30"},"RouteIndependentPercentageEnable":{"type":"boolean","required":false},"RouteIndependentPercentageList":{"type":"array","items":{"type":"object","properties":{"RouteId":{"type":"integer","format":"int64","required":false},"Percentage":{"type":"integer","format":"int32","required":false}},"required":false},"required":false}},"required":false}},{"name":"AcceptLanguage","in":"query","schema":{"title":"返回结果显示的语言。取值：zh（默认值）：中文，en：英文","description":"返回结果显示的语言。取值：zh（默认值）：中文，en：英文","type":"string","required":false,"example":"zh"}}],"responses":{"200":{"schema":{"title":"RestResult","description":"RestResult","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"EE5C32A1-BC0E-4B79-817C-103E4EDF****"},"Success":{"description":"请求结果，取值如下：\n- `true`：请求成功。\n- `false`：请求失败。","type":"boolean","example":"true"},"Code":{"title":"code仅仅用来和success同步","description":"Code仅仅用来和Success同步。","type":"integer","format":"int32","example":"200"},"ErrorCode":{"description":"错误码。","type":"string","example":"mse-100-000"},"HttpStatusCode":{"description":"HTTP状态码。","type":"integer","format":"int32","example":"200"},"Message":{"description":"返回信息。","type":"string","example":"请求处理成功"},"Data":{"description":"数据概览。","type":"object","properties":{"name":{"description":"泳道名称","type":"string","example":"test"},"id":{"description":"泳道ID","type":"integer","format":"int64","example":"94765"},"tag":{"description":"泳道对应的标签。","type":"string","example":"release"},"status":{"description":"泳道状态","type":"integer","format":"int32","example":"0"},"enable":{"description":"泳道开关","type":"boolean","example":"true"},"regionId":{"description":"应用所在的区域。","type":"string","example":"cn-beijing"},"groupId":{"description":"泳道组Id。","type":"integer","format":"int64","example":"72586"},"entryRule":{"description":"入口应用规则","type":"string","example":"{}"},"entryRules":{"description":"名称","type":"array","items":{"description":"入口应用规则详情","type":"object","properties":{"paths":{"description":"路径列表","type":"array","items":{"description":"路径列表","type":"string","example":"/"}},"path":{"title":"","description":"代码组路径","type":"string","example":"/adump/wxb/prod"},"condition":{"description":"条件","type":"string","example":"AND"},"restItems":{"description":"Rest匹配规则列表","type":"array","items":{"description":"Rest匹配规则","type":"object","properties":{"type":{"title":"匹配类型","description":"匹配类型","type":"string","example":"cookie"},"name":{"title":"名称","description":"名称","type":"string","example":"test"},"operator":{"title":"操作符","description":"操作符","type":"string","example":"rawvalue"},"nameList":{"title":"匹配列表","description":"名称列表","type":"array","items":{"description":"名称","type":"string","example":"test"},"maxItems":10},"datum":{"title":"数值","description":"数值","type":"string","example":"x"},"cond":{"title":"匹配符","description":"匹配符","type":"string","example":"=="},"divisor":{"title":"除数","description":"除数","type":"integer","format":"int32","example":"10"},"remainder":{"title":"余数","description":"余数","type":"integer","format":"int32","example":"10"},"rate":{"title":"百分比","description":"百分比","type":"integer","format":"int32","example":"30"},"value":{"title":"值","description":"值","type":"string","example":"9"}}}}}}},"enableRules":{"description":"是否开启规则。","type":"boolean","example":"true"},"gmtCreate":{"description":"泳道创建时间。","type":"string","example":"1545726028000"},"gmtModified":{"description":"泳道更新时间。","type":"string","example":"1565701886000"},"gatewaySwimmingLaneRouteJson":{"description":"MSE网关路由规则","type":"string","example":"{}"},"pathIndependentPercentageEnable":{"type":"boolean"}},"example":"{}"}}}}},"errorCodes":{"400":[{"errorCode":"IllegalRequest","errorMessage":"Invalid request:%s"},{"errorCode":"InvalidParameter","errorMessage":"Parameter error:%s"}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to perform this operation:%s"}],"404":[{"errorCode":"NotFound","errorMessage":"Not found:%s"}],"500":[{"errorCode":"InternalError","errorMessage":"Console error. Try again later:%s"}]},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"EE5C32A1-BC0E-4B79-817C-103E4EDF****\\\",\\n  \\\"Success\\\": true,\\n  \\\"Code\\\": 200,\\n  \\\"ErrorCode\\\": \\\"mse-100-000\\\",\\n  \\\"HttpStatusCode\\\": 200,\\n  \\\"Message\\\": \\\"请求处理成功\\\",\\n  \\\"Data\\\": {\\n    \\\"name\\\": \\\"test\\\",\\n    \\\"id\\\": 94765,\\n    \\\"tag\\\": \\\"release\\\",\\n    \\\"status\\\": 0,\\n    \\\"enable\\\": true,\\n    \\\"regionId\\\": \\\"cn-beijing\\\",\\n    \\\"groupId\\\": 72586,\\n    \\\"entryRule\\\": \\\"{}\\\",\\n    \\\"entryRules\\\": [\\n      {\\n        \\\"paths\\\": [\\n          \\\"/\\\"\\n        ],\\n        \\\"path\\\": \\\"/adump/wxb/prod\\\",\\n        \\\"condition\\\": \\\"AND\\\",\\n        \\\"restItems\\\": [\\n          {\\n            \\\"type\\\": \\\"cookie\\\",\\n            \\\"name\\\": \\\"test\\\",\\n            \\\"operator\\\": \\\"rawvalue\\\",\\n            \\\"nameList\\\": [\\n              \\\"test\\\"\\n            ],\\n            \\\"datum\\\": \\\"x\\\",\\n            \\\"cond\\\": \\\"==\\\",\\n            \\\"divisor\\\": 10,\\n            \\\"remainder\\\": 10,\\n            \\\"rate\\\": 30,\\n            \\\"value\\\": \\\"9\\\"\\n          }\\n        ]\\n      }\\n    ],\\n    \\\"enableRules\\\": true,\\n    \\\"gmtCreate\\\": \\\"1545726028000\\\",\\n    \\\"gmtModified\\\": \\\"1565701886000\\\",\\n    \\\"gatewaySwimmingLaneRouteJson\\\": \\\"{}\\\",\\n    \\\"pathIndependentPercentageEnable\\\": true\\n  }\\n}\",\"type\":\"json\"}]","title":"创建或者更新全链路灰度泳道"}