{"summary":"创建网关鉴权。","methods":["post","get"],"schemes":["http","https"],"tags":["gateway"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"37105","abilityTreeNodes":["FEATUREmseFZIQVY"]},"parameters":[{"name":"Name","in":"query","schema":{"description":"鉴权名称。","type":"string","required":false,"example":"test"}},{"name":"Type","in":"query","schema":{"description":"鉴权类型：\n\n- JWT\n- OIDC\n- IDaaS\n- ExternalAuthZ（自建的鉴权服务）","type":"string","required":false,"example":"JWT"}},{"name":"Issuer","in":"query","schema":{"description":"鉴权类型为JWT/OIDC时使用：\n\n- JWT：表示JWT claims 的iss(issuer)，即签发人。\n- OIDC：表示OIDC claims 的iss(issuer)，即签发人","type":"string","required":false,"example":"https://example.com/auth"}},{"name":"Jwks","in":"query","schema":{"description":"JWT公钥，支持JSON格式。","type":"string","required":false,"example":"{\"keys\":[{\"e\":\"AQAB\",\"kid\":\"DHFbpoIUqrY8t2zpA2qXfCmr5VO5ZEr4RzHU_-envvQ\",\"kty\":\"RSA\",\"n\":\"xAE7eB6qugXyCAG3yhh7pkDkT65pHymX-P7KfIupjf59vsdo91bSP9C8H07pSAGQO1MV_xFj9VswgsCg4R6otmg5PV2He95lZdHtOcU5DXIg_pbhLdKXbi66GlVeK6ABZOUW3WYtnNHD-91gVuoeJT_DwtGGcp4ignkgXfkiEm4sw-4sfb4qdt5oLbyVpmW6x9cfa7vs2WTfURiCrBoUqgBo_-4WTiULmmHSGZHOjzwa8WtrtOQGsAFjIbno85jp6MnGGGZPYZbDAa_b3y5u-YpW7ypZrvD8BgtKVjgtQgZhLAGezMt0ua3DRrWnKqTZ0BJ_EyxOGuHJrLsn00fnMQ\"}]}"}},{"name":"TokenPosition","in":"query","schema":{"description":"JWT Token类型：\n\n- HEADER：通过Header传输\n\n要校验的Token参数信息，默认是以Bearer为前缀放在Authorization header中，例如：Authorization: Bearer token。","type":"string","required":false,"example":"HEADER"}},{"name":"TokenName","in":"query","schema":{"description":"JWT Token保存的位置。\n\n要校验的Token参数信息，默认是以Bearer为前缀放在Authorization header中，例如：`Authorization: Bearer token`。","type":"string","required":false,"example":"Authorization"}},{"name":"TokenNamePrefix","in":"query","schema":{"description":"JWT Token的前缀。\n\n要校验的Token参数信息，默认是以Bearer为前缀放在Authorization header中，例如：`Authorization: Bearer token`。","type":"string","required":false,"example":"Bearer "}},{"name":"TokenPass","in":"query","schema":{"description":"是否透传Token。","type":"boolean","required":false,"example":"true"}},{"name":"IsWhite","in":"query","schema":{"description":"授权黑白名单模式：\n\n- true：白名单模式（名单中的 hosts + paths 不需要校验即可访问，其余都需要校验）\n- false：黑名单模式（名单中的 hosts + paths 需要校验，其余可直接访问）","type":"boolean","required":false,"example":"true"}},{"name":"Status","in":"query","schema":{"description":"未开放参数，无需传递（鉴权创建后默认为关闭状态）。","type":"boolean","required":false,"example":"false"}},{"name":"RedirectUrl","in":"query","schema":{"description":"授权成功后的重定向地址（OIDC/IDaaS使用，需要与OIDC/IDaaS中配置的重定向地址保持一致。）","type":"string","required":false,"example":"https://test-.com/oauth2/callback"}},{"name":"ClientId","in":"query","schema":{"description":"服务注册的应用ID（OIDC/IDaaS使用）。","type":"string","required":false,"example":"23460e2fdd9bf9ad106****"}},{"name":"ClientSecret","in":"query","schema":{"description":"服务注册的应用Secret（OIDC/IDaaS使用）。","type":"string","required":false,"example":"123****"}},{"name":"CookieDomain","in":"query","schema":{"description":"Cookie的域名，认证通过后会将Cookie发送到指定的域名，保持登录状态。\n\n例如：设置`Cookie-domain=a.example.com`，则Cookie会发送到域名`a.example.com`；设置`Cookie-domain=.example.com`，则Cookie会发送到`example.com`的所有子域名。","type":"string","required":false,"example":"test.com"}},{"name":"ScopesList","in":"query","style":"json","schema":{"description":"OIDC授权作用域（OIDC使用）。","type":"array","items":{"description":"OIDC授权作用域","type":"string","required":false,"example":"openid"},"required":false}},{"name":"LoginUrl","in":"query","schema":{"description":"IDaaS实例用户登录页地址（IDaaS使用）。","type":"string","required":false,"example":"https://daxxxxcn.aliyunidaas.com/"}},{"name":"Sub","in":"query","schema":{"description":"鉴权类型为JWT时使用；JWT claims 的sub（subject），即主体，请确保JWT的Payload中的sub字段的值与此处配置的值一致。如果该参数未设置或者为空，那么默认与Issuer参数设置的值一致","type":"string","required":false,"example":"testing@secure.istio.io"}},{"name":"ExternalAuthZJSON","in":"query","style":"json","schema":{"description":"自定义鉴权信息。","type":"object","properties":{"ServiceId":{"description":"鉴权服务ID。","type":"integer","format":"int64","required":false,"example":"1343"},"PrefixPath":{"description":"鉴权服务提供的鉴权API的Path，API的Path需是前缀匹配。","type":"string","required":false,"example":"/auth"},"TokenKey":{"description":"Token处于请求报文中哪个Header中，常见的有Authorization和Cookie。","type":"string","required":false,"example":"Authorization"},"AllowRequestHeaders":{"description":"鉴权请求中允许携带的头部。","type":"array","items":{"description":"允许的请求头名称。","type":"string","required":false,"example":"x-req"},"required":false},"AllowUpstreamHeaders":{"description":"鉴权响应中允许保留的头部。","type":"array","items":{"description":"允许的响应头名称。","type":"string","required":false,"example":"x-resp"},"required":false},"Timeout":{"description":"鉴权服务的超时时间，单位：秒。","type":"integer","format":"int32","required":false,"example":"10"},"IsRestrict":{"description":"自定义鉴权模式：\n\n- true：严格模式，当鉴权服务不可用时（鉴权服务建立连接失败或者返回5xx请求），网关拒绝客户端请求\n- false：宽松模式，当鉴权服务不可用时（鉴权服务建立连接失败或者返回5xx请求），网关放过客户端请求","type":"boolean","required":false,"example":"true"},"WithRequestBody":{"description":"是否允许携带Body。","type":"boolean","required":false,"example":"true"},"BodyMaxBytes":{"description":"Body的最大字节数。","type":"integer","format":"int32","required":false,"example":"4000000"}},"required":false}},{"name":"GatewayUniqueId","in":"query","schema":{"description":"网关唯一标识ID。","type":"string","required":false,"example":"gw-*****9b04bb4474cae9d645be850e3d7"}},{"name":"AuthResourceMode","in":"query","schema":{"title":"授权资源模式：\n\n- 0：简单模式\n- 1：复杂模式","description":"授权资源模式：\n\n- 0：简单模式\n- 1：复杂模式","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"AuthResourceConfig","in":"query","schema":{"title":"复杂模式的YAML配置","description":"复杂模式的YAML配置","type":"string","required":false}},{"name":"AuthResourceList","in":"query","style":"json","schema":{"description":"鉴权的授权规则列表，多个规则条件之间是“或”关系，规则条件内的多个匹配项之间是“与”关系。","type":"array","items":{"description":"数据结构。","type":"object","properties":{"DomainId":{"description":"规则内域名的ID。","type":"integer","format":"int64","required":false,"example":"1765"},"Path":{"description":"规则的匹配路径。","type":"string","required":false,"example":"/test"},"MatchType":{"description":"请求Path的匹配类型：\n\n- EQUAL：精确匹配\n- PRE：前缀匹配\n- ERGULAR：正则匹配","type":"string","required":false,"example":"EQUAL"},"IgnoreCase":{"description":"路径是否开启大小写敏感（创建自定义鉴权时使用，其他鉴权类型默认开启大小写敏感）\n\n- true：开启大小写敏感\n- false：关闭大小写敏感","type":"boolean","required":false,"example":"true"},"AuthResourceHeaderList":{"description":"规则的请求头（当前仅供自定义鉴权使用）","type":"array","items":{"type":"object","properties":{"HeaderKey":{"description":"请求头名称。","type":"string","required":false,"example":"x-req"},"HeaderMethod":{"description":"匹配条件：\n\n- EQUAL：等于\n- NOT_EQUAL：不等于\n- EXIST：存在\n- NOT_EXIST：不存在\n- INCLUDE：包含\n- EXCLUDE：不包含\n- PREFIX：前缀\n- SUFFIX：后缀\n- REGREX：正则","type":"string","required":false,"example":"EQUAL"},"HeaderValue":{"description":"请求头的值。","type":"string","required":false,"example":"123"}},"required":false},"required":false}},"required":false},"required":false}},{"name":"AcceptLanguage","in":"query","schema":{"title":"返回结果显示的语言。取值：zh（默认值）：中文，en：英文","description":"返回结果显示的语言。取值：zh（默认值）：中文，en：英文","type":"string","required":false,"example":"zh"}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"数据结构。","type":"object","properties":{"RequestId":{"title":"Id of the request","description":"请求ID。","type":"string","example":"4279C00F-A5E1-53C6-A43B-751C1C524D0B"},"HttpStatusCode":{"description":"HTTP状态码。","type":"integer","format":"int32","example":"200"},"Message":{"description":"返回信息。","type":"string","example":"OK"},"Code":{"description":"用于和Success同步，当Success为true时，Code为200。","type":"integer","format":"int32","example":"200"},"Success":{"description":"请求结果，取值如下：\n- `true`：请求成功。\n- `false`：请求失败。","type":"boolean","example":"true"},"Data":{"description":"创建的鉴权ID。","type":"integer","format":"int64","example":"333"}}}}},"errorCodes":{"400":[{"errorCode":"IllegalRequest","errorMessage":"Invalid request:%s"},{"errorCode":"InvalidParameter","errorMessage":"Parameter error:%s"}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to perform this operation:%s"}],"404":[{"errorCode":"NotFound","errorMessage":"Not found:%s"}],"500":[{"errorCode":"InternalError","errorMessage":"Console error. Try again later:%s"}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"4279C00F-A5E1-53C6-A43B-751C1C524D0B\\\",\\n  \\\"HttpStatusCode\\\": 200,\\n  \\\"Message\\\": \\\"OK\\\",\\n  \\\"Code\\\": 200,\\n  \\\"Success\\\": true,\\n  \\\"Data\\\": 333\\n}\",\"type\":\"json\"}]","title":"创建网关鉴权"}