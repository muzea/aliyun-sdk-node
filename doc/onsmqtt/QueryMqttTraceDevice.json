{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{},"parameters":[{"name":"MqttRegionId","in":"query","schema":{"description":"云消息队列 MQTT 版实例地域（Region）的ID。更多信息，请参见[服务接入点](~~181438~~)。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"InstanceId","in":"query","schema":{"description":"云消息队列 MQTT 版实例的ID，一定要和客户端实际使用的实例ID匹配。您可以在控制台**实例详情**页面的**基础信息**区域查看。","type":"string","required":true,"docRequired":true,"example":"mqtt-cn-i7m26mf****"}},{"name":"Reverse","in":"query","schema":{"description":"返回结果是否倒序显示。取值说明如下：\n\n- **true**：按照设备活动时间倒序显示，最后一次的设备活动信息显示在第一条，最早一次的设备活动信息显示在最后一条。\n\n- **false**：按照设备活动时间顺序显示，最早一次的设备活动信息显示在第一条，最后一次的设备活动信息显示在最后一条。\n\n若不输入，则返回结果默认按照设备活动时间顺序显示。","type":"boolean","required":false,"docRequired":true,"example":"false"}},{"name":"ClientId","in":"query","schema":{"description":"需要查询轨迹信息的设备的Client ID。","type":"string","required":true,"docRequired":true,"example":"GID_test@@@producer"}},{"name":"BeginTime","in":"query","schema":{"description":"查询范围的起始时间戳。单位：毫秒。","type":"integer","format":"int64","required":true,"docRequired":true,"maximum":"9223372036854774807","minimum":"-9223372036854774808","example":"1621580400000"}},{"name":"EndTime","in":"query","schema":{"description":"查询范围的终止时间戳。单位：毫秒。","type":"integer","format":"int64","required":true,"docRequired":true,"maximum":"9223372036854774807","minimum":"-9223372036854774808","example":"1621584000000"}},{"name":"CurrentPage","in":"query","schema":{"description":"当前取第几页消息，从1开始递增。若输入参数大于总页数，则返回结果为空。","type":"integer","format":"int32","required":true,"docRequired":true,"maximum":"2147483647","minimum":"-2147483648","example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询，每页最多显示的消息数量，最小1条，最多100条。","type":"integer","format":"int32","required":true,"docRequired":true,"maximum":"2147483647","minimum":"-2147483648","example":"5"}}],"responses":{"200":{"schema":{"type":"object","properties":{"CurrentPage":{"description":"当前位于第几页。","type":"integer","format":"int32","example":"1"},"RequestId":{"description":"公共参数，每个请求的ID都是唯一的，可用于排查和定位问题。","type":"string","example":"317076B7-F946-46BC-A98F-4CF9777C****"},"PageSize":{"description":"每页最多显示的设备活动信息数量。","type":"integer","format":"int32","example":"2"},"Total":{"description":"查询到的设备活动信息总数。","type":"integer","format":"int64","example":"3"},"DeviceInfoList":{"description":"查询的设备活动信息明细。","type":"array","items":{"type":"object","properties":{"ChannelId":{"description":"设备连接标识。","type":"string","example":"c69fe839209547fa9d073781b9cd****"},"Time":{"description":"设备动作发生的时间。","type":"string","example":"2021-05-21 15:51:54.867"},"ActionCode":{"description":"设备动作的返回码。取值说明如下：\n\n- **mqtt.trace.action.connect**：设备动作为**connect**时返回该参数值。\n\n- **mqtt.trace.action.close**：设备动作为**close**时返回该参数值。\n\n- **mqtt.trace.action.disconnect**：设备动作为**disconnect**时返回该参数值。","type":"string","example":"mqtt.trace.action.connect"},"Action":{"description":"设备动作。取值说明如下：\n\n- **connect**：客户端请求与服务端连接。\n\n- **close**：TCP连接断开。\n\n- **disconnect**：客户端请求与服务端断开连接。","type":"string","example":"connect"},"ActionInfo":{"description":"设备动作的描述信息。取值说明如下：\n\n- **accepted**：服务端接收客户端发起的连接请求。\n\n- **not authorized**：客户端访问的实例权限校验失败导致TCP连接断开。\n\n- **clientId conflict**：客户端标识冲突导致TCP连接断开。\n\n- **resource auth failed**：客户端访问的Topic或Group ID资源权限校验失败导致TCP连接断开。\n\n- **no heart**：客户端无心跳导致TCP连接断开。\n\n- **closed by client**：客户端异常导致TCP连接断开。\n\n- **disconnected by client**：客户端请求断开连接。\n\n- **invalid param**：请求参数不合法导致TCP连接断开。\n\n- **Socket IOException**：网络抖动或丢包导致TCP连接断开。","type":"string","example":"accept"}}}}}}}},"errorCodes":{"404":[{"errorCode":"ApiNotSupport","errorMessage":"The specified API is not supported."}],"500":[{"errorCode":"SystemOverFlow","errorMessage":"An error occurred while processing your request. Please try again."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"CurrentPage\\\": 1,\\n  \\\"RequestId\\\": \\\"317076B7-F946-46BC-A98F-4CF9777C****\\\",\\n  \\\"PageSize\\\": 2,\\n  \\\"Total\\\": 3,\\n  \\\"DeviceInfoList\\\": [\\n    {\\n      \\\"ChannelId\\\": \\\"c69fe839209547fa9d073781b9cd****\\\",\\n      \\\"Time\\\": \\\"2021-05-21 15:51:54.867\\\",\\n      \\\"ActionCode\\\": \\\"mqtt.trace.action.connect\\\",\\n      \\\"Action\\\": \\\"connect\\\",\\n      \\\"ActionInfo\\\": \\\"accept\\\"\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<QueryMqttTraceDeviceResponse>\\n<DeviceInfoList>\\n    <Action>connect</Action>\\n    <ActionCode>mqtt.trace.action.connect</ActionCode>\\n    <ActionInfo>accepted</ActionInfo>\\n    <Time>2021-05-21 15:10:21.844</Time>\\n    <ChannelId>27e1c09a1d7d4944901500db7186****</ChannelId>\\n </DeviceInfoList>\\n <DeviceInfoList>\\n    <Action>close</Action>\\n    <ActionCode>mqtt.trace.action.close</ActionCode>\\n    <ActionInfo>no heart</ActionInfo>\\n    <Time>2021-05-21 15:51:37.980</Time>\\n    <ChannelId>27e1c09a1d7d4944901500db7186****</ChannelId>\\n </DeviceInfoList>\\n <DeviceInfoList>\\n    <Action>connect</Action>\\n    <ActionCode>mqtt.trace.action.connect</ActionCode>\\n    <ActionInfo>accepted</ActionInfo>\\n    <Time>2021-05-21 15:52:48.669</Time>\\n    <ChannelId>34022074d3c1403faba6e0334121****</ChannelId>\\n </DeviceInfoList>\\n <PageSize>5</PageSize>\\n <CurrentPage>1</CurrentPage>\\n <Total>3</Total>\\n <RequestId>317076B7-F946-46BC-A98F-4CF9777C****</RequestId>\\n</QueryMqttTraceDeviceResponse>\",\"errorExample\":\"\"}]","title":"查询设备轨迹","summary":"分页查询微消息队列MQTT版客户端的设备轨迹。当设备的状态出现异常时，您可以通过该接口查询指定设备的连接历史，帮助您快速定位异常原因。","description":"- 每成功调用一次**QueryMqttTraceDevice**接口，都会计算为一次消息TPS，从而影响您的计费。计费详情，请参见[计费说明](~~52819~~)。\n- 本接口的单用户QPS限制为500次/秒。超过限制，API调用会被限流，这可能会影响您的业务，请合理调用。更多信息，请参见[QPS限制](~~163047~~)。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":"# 控制台操作\n除了调用**QueryMqttTraceDevice**接口，您还可以通过微消息队列MQTT版控制台查看设备轨迹信息。具体操作，请参见[设备轨迹查询](~~140951~~)。"}