{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","systemTags":{},"parameters":[{"name":"MqttRegionId","in":"query","schema":{"description":"云消息队列 MQTT 版实例地域（Region）的ID。请参见[服务接入点](~~181438~~)。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"InstanceId","in":"query","schema":{"description":"云消息队列 MQTT 版实例的ID，一定要和客户端实际使用的实例ID匹配。您可以在控制台**实例详情**页面的**基础信息**区域查看。","type":"string","required":true,"docRequired":true,"example":"mqtt-cn-i7m26mf****"}},{"name":"Reverse","in":"query","schema":{"description":"返回结果是否倒序显示。取值说明如下：\n\n- **true**：按照消息的投递时间倒序显示，最后一条消费的消息显示在第一条，最早一条消费的消息显示在最后一条。\n\n- **false**：按照消息的投递时间顺序显示，最早一条消费的消息显示在第一条，最后一条消费的消息显示在最后一条。\n\n若不输入，则返回结果默认按照消息的投递时间顺序显示。","type":"boolean","required":false,"docRequired":true,"example":"false"}},{"name":"ClientId","in":"query","schema":{"description":"指定订阅消息的客户端ID。若不输入，则返回所有订阅该消息的客户端信息。","type":"string","required":false,"docRequired":true,"example":"GID_test@@@consumer"}},{"name":"BeginTime","in":"query","schema":{"description":"查询范围的起始时间戳。单位：毫秒。","type":"integer","format":"int64","required":true,"docRequired":true,"maximum":"9223372036854774807","minimum":"-9223372036854774808","example":"1621936800000"}},{"name":"EndTime","in":"query","schema":{"description":"查询范围的终止时间戳。单位：毫秒。","type":"integer","format":"int64","required":true,"docRequired":true,"maximum":"9223372036854774807","minimum":"-9223372036854774808","example":"1618646400000"}},{"name":"CurrentPage","in":"query","schema":{"description":"当前取第几页消息，从1开始递增。若输入参数大于总页数，则返回结果为空。","type":"integer","format":"int32","required":true,"docRequired":true,"maximum":"2147483647","minimum":"-2147483648","example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询，每页最多显示的消息数量，最小1条，最多100条。","type":"integer","format":"int32","required":true,"docRequired":true,"maximum":"2147483647","minimum":"-2147483648","example":"5"}},{"name":"MsgId","in":"query","schema":{"description":"消息ID，即Message ID。","type":"string","required":true,"docRequired":true,"example":"AC1EC1B33D5978308DB17F3245E4****","maxLength":2147483647,"minLength":0}}],"responses":{"200":{"schema":{"type":"object","properties":{"CurrentPage":{"description":"当前位于第几页。","type":"integer","format":"int32","example":"1"},"RequestId":{"description":"公共参数，每个请求的ID都是唯一的，可用于排查和定位问题。","type":"string","example":"4E685844-ADAF-4D85-9EAC-F9471E8C****"},"PageSize":{"description":"每页最多显示的消息数量。","type":"integer","format":"int32","example":"5"},"Total":{"description":"查询到的消息轨迹总数。","type":"integer","format":"int64","example":"2"},"MessageTraceLists":{"description":"返回的消息投递轨迹列表。","type":"array","items":{"type":"object","properties":{"Time":{"description":"消息的投递时间。","type":"string","example":"2021-05-25 16:46:41.274"},"Action":{"description":"消息动作。取值说明如下：\n\n- **sub**：微消息队列MQTT版客户端订阅消息。\n\n- **push_offline**：服务端推送离线消息到微消息队列MQTT版客户端。","type":"string","example":"sub"},"ActionCode":{"description":"消息动作的返回码。取值说明如下：\n\n- **mqtt.trace.action.msg.sub**：消息动作取值为**sub**时返回该参数值。\n\n- **mqtt.trace.action.msg.push.offline**：消息动作取值为**push_offline**时返回该参数值。","type":"string","example":"mqtt.trace.action.msg.sub"},"ActionInfo":{"description":"消息动作的说明信息。取值说明如下：\n\n- **Push To Mqtt Client**：消息动作取值为**sub**时返回该参数值。\n\n- **Push Offline Msg To Mqtt Client**：消息动作取值为**push_offline**时返回该参数值。","type":"string","example":"Push To Mqtt Client"},"MsgId":{"description":"消息ID，即Message ID。","type":"string","example":"AC1EC1B33D5978308DB17F3245E4****"},"ClientId":{"description":"订阅消息的客户端ID。","type":"string","example":"GID_test@@@consumer"}}}}}}}},"errorCodes":{"404":[{"errorCode":"ApiNotSupport","errorMessage":"The specified API is not supported."}],"500":[{"errorCode":"SystemOverFlow","errorMessage":"An error occurred while processing your request. Please try again."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"CurrentPage\\\": 1,\\n  \\\"RequestId\\\": \\\"4E685844-ADAF-4D85-9EAC-F9471E8C****\\\",\\n  \\\"PageSize\\\": 5,\\n  \\\"Total\\\": 2,\\n  \\\"MessageTraceLists\\\": [\\n    {\\n      \\\"Time\\\": \\\"2021-05-25 16:46:41.274\\\",\\n      \\\"Action\\\": \\\"sub\\\",\\n      \\\"ActionCode\\\": \\\"mqtt.trace.action.msg.sub\\\",\\n      \\\"ActionInfo\\\": \\\"Push To Mqtt Client\\\",\\n      \\\"MsgId\\\": \\\"AC1EC1B33D5978308DB17F3245E4****\\\",\\n      \\\"ClientId\\\": \\\"GID_test@@@consumer\\\"\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<QueryMqttTraceMessageSubscribeResponse>\\n  <MessageTraceLists>\\n    <Action>sub</Action>\\n    <ActionCode>mqtt.trace.action.msg.sub</ActionCode>\\n    <ClientId>GID_test@@@consumer</ClientId>\\n    <ActionInfo>Push To Mqtt Client</ActionInfo>\\n    <Time>2021-05-25 16:46:41.274 </Time>\\n    <MsgId>AC1EC1B33D5978308DB17F3245E4****</MsgId>\\n  </MessageTraceLists>\\n  <MessageTraceLists>\\n    <Action>sub</Action>\\n    <ActionCode>mqtt.trace.action.msg.sub</ActionCode>\\n    <ClientId>GID_test@@@consumer2</ClientId>\\n    <ActionInfo>Push To Mqtt Client</ActionInfo>\\n    <Time>2021-05-25 16:46:41.247 </Time>\\n    <MsgId>AC1EC1B33D5978308DB17F3245E4****</MsgId>\\n  </MessageTraceLists>\\n  <RequestId>4E685844-ADAF-4D85-9EAC-F9471E8C****</RequestId>\\n  <PageSize>5</PageSize>\\n  <CurrentPage>1</CurrentPage>\\n  <Total>2</Total>\\n</QueryMqttTraceMessageSubscribeResponse>\",\"errorExample\":\"\"}]","title":"查询消息消费轨迹","summary":"查询指定消息的投递轨迹。当消息的收发不符合预期时，您可以通过该接口查看订阅该消息的客户端、消息的投递时间等详细信息，帮助您快速定位异常原因。","description":"- 每成功调用一次**QueryMqttTraceMessageSubscribe**接口，都会计算为一次消息TPS，从而影响您的计费。计费详情，请参见[计费说明](~~52819~~)。\n- 本接口的单用户QPS限制为500次/秒。超过限制，API调用会被限流，这可能会影响您的业务，请合理调用。更多信息，请参见[QPS限制](~~163047~~)。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":"# 控制台操作\n除了调用**QueryMqttTraceMessageSubscribe**接口，您还可以通过微消息队列MQTT版控制台查看消息的投递轨迹。具体操作，请参见[消息轨迹查询](~~205708~~)。"}