{"summary":"该接口用于修改RDS实例的备份策略设置。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"update"},"parameters":[{"name":"DBInstanceId","in":"query","schema":{"description":"实例ID。可调用DescribeDBInstances获取。","type":"string","required":true,"docRequired":true,"example":"rm-uf6wjk5****"}},{"name":"BackupPolicyMode","in":"query","schema":{"description":"备份类型：\n\n* **DataBackupPolicy**：数据备份\n* **LogBackupPolicy**：日志备份","type":"string","required":false,"example":"DataBackupPolicy"}},{"name":"PreferredBackupTime","in":"query","schema":{"description":"执行备份任务的时间。格式：<i>HH:mm</i>Z-<i>HH:mm</i>Z（UTC时间）。\n\n> * **BackupPolicyMode**为**DataBackupPolicy**时，该参数必传。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"00:00Z-01:00Z"}},{"name":"PreferredBackupPeriod","in":"query","schema":{"description":"备份周期。至少需要指定2天，多个取值用英文逗号（,）隔开。取值：\n* **Monday**：周一\n* **Tuesday**：周二\n* **Wednesday**：周三\n* **Thursday**：周四\n* **Friday**：周五\n* **Saturday**：周六\n* **Sunday**：周日\n\n> * 与**BackupInterval**参数共同决定备份策略。例如：本参数指定周六周日备份，**BackupInterval**参数指定30分钟，则在每周的周六和周日每隔30分钟执行一次备份。\n> * **BackupPolicyMode**参数为**DataBackupPolicy**时，该参数必传。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"Monday"}},{"name":"BackupRetentionPeriod","in":"query","schema":{"description":"数据备份保留天数，取值：**7~730**。\n\n> * **BackupPolicyMode**为**DataBackupPolicy**时，该参数必传。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"7"}},{"name":"BackupLog","in":"query","schema":{"description":"是否开启日志备份。取值：\n\n* **Enable**：开启。\n* **Disabled**：关闭。\n\n> * **BackupPolicyMode**为**DataBackupPolicy**时，用于开启或关闭日志备份。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"Enable"}},{"name":"LogBackupRetentionPeriod","in":"query","schema":{"description":"日志备份保留天数。取值：**7~730**，且不大于数据备份保留天数。\n\n> * 当开启日志备份时，可设置日志备份文件的保留天数，目前仅支持MySQL和PostgreSQL实例设置该值。\n> * **BackupPolicyMode**参数为**DataBackupPolicy**或**LogBackupPolicy**时都适用。","type":"string","required":false,"example":"7"}},{"name":"EnableBackupLog","in":"query","schema":{"description":"是否开启日志备份。取值：\n* **True**或**1**：开启。\n* **False**或**0**：关闭。\n\n> * **BackupPolicyMode**为**LogBackupPolicy**时，用于开启或关闭日志备份。\n> * 仅在**BackupPolicyMode**参数为**LogBackupPolicy**时生效。","type":"string","required":false,"enumValueTitles":{},"example":"1","enum":["1","0","True","False"]}},{"name":"LocalLogRetentionHours","in":"query","schema":{"description":"日志备份本地保留小时数。取值：**0~7*24**，0表示不保留。\n\n> * **BackupPolicyMode**为**LogBackupPolicy**时，该参数必传。\n> * 仅在**BackupPolicyMode**参数为**LogBackupPolicy**时生效。","type":"string","required":false,"example":"18"}},{"name":"LocalLogRetentionSpace","in":"query","schema":{"description":"本地日志最大循环空间使用率，超出后，则从最早的Binlog开始清理，直到空间使用率低于该比例。取值：**0~50**。默认不修改。\n\n> * **BackupPolicyMode**为**LogBackupPolicy**时，该参数必传。\n> * 仅在**BackupPolicyMode**参数为**LogBackupPolicy**时生效。","type":"string","required":false,"example":"30"}},{"name":"HighSpaceUsageProtection","in":"query","schema":{"description":"实例使用空间大于80%，或者剩余空间小于5GB时，是否无条件清理Binlog。取值：**Enable | Disable**。默认不修改。\n\n> * **BackupPolicyMode**为**LogBackupPolicy**时，该参数必传。\n> * 仅在**BackupPolicyMode**参数为**LogBackupPolicy**时生效。","type":"string","required":false,"example":"Enable"}},{"name":"LogBackupFrequency","in":"query","schema":{"description":"日志备份频率，取值：\n* **LogInterval**：每30分钟备份一次。\n* 默认与数据备份频率一致。\n\n> * **LogInterval**参数仅适用于SQL Server。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"LogInterval"}},{"name":"CompressType","in":"query","schema":{"description":"备份压缩方式。取值：\n* **0**：不压缩。\n* **1**：zlib压缩，格式为tar.gz。\n* **2**：并行zlib压缩。\n* **4**：quicklz压缩，格式为xb.gz。仅适用于MySQL 5.6/5.7，此备份压缩方式可用于[单库单表恢复](~~103175~~)。\n* **8**：quicklz压缩，格式为xb.gz。仅适用于MySQL 8.0。暂不支持单库单表恢复。\n\n> 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"4"}},{"name":"ArchiveBackupRetentionPeriod","in":"query","schema":{"description":"归档备份的保留天数。默认为**0**，表示未开启归档备份。取值：**30**~**1095**。\n\n> 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"365"}},{"name":"ArchiveBackupKeepPolicy","in":"query","schema":{"description":"归档备份的保留周期，该周期内能保存的备份个数由**ArchiveBackupKeepCount**决定。默认为**0**。取值：\n* **ByMonth**：月\n* **ByWeek**：周\n* **KeepAll**：全部保留\n\n> 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"ByMonth"}},{"name":"ArchiveBackupKeepCount","in":"query","schema":{"description":"归档备份的保留个数。默认为**1**。取值：\n* 当**ArchiveBackupKeepPolicy**为**ByMonth**时，取值为**1**~**31**。\n* 当**ArchiveBackupKeepPolicy**为**ByWeek**时，取值为**1**~**7**。\n\n> * 当**ArchiveBackupKeepPolicy**为**KeepAll**时，本参数无需传入。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"ReleasedKeepPolicy","in":"query","schema":{"description":"已删除实例的归档备份保留策略。默认为None。取值：\n* **None**：不保留\n* **Lastest**：保留最后一个\n* **All**：全部保留\n\n> 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"None"}},{"name":"LogBackupLocalRetentionNumber","in":"query","schema":{"description":"本地Binlog保留个数。默认为**60**。取值：**6**~**100**。\n\n> * 仅在**BackupPolicyMode**参数为**LogBackupPolicy**时生效。\n> * 如果实例类型为MySQL，可以传入**-1**，即不限制本地Binlog的保留个数。","type":"integer","format":"int32","required":false,"example":"60","default":""}},{"name":"Category","in":"query","schema":{"description":"是否开启秒级备份。取值：\n* **Flash**：开启\n* **Standard**：关闭\n\n> 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"Standard"}},{"name":"BackupInterval","in":"query","schema":{"description":"快照备份频率。取值：\n* **-1**：不设置备份频率。\n* **30**：30分钟。\n* **60**：60分钟。\n* **120**：120分钟。\n* **240**：240分钟。\n* **480**：480分钟。\n\n> * 与**PreferredBackupPeriod**参数共同决定备份策略。例如：**PreferredBackupPeriod**参数指定周六周日备份，本参数指定**-1**，则在每周的周六和周日各执行一次备份。\n> * PostgreSQL实例必须是云盘实例。\n> * SQL Server实例必须已[开启快照备份](~~211143~~)。\n> * **Category**参数为**Flash**时本参数无效。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"30"}},{"name":"BackupMethod","in":"query","schema":{"description":"实例的备份方式。取值：\n* **Physical**：物理备份\n* **Snapshot**：快照备份\n\n默认值：**Physical**\n\n> * 本参数仅对SQL Server云盘版实例生效。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"string","required":false,"example":"Physical"}},{"name":"EnableIncrementDataBackup","in":"query","schema":{"description":"是否开启增量备份。取值：\n* **False**（默认）：关闭\n* **True**：开启\n\n> * 本参数仅对SQL Server云盘版实例生效。\n> * 仅在**BackupPolicyMode**参数为**DataBackupPolicy**时生效。","type":"boolean","required":false,"example":"False"}},{"name":"BackupPriority","in":"query","schema":{"description":"设置备库备份选项。取值：\n- **1**：优先备库\n- **2**：强制主库\n\n> \n> - 该参数仅适用于SQL Server集群版实例。 \n> - 仅当**BackupMethod**取值为**Physical**时，该参数才生效。如果**BackupMethod**设置为**Snapshot**，SQL Server集群版实例将强制在主库备份。","type":"integer","format":"int32","required":false,"example":"2"}}],"responses":{"200":{"schema":{"description":"返回参数详情。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"DA147739-AEAD-4417-9089-65E9B1D8240D"},"CompressType":{"description":"备份压缩方式，取值：\n* **0**：不压缩。\n* **1**：zlib压缩。\n* **2**：并行zlib压缩。\n* **4**：quicklz压缩，开启了库表恢复。\n* **8**：MySQL8.0 quicklz压缩但是还未支持库表恢复。","type":"string","example":"4"},"LocalLogRetentionSpace":{"description":"本地日志最大循环空间使用率。","type":"string","example":"30"},"LogBackupLocalRetentionNumber":{"description":"本地Binlog保留个数。","type":"integer","format":"int32","example":"60"},"DBInstanceID":{"description":"实例ID。","type":"string","example":"rm-uf6wjk5****"},"EnableBackupLog":{"description":"是否开启了日志备份。取值：\n* **1**：开启\n* **0**：关闭","type":"string","example":"1"},"LocalLogRetentionHours":{"description":"日志备份本地保留小时数。","type":"integer","format":"int32","example":"18"},"HighSpaceUsageProtection":{"description":"实例使用空间大于80%，或者剩余空间小于5GB时，是否无条件清理Binlog。","type":"string","example":"Disable"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidColdRetention.Format","errorMessage":"Invalid cold retention format."},{"errorCode":"InvalidLogBackupFrequency.Malformed","errorMessage":"Invalid log backup frequency."},{"errorCode":"InvalidBackupRetentionPeriod.Malformed","errorMessage":"The specified backup retention period is invalid."},{"errorCode":"BackupPropertyNotFound","errorMessage":"Backup policy not found"},{"errorCode":"OperationDenied.SwitchToSnapshot","errorMessage":"Snapshot backup does not support cross region storage at present. Please turn off cross region backup before switching to snapshot backup mode."},{"errorCode":"InvalidReleasedKeepPolicy.Format","errorMessage":"Specified Released Keep Policy is not valid."},{"errorCode":"IncorrectBackupPolicy","errorMessage":"The current instance has an advanced backup policy enabled. Currently, you cannot use the OpenAPI to modify the backup policy. You need to modify the backup policy in the console."},{"errorCode":"Order.ComboInstanceNotAllowOperate","errorMessage":"A package instance is not allowed to operate independently."},{"errorCode":"Price.PricingPlanResultNotFound","errorMessage":"Pricing plan price result not found."},{"errorCode":"Order.NoRealNameAuthentication","errorMessage":"You have not passed the real-name authentication and do not meet the purchase conditions. Please log in to the user center for real-name authentication."},{"errorCode":"InsufficientAvailableQuota","errorMessage":"Your account quota limit is less than 0, please recharge before trying to purchase."},{"errorCode":"CommodityServiceCalling.Exception","errorMessage":"Failed to call commodity service."},{"errorCode":"RegionDissolvedEOM","errorMessage":"Dear customer, Alibaba Cloud plans to optimize and adjust the current region. Cloud services in this region will cease operations. You are currently unable to operate new purchase orders. Thank you for your understanding and support."},{"errorCode":"Commodity.InvalidComponent","errorMessage":"The module you purchased is not legal, please buy it again."},{"errorCode":"RegionEndTimeDissolvedIndia","errorMessage":"Cloud services in the India (Mumbai) region will be discontinued. Set the validity date to July 15, 2024 or earlier than July 15, 2024."},{"errorCode":"RegionEndTimeDissolvedAustralia","errorMessage":"Cloud services in the Australia (Sydney) region will be discontinued. Set the validity date to September 30, 2024 or earlier than September 30, 2024."},{"errorCode":"Price.CommoditySys","errorMessage":"Commodity system call exception."},{"errorCode":"Pay.InsufficientBalance","errorMessage":"Insufficient available balance."},{"errorCode":"Order.PeriodInvalid","errorMessage":"There is a problem with the period you selected, please choose again."},{"errorCode":"pay.noCreditCard","errorMessage":"Account not bound to credit card."},{"errorCode":"Order.InstHasUnpaidOrder","errorMessage":"There is an unpaid order for the service you have purchased. Please pay or void it before placing the order."},{"errorCode":"noAvailablePaymentMethod","errorMessage":"No payment method is specified for your account. We recommend that you add a payment method."},{"errorCode":"BasicInfoUncompleted","errorMessage":"Your information is incomplete. Complete your information before the operation."},{"errorCode":"Risk.RiskControlRejection","errorMessage":"Your account is abnormal, please contact customer service for details."},{"errorCode":"Api.NotSupport","errorMessage":"Specified api is not supported."},{"errorCode":"ContainForbiddenLabelError","errorMessage":"There is a label that prohibits placing orders. Please contact your distributor for assistance."},{"errorCode":"InvalidDBInstanceId.NotFound","errorMessage":"The DBInstanceId provided does not exist in records."},{"errorCode":"InvalidInstanceLevel.DiskType","errorMessage":"Specified instance level not support request disk type"},{"errorCode":"InvalidParam","errorMessage":"Sepcified wal level Parameter is invalid. There are still logical slots in instance, so it can not be set as replica."},{"errorCode":"KmsApiError","errorMessage":"User secret key invalid."},{"errorCode":"System.SaleValidateFailed","errorMessage":"Sales expression validation system error."},{"errorCode":"Abs.InvalidAccount.NotFound","errorMessage":"account  is not found."}],"403":[{"errorCode":"IncorrectCategory","errorMessage":"Current Instance type does not support Category."},{"errorCode":"OperationDenied.SwitchSnapshotToPhysical","errorMessage":"Only physical backup to snapshot backup is supported."},{"errorCode":"OperationDenied.ModifyBackupSwitchOff","errorMessage":"The switch is not turned on. It is forbidden to modify the backup mode."},{"errorCode":"OperationDenied.ApiForbiddenForLogBackupFrequency","errorMessage":"When the instance is a snapshot backup, the log backup frequency is not allowed to be consistent with the data backup."},{"errorCode":"OperationDenied.NotSupportedBackupMethod","errorMessage":"When the storage is larger than 4000 GB, only snapshot backup is supported."},{"errorCode":"OperationDenied.ApiForbidden","errorMessage":"Operation is not permitted."},{"errorCode":"OrderStatus.UnPaid","errorMessage":"The specified db instance has unpaid order."},{"errorCode":"InvalidReduceDiskSize","errorMessage":"The storage capacity after the scale-down must be larger than the used amount."},{"errorCode":"CloudSSDNotSupport","errorMessage":"Cloud ssd does not support this operation, please upgrade to essd."},{"errorCode":"InvalidUserOperatorPermission","errorMessage":"The user permission does not support this operation."},{"errorCode":"InvalidVswitchId","errorMessage":"Specified conn vswitch id is not valid."}],"404":[{"errorCode":"InvalidClusterKms","errorMessage":"The current instance does not authorized to access the Key Management Service."}],"500":[{"errorCode":"ExternalFailure","errorMessage":"The request processing has failed due to external service failure."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"DA147739-AEAD-4417-9089-65E9B1D8240D\\\",\\n  \\\"CompressType\\\": \\\"4\\\",\\n  \\\"LocalLogRetentionSpace\\\": \\\"30\\\",\\n  \\\"LogBackupLocalRetentionNumber\\\": 60,\\n  \\\"DBInstanceID\\\": \\\"rm-uf6wjk5****\\\",\\n  \\\"EnableBackupLog\\\": \\\"1\\\",\\n  \\\"LocalLogRetentionHours\\\": 18,\\n  \\\"HighSpaceUsageProtection\\\": \\\"Disable\\\"\\n}\",\"errorExample\":\"{\\n    \\\"RequestId\\\": \\\"7463B73D-35CC-4D19-A010-6B8D65D242EF\\\",\\n    \\\"HostId\\\": \\\"rds.aliyuncs.com\\\",\\n    \\\"Code\\\": \\\"UnsupportedOperation\\\",\\n    \\\"Message\\\": \\\"The specified action is not supported.\\\"\\n}\"},{\"type\":\"xml\",\"example\":\"<ModifyBackupPolicyResponse>\\n      <HighSpaceUsageProtection>Disable</HighSpaceUsageProtection>\\n\\t<DBInstanceID>rm-bp1z3xxxxx</DBInstanceID>\\n\\t<RequestId>E4BF5598-ED12-4406-AAA4-F375428BE741</RequestId>\\n\\t<LocalLogRetentionHours>18</LocalLogRetentionHours>\\n\\t<EnableBackupLog>1</EnableBackupLog>\\n\\t<LocalLogRetentionSpace>30</LocalLogRetentionSpace>\\n    <LogBackupLocalRetentionNumber>60</LogBackupLocalRetentionNumber>\\n</ModifyBackupPolicyResponse>\",\"errorExample\":\"\"}]","title":"修改实例备份策略","description":"### 适用引擎\n\n- RDS MySQL\n- RDS PostgreSQL\n- RDS SQL Server\n- RDS MariaDB\n\n### 相关功能文档\n><notice>使用该接口前，请仔细阅读功能文档，确保完全了解使用接口的前提条件及使用后造成的影响后，再进行操作。></notice>\n\n- [RDS MySQL自动备份策略设置](~~98818~~)\n- [RDS PostgreSQL自动备份策略设置](~~96772~~)\n- [RDS SQL Server自动备份策略设置](~~95717~~)\n- [RDS MariaDB自动备份策略设置](~~97147~~)","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}