{"summary":"该接口用于配置RDS实例数据库代理连接地址的访问策略。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"update"},"parameters":[{"name":"DBInstanceId","in":"query","schema":{"description":"实例ID。可调用DescribeDBInstances获取。","type":"string","required":true,"docRequired":true,"example":"rm-bp145737x5bi6****"}},{"name":"DBProxyEndpointId","in":"query","schema":{"description":"代理连接地址ID。可以通过接口DescribeDBProxyEndpoint查看。\n\n> - MySQL：当**DbEndpointOperator**取值为**Delete**或**Modify**时，本参数必须传入。\n> - PostgreSQL：当**DbEndpointOperator**取值为**Delete**、**Modify**或**Create**时，本参数必须传入。","type":"string","required":false,"docRequired":false,"example":"gos787jog2wk0y****"}},{"name":"ConfigDBProxyFeatures","in":"query","schema":{"description":"设置代理连接地址想要开通的代理功能，各功能之间以英文分号（;）隔开。格式：`功能1:开通情况;功能2:开通情况;... `，末尾不加英文分号（;）。\n\n功能取值：\n* **ReadWriteSpliting**：读写分离\n* **ConnectionPersist**：连接池\n* **TransactionReadSqlRouteOptimizeStatus**：事务拆分\n\n开通情况取值：\n* **1**：功能已开通\n* **0**：功能未开通\n\n> RDS PostgreSQL仅支持设置**ReadWriteSpliting**。","type":"string","required":false,"example":"ReadWriteSpliting:1;ConnectionPersist:0"}},{"name":"RegionId","in":"query","schema":{"description":"地域ID。可调用DescribeRegions获取。","type":"string","required":false,"example":"cn-hangzhou"}},{"name":"ReadOnlyInstanceMaxDelayTime","in":"query","schema":{"description":"读写分离中只读实例的最大延迟阈值，当只读实例延迟时间超过该值时，读取流量不发往该实例，单位：秒。不传该参数则保持原值。取值：**0**~**3600**。默认值：**30**。\n>开通读写分离时才需要传入该参数。","type":"string","required":false,"example":"30"}},{"name":"ReadOnlyInstanceDistributionType","in":"query","schema":{"description":"读权重分配模式。取值：\n\n* **Standard**：按规格权重自动分配。\n* **Custom**：自定义分配权重。\n\n> 开通读写分离时才需要传入该参数。权限分配模式的详细信息，MySQL请参见[读权重分配](~~96076~~)，PostgreSQL请参见[开通并配置数据库代理服务](~~418272~~)。","type":"string","required":false,"example":"Standard"}},{"name":"ReadOnlyInstanceWeight","in":"query","schema":{"description":"自定义读权重分配，即传入主实例和只读实例的读请求权重。以100递增，最大值为10000，格式：\n\n- 常规实例：`{\"主实例ID\":\"权重\",\"只读实例ID\":\"权重\"...}`\n\n    示例：`{\"rm-uf6wjk5****\":\"500\",\"rr-tfhfgk5xxx\":\"200\"...}`\n- RDS MySQL集群版实例：`{\"只读实例ID\":\"权重\",\"DBClusterNode\":{\"主节点ID\":\"权重\",\"备节点ID\":\"权重\",\"备节点ID\":\"权重\"...}}`\n\n    示例：`{\"rr-tfhfgk5****\":\"200\",\"DBClusterNode\":{\"rn-2z****\":\"0\",\"rn-2z****\":\"400\",\"rn-2z****\":\"400\"...}}`\n    > **DBClusterNode**为集群版独有的请求信息，包含主备节点的**NodeID**以及**权重**。","type":"string","required":false,"example":"{\"rm-uf6wjk5****\":\"500\",\"rr-tfhfgk5xxx\":\"200\"...}"}},{"name":"DBInstanceId","in":"query","schema":{"description":"实例ID。可调用DescribeDBInstances获取。","type":"string","required":true,"docRequired":true,"example":"rm-bp145737x5bi6****"}},{"name":"DbEndpointOperator","in":"query","schema":{"description":"操作类型，取值：\n* **Modify**：默认值，修改代理终端。\n* **Create**：新建代理终端。\n* **Delete**：删除代理终端。","type":"string","required":false,"example":"Modify"}},{"name":"DbEndpointAliases","in":"query","schema":{"description":"代理终端的备注信息。","type":"string","required":false,"example":"test-proxy"}},{"name":"DbEndpointType","in":"query","schema":{"description":"代理终端的类型，保留参数，无需设置。","type":"string","required":false,"example":"RWSplit"}},{"name":"DbEndpointReadWriteMode","in":"query","schema":{"description":"读写类型，取值：\n* **ReadWrite**：连接主实例，可接受写请求。\n* **ReadOnly**：默认值，不连接主实例，无法接受写请求。\n\n> * 当**DbEndpointOperator**取值为**Create**时，本参数必须传入。\n> * RDS MySQL实例中，本参数的取值从**ReadWrite**更换为**ReadOnly**时，会关闭事务拆分功能。","type":"string","required":false,"example":"ReadWrite"}},{"name":"DBProxyEngineType","in":"query","schema":{"description":"废弃参数，无需配置。","type":"string","required":false,"example":"normal"}}],"responses":{"200":{"schema":{"description":"返回参数详情。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"6B50D92C-1960-4D4F-A290-AFADD6B1A5C8"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidVpcInstanceId","errorMessage":"The specified VPC instance ID is invalid."},{"errorCode":"InvalidEndPoint.Format","errorMessage":"The specified EndPoint is not valid."},{"errorCode":"InvalidEndpointType.Format","errorMessage":"The specified EndpointType is invalid."},{"errorCode":"IncorrectDBInstanceNetType","errorMessage":"The current database instance network type does not support the operation."},{"errorCode":"EndpointNum.Error","errorMessage":"The number of endpoint is invalid."},{"errorCode":"EndpointTypeOperation.NotSupport","errorMessage":"The endpoint type does not support the operation."},{"errorCode":"InvalidDBInstanceName","errorMessage":"Specified parameter DBInstanceName is not valid."},{"errorCode":"ClusterEndpoint.StatusNotValid","errorMessage":"The cluster endpoint status is invalid."},{"errorCode":"MaxscaleNotSupport","errorMessage":"Current custins can not support Maxscale."},{"errorCode":"Order.ComboInstanceNotAllowOperate","errorMessage":"A package instance is not allowed to operate independently."},{"errorCode":"Price.PricingPlanResultNotFound","errorMessage":"Pricing plan price result not found."},{"errorCode":"Order.NoRealNameAuthentication","errorMessage":"You have not passed the real-name authentication and do not meet the purchase conditions. Please log in to the user center for real-name authentication."}],"403":[{"errorCode":"MaxScaleLevel.NotSupport","errorMessage":"The current maxscale ins_num does not support this operation."},{"errorCode":"ReadDBInstance.NotFound","errorMessage":"The current database instance does not contain any read only instance."},{"errorCode":"IncorrectKindCode","errorMessage":"The current KindCode of the custins does not support the operation."},{"errorCode":"IncorrectDBInstanceState","errorMessage":"The current database instance state does not support the operation."},{"errorCode":"IncorrectDBInstanceEngine","errorMessage":"Current DB Instance engine does not support this operation."},{"errorCode":"IncorrectDBInstanceType","errorMessage":"Current DB instance type does not support this operation."}],"404":[{"errorCode":"EndpointConfig.Invalid","errorMessage":"Please check the endpoint config parameter."},{"errorCode":"Readins.NotFound","errorMessage":"The current instance does not contain any read only instance. The operation is not supported."},{"errorCode":"Endpoint.NotFound","errorMessage":"Specified endpoint is not found."},{"errorCode":"EndpointType.NotFound","errorMessage":"The specified endpoint type is not found."},{"errorCode":"InvalidReadDBInstance.NotFound","errorMessage":"The specified read only database instance does not exist."},{"errorCode":"InvalidParam","errorMessage":"The specified Weight is invalid."},{"errorCode":"Maxscale.NotFound","errorMessage":"The related maxscale instance is not found."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"6B50D92C-1960-4D4F-A290-AFADD6B1A5C8\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<ModifyDBProxyEndpointResponse>\\r\\n  <RequestId>6B50D92C-1960-4D4F-A290-AFADD6B1A5C8</RequestId>\\r\\n</ModifyDBProxyEndpointResponse>\",\"errorExample\":\"\"}]","title":"配置数据库代理连接地址访问策略","description":"### 适用引擎\n\n- RDS MySQL\n- RDS PostgreSQL\n\n### 相关功能文档\n><notice>使用该接口前，请仔细阅读功能文档，确保完全了解使用接口的前提条件及使用后造成的影响后，再进行操作。></notice>\n\n- [RDS MySQL配置数据库代理连接地址访问策略](~~2621331~~)\n- [RDS PostgreSQL配置数据库代理连接地址访问策略](~~418273~~)","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}