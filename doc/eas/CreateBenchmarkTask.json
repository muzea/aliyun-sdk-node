{"summary":"调用CreateBenchmarkTask，创建压测任务。","path":"/api/v2/benchmark-tasks","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{},"parameters":[{"name":"body","in":"body","schema":{"description":"压测任务的配置参数。","type":"string","required":false,"example":"{\n    \"base\": {\n        \"duration\": 600\n    },\n    \"service\": {\n        \"serviceName\": \"test_service\",\n        \"requestToken\": \"test_token\"\n    },\n    \"data\": {\n        \"path\": \"https://larec-benchmark-cd.oss-cn-chengdu.aliyuncs.com/youbei/sv_dbmtl/data/youbei.warmup.tf.bin\",\n        \"dataType\": \"binary\"\n    },\n    \"optional\": {\n       \"maxRt\": 100\n    }\n}"}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"返回结果。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"40325405-579C-4D82********"},"TaskName":{"description":"压测任务名字。","type":"string","example":"benchmark-larec-test-1076"},"Region":{"description":"压测任务所在的区域。","type":"string","example":"cn-shanghai"},"Message":{"description":"请求返回信息。","type":"string","example":"Benchmark  task [foo] is Creating"}}}}},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"40325405-579C-4D82********\\\",\\n  \\\"TaskName\\\": \\\"benchmark-larec-test-1076\\\",\\n  \\\"Region\\\": \\\"cn-shanghai\\\",\\n  \\\"Message\\\": \\\"Benchmark  task [foo] is Creating\\\"\\n}\",\"type\":\"json\"}]","title":"创建压测任务","requestParamsDescription":"## 压测任务配置参数\neas-benchmark 整体配置分五部分，如下所示：\n\n| **参数** | **说明** |\n| --- | --- |\n| base | 压测任务的基本配置。 |\n| service | 待压测服务的相关配置。 |\n| data | 压测请求数据的相关配置。 |\n| http | 服务请求HTTP相关配置。 |\n| optional | 压测任务可选高级配置。 |\n\n#### 表1. base描述表\n| **参数** | **说明** |\n| --- | --- |\n| name | 【可选】压测任务的名称，如果不指定，会根据服务名自动生成。 |\n| duration | 【可选】压测任务执行的总时间，单位为秒，默认为1200。 |\n| qps | 【可选】压测任务的目标（预期）QPS， 默认为10000。 |\n| concurrency | 【可选】每个压测实例内创建的并发连接数, 初始值默认为40，会动态修改。 |\n| agentCount | 【可选】压测任务创建的实例个数，初始值默认为1，会动态修改。 |\n\n\n#### 表2. service描述表\n当您需要通过访问网关的模式创建压测任务时，需要[提交工单](https://smartservice.console.aliyun.com/service/create-ticket?product=learn)开通白名单权限。    \n| **参数** | **说明** |\n| --- | --- |\n| serviceUrl | 【可选】待压测服务的访问URL，如果待压测服务是EAS服务，无需配置。 |\n| serviceName | 【可选】待压测服务的服务名，如果待压测服务是EAS服务，必须配置；如果待压测服务是自定义服务，无需配置。 |\n| requestToken | 【可选】访问服务的鉴权token，如果**serviceName**被指定，无需配置。 |\n| endpointType | 【可选】服务支持的压测类型，支持**default**（网关）、**direct**（直连模式） 两种模式，默认为**direct**。 |\n#### 表3. data描述表\n| **参数** | **说明** |\n| --- | --- |\n| content | 【可选】压测请求数据，字符串格式。 |\n| path | 【可选】测试数据源的HTTP路径，可以是单个文件，也支持`.zip`文件，对`.zip`文件下载后会自动解压。 |\n| dataType | 【可选】测试数据的类型，支持text和binary两种类型，默认为text类型。 |\n| multiLine | 【可选】测试数据是否是按行分割的，BOOL类型，如果设置为true，会将下载的数据逐行解析。|\n#### 表4、HTTP描述表\n| **参数** | **说明** |\n| --- | --- |\n| method | 【可选】HTTP请求方法，默认为POST类型。 |\n| host | 【可选】请求主机HOST设置，默认为空。 |\n| headers | 【可选】HTTP请求HEADER设置，LIST类型，例如：`[\"Authorization:aaa\", \"Content-Type:text\"] `。|\n| timeout | 【可选】HTTP请求延时，单位为毫秒，默认20000。|\n#### 表5. optional描述表\n| **参数** | **说明** |\n| --- | --- |\n| mode | 【可选】压测模式，支持以下三种模式：<br>**auto（自动加压模式）**：默认值。eas-benchmark控制器会自动创建用于压测的Agent Worker，并设置合适的并发，通过自动寻优的算法来寻找服务的承压上限。<br>**scan（周期加压模式）**：根据您指定的起始QPS（minQPS）、QPS上限（maxQPS）、QPS增长时间间隔（adjustInterval）和QPS增长步长（qpsGrowthDelta）等参数，动态加压，当服务承载到达指定的maxRT、maxQPS或服务压测出现错误数量超出容忍程度（faultTolerate）时为止。<br>**manual（手动加压模式）**：固定压测Agent数量及每个Agent的并发数，您可以在压测过程中动态调整Agent数量及Agent并发数。|\n| adjustInterval | 【可选】自动加压的动态调整间隔，单位为秒，默认为60。例如设置为30， 则每隔30秒调整加压阈值。|\n| minQPS | 【可选】在自动加压过程中QPS的最小值，默认为100。|\n| maxQPS | 【可选】在自动加压过程中QPS的最大值，默认为10000。|\n| maxRT | 【可选】期望的最大RT，超过该阈值会自动调节QPS，直到实时RT符合预期。|\n| qpsGrowthDelta | 【可选】在自动加压过程中QPS每次增长的数值，默认为50 。|\n| faultTolerate | 【可选】请求错误（非200状态码）率的容忍程度，默认为0.001。 |\n| faultAction | 【可选】在请求错误率超过faultTolerate设定的阈值时，压测的行为，可选值：stop （维持当前qps, 不再继续加压）；revise（动态调整QPS，直到请求错误率符合预期）|"}