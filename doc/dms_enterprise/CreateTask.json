{"summary":"调用CreateTask接口，创建任务流任务。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"145318","abilityTreeNodes":["FEATUREdmsXSH6IQ"]},"parameters":[{"name":"Tid","in":"query","schema":{"description":"租户ID。\n> 取自系统右上角头像处悬停展示的租户ID信息，详情请参见[查看租户信息](~~181330~~)。","type":"integer","format":"int64","required":false,"maximum":"9223372036854775807","minimum":"1","example":"3***"}},{"name":"DagId","in":"query","schema":{"description":"任务流ID，可通过调用接口[ListTaskFlow](~~424565~~)或[ListLhTaskFlowAndScenario](~~426672~~)获取该参数的值。","type":"integer","format":"int64","required":true,"docRequired":true,"example":"7***"}},{"name":"NodeName","in":"query","schema":{"description":"任务节点名称。","type":"string","required":true,"docRequired":true,"example":"zhttest"}},{"name":"NodeType","in":"query","schema":{"description":"任务节点类型，取值请参见[NodeType参数说明](~~424705~~)。","type":"string","required":true,"docRequired":true,"example":"36"}},{"name":"NodeContent","in":"query","schema":{"description":"节点配置内容。","type":"string","required":false,"example":"test"}},{"name":"TimeVariables","in":"query","schema":{"description":"节点变量（时间变量配置）。","type":"string","required":false,"example":"test"}},{"name":"NodeOutput","in":"query","schema":{"description":"任务输出变量。","type":"string","required":false,"example":"test"}},{"name":"GraphParam","in":"query","schema":{"description":"节点在图上的显示位置。","type":"string","required":false,"example":"test"}}],"responses":{"200":{"schema":{"description":"返回参数值如下。","type":"object","properties":{"RequestId":{"description":"请求ID，用于定位日志，排查问题。\n","type":"string","example":"CFD8FE00-36D9-4C1B-940D-65A7B73D9066"},"ErrorCode":{"description":"错误码。","type":"string","example":"InvalidParameterValid"},"ErrorMessage":{"description":"调用失败时，返回的错误信息。","type":"string","example":"InvalidParameterValid"},"Success":{"description":"请求是否成功，返回值如下：\n- true：请求成功\n- false：请求失败","type":"boolean","example":"true"},"NodeId":{"description":"创建成功时，返回的任务节点ID。","type":"integer","format":"int64","example":"3***"}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"CFD8FE00-36D9-4C1B-940D-65A7B73D9066\\\",\\n  \\\"ErrorCode\\\": \\\"InvalidParameterValid\\\",\\n  \\\"ErrorMessage\\\": \\\"InvalidParameterValid\\\",\\n  \\\"Success\\\": true,\\n  \\\"NodeId\\\": 0\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateTaskResponse>\\n    <RequestId>CFD8FE00-36D9-4C1B-940D-65A7B73D9066</RequestId>\\n    <ErrorCode>InvalidParameterValid</ErrorCode>\\n    <ErrorMessage>InvalidParameterValid</ErrorMessage>\\n    <Success>true</Success>\\n</CreateTaskResponse>\",\"errorExample\":\"\"}]","title":"创建任务流任务","requestParamsDescription":"# 节点配置相关参数说明\n根据节点类型的不同，节点的配置有所区别。此文档为任务流任务相关接口，如CreateTask、UpdateTaskOutput等接口的补充说明，其中NodeParam、NodeContent、GraphParam的配置具有通用性。  \n当前仅“单实例SQL赋值”、“脚本代码”、“Ecs远程命令”任务节点具有输出变量，配置方式有所区别，详情可参考UpdateTaskOutput接口文档说明。\n\n##  单实例SQL\n- DagId\n- NodeName\n- NodeType: 1\n- NodeParam\n- GraphParam\n- NodeContent: 样例如下\n```Json\n{\n    \"dbId\":123456, // 数据库Id\n    \"sql\":\"/* 请使用当前节点所选择的数据库语法编写SQL */\", // sql语句\n    \"dbType\":\"lindorm_sql\" // 数据库类型\n}\n```\n\n##  脚本代码\n- DagId\n- NodeName\n- NodeType: 28\n- NodeParam\n- GraphParam\n- NodeOutput\n```Json\n{\n    \"outputs\":[\n        {\n            \"extractMethod\":\"json\", // 固定为json\n            \"variableName\":\"var\",  // 变量名\n            \"description\":\"demo desc\" // 变量描述\n        }\n    ]\n}\n```\n- NodeContent：样例如下  \n```json\n{\n    \"regionId\":\"cn-hangzhou\", // 地域\n    \"gatewayId\":\"dg-xxxxxxxxxxxxxx\", // 网关ID\n    \"gatewayInstanceId\":\"dg-node-xxxxxxxxxxxxxx\", // 网关实例ID\n    \"scriptFileName\":\"demo.sh\", // 文件名\n    \"args\":[ // 运行参数\n        \"-n value\",\n        \"-n1 value1\"\n    ]\n}\n```\n\n## 无锁数据变更\n- DagId\n- NodeName\n- NodeType: 24\n- NodeParam\n- GraphParam\n- NodeContent: 样例如下  \n```json\n{\n    \"dbId\":123456, // 数据库Id\n    \"sql\":\"/* 请使用当前节点所选择的数据库语法编写SQL */\", // sql语句\n    \"dbType\":\"polardb\" // 数据库类型\n}\n```\n\n## 单实例SQL赋值\n- DagId\n- NodeName\n- NodeType: 32\n- NodeParam\n- GraphParam\n- NodeOutput: 样例如下\n```Json\n{\n    \"outputs\":[\n        {\n            /*\n            // 变量提取设置\n            {\n                \"row\":0, // 行，-1为所有行\n                \"column\":-1, // 列，-1为所有列\n                \"combiner\":\",\" // 分隔符,当选中所有行或所有列时，需要指定连接符。变量返回值为字符串\n            }\n            */\n            \"extractMethod\":\"{\\\"row\\\":0,\\\"column\\\":-1,\\\"combiner\\\":\\\",\\\"}\", \n            \"variableName\":\"var\", // 变量名\n            \"description\":\"For demo\" // 变量介绍\n        }\n    ]\n}\n```\n- NodeContent: 样例如下  \n```json\n{\n    \"dbId\":123456, // 数据库Id\n    \"sql\":\"/* 请使用当前节点所选择的数据库语法编写SQL，仅支持SELECT语句，且默认返回最大行数为30 *\", // sql语句\n    \"dbType\":\"lindorm_cql\" // 数据库类型\n}\n```\n\n## 依赖检查\n- DagId\n- NodeName\n- NodeType: 2\n- NodeParam\n- GraphParam\n- NodeContent: 样例如下  \n```Json\n{\n    \"dependentDAGId\":132,  // 依赖项：任务流\n    \"dependentNodeId\":\"\", // 依赖项：单个节点，缺省时依赖项为指定的任务流\n    \"dependentStartTimePattern\":\"yyyy-MM-dd HH:mm|-2d+0h+0m\", // 开始时间偏移点\n    \"dependentEndTimePattern\":\"yyyy-MM-dd HH:mm|+1d+0h+0m\", // 结束时间偏移点\n    \"multiSuccessStrategy\":2, //  实例检查策略： 0.最后一次成功； 1.全部成功； 2.指定单次成功\n    \"multiSuccessStrategyIndex\":1 // 实例检查策略： 第 x+1 次\n}\n```\n\n## 表时间列状态检查\n- DagId\n- NodeName\n- NodeType: 2\n- NodeParam\n- GraphParam\n- NodeContent: 样例如下  \n```Json\n{\n    \"dependentDAGId\":132,  // 依赖项：任务流\n    \"dependentNodeId\":\"\", // 依赖项：单个节点，缺省时依赖项为指定的任务流\n    \"dependentStartTimePattern\":\"yyyy-MM-dd HH:mm|-2d+0h+0m\", // 开始时间偏移点\n    \"dependentEndTimePattern\":\"yyyy-MM-dd HH:mm|+1d+0h+0m\", // 结束时间偏移点\n    \"multiSuccessStrategy\":2, //  实例检查策略： 0.最后一次成功； 1.全部成功； 2.指定单次成功\n    \"multiSuccessStrategyIndex\":1 // 实例检查策略： 第 x+1 次\n}\n```\n\n\n## SQL状态检查\n- DagId\n- NodeName\n- NodeType: 25\n- NodeParam\n- GraphParam\n- NodeContent: 样例如下  \n```Json\n{\n    \"dbId\":123456,\n    \"sql\":\"/* 请使用当前节点所选择的数据库语法编写SQL */ \\n\\n select 1 from abc\",\n    \"dbType\":\"lindorm_cql\"\n}\n```"}