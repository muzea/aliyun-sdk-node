{"summary":"在DMS中录入新的数据库实例。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create"},"parameters":[{"name":"Tid","in":"query","schema":{"description":"租户ID，可通过调用接口[GetUserActiveTenant](~~198073~~)获取该参数的值。","type":"integer","format":"int64","required":false,"docRequired":false,"example":"3***"}},{"name":"InstanceType","in":"query","schema":{"description":"数据库类型，取值请参见[DbType参数说明](~~198106~~)。","type":"string","required":true,"docRequired":true,"example":"MySQL"}},{"name":"InstanceSource","in":"query","schema":{"description":"数据库实例来源，取值如下：\n\n- **PUBLIC_OWN**：代表公网自建实例\n- **RDS**：代表RDS实例\n- **ECS_OWN**：代表ECS自建实例\n- **VPC_IDC**：代表VPC IDC自建实例\n","type":"string","required":true,"docRequired":true,"example":"RDS"}},{"name":"NetworkType","in":"query","schema":{"description":"网络类型，取值如下：\n\n- **CLASSIC**：经典网络\n- **VPC**：VPC网络\n","type":"string","required":true,"docRequired":true,"example":"VPC"}},{"name":"EnvType","in":"query","schema":{"description":"环境类型，取值如下：\n- product：生产环境\n- dev：开发环境\n- pre：预发环境\n- test：测试环境\n- sit：SIT环境\n- uat：UAT环境\n- pet：压测环境\n- stag：STAG环境\n","type":"string","required":true,"docRequired":true,"example":"product"}},{"name":"EcsInstanceId","in":"query","schema":{"description":"ECS的实例ID。\n\n>如果InstanceSource取值为ECS_OWN，此值必填。","type":"string","required":false,"example":"i-2zei9gs1t7h8l7ac****"}},{"name":"VpcId","in":"query","schema":{"description":"VPC ID。\n\n> 如果InstanceSource取值为VPC_IDC时，此值必填。","type":"string","required":false,"example":"vpc-xxxxxxxxxxxxxxxxxxxxx"}},{"name":"EcsRegion","in":"query","schema":{"description":"实例所在区域。\n\n>如果InstanceSource取值为RDS、ECS\\_OWN或VPC_IDC，此值必填。","type":"string","required":false,"example":"cn-hangzhou"}},{"name":"Host","in":"query","schema":{"description":"目标数据库的主机地址。","type":"string","required":true,"docRequired":true,"example":"172.XX.XXX.254"}},{"name":"Port","in":"query","schema":{"description":"目标数据库的访问端口。","type":"integer","format":"int32","required":true,"docRequired":true,"example":"3306"}},{"name":"Sid","in":"query","schema":{"description":"数据库SID。\n\n>如果InstanceType为ORACLE，此项必填。","type":"string","required":false,"example":"XXX"}},{"name":"DatabaseUser","in":"query","schema":{"description":"数据库访问账号。","type":"string","required":true,"docRequired":true,"example":"dmstest"}},{"name":"DatabasePassword","in":"query","schema":{"description":"数据库访问密码。","type":"string","required":true,"docRequired":true,"example":"******"}},{"name":"InstanceAlias","in":"query","schema":{"description":"实例别名，可以帮助用户快速区分定位实例。","type":"string","required":true,"docRequired":true,"example":"测试实例"}},{"name":"DbaUid","in":"query","schema":{"description":"实例DBA角色的用户UID，可通过调用接口[ListUsers](~~141938~~)或[GetInstance](~~141567~~)获取该参数的值。","type":"integer","format":"int64","required":true,"docRequired":true,"example":"22275482072787****"}},{"name":"SafeRule","in":"query","schema":{"description":"实例的安全规则集（GroupName），可通过调用接口[ListStandardGroups](~~417891~~)或[GetInstance](~~141567~~)获取该参数的值。","type":"string","required":true,"docRequired":true,"example":"测试使用"}},{"name":"QueryTimeout","in":"query","schema":{"description":"查询超时时间，单位：s（秒）。","type":"integer","format":"int32","required":true,"docRequired":true,"example":"60"}},{"name":"ExportTimeout","in":"query","schema":{"description":"导出超时时间，单位：s（秒）。","type":"integer","format":"int32","required":true,"docRequired":true,"example":"600"}},{"name":"DataLinkName","in":"query","schema":{"description":"输入跨库查询datalink名称。\n\n> - 如果UseDsql取值为1，此值必填。\n> - DBLink名称只能使用小写字母和下划线（_）。\n> - DBLink名称需要在租户内保持全局唯一性。","type":"string","required":false,"example":"dblink_test"}},{"name":"DdlOnline","in":"query","schema":{"description":"是否开启结构变更优先，取值如下：\n- **0** ：不使用\n- **1** ：原生无锁优先，失败转DMS执行\n- **2** ：DMS无锁变更执行\n\n> 支持的数据库类型：RDS MySQL、PolarDB MySQL引擎、MyBase MySQL、其他来源MySQL。","type":"integer","format":"int32","required":false,"example":"2","enum":["0","1","2"]}},{"name":"UseDsql","in":"query","schema":{"description":"是否启用跨实例查询，取值如下：\n- **0**：不开启\n- **1**：开启\n\n> 支持的数据库类型：MySQL、SQL Server、PostgreSQL、PolarDB PostgreSQL版（兼容Oracle）、Redis。","type":"integer","format":"int32","required":false,"example":"1","enum":["0","1"]}},{"name":"SkipTest","in":"query","schema":{"description":"实例是否忽略测试连通性。取值如下：\n- **true**：忽略\n- **false**：不忽略","type":"boolean","required":false,"docRequired":false,"example":"true"}},{"name":"EnableSellSitd","in":"query","schema":{"title":"- Y：开启敏感数据保护\n- NULL或其它：不开启敏感数据保护","description":"- **Y**：开启敏感数据保护\n- **NULL或其它**：不开启敏感数据保护","type":"string","required":false,"example":"Y"}},{"name":"TemplateId","in":"query","schema":{"title":"分类分级模板ID，可从ListClassificationTemplates获取","description":"分类分级模板ID。您可以调用[ListClassificationTemplates](~~460613~~)接口获取该参数的值。","type":"integer","format":"int64","required":false,"example":"31***"}},{"name":"TemplateType","in":"query","schema":{"title":"分类分级模板类型，可从ListClassificationTemplates获取","description":"分类分级模板类型。您可以调用[ListClassificationTemplates](~~460613~~)接口获取该参数的值。","type":"string","required":false,"example":"INNER"}},{"name":"DbaUidByString","in":"query","schema":{"title":"用于替换DbaUid字段，可输入角色账号等非数字DbaUid","description":"用于替换DbaUid字段，可输入角色账号等非数字DbaUid","type":"string","required":false,"example":"22275482072787****"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"F4E2A94B-604F-43FF-93E7-F4EE3DCF412E"},"ErrorCode":{"description":"错误码。","type":"string","example":"UnknownError"},"ErrorMessage":{"description":"错误消息。","type":"string","example":"UnknownError"},"Success":{"description":"请求是否成功，返回值如下：\n- **true**：请求成功\n- **false**：请求失败","type":"boolean","example":"true"}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"F4E2A94B-604F-43FF-93E7-F4EE3DCF412E\\\",\\n  \\\"ErrorCode\\\": \\\"UnknownError\\\",\\n  \\\"ErrorMessage\\\": \\\"UnknownError\\\",\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<RegisterInstanceResponse>\\n    <RequestId>F4E2A94B-604F-43FF-93E7-F4EE3DCF412E</RequestId>\\n    <Success>true</Success>\\n</RegisterInstanceResponse>\",\"errorExample\":\"\"}]","title":"录入新的数据库实例（旧）","description":"前提条件：\n您的用户角色为管理员或DBA。可通过调用接口[ListUsers](~~141938~~)或[GetUser](~~147098~~)获取用户角色RoleIdList。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":"### Python sdk示例\n\n示例为VPC专线实例的录入。\n\n```\n#coding=utf-8\nfrom aliyunsdkcore.client import AcsClient\nfrom aliyunsdkdms_enterprise.request.v20181101.RegisterInstanceRequest import RegisterInstanceRequest\nclient = AcsClient(\n    \"<your-access-key-id>\",\n    \"<your-access-key-secret>\",\n    \"<your-region-id>\"\n)\n# VPC_IDC实例注册示例\nrequest = RegisterInstanceRequest()\n# 租户ID\nrequest.set_Tid(1)\n# 实例host\nrequest.set_Host(\"192.168.16.113\")\n# 实例port\nrequest.set_Port(3314)\n# 实例db类型 eg : MySQL\nrequest.set_InstanceType(\"MySQL\")\n# 实例来源 eg : VPC_IDC\nrequest.set_InstanceSource(\"VPC_IDC\")\n# 网络类型 type: eg : VPC\nrequest.set_NetworkType(\"VPC\")\nrequest.set_EnvType(\"PRODUCT\")\n# request.set_EcsInstanceId()\n# 实例 vpc id\nrequest.set_VpcId（\"实例 VPC ID\"）\n# 实例 ecs region eg: cn-hangzhou\nrequest.set_EcsRegion（\"实例 ecs region\"）\n# request.set_Sid();\n# 实例db登录用户\nrequest.set_DatabaseUser（\"实例db登录用户\"）\n# 实例db登录密码\nrequest.set_DatabasePassword（\"实例db登录密码\"）\n# 实例别名, 方便DMS企业版里面区分实例用\nrequest.set_InstanceAlias（\"实例别名\"）\n# 实例dba 阿里云uid（此用户必须先在DMS企业版录入, 或者使用API提前录入）\nrequest.set_DbaUid(-1)\nrequest.set_SafeRule（\"DMS企业版里面配置的安全规则的规则名\"）\nrequest.set_QueryTimeout(60)\nrequest.set_ExportTimeout(600)\nresponse = client.do_action_with_exception(request)\nprint response\n```"}