{"summary":"获取SQL审核优化建议的详情，适用于数据变更工单和SQLReview工单。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"SQLReviewQueryKey","in":"query","schema":{"description":"查询SQL审核优化建议详情信息。您可以调用[ListSQLReviewOriginSQL](~~257870~~)接口获取该参数的值。","type":"string","required":true,"example":"a57e54ec5433475ea3082d882fdb****"}},{"name":"Tid","in":"query","schema":{"description":"租户ID。您可以调用[GetUserActiveTenant](~~198073~~)或[ListUserTenants](~~198074~~)接口获取该参数的值。","type":"integer","format":"int64","required":false,"maximum":"9223372036854775807","minimum":"1","example":"1"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"0C1CB646-1DE4-4AD0-B4A4-7D47DD52E931"},"ErrorCode":{"description":"错误码。","type":"string","example":"UnknownError"},"ErrorMessage":{"description":"错误信息。","type":"string","example":"UnknownError"},"Success":{"description":"请求是否成功。","type":"boolean","example":"true"},"OptimizeDetail":{"description":"审核详情。","type":"object","properties":{"QueryKey":{"description":"SQL审核优化建议详情信息的查询KEY。","type":"string","example":"a57e54ec5433475ea3082d882fdb****"},"InstanceId":{"description":"数据库所属实例ID。","type":"integer","format":"int32","example":"123321"},"DbId":{"description":"数据库ID。","type":"integer","format":"int32","example":"111222"},"SqlType":{"description":"SQL类型，如DELETE、UPDATE、ALTER_TABLE等。","type":"string","example":"UPDATE"},"QualityResult":{"description":"SQL质量。","type":"object","properties":{"ErrorMessage":{"description":"错误信息。","type":"string","example":"syntax error"},"Results":{"description":"规则审核结果。","type":"array","items":{"description":"一条规则的审核详情。","type":"object","properties":{"RuleName":{"description":"规则名。请参见[SQL审核优化建议](~~194114~~)。","type":"string","example":"SELECT_SUGGEST_ASSIGN_WHERE"},"Feedback":{"description":"SQL审核优化反馈结果。返回值如下：\n- **MUST_IMPROVE**：必须改进。\n- **POTENTIAL_ISSUE**：潜在问题。\n- **SUGGEST_IMPROVE**：建议改进。\n- **USEDMSTOOLKIT**：使用无锁结构变更。\n- **USEDMSDML_UNLOCK**：使用无锁数据变更。\n- **TABLEINDEXSUGGEST**：索引推荐。","type":"string","example":"MUST_IMPROVE"},"Comments":{"description":"管理员进行SQL审核规则自定义配置时填写的**备注**信息。详细操作，请参见[SQL审核优化建议](~~194114~~)。","type":"string","example":"xxx业务规定：查询必须带where条件"},"Messages":{"description":"审核信息列表。","type":"array","items":{"description":"审核信息。","type":"string","example":"xxx表不存在"}},"Scripts":{"description":"某些规则附带生成变更脚本。","type":"array","items":{"description":"变更脚本。","type":"object","properties":{"OpType":{"description":"执行脚本的目的。当前支持AddIndex（增加索引）。","type":"string","example":"AddIndex"},"Content":{"description":"脚本内容。","type":"string","example":"alter table xxx add index idx_xx(yyy);"},"TableName":{"description":"表名。","type":"string","example":"xxx"}}}},"RuleType":{"description":"SQL审核规则。返回值如下：\n\n- **REVIEW**：规范审核。\n- **OPTIMIZE**：优化建议。","type":"string","example":"REVIEW"}}}},"OccurError":{"description":"是否遇到错误。返回值如下：\n- **true**：存在错误。\n- **false**：不存在错误。","type":"boolean","example":"false"}}}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"0C1CB646-1DE4-4AD0-B4A4-7D47DD52E931\\\",\\n  \\\"ErrorCode\\\": \\\"UnknownError\\\",\\n  \\\"ErrorMessage\\\": \\\"UnknownError\\\",\\n  \\\"Success\\\": true,\\n  \\\"OptimizeDetail\\\": {\\n    \\\"QueryKey\\\": \\\"a57e54ec5433475ea3082d882fdb****\\\",\\n    \\\"InstanceId\\\": 123321,\\n    \\\"DbId\\\": 111222,\\n    \\\"SqlType\\\": \\\"UPDATE\\\",\\n    \\\"QualityResult\\\": {\\n      \\\"ErrorMessage\\\": \\\"syntax error\\\",\\n      \\\"Results\\\": [\\n        {\\n          \\\"RuleName\\\": \\\"SELECT_SUGGEST_ASSIGN_WHERE\\\",\\n          \\\"Feedback\\\": \\\"MUST_IMPROVE\\\",\\n          \\\"Comments\\\": \\\"xxx业务规定：查询必须带where条件\\\",\\n          \\\"Messages\\\": [\\n            \\\"xxx表不存在\\\"\\n          ],\\n          \\\"Scripts\\\": [\\n            {\\n              \\\"OpType\\\": \\\"AddIndex\\\",\\n              \\\"Content\\\": \\\"alter table xxx add index idx_xx(yyy);\\\",\\n              \\\"TableName\\\": \\\"xxx\\\"\\n            }\\n          ],\\n          \\\"RuleType\\\": \\\"REVIEW\\\"\\n        }\\n      ],\\n      \\\"OccurError\\\": false\\n    }\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GetSQLReviewOptimizeDetailResponse>\\n    <RequestId>0C1CB646-1DE4-4AD0-B4A4-7D47DD52E931</RequestId>\\n    <ErrorCode>UnknownError</ErrorCode>\\n    <ErrorMessage>UnknownError</ErrorMessage>\\n    <Success>true</Success>\\n    <OptimizeDetail>\\n        <QueryKey>a57e54ec5433475ea3082d882fdb****</QueryKey>\\n        <InstanceId>123321</InstanceId>\\n        <DbId>111222</DbId>\\n        <SqlType>UPDATE</SqlType>\\n        <QualityResult>\\n            <ErrorMessage>syntax error</ErrorMessage>\\n            <Results>\\n                <RuleName>SELECT_SUGGEST_ASSIGN_WHERE</RuleName>\\n                <Feedback>MUST_IMPROVE</Feedback>\\n                <Comments>xxx业务规定：查询必须带where条件</Comments>\\n                <Messages>xxx表不存在</Messages>\\n                <Scripts>\\n                    <OpType>AddIndex</OpType>\\n                    <Content>alter table xxx add index idx_xx(yyy);</Content>\\n                    <TableName>xxx</TableName>\\n                </Scripts>\\n                <RuleType>REVIEW</RuleType>\\n            </Results>\\n            <OccurError>false</OccurError>\\n        </QualityResult>\\n    </OptimizeDetail>\\n</GetSQLReviewOptimizeDetailResponse>\",\"errorExample\":\"\"}]","title":"获取SQL审核优化建议的详情","description":"SQL审核功能的更多信息，请参见[SQL审核](~~60374~~)。"}