{"path":"/V2/UpdateStackTemplateByResources","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"update"},"parameters":[{"name":"StackId","in":"query","schema":{"description":"资源栈ID。\n\n","type":"string","required":true,"docRequired":true,"example":"4a6c9851-3b0f-4f5f-b4ca-a14bf691****"}},{"name":"DryRun","in":"query","schema":{"description":"此次请求是否只预览结果，取值：\n- true：返回修正后的资源栈的模板的内容，并不会修改资源栈的模板。与原模板比较分析后，再判断是否要执行修正。\n- false（默认值）：会直接对资源栈的模板进行修正以消除偏差。  \n\n> 建议设置DryRun为true，预览修改后的模板。如果符合预期，再设置DryRun为false，真正地执行修改。","type":"boolean","required":false,"docRequired":false,"example":"false"}},{"name":"RegionId","in":"query","schema":{"description":"资源栈所属的地域ID。您可以调用[DescribeRegions](~~131035~~)查看最新的阿里云地域列表。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求的幂等性。 该值由客户端生成，并且必须是全局唯一的。   \n长度最大为64个字符，可包含英文字符、数字、短划线（-）和下划线（_）。\n\n更多详情，请参见[如何保证幂等性](~~134212~~)。","type":"string","required":false,"docRequired":false,"example":"123e4567-e89b-12d3-a456-42665544****"}},{"name":"TemplateFormat","in":"query","schema":{"description":"返回的模板格式，取值：\n- JSON（默认值）\n- YAML","type":"string","required":false,"docRequired":false,"example":"JSON"}},{"name":"LogicalResourceId","in":"query","style":"repeatList","schema":{"description":"资源名列表，用于过滤资源。修正模板时仅涉及列表中的资源。默认修正所有有偏差的资源。\n\n如果被修正的列表中包含偏差状态为DELETED的资源，为了确保修正后模板的正确性，可能会对列表之外但引用了被删除资源的资源进行调整。","type":"array","items":{"description":"资源名列表，用于过滤资源。修正模板时仅涉及列表中的资源。默认修正所有有偏差的资源。\n\n如果被修正的列表中包含偏差状态为DELETED的资源，为了确保修正后模板的正确性，可能会对列表之外但引用了被删除资源的资源进行调整。","type":"string","required":false,"example":"WebServer"},"required":false,"example":"Vpc","maxItems":200}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"B288A0BE-D927-4888-B0F7-B35EF84B6E6F"},"NewTemplateBody":{"description":"修正后的模板的内容。","type":"string","example":"{\\\"ROSTemplateFormatVersion\\\": \\\"2015-09-01\\\", \\\"Resources\\\": {\\\"Vpc\\\": {\\\"Type\\\": \\\"ALIYUN::ECS::VPC\\\", \\\"Properties\\\": {\\\"VpcName\\\": \\\"test\\\", \\\"CidrBlock\\\": \\\"192.168.0.0/16\\\", \\\"Description\\\": \\\"test2\\\"}}}, \\\"Outputs\\\": {\\\"VpcId\\\": {\\\"Value\\\": {\\\"Fn::GetAtt\\\": [\\\"Vpc\\\", \\\"VpcId\\\"]}}}}"},"OldTemplateBody":{"description":"修正前的模板的内容。","type":"string","example":"{\\\"ROSTemplateFormatVersion\\\": \\\"2015-09-01\\\", \\\"Resources\\\": {\\\"Vpc\\\": {\\\"Type\\\": \\\"ALIYUN::ECS::VPC\\\", \\\"Properties\\\": {\\\"VpcName\\\": \\\"test\\\", \\\"CidrBlock\\\": \\\"192.168.0.0/16\\\", \\\"Description\\\": \\\"test1\\\"}}}, \\\"Outputs\\\": {\\\"VpcId\\\": {\\\"Value\\\": {\\\"Fn::GetAtt\\\": [\\\"Vpc\\\", \\\"VpcId\\\"]}}}}"}}}}},"errorCodes":{},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"B288A0BE-D927-4888-B0F7-B35EF84B6E6F\\\",\\n  \\\"NewTemplateBody\\\": \\\"{\\\\\\\\\\\\\\\"ROSTemplateFormatVersion\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"2015-09-01\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"Resources\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Vpc\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Type\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"ALIYUN::ECS::VPC\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"Properties\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"VpcName\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"test\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"CidrBlock\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"192.168.0.0/16\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"Description\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"test2\\\\\\\\\\\\\\\"}}}, \\\\\\\\\\\\\\\"Outputs\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"VpcId\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Value\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Fn::GetAtt\\\\\\\\\\\\\\\": [\\\\\\\\\\\\\\\"Vpc\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"VpcId\\\\\\\\\\\\\\\"]}}}}\\\",\\n  \\\"OldTemplateBody\\\": \\\"{\\\\\\\\\\\\\\\"ROSTemplateFormatVersion\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"2015-09-01\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"Resources\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Vpc\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Type\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"ALIYUN::ECS::VPC\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"Properties\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"VpcName\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"test\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"CidrBlock\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"192.168.0.0/16\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"Description\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"test1\\\\\\\\\\\\\\\"}}}, \\\\\\\\\\\\\\\"Outputs\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"VpcId\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Value\\\\\\\\\\\\\\\": {\\\\\\\\\\\\\\\"Fn::GetAtt\\\\\\\\\\\\\\\": [\\\\\\\\\\\\\\\"Vpc\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"VpcId\\\\\\\\\\\\\\\"]}}}}\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<UpdateStackTemplateByResourcesResponse>\\n    <RequestId>B288A0BE-D927-4888-B0F7-B35EF84B6E6F</RequestId>\\n    <NewTemplateBody>{\\\"ROSTemplateFormatVersion\\\": \\\"2015-09-01\\\", \\\"Resources\\\": {\\\"Vpc\\\": {\\\"Type\\\": \\\"ALIYUN::ECS::VPC\\\", \\\"Properties\\\": {\\\"VpcName\\\": \\\"test\\\", \\\"CidrBlock\\\": \\\"192.168.0.0/16\\\", \\\"Description\\\": \\\"test2\\\"}}}, \\\"Outputs\\\": {\\\"VpcId\\\": {\\\"Value\\\": {\\\"Fn::GetAtt\\\": [\\\"Vpc\\\", \\\"VpcId\\\"]}}}}</NewTemplateBody>\\n    <OldTemplateBody>{\\\"ROSTemplateFormatVersion\\\": \\\"2015-09-01\\\", \\\"Resources\\\": {\\\"Vpc\\\": {\\\"Type\\\": \\\"ALIYUN::ECS::VPC\\\", \\\"Properties\\\": {\\\"VpcName\\\": \\\"test\\\", \\\"CidrBlock\\\": \\\"192.168.0.0/16\\\", \\\"Description\\\": \\\"test1\\\"}}}, \\\"Outputs\\\": {\\\"VpcId\\\": {\\\"Value\\\": {\\\"Fn::GetAtt\\\": [\\\"Vpc\\\", \\\"VpcId\\\"]}}}}</OldTemplateBody>\\n</UpdateStackTemplateByResourcesResponse>\",\"errorExample\":\"\"}]","title":"修正资源栈模板","summary":"通过执行偏差检测，消除资源栈的偏差。","description":"使用限制：只能对偏差状态（DRIFTED）的资源栈进行消除偏差。您需要先调用[DetectStackDrift](~~155094~~)接口对资源栈进行偏差检测，然后调用[GetStackDriftDetectionStatus](~~155097~~)接口查询资源栈偏差状态，确保资源栈处于偏差（DRIFTED）状态，最后调用UpdateStackTemplateByResources接口消除偏差。  \n\n本文将提供一个示例，为杭州地域资源栈ID为`4a6c9851-3b0f-4f5f-b4ca-a14bf691****`的资源栈消除偏差。\n","requestParamsDescription":" 关于公共请求参数的详情，请参见[公共参数](~~131957~~)。","responseParamsDescription":" ","extraInfo":"| HTTP| 错误码 | 错误信息 | 描述 |\n| ------------- | ------------- | ------------- | ------------- |\n| 400 | StackDriftDetectionNotAvailable |There is no complete drift detection for stack ({ID}). |资源栈没有成功完成过的偏差。ID为资源栈ID。|\n| 400 | StackAlreadyInSync |This is not need to correct stack drifts, stack ({ID}) is already in sync. |没有必要对资源栈模板进行修正，因为没有偏差。ID为资源栈ID。|\n| 400 | CorrectStackDriftsFailure |{reason} |无法对资源栈进行修正。reason为原因。 |\n| 404 | StackNotFound |The Stack ({name}) could not be found. |资源栈不存在。name为资源栈名称或ID。 |\n| 404 | ResourceNotFound|The Resource ({name}) could not be found in Stack {stack}. |资源栈中不存某资源。name为资源名，stack为资源栈名称或ID。|"}