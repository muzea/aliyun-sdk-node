{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"资源栈所属的地域ID。\n您可以调用[DescribeRegions](~~131035~~)查看最新的阿里云地域列表。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"StackId","in":"query","schema":{"description":"资源栈ID。","type":"string","required":false,"docRequired":false,"example":"4a6c9851-3b0f-4f5f-b4ca-a14bf691****\t"}},{"name":"OperationType","in":"query","schema":{"description":"需要检测的操作类型。\n取值：\n\n- DeleteStack：检测删除资源栈操作涉及的高风险资源。\n\n- CreateStack：创建资源栈操作可能出现的创建失败的风险，仅支持检测调用者可能缺失的权限。","type":"string","required":false,"docRequired":true,"example":"DeleteStack"}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求的幂等性。该值由客户端生成，并且必须是全局唯一的。 \n长度不超过64个字符，可包含英文字母、数字、短划线（-）和下划线（_）。 \n更多详情，请参见[如何保证幂等性](~~134212~~)。","type":"string","required":false,"docRequired":false,"example":"123e4567-e89b-12d3-a456-42665544****\t"}},{"name":"RamRoleName","in":"query","schema":{"description":"RAM角色名称。\n\n- 如果指定RAM角色，ROS将根据RAM角色的权限创建资源栈，使用角色的凭证代表用户进行接口调用。  \n\n- 如果不指定RAM角色，ROS将使用当前账号相关权限创建资源栈。\n\nRAM角色名称最大长度为64个字节。","type":"string","required":false,"example":"test-role"}},{"name":"RetainAllResources","in":"query","schema":{"description":"是否保留该资源栈下的所有资源。\n取值：  \n\n- true：保留。  \n\n- false（默认值）：不保留。  \n  \n\n> 当OperationType取值为DeleteStack时该参数有效。","type":"boolean","required":false,"docRequired":false,"example":"false"}},{"name":"RetainResources","in":"query","style":"repeatList","schema":{"description":"需要保留资源的列表。  \n> 当OperationType取值为DeleteStack时，该参数有效。","type":"array","items":{"description":"需要保留的资源。  ","type":"string","required":false,"example":"instance"},"required":false,"example":"WebServer","maxItems":200}},{"name":"TemplateBody","in":"formData","schema":{"description":"模板主体的结构。长度为1~524,288个字节。如果长度较长，则建议通过HTTP POST+Body Param的方式，将参数放在请求体中进行传递，避免因URL过长而导致请求失败。 \n> 您必须且仅能指定TemplateBody、TemplateURL、TemplateId或TemplateScratchId其中一个参数。","type":"string","required":false,"example":"{\"ROSTemplateFormatVersion\":\"2015-09-01\"}"}},{"name":"TemplateURL","in":"query","schema":{"description":"包含模板主体的文件的位置。URL必须指向位于Web服务器（HTTP或HTTPS）或阿里云OSS存储空间（例如：oss://ros/stack-policy/demo、oss://ros/stack-policy/demo?RegionId=cn-hangzhou）中的模板，模板的最大长度为524,288个字节。如未指定OSS地域，默认与RegionId取值相同。\n\n> 您必须且仅能指定TemplateBody、TemplateURL、TemplateId或TemplateScratchId其中一个参数。","type":"string","required":false,"example":"oss://ros-template/demo"}},{"name":"TemplateId","in":"query","schema":{"description":"模板ID。支持共享模板和私有模板。\n\n> 您必须且仅能指定TemplateBody、TemplateURL、TemplateId或TemplateScratchId其中一个参数。","type":"string","required":false,"example":"5ecd1e10-b0e9-4389-a565-e4c15efc****"}},{"name":"TemplateVersion","in":"query","schema":{"description":"模板版本。\n\n> 当您指定TemplateId时，本参数才生效。","type":"string","required":false,"example":"v1"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"72108E7A-E874-4A5E-B22C-A61E94AD12CD"},"RiskResources":{"description":"风险信息。","type":"array","items":{"type":"object","properties":{"LogicalResourceId":{"description":"资源逻辑ID，即模板定义的资源名称。","type":"string","example":"MySG"},"PhysicalResourceId":{"description":"资源物理ID，即实际的资源ID。","type":"string","example":"sg-bp1dpioafqphedg9****"},"RequestId":{"description":"对资源进行风险检测失败时的请求ID。\n\n> 当风险检测正常时，不返回该参数。","type":"string","example":"DF4296CF-F45F-4845-A72B-BE617601DB25"},"ResourceType":{"description":"资源类型。","type":"string","example":"ALIYUN::ECS::SecurityGroup"},"Code":{"description":"对资源进行风险检测失败时的错误码。\n\n> 当风险检测正常时，不返回该参数。","type":"string","example":"NoPermission"},"Message":{"description":"对资源进行风险检测失败时的错误信息。\n\n> 当风险检测正常时，不返回该参数。","type":"string","example":"You are not authorized to complete this action."},"RiskType":{"description":"风险类型。取值：\n- Referenced：当前资源被其他资源引用。\n- MaybeReferenced：当前资源可能被其他资源引用。\n- AdditionalRiskCheckRequired：嵌套资源栈需要额外进行风险检测。\n- OperationIgnored：当前操作对当前资源不生效。","type":"string","example":"Referenced"},"Reason":{"description":"风险原因。","type":"string","example":"There are some ECS instances (i-bp18el96s4wq635e****) depending on the security group."}}}},"MissingPolicyActions":{"description":"调用者所属账号缺少的资源操作列表。","type":"array","items":{"description":"调用者所属账号缺少的资源操作列表。","type":"string","example":"[\"ecs:DescribeInstance\", \"ros:CreateStack\"]"}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"72108E7A-E874-4A5E-B22C-A61E94AD12CD\\\",\\n  \\\"RiskResources\\\": [\\n    {\\n      \\\"LogicalResourceId\\\": \\\"MySG\\\",\\n      \\\"PhysicalResourceId\\\": \\\"sg-bp1dpioafqphedg9****\\\",\\n      \\\"RequestId\\\": \\\"DF4296CF-F45F-4845-A72B-BE617601DB25\\\",\\n      \\\"ResourceType\\\": \\\"ALIYUN::ECS::SecurityGroup\\\",\\n      \\\"Code\\\": \\\"NoPermission\\\",\\n      \\\"Message\\\": \\\"You are not authorized to complete this action.\\\",\\n      \\\"RiskType\\\": \\\"Referenced\\\",\\n      \\\"Reason\\\": \\\"There are some ECS instances (i-bp18el96s4wq635e****) depending on the security group.\\\"\\n    }\\n  ],\\n  \\\"MissingPolicyActions\\\": [\\n    \\\"[\\\\\\\"ecs:DescribeInstance\\\\\\\", \\\\\\\"ros:CreateStack\\\\\\\"]\\\"\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<ListStackOperationRisksResponse>\\n    <RequestId>72108E7A-E874-4A5E-B22C-A61E94AD12CD</RequestId>\\n    <RiskResources>\\n        <LogicalResourceId>MySG</LogicalResourceId>\\n        <PhysicalResourceId>sg-bp1dpioafqphedg9****</PhysicalResourceId>\\n        <RequestId>DF4296CF-F45F-4845-A72B-BE617601DB25</RequestId>\\n        <ResourceType>ALIYUN::ECS::SecurityGroup</ResourceType>\\n        <Code>NoPermission</Code>\\n        <Message>You are not authorized to complete this action.</Message>\\n        <RiskType>Referenced</RiskType>\\n        <Reason>There are some ECS instances (i-bp18el96s4wq635e****) depending on the security group.</Reason>\\n    </RiskResources>\\n    <MissingPolicyActions>[\\\"ecs:DescribeInstance\\\", \\\"ros:CreateStack\\\"]</MissingPolicyActions>\\n</ListStackOperationRisksResponse>\",\"errorExample\":\"\"}]","title":"检测资源栈操作可能涉及的风险及原因","summary":"检测进行资源栈操作可能涉及的风险，并返回风险原因或缺失项。","description":"本接口目前支持以下情况：\n\n- 删除资源栈操作可能涉及的高风险资源，并返回每个资源对应的风险原因。\n\n- 创建资源栈操作可能出现的创建失败的风险，仅支持检测调用者可能缺失的权限。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}