{"summary":"调用UpdateAutoThrottleRulesAsync接口，采用异步方式，批量设置指定数据库实例的自动SQL限流配置参数。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","systemTags":{"operationType":"none","riskType":"none","chargeType":"free"},"parameters":[{"name":"ConsoleContext","in":"query","schema":{"description":"备用参数。","type":"string","required":false,"example":"None"}},{"name":"InstanceIds","in":"query","schema":{"description":"数据库实例ID。\n\n> 数据格式为JSONArray，例如`['实例ID1','实例ID2']`，实例ID间用英文逗号（,）分隔。","type":"string","required":true,"example":"['rm-2ze8g2am97624****','rm-2ze9xrhze0709****']"}},{"name":"CpuUsage","in":"query","schema":{"description":"CPU利用率阈值，取值范围：70%~100%。","type":"number","format":"double","required":true,"example":"70"}},{"name":"CpuSessionRelation","in":"query","schema":{"title":"[AND | OR]","description":"CPU利用率阈值和活跃会话数阈值的逻辑关系。\n- **AND**：且。\n- **OR**：或。","type":"string","required":true,"enumValueTitles":{},"example":"OR"}},{"name":"ActiveSessions","in":"query","schema":{"description":"活跃会话数阈值。\t\n\n- 与CPU利用率阈值关系为**OR**（或）时，大于等于16。\n- 与CPU利用率阈值关系为**AND**（且）时，大于等于2。","type":"integer","format":"int64","required":true,"example":"16"}},{"name":"AbnormalDuration","in":"query","schema":{"description":"触发自动SQL限流的异常的持续时间阈值，取值范围：大于等于2的正整数，单位：分钟。\n","type":"number","format":"double","required":true,"example":"2"}},{"name":"MaxThrottleTime","in":"query","schema":{"description":"最大限流时长，取值为正整数，单位：分钟。","type":"number","format":"double","required":true,"example":"10"}},{"name":"AllowThrottleStartTime","in":"query","schema":{"description":"可限流时间段的开始时间（UTC时间）。","type":"string","required":true,"example":"00:00Z"}},{"name":"AllowThrottleEndTime","in":"query","schema":{"description":"可限流时间段的结束时间（UTC时间）。","type":"string","required":true,"example":"23:59Z"}},{"name":"AutoKillSession","in":"query","schema":{"description":"是否同时KILL执行中的异常SQL：\n> 异常SQL：与需要限流的SQL模板相同。\n\n- **true**：是。\n- **false**：否。","type":"boolean","required":true,"example":"true"}},{"name":"ResultId","in":"query","schema":{"description":"异步请求的ID。\n> 异步调用后不会立即返回完整结果，首先需要调用该接口获取**ResultId**，然后使用返回数据的**ResultId**，重新发起调用，直到**isFinish**取值为**true**时，返回完整结果。即获取一次完整数据，至少需要调用该接口两次。","type":"string","required":false,"example":"async__507044db6c4eadfa2dab9b084e80****"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"返回的状态码。","type":"integer","format":"int64","example":"200"},"Message":{"description":"请求返回消息。\n>请求成功时该参数返回**Successful**，请求失败时会返回请求异常信息（如错误码等）。","type":"string","example":"Successful"},"Data":{"description":"返回的数据。","type":"object","properties":{"Fail":{"description":"请求是否失败：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"false"},"ConfigResponse":{"description":"批量设置的返回数据。\n> 异步请求完成时（即isFinish取值为**true**时）才会返回该数据。","type":"object","properties":{"TotalInstanceCount":{"description":"总数据库实例数量。","type":"integer","format":"int64","example":"2"},"ConfigSuccessInstanceCount":{"description":"设置成功的数据库实例数量。","type":"integer","format":"int64","example":"1"},"ConfigFailInstanceCount":{"description":"设置失败的数据库实例数量。","type":"integer","format":"int64","example":"1"},"ConfigSuccessInstanceList":{"description":"设置成功的数据库实例列表。","type":"array","items":{"type":"object","properties":{"ConfigSuccess":{"description":"设置是否成功：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"true"},"InstanceId":{"description":"数据库实例ID。","type":"string","example":"rm-2ze8g2am97624****"}}}},"ConfigFailInstanceList":{"description":"设置失败的数据库实例列表。","type":"array","items":{"type":"object","properties":{"ConfigSuccess":{"description":"设置是否成功：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"false"},"InstanceId":{"description":"数据库实例ID。","type":"string","example":"rm-2ze9xrhze0709****"},"ErrorMessage":{"description":"错误信息。","type":"string","example":"instance das autonomy service is off or can not find instance"}}}}}},"ResultId":{"description":"异步请求ID。","type":"string","example":"async__665ee69612f1627c7fd9f3c85075****"},"IsFinish":{"description":"异步请求是否执行完成：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"true"},"State":{"description":"异步请求的执行状态：\n\n- **RUNNING**：正在运行。\n\n- **SUCCESS**：成功。\n\n- **FAIL**：失败。","type":"string","example":"SUCCESS"},"Complete":{"description":"异步请求是否执行完成：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"true"},"Timestamp":{"description":"执行时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1645668213000"}}},"RequestId":{"description":"请求ID。","type":"string","example":"B6D17591-B48B-4D31-9CD6-9B9796B2****"},"Success":{"description":"请求是否执行成功：\n\n- **true**：执行成功。\n- **false**：执行失败。","type":"boolean","example":"true"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParams","errorMessage":"The request parameters are invalid."}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to do this action."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Code\\\": 200,\\n  \\\"Message\\\": \\\"Successful\\\",\\n  \\\"Data\\\": {\\n    \\\"Fail\\\": false,\\n    \\\"ConfigResponse\\\": {\\n      \\\"TotalInstanceCount\\\": 2,\\n      \\\"ConfigSuccessInstanceCount\\\": 1,\\n      \\\"ConfigFailInstanceCount\\\": 1,\\n      \\\"ConfigSuccessInstanceList\\\": [\\n        {\\n          \\\"ConfigSuccess\\\": true,\\n          \\\"InstanceId\\\": \\\"rm-2ze8g2am97624****\\\"\\n        }\\n      ],\\n      \\\"ConfigFailInstanceList\\\": [\\n        {\\n          \\\"ConfigSuccess\\\": false,\\n          \\\"InstanceId\\\": \\\"rm-2ze9xrhze0709****\\\",\\n          \\\"ErrorMessage\\\": \\\"instance das autonomy service is off or can not find instance\\\"\\n        }\\n      ]\\n    },\\n    \\\"ResultId\\\": \\\"async__665ee69612f1627c7fd9f3c85075****\\\",\\n    \\\"IsFinish\\\": true,\\n    \\\"State\\\": \\\"SUCCESS\\\",\\n    \\\"Complete\\\": true,\\n    \\\"Timestamp\\\": 1645668213000\\n  },\\n  \\\"RequestId\\\": \\\"B6D17591-B48B-4D31-9CD6-9B9796B2****\\\",\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<UpdateAutoThrottleRulesAsyncResponse>\\n    <Code>200</Code>\\n    <Message>Successful</Message>\\n    <Data>\\n        <Fail>false</Fail>\\n        <ConfigResponse>\\n            <TotalInstanceCount>2</TotalInstanceCount>\\n            <ConfigSuccessInstanceCount>1</ConfigSuccessInstanceCount>\\n            <ConfigFailInstanceCount>1</ConfigFailInstanceCount>\\n            <ConfigSuccessInstanceList>\\n                <ConfigSuccess>true</ConfigSuccess>\\n                <InstanceId>rm-2ze8g2am97624****</InstanceId>\\n            </ConfigSuccessInstanceList>\\n            <ConfigFailInstanceList>\\n                <ConfigSuccess>false</ConfigSuccess>\\n                <InstanceId>rm-2ze9xrhze0709****</InstanceId>\\n                <ErrorMessage>instance das autonomy service is off or can not find instance</ErrorMessage>\\n            </ConfigFailInstanceList>\\n        </ConfigResponse>\\n        <ResultId>async__665ee69612f1627c7fd9f3c85075****</ResultId>\\n        <IsFinish>true</IsFinish>\\n        <State>SUCCESS</State>\\n        <Complete>true</Complete>\\n        <Timestamp>1645668213000</Timestamp>\\n    </Data>\\n    <RequestId>B6D17591-B48B-4D31-9CD6-9B9796B2****</RequestId>\\n    <Success>true</Success>\\n</UpdateAutoThrottleRulesAsyncResponse>\",\"errorExample\":\"\"}]","title":"设置自动SQL限流配置参数","description":"> 异步调用后不会立即返回完整结果，首先需要调用该接口获取**ResultId**，然后使用返回数据的**ResultId**，重新发起调用，直到**isFinish**取值为**true**时，返回完整结果。即获取一次完整数据，至少需要调用该接口两次。\n\n使用该接口需满足以下前提条件：\n- 在使用SDK调用DAS服务时，需要将地域指定为cn-shanghai。\n\n- 目标数据库实例已开启自治服务，详情请参见[自治中心](~~152139~~)。\n\n- 目标数据库实例为：\n    - RDS MySQL 5.6、5.7、 8.0高可用系列、三节点企业系列。\n    - PolarDB MySQL版 5.6集群版、5.7集群版、 8.0集群版、8.0高压缩引擎（X-Engine）。"}