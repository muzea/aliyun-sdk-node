{"summary":"调用GetPfsSqlSample接口，获取性能洞察（新版）功能的SQL样本数据。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"get","riskType":"none","chargeType":"free"},"parameters":[{"name":"InstanceId","in":"formData","schema":{"description":"实例ID。\n>仅支持RDS MySQL和PolarDB MySQL版数据库实例。","type":"string","required":true,"example":"rm-2ze1jdv45i7l6****"}},{"name":"NodeId","in":"formData","schema":{"description":"节点ID。\n\n> 对于RDS MySQL集群系列或PolarDB MySQL版数据库实例，需要提供节点ID。","type":"string","required":false,"example":"r-x****-db-0"}},{"name":"SqlId","in":"formData","schema":{"description":"SQL ID。","type":"string","required":false,"example":"651b56fe9418d48edb8fdf0980ec****"}},{"name":"StartTime","in":"formData","schema":{"description":"查询开始时间，格式为unix时间戳，单位为毫秒。","type":"integer","format":"int64","required":true,"example":"1676511134614"}},{"name":"EndTime","in":"formData","schema":{"description":"查询结束时间，格式为unix时间戳，单位为毫秒。\n\n> 查询结束时间需晚于查询开始时间，最多可查看最近一个月内任意七天的数据。","type":"integer","format":"int64","required":true,"example":"1678074351197"}}],"responses":{"200":{"schema":{"description":"返回数据。","type":"object","properties":{"Message":{"description":"请求返回消息。\n\n> 请求成功时该参数返回**Successful**，请求失败时会返回请求异常信息（如错误码等）。","type":"string","example":"Successful"},"RequestId":{"description":"请求ID。","type":"string","example":"9CB97BC4-6479-55D0-B9D0-EA925AFE****"},"Code":{"description":"返回状态码。","type":"integer","format":"int64","example":"200"},"Success":{"description":"请求是否执行成功：\n\n- **true**：执行成功。\n- **false**：执行失败。","type":"boolean","example":"true"},"Data":{"description":"返回的SQL样本数据。","type":"array","items":{"description":"返回数据。","type":"object","properties":{"UserId":{"description":"用户ID。","type":"string","example":"196278346919****"},"InstanceId":{"description":"实例ID。","type":"string","example":"rm-2ze1jdv45i7l6****"},"NodeId":{"description":"节点ID。\n\n> RDS MySQL集群系列或PolarDB MySQL版数据库实例才会返回该数据。","type":"string","example":"r-x****-db-0"},"LogicId":{"description":"逻辑库ID。","type":"string","example":"xxxxx"},"Timestamp":{"description":"执行SQL的时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1660100753556"},"SqlId":{"description":"SQL ID。","type":"string","example":"651b56fe9418d48edb8fdf0980ec****"},"Sql":{"description":"SQL样本。","type":"string","example":"select * from xxxx where ****"},"ThreadId":{"description":"线程ID。","type":"integer","format":"int32","example":"81751940"},"EventId":{"description":"事件ID。","type":"integer","format":"int32","example":"63735293"},"EndEventId":{"description":"该参数在事件开始时默认为NULL，在事件结束时更新为线程当前事件编号。","type":"integer","format":"int32","example":"0"},"EventName":{"description":"事件名称。","type":"string","example":"statement/sql/select"},"Latency":{"description":"执行耗时，单位为毫秒。","type":"number","format":"double","example":"0.199"},"LockLatency":{"description":"锁等待时间，单位为毫秒。","type":"number","format":"double","example":"0.09"},"Errors":{"description":"SQL语句错误数。","type":"integer","format":"int32","example":"0"},"Warnings":{"description":"SQL语句警告数。","type":"integer","format":"int32","example":"0"},"RowsAffected":{"description":"影响行数。","type":"integer","format":"int32","example":"0"},"RowsSent":{"description":"返回的SQL语句的当前行数。","type":"integer","format":"int32","example":"0"},"RowsExamined":{"description":"扫描行数。","type":"integer","format":"int32","example":"2048576"},"CreateTmpDiskTables":{"description":"执行语句时创建的磁盘上内部临时表的数量。","type":"integer","format":"int32","example":"0"},"CreateTmpTables":{"description":"执行语句时创建的内部临时表的数量。","type":"integer","format":"int32","example":"0"},"SelectFullJoin":{"description":"不使用索引而执行表扫描的连接数。\n><notice>该参数是用来统计联合查询过程中没有利用索引的情况，如果该参数值不为0，请仔细检查表的索引。\n></notice>","type":"integer","format":"int32","example":"0"},"SelectFullRangeJoin":{"description":"在引用表上使用范围搜索的连接数。","type":"integer","format":"int32","example":"0"},"SelectRange":{"description":"在第一个表中使用范围的连接数量。","type":"integer","format":"int32","example":"0"},"SelectRangeCheck":{"description":"在每一行数据后对键值进行检查，统计不带键值的连接的数量。\n><notice>该参数是用来统计联合查询过程中没有利用索引的情况，如果该参数值不为0，请仔细检查表的索引。\n></notice>","type":"integer","format":"int32","example":"0"},"SelectScan":{"description":"扫描数量。","type":"integer","format":"int32","example":"0"},"SortMergePasses":{"description":"排序算法必须执行的合并次数。","type":"integer","format":"int32","example":"0"},"SortRange":{"description":"使用范围进行排序的次数。","type":"integer","format":"int32","example":"0"},"SortRows":{"description":"排序行数。","type":"integer","format":"int32","example":"0"},"SortScan":{"description":"扫描排序次数。","type":"integer","format":"int32","example":"1"},"NoIndexUsed":{"description":"语句在不使用索引的情况下是否执行了表扫描：\n\n- **1**：是。\n- **0**：否。","type":"integer","format":"int32","example":"1"},"NoGoodIndexUsed":{"description":"服务器是否查找不到可用于该语句的索引：\n\n- **1**：是。\n- **0**：否。","type":"integer","format":"int32","example":"1"},"Db":{"description":"数据库名称。","type":"string","example":"testDB"}}}}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParams","errorMessage":"The request parameters are invalid."}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to do this action."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Message\\\": \\\"Successful\\\",\\n  \\\"RequestId\\\": \\\"9CB97BC4-6479-55D0-B9D0-EA925AFE****\\\",\\n  \\\"Code\\\": 200,\\n  \\\"Success\\\": true,\\n  \\\"Data\\\": [\\n    {\\n      \\\"UserId\\\": \\\"196278346919****\\\",\\n      \\\"InstanceId\\\": \\\"rm-2ze1jdv45i7l6****\\\",\\n      \\\"NodeId\\\": \\\"r-x****-db-0\\\",\\n      \\\"LogicId\\\": \\\"xxxxx\\\",\\n      \\\"Timestamp\\\": 1660100753556,\\n      \\\"SqlId\\\": \\\"651b56fe9418d48edb8fdf0980ec****\\\",\\n      \\\"Sql\\\": \\\"select * from xxxx where ****\\\",\\n      \\\"ThreadId\\\": 81751940,\\n      \\\"EventId\\\": 63735293,\\n      \\\"EndEventId\\\": 0,\\n      \\\"EventName\\\": \\\"statement/sql/select\\\",\\n      \\\"Latency\\\": 0.199,\\n      \\\"LockLatency\\\": 0.09,\\n      \\\"Errors\\\": 0,\\n      \\\"Warnings\\\": 0,\\n      \\\"RowsAffected\\\": 0,\\n      \\\"RowsSent\\\": 0,\\n      \\\"RowsExamined\\\": 2048576,\\n      \\\"CreateTmpDiskTables\\\": 0,\\n      \\\"CreateTmpTables\\\": 0,\\n      \\\"SelectFullJoin\\\": 0,\\n      \\\"SelectFullRangeJoin\\\": 0,\\n      \\\"SelectRange\\\": 0,\\n      \\\"SelectRangeCheck\\\": 0,\\n      \\\"SelectScan\\\": 0,\\n      \\\"SortMergePasses\\\": 0,\\n      \\\"SortRange\\\": 0,\\n      \\\"SortRows\\\": 0,\\n      \\\"SortScan\\\": 1,\\n      \\\"NoIndexUsed\\\": 1,\\n      \\\"NoGoodIndexUsed\\\": 1,\\n      \\\"Db\\\": \\\"testDB\\\"\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GetPfsSqlSampleResponse>\\n    <Message>Successful</Message>\\n    <RequestId>9CB97BC4-6479-55D0-B9D0-EA925AFE****</RequestId>\\n    <Code>200</Code>\\n    <Success>true</Success>\\n    <Data>\\n        <UserId>196278346919****</UserId>\\n        <InstanceId>rm-2ze1jdv45i7l6****</InstanceId>\\n        <NodeId>r-x****-db-0</NodeId>\\n        <LogicId>xxxxx</LogicId>\\n        <Timestamp>1660100753556</Timestamp>\\n        <SqlId>651b56fe9418d48edb8fdf0980ec****</SqlId>\\n        <Sql>select * from xxxx where ****</Sql>\\n        <ThreadId>81751940</ThreadId>\\n        <EventId>63735293</EventId>\\n        <EndEventId>0</EndEventId>\\n        <EventName>statement/sql/select</EventName>\\n        <Latency>0.199</Latency>\\n        <LockLatency>0.09</LockLatency>\\n        <Errors>0</Errors>\\n        <Warnings>0</Warnings>\\n        <RowsAffected>0</RowsAffected>\\n        <RowsSent>0</RowsSent>\\n        <RowsExamined>2048576</RowsExamined>\\n        <CreateTmpDiskTables>0</CreateTmpDiskTables>\\n        <CreateTmpTables>0</CreateTmpTables>\\n        <SelectFullJoin>0</SelectFullJoin>\\n        <SelectFullRangeJoin>0</SelectFullRangeJoin>\\n        <SelectRange>0</SelectRange>\\n        <SelectRangeCheck>0</SelectRangeCheck>\\n        <SelectScan>0</SelectScan>\\n        <SortMergePasses>0</SortMergePasses>\\n        <SortRange>0</SortRange>\\n        <SortRows>0</SortRows>\\n        <SortScan>1</SortScan>\\n        <NoIndexUsed>1</NoIndexUsed>\\n        <NoGoodIndexUsed>1</NoGoodIndexUsed>\\n        <Db>testDB</Db>\\n    </Data>\\n</GetPfsSqlSampleResponse>\",\"errorExample\":\"\"}]","title":"获取SQL样本数据","description":"使用该接口需满足以下前提条件：\n\n- 使用阿里云或DAS的SDK时，建议使用最新版本。\n- 在使用SDK调用DAS服务时，需要将地域指定为cn-shanghai。\n- 目标数据库实例为RDS MySQL或PolarDB MySQL版。\n- 目标数据库实例已开启性能洞察（新版），详情请参见[性能洞察（新版）](~~469117~~)。"}