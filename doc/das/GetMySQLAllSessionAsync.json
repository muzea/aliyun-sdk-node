{"summary":"调用GetMySQLAllSessionAsync接口，采用异步方式获取实例当前会话数据，并按照不同维度统计会话信息。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"InstanceId","in":"query","schema":{"description":"实例ID。\n>仅支持RDS MySQL、PolarDB MySQL版和PolarDB-X 2.0实例。","type":"string","required":true,"example":"rm-2ze8g2am97624****\n"}},{"name":"NodeId","in":"query","schema":{"description":"节点ID。\n\n> 对于PolarDB MySQL版实例，需要提供节点ID。不指定节点ID时，默认返回主节点的会话数据。","type":"string","required":false,"example":"pi-wz954ryd8f893****"}},{"name":"ResultId","in":"query","schema":{"description":"异步请求的ID。\n> 异步调用方式不会立即返回完整结果，首先需要调用该接口获取**ResultId**，然后使用返回数据的**ResultId**，重新发起调用，直到**isFinish**取值为**true**时，返回完整结果。即获取一次完整数据，至少需要调用该接口两次。","type":"string","required":false,"example":"async__507044db6c4eadfa2dab9b084e80****"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"返回的状态码。","type":"integer","format":"int64","example":"200"},"Message":{"description":"请求返回消息。\n\n> 请求成功时该参数返回**Successful**，请求失败时会返回请求异常信息（如错误码等）","type":"string","example":"Successful"},"Data":{"description":"返回的数据。","type":"object","properties":{"Fail":{"description":"请求是否失败：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"false"},"SessionData":{"description":"会话数据。","type":"object","properties":{"TotalSessionCount":{"description":"会话总数。","type":"integer","format":"int64","example":"988"},"ActiveSessionCount":{"description":"运行中会话总数。","type":"integer","format":"int64","example":"10"},"MaxActiveTime":{"description":"运行中会话执行的最长时间，单位为秒（s）。","type":"integer","format":"int64","example":"6"},"SessionList":{"description":"会话列表。","type":"array","items":{"description":"会话。","type":"object","properties":{"SessionId":{"description":"会话ID。","type":"integer","format":"int64","example":"14521783"},"User":{"description":"数据库用户名。","type":"string","example":"testUser"},"Client":{"description":"客户端IP地址。","type":"string","example":"47.100.XX.XX"},"DbName":{"description":"数据库名。","type":"string","example":"dbTest"},"Command":{"description":"会话执行的命令类型。","type":"string","example":"Query"},"Time":{"description":"会话执行时间，单位为秒（s）。","type":"integer","format":"int64","example":"6"},"State":{"description":"会话状态。","type":"string","example":"starting"},"SqlText":{"description":"会话执行的SQL语句。","type":"string","example":"INSERT INTO ..."},"UserClientAlias":{"description":"客户端IP别名。","type":"string","example":"master-shanghai"},"TrxId":{"description":"会话所在事务ID。","type":"string","example":"754300775132"},"TrxDuration":{"description":"事务持续时间，单位为秒（s）。","type":"integer","format":"int64","example":"6"},"SqlTemplateId":{"description":"SQL模板ID。\n\n> 仅PolarDB-X 2.0实例返回该字段。","type":"string","example":"a7cac1a9"}}}},"UserStats":{"description":"按数据库账号统计会话。","type":"array","items":{"type":"object","properties":{"Key":{"description":"数据库账号名。","type":"string","example":"testUser"},"TotalCount":{"description":"该账号会话总数。","type":"integer","format":"int64","example":"2"},"ActiveCount":{"description":"该账号活跃会话数。\n\n> 活跃会话判断逻辑： 命令是Query或者Execute，以及未结束事务中的会话。","type":"integer","format":"int64","example":"1"},"ThreadIdList":{"description":"该账号对应的会话ID列表。","type":"array","items":{"description":"会话ID列表。","type":"integer","format":"int64","example":"[14525727,14526269]"}},"UserList":{"description":"会话对应的账号列表。","type":"array","items":{"description":"数据库账号。","type":"string","example":"['testUser']"}}}}},"ClientStats":{"description":"按客户端IP统计会话。","type":"array","items":{"type":"object","properties":{"Key":{"description":"客户端IP地址。","type":"string","example":"47.100.XX.XX"},"TotalCount":{"description":"该客户端IP地址下的会话总数。","type":"integer","format":"int64","example":"2"},"ActiveCount":{"description":"该客户端IP地址下的活跃会话数。\n\n> 活跃会话判断逻辑： 命令是Query或者Execute，以及未结束事务中的会话。","type":"integer","format":"int64","example":"1"},"ThreadIdList":{"description":"该客户端IP对应的会话ID列表。","type":"array","items":{"description":"会话ID列表。","type":"integer","format":"int64","example":"[14526018,14525956]"}},"UserList":{"description":"会话对应的账号列表。","type":"array","items":{"description":"数据库账号。","type":"string","example":"['testUser']"}}}}},"DbStats":{"description":"按数据库统计会话。","type":"array","items":{"type":"object","properties":{"Key":{"description":"数据库名。","type":"string","example":"dbTest"},"TotalCount":{"description":"该数据库会话总数。","type":"integer","format":"int64","example":"2"},"ActiveCount":{"description":"该数据库活跃会话数。\n\n> 活跃会话判断逻辑： 命令是Query或者Execute，以及未结束事务中的会话。","type":"integer","format":"int64","example":"1"},"ThreadIdList":{"description":"该数据库名对应的会话ID列表。","type":"array","items":{"description":"会话ID列表。","type":"integer","format":"int64","example":"[14525727,14526269]"}},"UserList":{"description":"会话对应的账号列表。","type":"array","items":{"description":"数据库账号。","type":"string","example":"['testUser']"}}}}},"TimeStamp":{"description":"获取会话的时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1659581514000020"}}},"ResultId":{"description":"异步请求ID。","type":"string","example":"async__507044db6c4eadfa2dab9b084e80****"},"IsFinish":{"description":"异步请求是否执行完成：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"true"},"State":{"description":"异步请求的执行状态：\n\n- **RUNNING**：正在运行。\n\n- **SUCCESS**：成功。\n\n- **FAIL**：失败。","type":"string","example":"SUCCESS"},"Complete":{"description":"异步请求是否执行完成：\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"true"},"Timestamp":{"description":"执行时间，格式为Unix时间戳，单位为毫秒（ms）。","type":"integer","format":"int64","example":"1660100753556"}}},"RequestId":{"description":"请求ID。","type":"string","example":"B6D17591-B48B-4D31-9CD6-9B9796B2****"},"Success":{"description":"请求是否执行成功：\n\n- **true**：执行成功。\n- **false**：执行失败。","type":"boolean","example":"true"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParams","errorMessage":"The request parameters are invalid."}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to do this action."}]},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Code\\\": 200,\\n  \\\"Message\\\": \\\"Successful\\\",\\n  \\\"Data\\\": {\\n    \\\"Fail\\\": false,\\n    \\\"SessionData\\\": {\\n      \\\"TotalSessionCount\\\": 988,\\n      \\\"ActiveSessionCount\\\": 10,\\n      \\\"MaxActiveTime\\\": 6,\\n      \\\"SessionList\\\": [\\n        {\\n          \\\"SessionId\\\": 14521783,\\n          \\\"User\\\": \\\"testUser\\\",\\n          \\\"Client\\\": \\\"47.100.XX.XX\\\",\\n          \\\"DbName\\\": \\\"dbTest\\\",\\n          \\\"Command\\\": \\\"Query\\\",\\n          \\\"Time\\\": 6,\\n          \\\"State\\\": \\\"starting\\\",\\n          \\\"SqlText\\\": \\\"INSERT INTO ...\\\",\\n          \\\"UserClientAlias\\\": \\\"master-shanghai\\\",\\n          \\\"TrxId\\\": \\\"754300775132\\\",\\n          \\\"TrxDuration\\\": 6,\\n          \\\"SqlTemplateId\\\": \\\"a7cac1a9\\\"\\n        }\\n      ],\\n      \\\"UserStats\\\": [\\n        {\\n          \\\"Key\\\": \\\"testUser\\\",\\n          \\\"TotalCount\\\": 2,\\n          \\\"ActiveCount\\\": 1,\\n          \\\"ThreadIdList\\\": [\\n            0\\n          ],\\n          \\\"UserList\\\": [\\n            \\\"['testUser']\\\"\\n          ]\\n        }\\n      ],\\n      \\\"ClientStats\\\": [\\n        {\\n          \\\"Key\\\": \\\"47.100.XX.XX\\\",\\n          \\\"TotalCount\\\": 2,\\n          \\\"ActiveCount\\\": 1,\\n          \\\"ThreadIdList\\\": [\\n            0\\n          ],\\n          \\\"UserList\\\": [\\n            \\\"['testUser']\\\"\\n          ]\\n        }\\n      ],\\n      \\\"DbStats\\\": [\\n        {\\n          \\\"Key\\\": \\\"dbTest\\\",\\n          \\\"TotalCount\\\": 2,\\n          \\\"ActiveCount\\\": 1,\\n          \\\"ThreadIdList\\\": [\\n            0\\n          ],\\n          \\\"UserList\\\": [\\n            \\\"['testUser']\\\"\\n          ]\\n        }\\n      ],\\n      \\\"TimeStamp\\\": 1659581514000020\\n    },\\n    \\\"ResultId\\\": \\\"async__507044db6c4eadfa2dab9b084e80****\\\",\\n    \\\"IsFinish\\\": true,\\n    \\\"State\\\": \\\"SUCCESS\\\",\\n    \\\"Complete\\\": true,\\n    \\\"Timestamp\\\": 1660100753556\\n  },\\n  \\\"RequestId\\\": \\\"B6D17591-B48B-4D31-9CD6-9B9796B2****\\\",\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GetMySQLAllSessionAsyncResponse>\\n    <Code>200</Code>\\n    <Message>Successful</Message>\\n    <Data>\\n        <Fail>false</Fail>\\n        <SessionData>\\n            <TotalSessionCount>988</TotalSessionCount>\\n            <ActiveSessionCount>10</ActiveSessionCount>\\n            <MaxActiveTime>6</MaxActiveTime>\\n            <SessionList>\\n                <SessionId>14521783</SessionId>\\n                <User>testUser</User>\\n                <Client>47.100.XX.XX</Client>\\n                <DbName>dbTest</DbName>\\n                <Command>Query</Command>\\n                <Time>6</Time>\\n                <State>starting</State>\\n                <SqlText>INSERT INTO ...</SqlText>\\n                <UserClientAlias>master-shanghai</UserClientAlias>\\n                <TrxId>754300775132</TrxId>\\n                <TrxDuration>6</TrxDuration>\\n            </SessionList>\\n            <UserStats>\\n                <Key>testUser</Key>\\n                <TotalCount>984</TotalCount>\\n                <ActiveCount>11</ActiveCount>\\n                <UserList>['testUser']</UserList>\\n            </UserStats>\\n            <ClientStats>\\n                <Key>47.100.XX.XX</Key>\\n                <TotalCount>50</TotalCount>\\n                <ActiveCount>3</ActiveCount>\\n                <UserList>['testUser']</UserList>\\n            </ClientStats>\\n            <DbStats>\\n                <Key>dbTest</Key>\\n                <TotalCount>60</TotalCount>\\n                <ActiveCount>5</ActiveCount>\\n                <UserList>['testUser']</UserList>\\n            </DbStats>\\n            <TimeStamp>1659581514000020</TimeStamp>\\n        </SessionData>\\n        <ResultId>async__507044db6c4eadfa2dab9b084e80****</ResultId>\\n        <IsFinish>true</IsFinish>\\n        <State>SUCCESS</State>\\n        <Complete>true</Complete>\\n        <Timestamp>1660100753556</Timestamp>\\n    </Data>\\n    <RequestId>B6D17591-B48B-4D31-9CD6-9B9796B2****</RequestId>\\n    <Success>true</Success>\\n</GetMySQLAllSessionAsyncResponse>\",\"errorExample\":\"\"}]","title":"获取实例当前会话","description":"> 异步调用方式不会立即返回完整结果，首先需要调用该接口获取ResultId，然后使用返回数据的ResultId，重新发起调用，直到**isFinish**取值为**true**时，返回完整结果。即获取一次完整数据，至少需要调用该接口两次。\n\n- 本接口只适用于RDS MySQL，PolarDB MySQL版和PolarDB-X 2.0实例。\n\n- 使用阿里云或DAS的SDK时，建议使用最新版本。\n\n- 在使用SDK调用DAS服务时，需要将地域指定为cn-shanghai。"}