{"summary":"调用GetPfsSqlSummaries接口，查询数据库实例性能洞察（新版）中按照SQL ID维度的全量请求数据。","methods":["post","get"],"schemes":["https","http"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"InstanceId","in":"formData","schema":{"description":"实例ID。","type":"string","required":false,"example":"rm-uf61swc4cru0b****"}},{"name":"NodeId","in":"formData","schema":{"description":"节点ID。\n\n> 对于RDS MySQL集群系列或PolarDB MySQL版数据库实例，需要提供节点ID。","type":"string","required":false,"example":"r-****-db-0"}},{"name":"SqlId","in":"formData","schema":{"description":"SQL ID。\n\n> 传入SQL ID时，统计目标SQL ID的全量请求数据；为空时，统计整个数据库实例的全量请求数据。","type":"string","required":false,"example":"651b56fe9418d48edb8fdf0980ec****"}},{"name":"Keywords","in":"formData","schema":{"description":"SQL文本关键词，多个关键词以空格分隔。","type":"string","required":false,"example":"select update"}},{"name":"StartTime","in":"formData","schema":{"description":"查询开始时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","required":false,"example":"1675833788056"}},{"name":"EndTime","in":"formData","schema":{"description":"查询结束时间，格式为Unix时间戳，单位为毫秒。\n> 查询结束时间需晚于查询开始时间，最多可查看最近一个月内任意七天的数据。","type":"integer","format":"int64","required":false,"example":"1679297005999"}},{"name":"OrderBy","in":"formData","schema":{"description":"排序字段，默认为**count**。\n\n- **count**：执行次数。\n\n- **avgRt**：平均执行时间。\n\n- **rtRate**：耗时比例。\n\n- **rowsExamined**：总扫描行数。\n\n- **avgRowsExamined**：平均扫描行数。\n\n- **avgRowsReturned**：平均返回行数。","type":"string","required":false,"example":"count"}},{"name":"Asc","in":"formData","schema":{"description":"是否升序排序，默认为**false**。\n\n- **true**：是。\n- **false**：否。","type":"boolean","required":false,"example":"false"}},{"name":"PageNo","in":"formData","schema":{"description":"分页查询的页码，从1开始，默认为1。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"PageSize","in":"formData","schema":{"description":"分页查询每页最大记录数，默认为10，最大为100。","type":"integer","format":"int32","required":false,"example":"10"}}],"responses":{"200":{"schema":{"title":"ListResult<PfsSqlSummary>","description":"ListResult<PfsSqlSummary>","type":"object","properties":{"Message":{"description":"请求返回消息。\n>请求成功时该参数返回**Successful**，请求失败时会返回请求异常信息（如错误码等）。","type":"string","example":"Successful"},"RequestId":{"description":"请求ID。","type":"string","example":"54F3DBAE-9420-511A-9C29-265E8C04****"},"Data":{"description":"返回数据。","type":"object","properties":{"Total":{"description":"总数据量。","type":"integer","format":"int64","example":"264"},"List":{"description":"详细信息列表。","type":"array","items":{"description":"返回信息列表。","type":"object","properties":{"UserId":{"description":"用户ID。","type":"string","example":"196278346919****"},"Psql":{"description":"SQL模板。","type":"string","example":"select ?"},"InstanceId":{"description":"实例ID。","type":"string","example":"rm-2ze8g2am97624****"},"NodeId":{"description":"节点ID。\n> 对于RDS MySQL集群系列或PolarDB MySQL版数据库实例，返回此参数。","type":"string","example":"r-x****-db-0"},"SqlType":{"description":"SQL的类型。取值：\n- **SELECT**\n- **UPDATE**\n- **DELETE**","type":"string","example":"SELECT"},"LogicId":{"description":"逻辑库ID。","type":"integer","format":"int64","example":"58275984"},"SqlId":{"description":"SQL模板ID。","type":"string","example":"2e8147b5ca2dfc640dfd5e43d96a****"},"Timestamp":{"description":"数据日期，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1643040000000"},"RtRate":{"title":"耗时占比","description":"耗时占比。","type":"number","format":"double","example":"0.1384"},"CountRate":{"title":"执行次数占比","description":"执行次数占比。","type":"number","format":"double","example":"0.0586"},"FullScan":{"description":"是否全表扫描。取值：\n\n- **true**：是。\n- **false**：否。","type":"boolean","example":"true"},"Count":{"description":"总执行次数。","type":"integer","format":"int64","example":"100000"},"ErrCount":{"description":"错误次数。","type":"integer","format":"int64","example":"0"},"WarnCount":{"description":"警告次数。","type":"integer","format":"int64","example":"0"},"TotalLatency":{"description":"总执行耗时，单位毫秒。","type":"number","format":"double","example":"60913.256"},"MaxLatency":{"description":"最大执行耗时，单位毫秒。","type":"number","format":"double","example":"36.233"},"AvgLatency":{"description":"SQL平均执行耗时，单位毫秒。","type":"number","format":"double","example":"0.1717"},"RowsSent":{"description":"返回行数。","type":"integer","format":"int64","example":"0"},"RowsSendAvg":{"description":"平均发送行数。","type":"number","format":"double","example":"0"},"RowsExamined":{"description":"总扫描行数。","type":"integer","format":"int64","example":"100"},"RowsExaminedAvg":{"description":"平均扫描行数。","type":"number","format":"double","example":"0"},"RowsAffected":{"description":"影响行数。","type":"integer","format":"int64","example":"0"},"RowsAffectedAvg":{"description":"平均影响行数。","type":"number","format":"double","example":"0"},"TmpTables":{"description":"临时表数量。","type":"integer","format":"int64","example":"0"},"TmpDiskTables":{"description":"临时磁盘表数量。","type":"integer","format":"int64","example":"0"},"RowsSorted":{"description":"排序行数。","type":"integer","format":"int64","example":"0"},"SortMergePasses":{"description":"排序算法必须执行的合并次数。","type":"integer","format":"int64","example":"0"},"PhysicalReads":{"description":"物理节点数量。","type":"integer","format":"int64","example":"0"},"PhysicalAsyncReads":{"description":"物理异步节点数量。","type":"integer","format":"int64","example":"0"},"SemisyncDelayTime":{"description":"半同步延迟时间，单位毫秒。","type":"number","format":"double","example":"0.12"},"RowsSentAvg":{"description":"返回SQL句的平均行数。","type":"number","format":"double","example":"0.52"},"LogicReads":{"description":"逻辑节点数。","type":"integer","format":"int64","example":"0"},"RedoWrites":{"description":"重做节点数。","type":"integer","format":"int64","example":"0"},"DataWriteTime":{"description":"数据写入时间，单位毫秒。","type":"number","format":"double","example":"0"},"DataWrites":{"description":"可写数据节点数量。","type":"integer","format":"int32","example":"0"},"DataReadTime":{"description":"可读数据时间，单位毫秒。","type":"number","format":"double","example":"0"},"DataReads":{"description":"可读数据节点数量。","type":"integer","format":"int32","example":"0"},"RwlockOsWaits":{"description":"是否开启了读写分离。取值：\n\n- **0**：未开启。\n- **1**：开启。","type":"integer","format":"int32","example":"0"},"RwlockSpinRounds":{"description":"读写分离参数。","type":"integer","format":"int32","example":"0"},"RwlockSpinWaits":{"description":"是否开启多重索引扫描。取值：\n\n- **0**：未开启。\n- **1**：开启。","type":"integer","format":"int32","example":"0"},"MutexWaits":{"description":"互斥等待次数。","type":"integer","format":"int32","example":"1"},"MutexSpins":{"description":"互斥旋转次数。","type":"integer","format":"int32","example":"1"},"TransactionLockTime":{"description":"存储事务锁定时间，单位毫秒。","type":"number","format":"double","example":"0"},"ServerLockTime":{"description":"服务器锁定时间，单位毫秒。","type":"number","format":"double","example":"0"},"CpuTime":{"description":"CPU运行时间，单位为毫秒。","type":"number","format":"double","example":"0"},"ElapsedTime":{"description":"实际运行时间，单位毫秒。","type":"number","format":"double","example":"0"},"Id":{"title":"主键","description":"主键ID。","type":"integer","format":"int64","example":"26186357"},"SelectScanAvg":{"description":"平均扫描数。","type":"number","format":"double","example":"0"},"SelectRangeAvg":{"description":"平均选取范围。","type":"number","format":"double","example":"0"},"SelectFullJoinAvg":{"description":"不使用索引而执行表扫描的平均连接数。\n><notice>如果该参数值不为0，则应仔细检查表的索引。\n></notice>","type":"number","format":"double","example":"0"},"SelectFullRangeJoinAvg":{"description":"平均范围连接数。","type":"number","format":"double","example":"0"},"SortScanAvg":{"description":"平均扫描排序数。","type":"number","format":"double","example":"0"},"SortRowsAvg":{"description":"平均排序行数。","type":"number","format":"double","example":"0"},"TmpTablesAvg":{"description":"临时表平均数。","type":"number","format":"double","example":"0"},"TmpDiskTablesAvg":{"description":"临时磁盘表平均数。","type":"number","format":"double","example":"0"},"FirstTime":{"description":"首次执行时间，格式为unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1659308149000"},"LastTime":{"description":"最后变更时间，格式为unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1661306520000"},"LockLatencyAvg":{"description":"平均锁等待时间，单位毫秒。","type":"number","format":"double","example":"0"},"TimerWaitAvg":{"description":"备用参数。","type":"number","format":"double","example":"None"},"SortRangeAvg":{"description":"使用范围排序平均次数。","type":"number","format":"double","example":"0"},"CpuRate":{"description":"CPU执行时间与SQL总执行时间的比值。","type":"number","format":"double","example":"0"},"Db":{"description":"数据库名称。","type":"string","example":"testDB"},"Tables":{"description":"数据库表名。\n","type":"array","items":{"description":"数据库表名。\n","type":"string","example":"test_table"}}}}},"PageNo":{"description":"页码。","type":"integer","format":"int64","example":"1"},"PageSize":{"description":"每页最大记录数。","type":"integer","format":"int64","example":"10"},"Extra":{"description":"备用参数。","type":"any","example":"None"}}},"Code":{"description":"返回状态码。","type":"integer","format":"int64","example":"200"},"Success":{"description":"请求是否执行成功：\n\n- **true**：执行成功。\n- **false**：执行失败。","type":"boolean","example":"true"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParams","errorMessage":"The request parameters are invalid."}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to do this action."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Message\\\": \\\"Successful\\\",\\n  \\\"RequestId\\\": \\\"54F3DBAE-9420-511A-9C29-265E8C04****\\\",\\n  \\\"Data\\\": {\\n    \\\"Total\\\": 264,\\n    \\\"List\\\": [\\n      {\\n        \\\"UserId\\\": \\\"196278346919****\\\",\\n        \\\"Psql\\\": \\\"select ?\\\",\\n        \\\"InstanceId\\\": \\\"rm-2ze8g2am97624****\\\",\\n        \\\"NodeId\\\": \\\"r-x****-db-0\\\",\\n        \\\"SqlType\\\": \\\"SELECT\\\",\\n        \\\"LogicId\\\": 58275984,\\n        \\\"SqlId\\\": \\\"2e8147b5ca2dfc640dfd5e43d96a****\\\",\\n        \\\"Timestamp\\\": 1643040000000,\\n        \\\"RtRate\\\": 0.1384,\\n        \\\"CountRate\\\": 0.0586,\\n        \\\"FullScan\\\": true,\\n        \\\"Count\\\": 100000,\\n        \\\"ErrCount\\\": 0,\\n        \\\"WarnCount\\\": 0,\\n        \\\"TotalLatency\\\": 60913.256,\\n        \\\"MaxLatency\\\": 36.233,\\n        \\\"AvgLatency\\\": 0.1717,\\n        \\\"RowsSent\\\": 0,\\n        \\\"RowsSendAvg\\\": 0,\\n        \\\"RowsExamined\\\": 100,\\n        \\\"RowsExaminedAvg\\\": 0,\\n        \\\"RowsAffected\\\": 0,\\n        \\\"RowsAffectedAvg\\\": 0,\\n        \\\"TmpTables\\\": 0,\\n        \\\"TmpDiskTables\\\": 0,\\n        \\\"RowsSorted\\\": 0,\\n        \\\"SortMergePasses\\\": 0,\\n        \\\"PhysicalReads\\\": 0,\\n        \\\"PhysicalAsyncReads\\\": 0,\\n        \\\"SemisyncDelayTime\\\": 0.12,\\n        \\\"RowsSentAvg\\\": 0.52,\\n        \\\"LogicReads\\\": 0,\\n        \\\"RedoWrites\\\": 0,\\n        \\\"DataWriteTime\\\": 0,\\n        \\\"DataWrites\\\": 0,\\n        \\\"DataReadTime\\\": 0,\\n        \\\"DataReads\\\": 0,\\n        \\\"RwlockOsWaits\\\": 0,\\n        \\\"RwlockSpinRounds\\\": 0,\\n        \\\"RwlockSpinWaits\\\": 0,\\n        \\\"MutexWaits\\\": 1,\\n        \\\"MutexSpins\\\": 1,\\n        \\\"TransactionLockTime\\\": 0,\\n        \\\"ServerLockTime\\\": 0,\\n        \\\"CpuTime\\\": 0,\\n        \\\"ElapsedTime\\\": 0,\\n        \\\"Id\\\": 26186357,\\n        \\\"SelectScanAvg\\\": 0,\\n        \\\"SelectRangeAvg\\\": 0,\\n        \\\"SelectFullJoinAvg\\\": 0,\\n        \\\"SelectFullRangeJoinAvg\\\": 0,\\n        \\\"SortScanAvg\\\": 0,\\n        \\\"SortRowsAvg\\\": 0,\\n        \\\"TmpTablesAvg\\\": 0,\\n        \\\"TmpDiskTablesAvg\\\": 0,\\n        \\\"FirstTime\\\": 1659308149000,\\n        \\\"LastTime\\\": 1661306520000,\\n        \\\"LockLatencyAvg\\\": 0,\\n        \\\"TimerWaitAvg\\\": 0,\\n        \\\"SortRangeAvg\\\": 0,\\n        \\\"CpuRate\\\": 0,\\n        \\\"Db\\\": \\\"testDB\\\",\\n        \\\"Tables\\\": [\\n          \\\"test_table\\\"\\n        ]\\n      }\\n    ],\\n    \\\"PageNo\\\": 1,\\n    \\\"PageSize\\\": 10,\\n    \\\"Extra\\\": \\\"None\\\"\\n  },\\n  \\\"Code\\\": 200,\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GetPfsSqlSummariesResponse>\\n    <Message>Successful</Message>\\n    <RequestId>54F3DBAE-9420-511A-9C29-265E8C04****</RequestId>\\n    <Data>\\n        <Total>264</Total>\\n        <List>\\n            <UserId>196278346919****</UserId>\\n            <Psql>select ?</Psql>\\n            <SqlFeature>None</SqlFeature>\\n            <InstanceId>rm-2ze8g2am97624****</InstanceId>\\n            <NodeId>r-x****-db-0</NodeId>\\n            <SqlType>SELECT</SqlType>\\n            <LogicId>58275984</LogicId>\\n            <SqlId>2e8147b5ca2dfc640dfd5e43d96a****</SqlId>\\n            <Timestamp>1643040000000</Timestamp>\\n            <RtRate>0.1384</RtRate>\\n            <CountRate>0.0586</CountRate>\\n            <FullScan>true</FullScan>\\n            <Count>100000</Count>\\n            <ErrCount>0</ErrCount>\\n            <WarnCount>0</WarnCount>\\n            <TotalLatency>60913.256</TotalLatency>\\n            <MaxLatency>36.233</MaxLatency>\\n            <AvgLatency>0.1717</AvgLatency>\\n            <RowsSent>0</RowsSent>\\n            <RowsSendAvg>0</RowsSendAvg>\\n            <RowsExamined>100</RowsExamined>\\n            <RowsExaminedAvg>0</RowsExaminedAvg>\\n            <RowsAffected>0</RowsAffected>\\n            <RowsAffectedAvg>0</RowsAffectedAvg>\\n            <TmpTables>0</TmpTables>\\n            <TmpDiskTables>0</TmpDiskTables>\\n            <RowsSorted>0</RowsSorted>\\n            <SortMergePasses>0</SortMergePasses>\\n            <PhysicalReads>0</PhysicalReads>\\n            <PhysicalAsyncReads>0</PhysicalAsyncReads>\\n            <SemisyncDelayTime>0.12</SemisyncDelayTime>\\n            <RowsSentAvg>0.52</RowsSentAvg>\\n            <LogicReads>0</LogicReads>\\n            <RedoWrites>0</RedoWrites>\\n            <DataWriteTime>0</DataWriteTime>\\n            <DataWrites>0</DataWrites>\\n            <DataReadTime>0</DataReadTime>\\n            <DataReads>0</DataReads>\\n            <RwlockOsWaits>0</RwlockOsWaits>\\n            <RwlockSpinRounds>0</RwlockSpinRounds>\\n            <RwlockSpinWaits>0</RwlockSpinWaits>\\n            <MutexWaits>1</MutexWaits>\\n            <MutexSpins>1</MutexSpins>\\n            <TransactionLockTime>0</TransactionLockTime>\\n            <ServerLockTime>0</ServerLockTime>\\n            <CpuTime>0</CpuTime>\\n            <ElapsedTime>0</ElapsedTime>\\n            <Id>26186357</Id>\\n            <SelectScanAvg>0</SelectScanAvg>\\n            <SelectRangeAvg>0</SelectRangeAvg>\\n            <SelectFullJoinAvg>0</SelectFullJoinAvg>\\n            <SelectFullRangeJoinAvg>0</SelectFullRangeJoinAvg>\\n            <SortScanAvg>0</SortScanAvg>\\n            <SortRowsAvg>0</SortRowsAvg>\\n            <TmpTablesAvg>0</TmpTablesAvg>\\n            <TmpDiskTablesAvg>0</TmpDiskTablesAvg>\\n            <FirstTime>1659308149000</FirstTime>\\n            <LastTime>1661306520000</LastTime>\\n            <LockLatencyAvg>0</LockLatencyAvg>\\n            <SortRangeAvg>0</SortRangeAvg>\\n            <CpuRate>0</CpuRate>\\n            <Db>testDB</Db>\\n            <Tables>test_table</Tables>\\n        </List>\\n        <PageNo>1</PageNo>\\n        <PageSize>10</PageSize>\\n        <Extra>None</Extra>\\n    </Data>\\n    <Code>200</Code>\\n    <Success>true</Success>\\n</GetPfsSqlSummariesResponse>\",\"errorExample\":\"\"}]","title":"查询按照SQL ID维度统计的全量请求数据","description":"使用该接口需满足以下前提条件：\n\n- 使用阿里云或DAS的SDK时，建议使用最新版本。\n- 在使用SDK调用DAS服务时，需要将地域指定为cn-shanghai。\n- 目标数据库实例为RDS MySQL或PolarDB MySQL版。\n- 目标数据库实例已开启性能洞察（新版），详情请参见[性能洞察（新版）](~~469117~~)。"}