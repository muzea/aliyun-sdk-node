{"summary":"调用DescribeSqlLogRecords接口，查询DAS企业版日志明细。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"list","riskType":"none","chargeType":"free","abilityTreeCode":"199697","abilityTreeNodes":["FEATUREhdmFT57I0"]},"parameters":[{"name":"InstanceId","in":"formData","schema":{"description":"数据库实例ID。","type":"string","required":true,"example":"pc-2ze8g2am97624****\n"}},{"name":"NodeId","in":"formData","schema":{"description":"节点ID。\n\n- 对于RDS MySQL和PolarDB MySQL版，该参数仅适用于集群版实例。若不传该参数，默认查询主节点日志明细。\n- 对于PolarDB-X 2.0，该参数传入**polarx_cn**（计算节点）或**polarx_dn**（数据节点）。","type":"string","required":false,"example":"pi-uf6k5f6g3912i****"}},{"name":"Role","in":"query","schema":{"description":"PolarDB-X 2.0数据库实例节点的角色。\n\n- **polarx_cn **：计算节点。\n- **polarx_dn **：数据节点。","type":"string","required":false,"example":"polarx_cn "}},{"name":"Filters","in":"query","style":"repeatList","schema":{"description":"筛选条件列表。","type":"array","items":{"description":"筛选条件。","type":"object","properties":{"Key":{"title":"过滤参数","description":"过滤参数。\n\n> 支持的过滤参数及其取值请参考**请求参数补充说明**。","type":"string","required":false,"example":"keyWords"},"Value":{"description":"过滤参数取值。","type":"string","required":false,"example":"select"}},"required":false},"required":false,"maxItems":100}},{"name":"StartTime","in":"formData","schema":{"description":"开始时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","required":false,"example":"1596177993000"}},{"name":"EndTime","in":"formData","schema":{"description":"结束时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","required":false,"example":"1608888296000"}},{"name":"PageNo","in":"formData","schema":{"description":"分页查询的页码，从1开始，默认为1。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"PageSize","in":"formData","schema":{"description":"每页最大记录数，默认值为10。","type":"integer","format":"int32","required":false,"example":"10"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"返回的状态码。","type":"string","example":"200"},"Message":{"description":"请求返回消息。\n\n> 请求成功时该参数返回**Successful**，请求失败时会返回请求异常信息（如错误码等）。","type":"string","example":"Successful"},"RequestId":{"description":"请求ID。","type":"string","example":"F43E7FB3-CE67-5FFD-A59C-EFD278BCD7BE"},"Success":{"description":"请求是否执行成功：\n\n- **true**：执行成功。\n- **false**：执行失败。","type":"string","example":"true"},"Data":{"title":"SqlLogDetailResult","description":"返回数据。","type":"object","properties":{"StartTime":{"description":"开始时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1596177993000"},"EndTime":{"description":"结束时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1608888296000"},"TotalRecords":{"description":"总记录数。","type":"integer","format":"int64","example":"1"},"Items":{"description":"列表数据","type":"object","properties":{"SQLLogRecord":{"description":"SQL日志数据。","type":"array","items":{"description":"SQL日志数据。","type":"object","properties":{"Ext":{"description":"扩展信息字段，备用参数。","type":"string","example":"None"},"ExecuteTime":{"description":"执行时间，格式为UTC时间：`yyyy-MM-ddTHH:mm:ssZ`。","type":"string","example":"2023-12-07T02:15:32Z"},"OriginTime":{"description":"执行时间戳，格式为Unix时间，单位为毫秒。","type":"integer","format":"int64","example":"1701886532000"},"HostAddress":{"description":"客户端IP地址。","type":"string","example":"11.197.XX.XX"},"UpdateRows":{"description":"更新行数。","type":"integer","format":"int64","example":"0"},"LogicRead":{"description":"逻辑读。","type":"integer","format":"int64","example":"0"},"SqlText":{"description":"SQL语句。","type":"string","example":"select resource_id as cluster_id, tpl_name \\n\\tfrom dbfree_alert_resource_tpl_ref\\n\\twhere user_id=? and type='cluster' group by resource_id, tpl_name"},"LockTime":{"description":"锁等待时间，单位毫秒。","type":"integer","format":"int64","example":"0"},"ScanRows":{"description":"扫描行数。","type":"integer","format":"int64","example":"0"},"ThreadId":{"description":"线程ID。","type":"integer","format":"int64","example":"None"},"State":{"description":"执行状态。\n\n- **0**：执行成功。\n- **1**：执行失败。","type":"string","example":"0"},"DBName":{"description":"数据库名称。","type":"string","example":"testdb"},"SqlType":{"description":"SQL语句的类型。","type":"string","example":"select"},"AccountName":{"description":"数据库账号。","type":"string","example":"testname"},"PhysicSyncRead":{"description":"物理同步读。","type":"integer","format":"int64","example":"0"},"PhysicAsyncRead":{"description":"物理异步读。","type":"integer","format":"int64","example":"0"},"TrxId":{"description":"事务ID。","type":"string","example":"200000"},"ReturnRows":{"description":"返回行数。","type":"integer","format":"int64","example":"0"},"Consume":{"description":"执行耗时，单位毫秒。","type":"integer","format":"int64","example":"58"},"Vip":{"description":"查询链接的endpoint解析地址。","type":"string","example":"100.115.XX.XX"},"NodeId":{"description":"节点ID。","type":"string","example":"pi-uf6k5f6g3912i****"},"SqlId":{"description":"SQL ID。","type":"string","example":"c67649d4a7fb62c4f8c7a447c52b5b17"},"UseImciEngine":{"description":"PolarDB MySQL版实例是否使用列存索引。\n\n- **true**：是。\n- **false**：否。","type":"string","example":"true"},"ParallelQueueTime":{"description":"PolarDB MySQL版实例的并行度。","type":"string","example":"2"},"ParallelDegree":{"description":"PolarDB MySQL版实例的并行排队时间，单位为毫秒。","type":"string","example":"10"},"Scnt":{"description":"PolarDB-X 2.0计算节点（CN）的DN请求数。","type":"integer","format":"int64","example":"10"},"Rows":{"description":"PolarDB-X 2.0数据库实例计算节点总更新或返回的行数。","type":"integer","format":"int64","example":"10"},"Frows":{"description":"PolarDB-X 2.0计算节点（CN）的拉取行数。","type":"integer","format":"int64","example":"10"},"TraceId":{"description":"PolarDB-X 2.0的跟踪ID，即SQL在数据节点的执行ID。","type":"string","example":"14c93b7c7bf00000 "},"PhysicRead":{"description":"物理读。","type":"integer","format":"int64","example":"0"},"CpuTime":{"description":"CPU执行时间，单位为微秒。","type":"integer","format":"int64","example":"100"},"Writes":{"description":"RDS SQL Server引擎的写入数。","type":"integer","format":"int64","example":"10"},"Collection":{"description":"预留参数。","type":"string","example":"None"}}}}}},"Finish":{"description":"任务是否完成。\n- **0**：未完成\n- **1**：已完成\n\n> 当**Finish**返回为0，并且包含**JobId**字段时，说明当前请求为异步请求，无法直接获取返回结果，需要进一步根据**JobId**进行查询。查询时将**JobId**作为**Filters**的输入值，例如：`Filters=[{\"Key\": \"JobId\", \"Value\": \"******\"}]`。","type":"string","example":"1"},"JobId":{"description":"异步任务ID。","type":"string","example":"MzI4NTZfUUlOR0RBT19DTTlfTlUyMF9NWVNRTF9PREJTX0xWU18zMjg1Nl9teXNxbF9XZWQgTWFyIDA2IDE0OjUwOjQ3IENTVCAyMDI0XzBfMzBfRXhlY3V0ZVRpbWVfREVTQ19XZWQgTWFyIDA2IDE0OjM1OjQ3IENTVCAyMDI0Xw==_1709708406465"}}}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParams","errorMessage":"The request parameters are invalid."}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to do this action."}]},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"Code\\\": \\\"200\\\",\\n  \\\"Message\\\": \\\"Successful\\\",\\n  \\\"RequestId\\\": \\\"F43E7FB3-CE67-5FFD-A59C-EFD278BCD7BE\\\",\\n  \\\"Success\\\": \\\"true\\\",\\n  \\\"Data\\\": {\\n    \\\"StartTime\\\": 1596177993000,\\n    \\\"EndTime\\\": 1608888296000,\\n    \\\"TotalRecords\\\": 1,\\n    \\\"Items\\\": {\\n      \\\"SQLLogRecord\\\": [\\n        {\\n          \\\"Ext\\\": \\\"None\\\",\\n          \\\"ExecuteTime\\\": \\\"2023-12-07T02:15:32Z\\\",\\n          \\\"OriginTime\\\": 1701886532000,\\n          \\\"HostAddress\\\": \\\"11.197.XX.XX\\\",\\n          \\\"UpdateRows\\\": 0,\\n          \\\"LogicRead\\\": 0,\\n          \\\"SqlText\\\": \\\"select resource_id as cluster_id, tpl_name \\\\\\\\n\\\\\\\\tfrom dbfree_alert_resource_tpl_ref\\\\\\\\n\\\\\\\\twhere user_id=? and type='cluster' group by resource_id, tpl_name\\\",\\n          \\\"LockTime\\\": 0,\\n          \\\"ScanRows\\\": 0,\\n          \\\"ThreadId\\\": 0,\\n          \\\"State\\\": \\\"0\\\",\\n          \\\"DBName\\\": \\\"testdb\\\",\\n          \\\"SqlType\\\": \\\"select\\\",\\n          \\\"AccountName\\\": \\\"testname\\\",\\n          \\\"PhysicSyncRead\\\": 0,\\n          \\\"PhysicAsyncRead\\\": 0,\\n          \\\"TrxId\\\": \\\"200000\\\",\\n          \\\"ReturnRows\\\": 0,\\n          \\\"Consume\\\": 58,\\n          \\\"Vip\\\": \\\"100.115.XX.XX\\\",\\n          \\\"NodeId\\\": \\\"pi-uf6k5f6g3912i****\\\",\\n          \\\"SqlId\\\": \\\"c67649d4a7fb62c4f8c7a447c52b5b17\\\",\\n          \\\"UseImciEngine\\\": \\\"true\\\",\\n          \\\"ParallelQueueTime\\\": \\\"2\\\",\\n          \\\"ParallelDegree\\\": \\\"10\\\",\\n          \\\"Scnt\\\": 10,\\n          \\\"Rows\\\": 10,\\n          \\\"Frows\\\": 10,\\n          \\\"TraceId\\\": \\\"14c93b7c7bf00000 \\\",\\n          \\\"PhysicRead\\\": 0,\\n          \\\"CpuTime\\\": 100,\\n          \\\"Writes\\\": 10,\\n          \\\"Collection\\\": \\\"None\\\"\\n        }\\n      ]\\n    },\\n    \\\"Finish\\\": \\\"1\\\",\\n    \\\"JobId\\\": \\\"MzI4NTZfUUlOR0RBT19DTTlfTlUyMF9NWVNRTF9PREJTX0xWU18zMjg1Nl9teXNxbF9XZWQgTWFyIDA2IDE0OjUwOjQ3IENTVCAyMDI0XzBfMzBfRXhlY3V0ZVRpbWVfREVTQ19XZWQgTWFyIDA2IDE0OjM1OjQ3IENTVCAyMDI0Xw==_1709708406465\\\"\\n  }\\n}\",\"type\":\"json\"}]","title":"（废弃）查询DAS企业版日志明细","description":"使用该接口需满足以下前提条件：\n\n- 使用阿里云或DAS的SDK时，建议使用最新版本。\n- 在使用SDK调用DAS服务时，需要将地域指定为cn-shanghai。","requestParamsDescription":"**Key**支持的参数和取值：\n\n- **KeyWords**：关键字，多个关键字间使用空格隔开。\n- **LogicalOperator**：关键字间的逻辑操作，取值为and或or。\n- **AccountName**：用户名。\n- **dbName**：数据库名称。\n- **HostAddress**：客户端IP地址。\n- **MaxConsume**：最大耗时，单位毫秒。\n- **MinConsume**：最小耗时，单位毫秒。\n- **MaxScanRows**：最大扫描行。\n- **MinScanRows**：最小扫描行。\n- **SqlType**：SQL类型，取值select、update、insert或delete。\n- **State**：执行结果，取值0（成功）或1（失败）。\n- **ThreadId**：线程ID。\n- **SortKey**：排序列名称，取值ScanRows（扫描行数）、UpdateRows（更新行数）、Consume（耗时）、ExecuteTime（执行时间）、ReturnRows（返回行数）、LockTime（锁等待时间）、Frows（PolarDB-X 2.0计算节点的拉取行数）、Scnt（PolarDB-X 2.0计算节点的DN请求数）、CpuTime（CPU执行时间）、PhysicalRead（物理读）。\n- **SortMethod**：排序方式，取值DESC（降序）、ASC（升序）。默认为DESC。\n- **TraceId**：PolarDB-X 2.0实例的跟踪ID。\n- **MinRows**：最小更新行数。\n- **MaxRows**：最大更新行数。\n- **MinScnt**：PolarDB-X 2.0计算节点（CN）的DN最小请求数。\n- **MaxScnt**：PolarDB-X 2.0计算节点（CN）的DN最大请求数。\n- **TrxId**：事务ID。\n- **Fail**：错误码。\n- **SqlId**：SQL ID。\n- **JobId**：对于开通企业版V0和V1的数据库实例，需要通过异步任务ID进一步查询返回结果。"}