{"methods":["post"],"schemes":["https","http"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"UserId","in":"query","schema":{"description":"用户ID，即创建数据库实例的阿里云主账号ID。\n\n> 非必填，输入目标数据库实例ID后，在调用API接口时，系统会自动获取用户ID。","type":"string","required":false,"example":"196278346919****"}},{"name":"InstanceId","in":"query","schema":{"description":"实例ID。","type":"string","required":true,"example":"rm-2ze8g2am97624****"}},{"name":"NodeId","in":"query","schema":{"description":"节点ID。\n\n> 对于PolarDB MySQL版实例，需要提供节点ID。","type":"string","required":false,"example":"pi-bp12v7243x012****"}},{"name":"SqlId","in":"query","schema":{"description":"SQL ID。\n\n> 填写SQL ID时，统计目标SQL ID的全量请求数据；为空时，统计整个数据库实例的全量请求数据。","type":"string","required":false,"example":"d71f82be1eef72bd105128204d2e****"}},{"name":"OriginHost","in":"query","schema":{"description":"执行SQL的客户端IP地址。\n\n> 非必填，输入目标客户端IP地址后，统计目标客户端IP地址的全量请求数据；为空时，统计整个数据库实例的全量请求数据。","type":"string","required":false,"example":"172.26.XX.XXX"}},{"name":"Keyword","in":"query","schema":{"description":"查询关键词。","type":"string","required":false,"example":"dbtest01"}},{"name":"Start","in":"query","schema":{"description":"查询开始时间，格式为Unix时间戳，单位为毫秒。\n\n> 查询开始时间需要在数据库实例SQL洞察存储时长范围内，最大不能早于当前时间90天。","type":"integer","format":"int64","required":true,"example":"1645581813000"}},{"name":"End","in":"query","schema":{"description":"查询结束时间，格式为Unix时间戳，单位为毫秒。\n\n> 查询结束时间需晚于查询开始时间，且查询开始时间和查询结束时间的间隔不能超过1天。","type":"integer","format":"int64","required":true,"example":"1645668213000"}},{"name":"OrderBy","in":"query","schema":{"description":"排序字段，默认为**count**。\n\n- **count**：执行次数。\n\n- **avgRt**：平均执行时间。\n\n- **rtRate**：耗时比例。\n\n- **rowsExamined**：总扫描行数。\n\n- **avgRowsExamined**：平均扫描行数。\n\n- **avgRowsReturned**：平均返回行数。\n\n","type":"string","required":false,"example":"count"}},{"name":"Asc","in":"query","schema":{"description":"升序排序开关，默认关闭。","type":"boolean","required":false,"example":"关闭"}},{"name":"PageNo","in":"query","schema":{"description":"分页查询的页码，从1开始，默认为1。","type":"integer","format":"int32","required":true,"example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询每页数据量，默认为20。","type":"integer","format":"int32","required":true,"example":"20"}},{"name":"SqlType","in":"query","schema":{"description":"SQL语句的类型，取值包括：**SELECT**、**INSERT**、**UPDATE**、**DELETE**、**LOGIN**、**LOGOUT**、**MERGE**、**ALTER**、**CREATEINDEX**、**DROPINDEX**、**CREATE**、**DROP**、**SET**、**DESC**、**REPLACE**、**CALL**、**BEGIN**、**DESCRIBE**、**ROLLBACK**、**FLUSH**、**USE**、**SHOW**、**START**、**COMMIT**和**RENAME**。\n\n> 当数据库实例为RDS MySQL、PolarDB MySQL版、PolarDB-X 2.0时，可以通过SQL语句类型进行统计。","type":"string","required":false,"example":"SELECT"}},{"name":"DbName","in":"query","schema":{"description":"数据库名。","type":"string","required":false,"example":"dbtest01"}},{"name":"Role","in":"query","schema":{"description":"PolarDB-X 2.0数据库实例节点信息。\n\n- **polarx_cn**：计算节点。\n\n- **polarx_dn**：数据节点。","type":"string","required":false,"example":"polarx_cn"}}],"responses":{"200":{"schema":{"description":"返回信息的详细列表。","type":"object","properties":{"Message":{"description":"请求返回消息。\n\n> 请求成功时该参数返回**Successful**，请求失败时会返回请求异常信息（如错误码等）。","type":"string","example":"Successful"},"RequestId":{"description":"请求ID。","type":"string","example":"7172BECE-588A-5961-8126-C216E16B****"},"Data":{"description":"返回数据。","type":"object","properties":{"Result":{"description":"返回的全量请求数据。","type":"object","properties":{"List":{"description":"全量请求数据列表。","type":"array","items":{"description":"全量请求数据列表。","type":"object","properties":{"SqlId":{"description":"SQL ID。","type":"string","example":"d71f82be1eef72bd105128204d2e****"},"AvgFetchRows":{"description":"PolarDB-X 2.0数据库实例计算节点平均拉取数据节点的行数。","type":"integer","format":"int64","example":"0"},"AvgLockWaitTime":{"description":"平均锁等待时长，单位为秒。","type":"number","format":"double","example":"0.00009589874265269765"},"AvgLogicalRead":{"description":"平均逻辑读。","type":"number","format":"double","example":"654.4470327860251"},"AvgPhysicalAsyncRead":{"description":"平均物理异步读取。","type":"integer","format":"int64","example":"0"},"AvgPhysicalSyncRead":{"description":"平均物理同步读取。","type":"integer","format":"int64","example":"0"},"AvgExaminedRows":{"description":"平均扫描行数。\n\n> 目前支持该字段的数据库：RDS MySQL、RDS PostgreSQL、PolarDB MySQL版。","type":"number","format":"double","example":"10000"},"AvgReturnedRows":{"description":"平均返回行数。","type":"number","format":"double","example":"10000"},"AvgUpdatedRows":{"description":"平均修改行数。\n\n> 目前支持该字段的数据库：RDS MySQL、PolarDB-X 2.0。","type":"integer","format":"int64","example":"10000"},"AvgRt":{"description":"平均执行耗时。","type":"number","format":"double","example":"2.499"},"AvgSqlCount":{"description":"平均SQL计数。","type":"integer","format":"int64","example":"10000"},"Count":{"description":"总执行次数。","type":"integer","format":"int64","example":"100000"},"CountRate":{"description":"执行次数比例。","type":"number","format":"double","example":"0.0586"},"Database":{"description":"数据库名。","type":"string","example":"dbtest01"},"ErrorCount":{"description":"执行错误次数。","type":"integer","format":"int64","example":"1"},"FetchRows":{"description":"PolarDB-X 2.0数据库实例计算节点拉取数据节点的行数。","type":"integer","format":"int64","example":"0"},"Ip":{"description":"实例的网络地址。","type":"string","example":"rm-uf6dyi58dm6****.mysql.rds.aliy****.com"},"LockWaitTime":{"description":"锁等待时长，单位为秒。","type":"number","format":"double","example":"1089.4177720290281"},"LogicalRead":{"description":"逻辑读。","type":"integer","format":"int64","example":"7.434573266E9"},"PhysicalAsyncRead":{"description":"物理异步读取。","type":"integer","format":"int64","example":"0"},"PhysicalSyncRead":{"description":"物理同步读取。","type":"integer","format":"int64","example":"0"},"Port":{"description":"端口号。","type":"integer","format":"int64","example":"3306"},"Psql":{"description":"SQL模板。","type":"string","example":"select * from dbtest01 where ****"},"Rows":{"description":"PolarDB-X 2.0数据库实例计算节点总更新或返回的行数。","type":"integer","format":"int64","example":"0"},"ExaminedRows":{"description":"总扫描行数。\n\n> 目前支持该字段的数据库：RDS MySQL、RDS PostgreSQL、PolarDB MySQL版。","type":"integer","format":"int64","example":"10000"},"RtGreaterThanOneSecondCount":{"description":"执行时长大于1秒的SQL数量。","type":"integer","format":"int64","example":"20"},"RtRate":{"description":"耗时比例。","type":"number","format":"double","example":"2.499"},"SqlCount":{"description":"SQL的数量。","type":"integer","format":"int64","example":"200"},"SumUpdatedRows":{"description":"总变更行数。","type":"integer","format":"int64","example":"100"},"Tables":{"description":"数据库表名。","type":"array","items":{"description":"数据库表名。\n","type":"string","example":"tabletest01,tabletest02"}},"Version":{"description":"版本。","type":"integer","format":"int64","example":"1"},"VpcId":{"description":"VPC ID。","type":"string","example":"vpc-2zentqj1sk4qmolci****"}}}},"Total":{"description":"总数据量。","type":"integer","format":"int64","example":"1"}}},"Fail":{"description":"请求是否失败。\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"false"},"IsFinish":{"description":"异步请求是否执行完成。\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"true"},"ResultId":{"description":"请求的ID。","type":"string","example":"9CB97BC4-6479-55D0-B9D0-EA925AFE****"},"State":{"description":"异步请求的执行状态。\n\n- **RUNNING**：正在运行。\n\n- **SUCCESS**：成功。\n\n- **FAIL**：失败。","type":"string","example":"SUCCESS"},"Timestamp":{"description":"执行时间，格式为Unix时间戳，单位为毫秒。","type":"integer","format":"int64","example":"1645668213000"}}},"Code":{"description":"返回的状态码。","type":"integer","format":"int64","example":"200"},"Success":{"description":"请求是否执行成功：\n\n- **true**：执行成功。\n- **false**：执行失败。","type":"boolean","example":"true"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParams","errorMessage":"The request parameters are invalid."}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to do this action."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Message\\\": \\\"Successful\\\",\\n  \\\"RequestId\\\": \\\"7172BECE-588A-5961-8126-C216E16B****\\\",\\n  \\\"Data\\\": {\\n    \\\"Result\\\": {\\n      \\\"List\\\": [\\n        {\\n          \\\"SqlId\\\": \\\"d71f82be1eef72bd105128204d2e****\\\",\\n          \\\"AvgFetchRows\\\": 0,\\n          \\\"AvgLockWaitTime\\\": 0.00009589874265269765,\\n          \\\"AvgLogicalRead\\\": 654.4470327860251,\\n          \\\"AvgPhysicalAsyncRead\\\": 0,\\n          \\\"AvgPhysicalSyncRead\\\": 0,\\n          \\\"AvgExaminedRows\\\": 10000,\\n          \\\"AvgReturnedRows\\\": 10000,\\n          \\\"AvgUpdatedRows\\\": 10000,\\n          \\\"AvgRt\\\": 2.499,\\n          \\\"AvgSqlCount\\\": 10000,\\n          \\\"Count\\\": 100000,\\n          \\\"CountRate\\\": 0.0586,\\n          \\\"Database\\\": \\\"dbtest01\\\",\\n          \\\"ErrorCount\\\": 1,\\n          \\\"FetchRows\\\": 0,\\n          \\\"Ip\\\": \\\"rm-uf6dyi58dm6****.mysql.rds.aliy****.com\\\",\\n          \\\"LockWaitTime\\\": 1089.4177720290281,\\n          \\\"LogicalRead\\\": 7434573266,\\n          \\\"PhysicalAsyncRead\\\": 0,\\n          \\\"PhysicalSyncRead\\\": 0,\\n          \\\"Port\\\": 3306,\\n          \\\"Psql\\\": \\\"select * from dbtest01 where ****\\\",\\n          \\\"Rows\\\": 0,\\n          \\\"ExaminedRows\\\": 10000,\\n          \\\"RtGreaterThanOneSecondCount\\\": 20,\\n          \\\"RtRate\\\": 2.499,\\n          \\\"SqlCount\\\": 200,\\n          \\\"SumUpdatedRows\\\": 100,\\n          \\\"Tables\\\": [\\n            \\\"tabletest01,tabletest02\\\"\\n          ],\\n          \\\"Version\\\": 1,\\n          \\\"VpcId\\\": \\\"vpc-2zentqj1sk4qmolci****\\\"\\n        }\\n      ],\\n      \\\"Total\\\": 1\\n    },\\n    \\\"Fail\\\": false,\\n    \\\"IsFinish\\\": true,\\n    \\\"ResultId\\\": \\\"9CB97BC4-6479-55D0-B9D0-EA925AFE****\\\",\\n    \\\"State\\\": \\\"SUCCESS\\\",\\n    \\\"Timestamp\\\": 1645668213000\\n  },\\n  \\\"Code\\\": 200,\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GetFullRequestStatResultByInstanceIdResponse>\\n    <Message>Successful</Message>\\n    <RequestId>7172BECE-588A-5961-8126-C216E16B****</RequestId>\\n    <Data>\\n        <Result>\\n            <List>\\n                <SqlId>d71f82be1eef72bd105128204d2e****</SqlId>\\n                <AvgFetchRows>0</AvgFetchRows>\\n                <AvgLockWaitTime>0.00009589874265269765</AvgLockWaitTime>\\n                <AvgLogicalRead>654.4470327860251</AvgLogicalRead>\\n                <AvgPhysicalAsyncRead>0</AvgPhysicalAsyncRead>\\n                <AvgPhysicalSyncRead>0</AvgPhysicalSyncRead>\\n                <AvgExaminedRows>10000</AvgExaminedRows>\\n                <AvgReturnedRows>10000</AvgReturnedRows>\\n                <AvgUpdatedRows>10000</AvgUpdatedRows>\\n                <AvgRt>2.499</AvgRt>\\n                <AvgSqlCount>10000</AvgSqlCount>\\n                <Count>100000</Count>\\n                <CountRate>0.0586</CountRate>\\n                <Database>dbtest01</Database>\\n                <ErrorCount>1</ErrorCount>\\n                <FetchRows>0</FetchRows>\\n                <Ip>rm-uf6dyi58dm6****.mysql.rds.aliy****.com</Ip>\\n                <LockWaitTime>1089.4177720290281</LockWaitTime>\\n                <PhysicalAsyncRead>0</PhysicalAsyncRead>\\n                <PhysicalSyncRead>0</PhysicalSyncRead>\\n                <Port>3306</Port>\\n                <Psql>select * from dbtest01 where ****</Psql>\\n                <Rows>0</Rows>\\n                <ExaminedRows>10000</ExaminedRows>\\n                <RtGreaterThanOneSecondCount>20</RtGreaterThanOneSecondCount>\\n                <RtRate>2.499</RtRate>\\n                <SqlCount>200</SqlCount>\\n                <SumUpdatedRows>100</SumUpdatedRows>\\n                <Tables>tabletest01,tabletest02</Tables>\\n                <Version>1</Version>\\n                <VpcId>vpc-2zentqj1sk4qmolci****</VpcId>\\n            </List>\\n            <Total>1</Total>\\n        </Result>\\n        <Fail>false</Fail>\\n        <IsFinish>true</IsFinish>\\n        <ResultId>9CB97BC4-6479-55D0-B9D0-EA925AFE****</ResultId>\\n        <State>SUCCESS</State>\\n        <Timestamp>1645668213000</Timestamp>\\n    </Data>\\n    <Code>200</Code>\\n    <Success>true</Success>\\n</GetFullRequestStatResultByInstanceIdResponse>\",\"errorExample\":\"\"}]","title":"按照SQL ID异步统计全量请求数据","summary":"调用GetFullRequestStatResultByInstanceId接口，按照SQL ID异步统计数据库实例SQL洞察结果中的全量请求数据。","description":"> 异步调用后不会立即返回完整结果，当返回数据中isFinish取值为**false**时，请等待1s后重新发起调用，直到isFinish取值为**true**时，返回完整结果。\n\nSQL洞察功能可对SQL进行健康情况诊断、性能问题排查，详情请参见[SQL洞察](~~204096~~)。\n\n- 目前支持的数据库实例请参见[DAS企业版使用说明](~~190912~~)。\n- 在使用SDK调用DAS服务时，需要将地域指定为cn-shanghai。"}