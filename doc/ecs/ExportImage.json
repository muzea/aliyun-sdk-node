{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"update","abilityTreeCode":"29030","abilityTreeNodes":["FEATUREecsZ3BT05"]},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"自定义镜像的地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。 ","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"ImageId","in":"query","schema":{"description":"自定义镜像ID。","type":"string","required":true,"example":"m-bp67acfmxazb4p****"}},{"name":"OSSBucket","in":"query","schema":{"description":"保存导出镜像的OSS bucket。","type":"string","required":true,"example":"testexportImage"}},{"name":"OSSPrefix","in":"query","schema":{"description":"您的OSS  Object的前缀。可以由数字或者字母组成，字符长度为1~30。","type":"string","required":false,"example":"EcsExport"}},{"name":"ImageFormat","in":"query","schema":{"description":"镜像文件的导出格式。取值范围：\n- raw。\n- vhd。\n- qcow2。\n- vmdk。\n- vdi。\n\n默认值：raw。","type":"string","required":false,"example":"raw"}},{"name":"RoleName","in":"query","schema":{"description":"导出镜像时使用的RAM角色名称。","type":"string","required":false,"example":"AliyunECSImageExportDefaultRole"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"C8B26B44-0189-443E-9816-D951F596****"},"TaskId":{"description":"导出镜像任务ID。","type":"string","example":"tsk-bp67acfmxazb4p****"},"RegionId":{"description":"地域ID。","type":"string","example":"cn-hangzhou"}}}}},"errorCodes":{"400":[{"errorCode":"MissingParameter","errorMessage":"An input parameter \"RegionId\" that is mandatory for processing the request is not supplied."},{"errorCode":"InvalidImageName.Malformed","errorMessage":"The specified Image name is wrongly formed."},{"errorCode":"InvalidOSSPrefix.Malformed","errorMessage":"The specified OSSPrefix format is wrongly formed."},{"errorCode":"InvalidRegionId.NotFound","errorMessage":"The specified RegionId does not exist."},{"errorCode":"InvalidRegion.NotSupport","errorMessage":"The specified region does not support image import or export."},{"errorCode":"IncorrectImageStatus","errorMessage":"The specified Image is not available."},{"errorCode":"InvalidImageFormat.Malformed","errorMessage":"The specified Image Format is wrongly formed."},{"errorCode":"InvalidOSSBucket.NotFound","errorMessage":"The specified OSS bucket does not exist in this region."},{"errorCode":"OperationDenied","errorMessage":"The specified image contains the snapshot of the data disk,does not support this operation."},{"errorCode":"InvalidImage.DiskAmountOrSize","errorMessage":"%s"},{"errorCode":"ImageNotSupported","errorMessage":"The specified Image contains encrypted snapshots, do not support export."},{"errorCode":"InvalidOSSObject.NeedRestore","errorMessage":"The specified OSS object is a archive object, need restore first."},{"errorCode":"InvalidOSSBucket.NotMatched","errorMessage":"The specified OSS bucket is incorrect, %s."},{"errorCode":"InvalidImageFormat.RegionNotSupported","errorMessage":"The specified image format is not supported in current region."}],"403":[{"errorCode":"ImageNotSupported","errorMessage":"The specified image from the image market, do not support export image."},{"errorCode":"ImageIsExporting","errorMessage":"The specified Image is exporting."},{"errorCode":"ExportImageFailed","errorMessage":"Exporting image is failed, Please contact the administrator."},{"errorCode":"UserNotInTheWhiteList","errorMessage":"The user is not in the white list of exporting image."},{"errorCode":"NoSetRoletoECSServiceAcount","errorMessage":"ECS service account Have no right to access your OSS.please attach a role of access your oss to ECS service account."},{"errorCode":"InvalidOSS.NotAuthorized","errorMessage":"The specified OSS bucket or object is not allowed to access."},{"errorCode":"ConcurrentQuotaExceed.ExportImage","errorMessage":"%s"},{"errorCode":"WeeklyQuotaExceed.ExportImage","errorMessage":"%s"},{"errorCode":"InvalidImageLicense.NotSupported","errorMessage":"%s"},{"errorCode":"InvalidImageCategory.NotSupported","errorMessage":"The specified image category is not supported."},{"errorCode":"InvalidOSSBucket.EncryptUnsupported","errorMessage":"Accessing objects from encrypted OSS bucket is not supported."}],"404":[{"errorCode":"InvalidImageId.NotFound","errorMessage":"The specified ImageId does not exist."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"C8B26B44-0189-443E-9816-D951F596****\\\",\\n  \\\"TaskId\\\": \\\"tsk-bp67acfmxazb4p****\\\",\\n  \\\"RegionId\\\": \\\"cn-hangzhou\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<ExportImageResponse>\\n    <RequestId>C8B26B44-0189-443E-9816-D951F596****</RequestId>\\n    <ExportTaskId>tsk-bp67acfmxazb4p****</ExportTaskId>\\n    <RegionId>cn-hangzhou</RegionId>\\n</ExportImageResponse>\",\"errorExample\":\"\"}]","title":"导出一份自定义镜像到OSS","summary":"导出一份自定义镜像到与自定义镜像同一地域的OSS Bucket里。","description":"## 接口说明\n\n导出镜像前：\n\n- 您需要先了解前提条件以及注意事项。更多信息，请参见[导出镜像](~~58181~~)。\n\n- 设置参数`ImageFormat`镜像导出格式功能仅在部分地域可用，支持的地域有印度（孟买）、日本（东京）、澳大利亚（悉尼）、印度尼西亚（雅加达）、德国（法兰克福）、阿联酋（迪拜）、美国（弗吉尼亚）、英国（伦敦）、新加坡、马来西亚（吉隆坡）和美国（硅谷）。不支持设置镜像格式的地域，默认导出RAW格式的镜像。\n\n- 您必须通过RAM授权云服务器ECS写入OSS的权限。具体操作说明如下：\n\n    - 创建角色：`AliyunECSImageExportDefaultRole`（其他任何角色名称无效），为该角色设置以下角色策略：\n      ```\n         {\n           \"Statement\": [\n             {\n               \"Action\": \"sts:AssumeRole\",\n               \"Effect\": \"Allow\",\n               \"Principal\": {\n                 \"Service\": [\n                   \"ecs.aliyuncs.com\"\n                 ]\n               }\n             }\n           ],\n           \"Version\": \"1\"\n         }\n  - 在角色`AliyunECSImageExportDefaultRole`下加入默认的系统权限策略：`AliyunECSImageExportRolePolicy`，该策略是云服务器ECS提供导出镜像的默认策略。更多详情，请参见[云资源访问授权](https://ram.console.aliyun.com/?spm=5176.2020520101.0.0.64c64df5dfpmdY#/role/authorize?request=%7B%22Requests%22:%20%7B%22request1%22:%20%7B%22RoleName%22:%20%22AliyunECSImageImportDefaultRole%22,%20%22TemplateId%22:%20%22ECSImportRole%22%7D,%20%22request2%22:%20%7B%22RoleName%22:%20%22AliyunECSImageExportDefaultRole%22,%20%22TemplateId%22:%20%22ECSExportRole%22%7D%7D,%20%22ReturnUrl%22:%20%22https:%2F%2Fecs.console.aliyun.com%2F%22,%20%22Service%22:%20%22ECS%22%7D)。您也可以创建自定义策略，权限需要包含：\n    ```\n         {\n           \"Version\": \"1\",\n           \"Statement\": [\n             {\n               \"Action\": [\n                 \"oss:GetObject\",\n                 \"oss:PutObject\",\n                 \"oss:DeleteObject\",\n                 \"oss:GetBucketLocation\",\n                 \"oss:GetBucketInfo\",\n                 \"oss:AbortMultipartUpload\",\n                 \"oss:ListMultipartUploads\",\n                 \"oss:ListParts\"\n               ],\n               \"Resource\": \"*\",\n               \"Effect\": \"Allow\"\n             }\n           ]\n         }\n      ```\n\n导出镜像后：\n\n自定义镜像将保存在指定的OSS bucket中，您可以下载自定义镜像。具体操作，请参见[下载自定义镜像文件](~~31912~~)。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}