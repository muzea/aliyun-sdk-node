{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"update"},"parameters":[{"name":"InstanceId","in":"query","schema":{"description":"实例ID。","type":"string","required":true,"example":"i-bp67acfmxazb4ph****"}},{"name":"RegionId","in":"query","schema":{"description":"实例所属的地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"InstanceType","in":"query","schema":{"description":"需要变配的目标实例规格。取值请参见[实例规格族](~~25378~~)或者调用[DescribeInstanceTypes](~~25620~~)。","type":"string","required":true,"example":"ecs.g5.xlarge"}},{"name":"OperatorType","in":"query","schema":{"description":"操作类型。取值范围：\n>该参数可无需上传，系统可自动判断升配还是降配；如要上传，请按照下面的逻辑规则操作。\n\n- upgrade：升级实例规格。请确保您的账户支付方式余额充足。\n\n- downgrade：降配实例规格。当`InstanceType`设置的实例规格低于当前实例规格时，设置`OperatorType=downgrade`。\n\n>升级或降低实例规格的注意事项请参见上文接口说明章节。","type":"string","required":false,"example":"upgrade"}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。ClientToken只支持ASCII字符，且不能超过64个字符。更多信息，请参见[如何保证幂等性](~~25693~~)。","type":"string","required":false,"example":"123e4567-e89b-12d3-a456-426655440000"}},{"name":"AutoPay","in":"query","schema":{"description":"升级实例规格时，是否自动支付。取值范围：\n\n- true：自动支付。\n    > 自动支付时，您需要确保支付方式余额充足，否则会生成异常订单，只能作废订单。如果您的支付方式余额不足，可以将参数`AutoPay`置为`false`，此时会生成未支付订单，您可以登录ECS管理控制台自行支付。\n\n- false：只生成订单不扣费。\n\n默认值：true。\n\n当参数`OperatorType`被置为`downgrade`时，将忽略参数`AutoPay`。","type":"boolean","required":false,"example":"true","default":"true"}},{"name":"MigrateAcrossZone","in":"query","schema":{"description":"是否支持跨集群升级实例规格。取值范围：\n- true：是。\n- false：否。\n\n默认值：false。\n\n当参数`MigrateAcrossZone`取值为`true`时，一旦您根据返回信息升级了云服务器，请留意以下注意事项：\n\n经典网络类型实例：\n- 对于[已停售的实例规格](~~55263~~)，非I/O优化实例变配到I/O优化实例时，实例私网IP地址、磁盘设备名和软件授权码会发生变化。对于Linux实例，普通云盘（cloud）会被识别为xvda或者xvdb等，高效云盘（cloud_efficiency）和SSD云盘（cloud_ssd）会被识别为vda或者vdb等。\n- 对于[正常售卖的实例规格族](~~25378~~)，实例的私网IP地址会发生变化。\n\n专有网络VPC类型实例：对于已停售的实例规格，非I/O优化实例变配到I/O优化实例时，云服务器磁盘设备名和软件授权码会发生变化。Linux实例的普通云盘（cloud）会被识别为xvda或者xvdb等，高效云盘（cloud_efficiency）和SSD云盘（cloud_ssd）会被识别为vda或者vdb等。","type":"boolean","required":false,"example":"false","default":"false"}},{"name":"SystemDisk.Category","in":"query","schema":{"description":"更换系统盘类型。取值范围：\n\n- cloud_efficiency：高效云盘。\n- cloud_ssd：SSD云盘。\n>该参数仅支持从[已停售的实例规格](~~55263~~)升级到[正常售卖的实例规格族](~~25378~~)，并将非I/O优化实例规格升级为I/O优化实例规格时有效。","type":"string","required":false,"example":"cloud_efficiency"}},{"name":"RebootTime","in":"query","schema":{"description":"实例的重启时间。按照[ISO 8601](~~25696~~)标准表示，使用UTC+0时间。格式为：yyyy-MM-ddTHH:mmZ。","type":"string","required":false,"example":"2018-01-01T12:05Z"}},{"name":"EndTime","in":"query","schema":{"description":"临时变更的终止时间。按照[ISO 8601](~~25696~~)标准表示，使用UTC+0时间。格式为：yyyy-MM-ddTHH:mmZ。","type":"string","required":false,"example":"2018-01-01T12:05Z"}},{"name":"RebootWhenFinished","in":"query","schema":{"description":"实例变配结束后是否立即重启。取值范围：\n\n- true：是。\n- false：否。\n\n默认值为false。\n\n> 若实例处于**停止中**状态，即使您设置了`RebootWhenFinished=true`，也会保持原状态不变，并不会执行任何操作。","type":"boolean","required":false,"example":"false"}},{"name":"ModifyMode","in":"query","schema":{"description":">该参数暂未开放使用。","type":"string","required":false,"example":"null","enum":["Online","Offline"]}},{"name":"Disk","in":"query","style":"repeatList","schema":{"description":">该参数暂未开放使用。","type":"array","items":{"description":">该参数暂未开放使用。","type":"object","properties":{"DiskId":{"description":">该参数暂未开放使用。","type":"string","required":false,"example":"null"},"Category":{"description":">该参数暂未开放使用。","type":"string","required":false,"example":"null"},"PerformanceLevel":{"description":">该参数暂未开放使用。","type":"string","required":false,"example":"null"}},"required":false},"required":false,"maxItems":128}}],"responses":{"200":{"schema":{"type":"object","properties":{"OrderId":{"description":"生成的订单ID。","type":"string","example":"1234567890"},"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidInstanceType.ValueUnauthorized","errorMessage":"The specified InstanceType is not authorized."},{"errorCode":"InvalidInstanceType.ValueNotSupported","errorMessage":"The specified InstanceType does not exist or beyond the permitted range."},{"errorCode":"InvalidBillingMethod.ValueNotSupported","errorMessage":"The operation is not permitted due to an invalid billing method of the instance."},{"errorCode":"InvalidInstance.PurchaseNotFound","errorMessage":"The specified instance has no purchase history."},{"errorCode":"InvalidInstance.UnpaidOrder","errorMessage":"The specified instance has unpaid order."},{"errorCode":"InvalidInstanceType.NotSupported","errorMessage":"The specified InstanceType is not Supported."},{"errorCode":"OrderCreationFailed","errorMessage":"Order creation failed, please check your params and try it again later."},{"errorCode":"Throttling","errorMessage":"You have made too many requests within a short time; your request is denied due to request throttling."},{"errorCode":"Account.Arrearage","errorMessage":"Your account has an outstanding payment."},{"errorCode":"InvalidInstanceId.NotFound","errorMessage":"The specified InstanceId does not exist."},{"errorCode":"InvalidRebootTime.MalFormed","errorMessage":"The specified rebootTime is not valid."},{"errorCode":"InvalidRebootTime.ValueNotSupported","errorMessage":"The specified RebootTime is not valid."},{"errorCode":"IdempotenceParamNotMatch","errorMessage":"Request uses a client token in a previous request but is not identical to that request."},{"errorCode":"InvalidInstanceChargeType.ValueNotSupported","errorMessage":"%s"},{"errorCode":"InvalidStatus.NotStopped","errorMessage":"Instance status must be stopped."},{"errorCode":"InvalidAction","errorMessage":"%s"},{"errorCode":"InstanceDowngrade.QuotaExceed","errorMessage":"Quota of instance downgrade is exceed."},{"errorCode":"InvalidParameter","errorMessage":"%s"},{"errorCode":"OperationDenied","errorMessage":"The current user does not support this operation."},{"errorCode":"LastOrderProcessing","errorMessage":"The previous order is still processing, please try again later."},{"errorCode":"InvalidOperation.VpcHasEnabledAdvancedNetworkFeature","errorMessage":"The specified vpc has enabled advanced network feature."},{"errorCode":"InvalidAction.WithActiveElasticUpgrade","errorMessage":"The instance has active Elastic Upgrade."},{"errorCode":"InstanceTypeNotSupported.TooManyDisksAttached","errorMessage":"%s"},{"errorCode":"QuotaExceed.DiskCapacity","errorMessage":"The used capacity of disk type has exceeded the quota in the zone,  %s."},{"errorCode":"MissingParameter.DiskCategory","errorMessage":"The specified parameter Disk.Category can not be null when Disk.DiskId is specified."},{"errorCode":"InvalidParameter.DiskCategory","errorMessage":"The specified parameter Disk.Category is not valid."},{"errorCode":"InvalidPerformanceLevel.Malformed","errorMessage":"The specified parameter Disk.n.PerformanceLevel is not valid."},{"errorCode":"InvalidSystemDiskCategory.NotMatchInstanceType","errorMessage":"The system disk category does not match the instance type."},{"errorCode":"QuotaExceed.RufundVcpu","errorMessage":"The maximum number of refunded vcpu is exceeded: %s ."},{"errorCode":"NoPermission.Price","errorMessage":"The operation requires price permission. Please either apply for permission from your main account, or set the parameter AutoPay as true."},{"errorCode":"NoPermission.Refund","errorMessage":"The operation requires refund permission. Please apply for permission from your main account."},{"errorCode":"InvalidInstanceStatus","errorMessage":"The current status of the instance does not support this operation."},{"errorCode":"InvalidOperation.InstanceRenewWithDowngradeInPlan","errorMessage":"The operation is denied due to the specified instance has renew with downgrade record in plan."},{"errorCode":"InvalidOperation.OnlineModificationUnsupported","errorMessage":"Online modification of instance type is not supported for the specified instance due to its CPU topology."}],"403":[{"errorCode":"OperationDenied.NoStock","errorMessage":"The specified instance is out of usage."},{"errorCode":"InvalidInstanceType.ValueNotSupported","errorMessage":"The specified InstanceType does not exist or beyond the permitted range."},{"errorCode":"InvalidUser.PassRoleForbidden","errorMessage":"The RAM user does not have privilege to pass a role."},{"errorCode":"ImageNotSupportInstanceType","errorMessage":"The specified image does not support the specified InstanceType."},{"errorCode":"InstanceType.Offline","errorMessage":"%s"},{"errorCode":"IncorrectInstanceStatus","errorMessage":"The current status of the resource does not support this operation."},{"errorCode":"Throttling","errorMessage":"You have made too many requests within a short time; your request is denied due to request throttling."},{"errorCode":"InvalidParameter.InstanceId","errorMessage":"%s"},{"errorCode":"OperationDenied","errorMessage":"%s"},{"errorCode":"InvalidInstanceStatus","errorMessage":"The current status of the instance does not support this operation."},{"errorCode":"InvalidOperation.StarterPackage","errorMessage":"StarterPackage not support modification."},{"errorCode":"InvalidInstance.PreInstanceExpired","errorMessage":"Instance business status is not Expired."},{"errorCode":"InvalidInstance.EipNotSupport","errorMessage":"The special instance with eip not support operate, please unassociate eip first."},{"errorCode":"OperationDenied.ImageNotValid","errorMessage":"The specified image is not authorized."},{"errorCode":"OperationDenied.LocalDiskUnsupported","errorMessage":"The configuration change is not allowed when the specified instance has local disks mounted."},{"errorCode":"InvalidOperation.EniCountExceeded","errorMessage":"%s"},{"errorCode":"InvalidOperation.Ipv4CountExceeded","errorMessage":"%s"},{"errorCode":"InvalidOperation.Ipv6CountExceeded","errorMessage":"%s"},{"errorCode":"InvalidOperation.Ipv6NotSupport","errorMessage":"%s"},{"errorCode":"InvalidOperation.Ipv4NotSupport","errorMessage":"%s"},{"errorCode":"InvalidInstance.NotFoundSystemDisk","errorMessage":"The specified instance has no system disk."},{"errorCode":"InvalidInstanceType.NotSupportDiskCategory","errorMessage":"The instanceType of the specified instance does not support this disk category."},{"errorCode":"QuotaExceed.ElasticQuota","errorMessage":"No additional quota is available for the specified ECS instance type."},{"errorCode":"InvalidResourceType.NotSupported","errorMessage":"%s"},{"errorCode":"InvalidOperation.MaxEniQueueNumberExceeded","errorMessage":"%s"},{"errorCode":"InvalidOperation.ExceedInstanceTypeQueueNumber","errorMessage":"%s"},{"errorCode":"InvalidParameter.InvalidEniQueueNumber","errorMessage":"%s"},{"errorCode":"HibernationConfigured.InstanceOperationForbidden","errorMessage":"The operation is not permitted due to limit of the hibernation configured instance."},{"errorCode":"InvalidOperation.MaxModifyOnlineNumberExceeded","errorMessage":"The specified instance has reached the maximum number of modify online attempts and needs to be rebooted."},{"errorCode":"InvalidOperation.RebootingRequired","errorMessage":"The specified instance needs to be rebooted."},{"errorCode":"InvalidOperation.OSTypeNotSupported","errorMessage":"The specified OS type is not supported."},{"errorCode":"OperationDenied.UnpaidOrder","errorMessage":"The specified instance has unpaid order."}],"404":[{"errorCode":"InvalidRegionId.NotFound","errorMessage":"The specified RegionId does not exist."},{"errorCode":"BillingMethodNotFound","errorMessage":"The account has not chosen any billing method."},{"errorCode":"InvalidInstanceId.NotFound","errorMessage":"The specified InstanceId does not exist."}],"500":[{"errorCode":"InternalError","errorMessage":"The request processing has failed due to some unknown error, exception or failure."},{"errorCode":"ImageOrderFailed","errorMessage":"Create marketplace image order failed."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"OrderId\\\": \\\"1234567890\\\",\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E\\\"\\n}\",\"errorExample\":\"{\\n    \\\"RequestId\\\": \\\"E69EF3CC-94CD-42E7-8926-F133B86387C0\\\",\\n    \\\"HostId\\\": \\\"ecs.aliyuncs.com\\\",\\n    \\\"Code\\\": \\\"InvalidBillingMethod.ValueNotSupported\\\",\\n    \\\"Message\\\": \\\"The operation is not permitted due to an invalid billing method of the instance.\\\"\\n}\"},{\"type\":\"xml\",\"example\":\"<ModifyPrepayInstanceSpecResponse>\\n    <RequestId>04F0F334-1335-436C-A1D7-6C044FE73368</RequestId>\\n    <OrderId>1234567890</OrderId>\\n</ModifyPrepayInstanceSpecResponse>\",\"errorExample\":\"<Error>\\n    <RequestId>E69EF3CC-94CD-42E7-8926-F133B86387C0</RequestId>\\n    <HostId>ecs.aliyuncs.com</HostId>\\n    <Code>InvalidBillingMethod.ValueNotSupported</Code>\\n    <Message>The operation is not permitted due to an invalid billing method of the instance.</Message>\\n</Error>\"}]","title":"升级或降低实例规格","summary":"调用ModifyPrepayInstanceSpec升级或者降低一台包年包月ECS实例的实例规格，新实例规格将会覆盖实例的整个生命周期。","description":"## 接口说明\n<props=\"china\">请确保在使用该接口前，您已充分了解[云服务器ECS](https://www.aliyun.com/price/product#/ecs/detail)的计费方式、产品定价以及[降配退款规则](~~116043~~)。</props>\n\n<props=\"intl\">请确保在使用该接口前，您已充分了解[云服务器ECS](https://www.alibabacloud.com/product/ecs#pricing)的计费方式、产品定价以及[降配退款规则](~~476339~~)。</props>\n\n升级或者降低包年包月实例规格前，您可以通过[DescribeResourcesModification](~~66187~~)查询当前实例支持变配的实例规格。详情请参见Python SDK示例[查询ECS变配的可用资源实践](~~109517~~)。\n\n调用该接口时，您需要注意：\n\n-   已过期实例无法修改实例规格，您可以续费后重新操作。\n-   降低实例规格时，您需要注意：\n\n    -   实例必须处于**已停止**（`Stopped`）状态。\n    -   降低前后的实例规格价格差退款会退还到您的原付费方式中，已使用的代金券不退回。\n\n-   本接口属于异步操作，等待约5~10秒后配置变更完成。随后，您必须调用API或者在控制台重启一次实例，否则规格变更不会生效，重启操作系统无效。\n\n    - 若实例处于**已停止**状态，仅需启动实例，无需重启。\n    - 若实例设置了`RebootWhenFinished=true`，则无需单独重启。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}