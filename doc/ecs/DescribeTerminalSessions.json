{"summary":"查看Session Manager会话历史记录。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"list","abilityTreeCode":"29325","abilityTreeNodes":["FEATUREecsXZ3H4M"]},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"地域ID。","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"InstanceId","in":"query","schema":{"description":"实例ID。","type":"string","required":false,"example":"i-bp1i7gg30r52z2em****"}},{"name":"SessionId","in":"query","schema":{"description":"会话ID。","type":"string","required":false,"example":"s-hz023od0x9****"}},{"name":"MaxResults","in":"query","schema":{"description":"分页查询时每页的最大条目数。\n\n最大值为100。\n\n默认值为10。","type":"integer","format":"int32","required":false,"example":"10"}},{"name":"NextToken","in":"query","schema":{"description":"查询凭证（Token），取值为上一次API调用返回的NextToken参数值。","type":"string","required":false,"example":"AAAAAdDWBF2****"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3****"},"NextToken":{"description":"本次调用返回的查询凭证值。","type":"string","example":"AAAAAdDWBF2****"},"Sessions":{"type":"object","properties":{"Session":{"description":"会话列表。","type":"array","items":{"description":"会话信息。","type":"object","properties":{"CreationTime":{"description":"会话的创建时间。","type":"string","example":"2024-01-19T09:15:46Z"},"TargetServer":{"description":"通过实例访问VPC内的目标服务地址。","type":"string","example":"192.168.0.246"},"PortNumber":{"description":"ECS实例的端口号，用于数据转发。若未设置数据转发的端口号，则该值为空。","type":"integer","format":"int32","example":"22"},"PrincipalId":{"description":"身份标识。按照身份类型`IdentityType`，取值如下：\n- 当前调用者是阿里云账号：返回阿里云账号ID。\n- 当前调用者是RAM用户：返回RAM用户ID。\n- 当前调用者是角色扮演：返回角色扮演实际委托人ID。","type":"string","example":"123456xxxx"},"Username":{"description":"连接时的用户名。","type":"string","example":"root"},"ClientIP":{"description":"远程连接的客户IP。","type":"string","example":"192.168.1.1"},"IdentityType":{"description":"身份类型。当前支持的身份类型包括：\n- Account：阿里云账号（主账号）。\n- RAMUser：RAM用户。\n- AssumedRoleUser：RAM角色。","type":"string","example":"RAMUser"},"SessionId":{"description":"会话ID。","type":"string","example":"s-hz023od0x9****"},"Connections":{"type":"object","properties":{"Connection":{"description":"连接信息列表。","type":"array","items":{"description":"连接信息。","type":"object","properties":{"ClosedReason":{"description":"连接结束原因。\n仅在状态（`Status`）为`Disconnected`、`Terminated`、`Failed`时返回该参数。可能值：\n- InstanceNotExists：指定的实例不存在或已释放。\n- InstanceNotRunning：该实例不在运行中。\n- DeliveryTimeout：连接超时。\n- AgentNeedUpgrade：云助手 Agent 需要升级。\n- AgentNotOnline：云助手Agent未连接到服务器。\n- MessageFormatInvalid：消息格式不合法。\n- AgentSocketClosed：连接正常关闭。\n- ClientClosed：会话管理客户端关闭了连接。","type":"string","example":"AgentNeedUpgrade"},"EndTime":{"description":"连接结束时间。","type":"string","example":"2024-01-19T09:16:46Z"},"Status":{"description":"会话状态，可能值：\n- Connecting：连接中。\n- Connected：已连接。\n- Disconnected：连接断开。\n- Terminating：会话终止中。\n- Terminated：会话已终止。\n- Failed：连接失败。","type":"string","example":"Connecting"},"StartTime":{"description":"连接开始时间。","type":"string","example":"2024-01-19T09:16:40Z"},"InstanceId":{"description":"实例ID。","type":"string","example":"i-bp1i7gg30r52z2em****"}}}}}}}}}}}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParameter.NextToken","errorMessage":"The specified parameter NextToken is not valid."},{"errorCode":"InvalidParameter.MaxResults","errorMessage":"The specified parameter MaxResults is not valid."}],"404":[{"errorCode":"InvalidRegionId.NotFound","errorMessage":"The specified parameter RegionId does not exist."}],"500":[{"errorCode":"InternalError","errorMessage":"An error occurred when you dispatched the request."}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3****\\\",\\n  \\\"NextToken\\\": \\\"AAAAAdDWBF2****\\\",\\n  \\\"Sessions\\\": {\\n    \\\"Session\\\": [\\n      {\\n        \\\"CreationTime\\\": \\\"2024-01-19T09:15:46Z\\\",\\n        \\\"TargetServer\\\": \\\"192.168.0.246\\\",\\n        \\\"PortNumber\\\": 22,\\n        \\\"PrincipalId\\\": \\\"123456xxxx\\\",\\n        \\\"Username\\\": \\\"root\\\",\\n        \\\"ClientIP\\\": \\\"192.168.1.1\\\",\\n        \\\"IdentityType\\\": \\\"RAMUser\\\",\\n        \\\"SessionId\\\": \\\"s-hz023od0x9****\\\",\\n        \\\"Connections\\\": {\\n          \\\"Connection\\\": [\\n            {\\n              \\\"ClosedReason\\\": \\\"AgentNeedUpgrade\\\",\\n              \\\"EndTime\\\": \\\"2024-01-19T09:16:46Z\\\",\\n              \\\"Status\\\": \\\"Connecting\\\",\\n              \\\"StartTime\\\": \\\"2024-01-19T09:16:40Z\\\",\\n              \\\"InstanceId\\\": \\\"i-bp1i7gg30r52z2em****\\\"\\n            }\\n          ]\\n        }\\n      }\\n    ]\\n  }\\n}\",\"type\":\"json\"}]","title":"查看Session Manager会话历史记录","description":"支持查看4周内创建的Session Manager会话记录。"}