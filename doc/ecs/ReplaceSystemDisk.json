{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"update","abilityTreeCode":"29160","abilityTreeNodes":["FEATUREecsTKAXF8"]},"parameters":[{"name":"InstanceId","in":"query","schema":{"description":"指定实例的ID。","type":"string","required":true,"docRequired":true,"example":"i-bp67acfmxazb4ph****"}},{"name":"ImageId","in":"query","schema":{"description":"重置系统时使用的镜像ID。\n\n未设置`DiskId`参数时，该参数为必选参数。","type":"string","required":false,"example":"m-bp67acfmxazb4ph****"}},{"name":"SystemDisk.Size","in":"query","schema":{"description":"新的系统盘容量，单位为GiB。取值范围：\n\n- 普通云盘：Max{20, 参数ImageId对应的镜像大小}~500。\n- ESSD云盘：\n  - PL0：Max{1, 参数 ImageId 对应的镜像大小}~2048。\n  - PL1：Max{20, 参数 ImageId 对应的镜像大小}~2048。\n  - PL2：Max{461, 参数 ImageId 对应的镜像大小}~2048。\n  - PL3：Max{1261, 参数 ImageId 对应的镜像大小}~2048。\n- ESSD AutoPL 云盘：Max{1, 参数 ImageId 对应的镜像大小}~2048。\n- 其他云盘：Max{20, 参数ImageId对应的镜像大小}~2048。\n\n默认值：Max{40, 参数ImageId对应的镜像大小}\n\n> 超过`Max{20, 更换前的系统盘容量}`的云盘容量部分，将收取额外费用。","type":"integer","format":"int32","required":false,"example":"80"}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。**ClientToken**只支持ASCII字符，且不能超过64个字符。更多信息，请参见[如何保证幂等性](~~25693~~)。","type":"string","required":false,"example":"123e4567-e89b-12d3-a456-426655440000"}},{"name":"UseAdditionalService","in":"query","schema":{"description":"是否使用阿里云提供的虚拟机系统配置（Windows：NTP、KMS；Linux：NTP、YUM）。\n\n> 挂载系统盘时（即设备名为/dev/xvda）有效。","type":"boolean","required":false,"example":"true"}},{"name":"Password","in":"query","schema":{"description":"是否重置ECS实例的用户名密码。长度为8至30个字符，必须同时包含大小写英文字母、数字和特殊符号中的三类字符。特殊符号可以是：\n\n```\n()`~!@#$%^&*-_+=|{}[]:;'<>,.?/\n```\n\n其中，Windows实例不能以斜线号（/）为密码首字符。\n\n默认值：保持不变。\n\n> 如果传入`Password`参数，建议您使用HTTPS协议发送请求，避免密码泄露。","type":"string","required":false,"example":"EcsV587!"}},{"name":"PasswordInherit","in":"query","schema":{"description":"是否使用镜像预设的密码。\n\n默认值：false。\n\n> 使用该参数时，Password参数必须为空。同时您需要确保使用的镜像已经设置了密码。 \n\n","type":"boolean","required":false,"example":"false"}},{"name":"KeyPairName","in":"query","schema":{"description":"密钥对名称。 \n\n> 该参数仅对Linux系统ECS实例生效。您可以为ECS实例绑定一个SSH密钥对，作为登录凭证。使用了SSH密钥对后，用户名密码的登录凭证方式将被禁用。","type":"string","required":false,"example":"testKeyPairName"}},{"name":"DiskId","in":"query","schema":{"description":"> 该参数已废弃，为提高兼容性，建议您使用 `ImageId`。","type":"string","required":false,"example":"d-bp67acfmxazb4ph****"}},{"name":"Platform","in":"query","schema":{"description":"> 已弃用。","type":"string","required":false,"example":"CentOS"}},{"name":"Architecture","in":"query","schema":{"description":"> 已弃用。","type":"string","required":false,"example":"i386"}},{"name":"SecurityEnhancementStrategy","in":"query","schema":{"description":"更换系统盘后，是否免费使用云安全中心服务。取值范围： \n\n- Active：使用。该值仅支持公共镜像。\n\n- Deactive：不使用。该值支持所有镜像。\n\n默认值：Deactive。","type":"string","required":false,"example":"Active"}},{"name":"Encrypted","in":"query","schema":{"description":"是否加密云盘。取值范围：\n\n- true：是。\n\n- false：否。\n\n\n默认值：false。","type":"boolean","required":false,"example":"false"}},{"name":"KMSKeyId","in":"query","schema":{"description":"系统盘对应的KMS密钥ID。","type":"string","required":false,"example":"e522b26d-abf6-4e0d-b5da-04b7******3c","maxLength":64}},{"name":"EncryptAlgorithm","in":"query","schema":{"description":">该参数暂未开放使用。","type":"string","required":false,"example":"hide"}},{"name":"Arn","in":"query","style":"repeatList","schema":{"description":"该参数暂未开放使用。","type":"array","items":{"type":"object","properties":{"RoleType":{"description":">该参数暂未开放使用。","type":"string","required":false,"example":"null"},"Rolearn":{"description":">该参数暂未开放使用。","type":"string","required":false,"example":"null"},"AssumeRoleFor":{"description":">该参数暂未开放使用。","type":"integer","format":"int64","required":false,"example":"0"}},"required":false},"required":false,"maxItems":10}}],"responses":{"200":{"schema":{"type":"object","properties":{"DiskId":{"description":"新系统盘的云盘ID。","type":"string","example":"d-bp67acfmxazb4ph****"},"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E"}}}}},"errorCodes":{"400":[{"errorCode":"LoginAsNonRoot.ImageNotSupport","errorMessage":"The specified image does not support login as non-root."},{"errorCode":"InvalidSystemDiskSize.ValueNotSupported","errorMessage":"The specified parameter SystemDisk.Size is invalid."},{"errorCode":"InvalidParameter.Conflict","errorMessage":"The specified image does not support the specified instance type."},{"errorCode":"InvalidSystemDiskSize.ImageNotSupportResize","errorMessage":"The specified image does not support resize."},{"errorCode":"InvalidSystemDiskSize","errorMessage":"The specified parameter SystemDisk.Size is invalid."},{"errorCode":"InvalidPassword.Malformed","errorMessage":"The specified parameter \"Password\" is not valid."},{"errorCode":"InvalidPasswordParam.Mismatch","errorMessage":"The input password should be null when passwdInherit is true."},{"errorCode":"OperationDenied","errorMessage":"The specified image contains the snapshot of the data disk,does not support this operation."},{"errorCode":"InvalidDiskCategory.ValueNotSupported","errorMessage":"The specified parameter \"DiskCategory\" is not valid."},{"errorCode":"InvalidKeyPairName.NotFound","errorMessage":"The specified KeyPairName does not exist."},{"errorCode":"DependencyViolation.IoOptimize","errorMessage":"The specified parameter InstanceId is not valid."},{"errorCode":"MissingParameter.Architecture","errorMessage":"Architecture should not be null."},{"errorCode":"InvalidArchitecture.Malformed","errorMessage":"Architecture is not valid."},{"errorCode":"MissingParameter.Platform","errorMessage":"Platform should not be null."},{"errorCode":"InvalidPlatform.Malformed","errorMessage":"Platform is not valid."},{"errorCode":"InvalidParameter.AllEmpty","errorMessage":"%s"},{"errorCode":"InvalidDiskId.NotFound","errorMessage":"The specified disk do not exist."},{"errorCode":"InvalidDatadisk.DiskStatusViolation","errorMessage":"The operation is not permitted due to status of the Datadisk."},{"errorCode":"InvalidDatadisk.DiskCategoryViolation","errorMessage":"The operation is not permitted due to category of the Datadisk."},{"errorCode":"InvalidDatadisk.ChargeTypeViolation","errorMessage":"The operation is not permitted due to charge type of the Datadisk."},{"errorCode":"MissingParameter","errorMessage":"The input parameter \"ImageId\" that is mandatory for processing this request is not supplied."},{"errorCode":"InvalidInstance.NotFoundSystemDisk","errorMessage":"The specified instance has no system disk."},{"errorCode":"InvalidParameter.DiskType","errorMessage":"The specified disk type which has kms key can't convert to system disk."},{"errorCode":"DISK_IN_DEDICATED_BLOCK_STORAGE_CLUSTER","errorMessage":"The disk in dedicated block storage cluster is not allowed to do this operation."},{"errorCode":"IncorrectDiskStatus.ReplicationStatusNotFound","errorMessage":"Disk replication status not found."},{"errorCode":"IncorrectDiskStatus.InReplication","errorMessage":"Disk already in replication."},{"errorCode":"InvalidInstanceType.NotSupported","errorMessage":"The specified instanceType is not supported by the image architecture."},{"errorCode":"InvalidRegionId.NotSupportReplaceEncryptedSystemDisk","errorMessage":"The specified region not support replace encrypted system disk."},{"errorCode":"InvalidStorageClusterId.CapacityNotEnough","errorMessage":"The remaining capacity of the current dedicated storage cluster is less than the size of disk."},{"errorCode":"QuotaExceed.DiskCapacity","errorMessage":"The used capacity of disk type has exceeded the quota in the zone,  %s."}],"403":[{"errorCode":"LoginAsNonRoot.RegionNotSupport","errorMessage":"The specified region does not support login as non-root."},{"errorCode":"InvalidSystemDiskStatus.IsTransfering","errorMessage":"The current status of the resource does not support this operation, system disk is transfering."},{"errorCode":"IncorrectDiskStatus","errorMessage":"The current disk status does not support this operation."},{"errorCode":"IncorrectInstanceStatus","errorMessage":"The current status of the resource does not support this operation."},{"errorCode":"InstanceLockedForSecurity","errorMessage":"The instance is locked due to security."},{"errorCode":"ImageNotSubscribed","errorMessage":"The specified image has not be subscribed."},{"errorCode":"ImageRemovedInMarket","errorMessage":"The specified market image is not available, Or the specified user defined image includes product code because it is based on an image subscribed from marketplace, and that image in marketplace includeing exact the same product code has been removed."},{"errorCode":"InstanceExpiredOrInArrears","errorMessage":"The specified operation is denied as your prepay instance is expired (prepay mode) or in arrears (afterpay mode)."},{"errorCode":"ChargeTypeViolation","errorMessage":"The operation is not permitted due to charge type of the instance."},{"errorCode":"DiskCreatingSnapshot","errorMessage":"The operation is denied due to a snapshot of the specified disk is not completed yet."},{"errorCode":"IoOptimized.NotSupported","errorMessage":"The specified image is not support IoOptimized Instance."},{"errorCode":"ImageNotSupportInstanceType","errorMessage":"The specified image don not support the InstanceType instance."},{"errorCode":"QuotaExceed.BuyImage","errorMessage":"The specified image is from the image market,You have not bought it or your quota has been exceeded."},{"errorCode":"INST_HAS_UNPAID_ORDER","errorMessage":"The instance has unpaid order."},{"errorCode":"OperationDenied.InstanceCreating","errorMessage":"The specified instance is creating."},{"errorCode":"DependencyViolation.WindowsInstance","errorMessage":"The instance creating is windows, cannot use ssh key pair to login."},{"errorCode":"InvalidParameter.NotMatch","errorMessage":"%s"},{"errorCode":"ResourcesNotInSameZone","errorMessage":"The specified instance and disk are not in the same zone."},{"errorCode":"OperationDenied.UnpaidOrder","errorMessage":"The specified instance has unpaid order."},{"errorCode":"InvalidHostname.MismatchImage","errorMessage":"The hostname of the current instance can not be applied to the image you choose."},{"errorCode":"OperationDenied.ImageNotValid","errorMessage":"%s"},{"errorCode":"HibernationConfigured.InstanceOperationForbidden","errorMessage":"The operation is not permitted due to limit of the hibernation configured instance."},{"errorCode":"InvalidOperation.MultiAttachDisk","errorMessage":"Multi attach disk does not support this operation."},{"errorCode":"InvalidRegionId.NotSupportEncryptAlgorithm","errorMessage":"The current region does not support creating encrypted disks with EncryptAlgorithm."},{"errorCode":"InvalidRegionId.NotExists","errorMessage":"The region not exists."},{"errorCode":"InvalidEncryptAlgorithm","errorMessage":"The specified parameter EncryptAlgorithm is not valid."},{"errorCode":"InvalidEncrypted.NotMatchKmsKeyId","errorMessage":"The specified parameter Encrypted must be true when KmsKeyId is not empty."},{"errorCode":"InvalidEncrypted.NotMatchEncryptAlgorithm","errorMessage":"The specified parameter Encrypted must be true when EncryptAlgorithm is not empty."},{"errorCode":"InvalidParameter.KmsNotEnabled","errorMessage":"The specified operation need enable KMS."},{"errorCode":"InvalidParameter.DataEncryptedKeyCreateFailed","errorMessage":"Create kms data encrypted key fail. If you need further assistance, you can contact the KMS Technical Support."},{"errorCode":"InvalidParameter.KMSKeyId.NotFound","errorMessage":"The specified KMSKeyId does not exist."},{"errorCode":"InvalidParameter.KMSKeyId.CMKUnauthorized","errorMessage":"This operation for kmsKeyId is forbidden by KMS. If you need further assistance, you can contact the KMS Technical Support."},{"errorCode":"InvalidParameter.KMSKeyId.CMKNotEnabled","errorMessage":"The CMK needs to be enabled."},{"errorCode":"InvalidParameter.KMSKeyId.KMSUnauthorized","errorMessage":"ECS service have no right to access your KMS."},{"errorCode":"InvalidKMSKeyId.NotSymmetric","errorMessage":"The specified parameter KmsKeyId must be symmetric."},{"errorCode":"InvalidDiskId.NotSupportReplaceEncryptedSystemDisk","errorMessage":"The specified diskId not support replace encrypted system disk."},{"errorCode":"NotSupportSnapshotEncrypted.DiskCategory","errorMessage":"The specified disk category does not support creating encrypted system disks or creating encrypted data disks from snapshots. Check the DiskCategory or Encrypted parameter, or check your account for default encryption settings."},{"errorCode":"InvalidEncrypted.DefaultEncryptionUnsupported","errorMessage":"The specified parameter Encrypted must be true when default encryption is enabled."}],"404":[{"errorCode":"InvalidInstanceId.NotFound","errorMessage":"The specified InstanceId does not exist."},{"errorCode":"InvalidImageId.NotFound","errorMessage":"The specified ImageId does not exist."},{"errorCode":"InvalidSystemDiskSize.MoreThanMaxSize","errorMessage":"The specified SystemDisk.Size parameter exceeds the maximum size."},{"errorCode":"InvalidSystemDiskSize.LessThanImageSize","errorMessage":"The specified parameter SystemDisk.Size is less than the image size."},{"errorCode":"InvalidSystemDiskSize.LessThanMinSize","errorMessage":"The specified parameter SystemDisk.Size is less than the min size."},{"errorCode":"NoSuchResource","errorMessage":"The specified resource is not found."}],"500":[{"errorCode":"OperationDenied","errorMessage":"Internal Error."},{"errorCode":"InternalError","errorMessage":"The request processing has failed due to some unknown error."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"DiskId\\\": \\\"d-bp67acfmxazb4ph****\\\",\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E\\\"\\n}\",\"errorExample\":\"{\\n    \\\"RequestId\\\":\\\"337568C5-64F3-4B76-8CDD-D3D8C57B5B8C\\\",\\n    \\\"DiskId\\\":\\\"d-j6cam2z21u4ks3dj6flb\\\"\\n}\"},{\"type\":\"xml\",\"example\":\"<ReplaceSystemDiskResponse>\\n    <DiskId>d-bp67acfmxazb4ph****</DiskId>\\n    <RequestId>F3CD6886-D8D0-4FEE-B93E-1B73239673DE</RequestId>\\n</ReplaceSystemDiskResponse>\",\"errorExample\":\"<ReplaceSystemDiskResponse>\\n    <DiskId>d-23jbf2v5m</DiskId>\\n    <RequestId>F3CD6886-D8D0-4FEE-B93E-1B73239673DE</RequestId>\\n</ReplaceSystemDiskResponse>\"}]","title":"更换操作系统","summary":"调用ReplaceSystemDisk更换一台ECS实例的操作系统。系统盘的云盘ID会发生变化，原云盘会被释放。","description":"## 接口说明\n\n更换系统盘时，您需要注意：\n\n- 不支持更换系统盘的云盘类型。\n\n- 不支持变更系统盘计费方式。\n \n- 实例的状态必须为已停止（`Stopped`）状态。\n\n    > 仅适用于专有网络VPC类型实例。如果ECS实例为按量付费计费模式，且开启默认启用节省停机模式，为防止地域范围内的ECS实例库存不足，引起的更换系统盘后无法重启实例。您需要在停止该实例时设置为普通停机模式。具体操作，请参见[StopInstance](~~25501~~)。  \n\n- ECS实例不能被安全锁定，即实例的`OperationLocks`参数值包含`\"LockReason\": \"security\"`。更多信息，请参见[安全锁定时的API行为](~~25695~~)。\n\n- 系统盘挂载的ECS实例不能有未支付的订单。 \n\n- 您可以通过参数`SystemDisk.Size`重新指定系统盘的容量大小。\n\n更换系统盘后，建议您通过以下任一方式验证是否更换成功：\n\n- 通过[DescribeDisks](~~25514~~)接口查询新系统盘的状态。如果已挂载实例，则表示更换系统盘的操作已完成。\n\n- 通过[DescribeInstances](~~25506~~)接口查询更换系统盘的实例的状态。如果返回值`OperationLocks`为空，则表示更换系统盘的操作已完成。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}