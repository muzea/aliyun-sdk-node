{"summary":"调用AuthorizeSecurityGroup增加一条或多条入方向安全组规则。指定安全组入方向的访问权限，允许或者拒绝其他设备发送入方向流量到安全组里的实例。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"29244","abilityTreeNodes":["FEATUREecsN1X6QX"]},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"安全组所属地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。 ","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"RegionId","in":"query","schema":{"description":"安全组所属地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。 ","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"RegionId","in":"query","schema":{"description":"安全组所属地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。 ","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。**ClientToken**只支持ASCII字符，且不能超过64个字符。更多信息，请参见[如何保证幂等性](~~25693~~)。","type":"string","required":false,"example":"123e4567-e89b-12d3-a456-426655440000"}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。**ClientToken**只支持ASCII字符，且不能超过64个字符。更多信息，请参见[如何保证幂等性](~~25693~~)。","type":"string","required":false,"example":"123e4567-e89b-12d3-a456-426655440000"}},{"name":"SecurityGroupId","in":"query","schema":{"description":"安全组ID。","type":"string","required":true,"docRequired":true,"example":"sg-bp67acfmxazb4p****"}},{"name":"SecurityGroupId","in":"query","schema":{"description":"安全组ID。","type":"string","required":true,"docRequired":true,"example":"sg-bp67acfmxazb4p****"}},{"name":"Permissions","in":"query","style":"flat","schema":{"description":"安全组规则列表。N的取值范围：1~100。","type":"array","items":{"description":"安全组规则列表。N的取值范围：1~100。","type":"object","properties":{"Policy":{"description":"设置访问权限。取值范围：\n\n- accept：接受访问。\n\n- drop：拒绝访问，不返回拒绝信息，表现为发起端请求超时或者无法建立连接的类似信息。\n\n默认值：accept。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"accept"},"Priority":{"description":"安全组规则优先级，数字越小，代表优先级越高。取值范围：1~100。\n\n默认值：1。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"1"},"IpProtocol":{"description":"传输层协议。取值不区分大小写。取值范围：\n\n- TCP。\n- UDP。\n- ICMP。\n- ICMPv6。\n- GRE。\n- ALL：支持所有协议。\n\nN的取值范围：1~100。\n\n","type":"string","required":false,"example":"ALL"},"SourceCidrIp":{"description":"需要设置访问权限的源端IPv4 CIDR地址段。支持CIDR格式和IPv4格式的IP地址范围。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"10.0.0.0/8"},"Ipv6SourceCidrIp":{"description":"需要设置访问权限的源端IPv6 CIDR地址段。支持CIDR格式和IPv6格式的IP地址范围。\n\nN的取值范围：1~100。\n\n> 仅在支持IPv6的VPC类型ECS实例上有效，且该参数与`SourceCidrIp`参数不可同时设置。","type":"string","required":false,"example":"2001:250:6000::***"},"SourceGroupId":{"description":"需要设置访问权限的源端安全组ID。\n\n- 至少设置`SourceGroupId`、`SourceCidrIp`、`Ipv6SourceCidrIp`或`SourcePrefixListId`参数中的一项。\n\n- 如果指定了`SourceGroupId`，没有指定参数`SourceCidrIp`或`Ipv6SourceCidrIp`，则参数`NicType`取值只能为`intranet`。\n\n- 如果同时指定了`SourceGroupId`和`SourceCidrIp`，则默认以`SourceCidrIp`为准。\n\nN的取值范围：1~100。\n\n您需要注意：\n\n- 企业安全组不支持授权安全组访问。\n\n- 普通安全组支持授权的安全组数量最多为20个。","type":"string","required":false,"example":"sg-bp67acfmxazb4p****"},"SourcePrefixListId":{"description":"需要设置访问权限的源端前缀列表ID。您可以调用[DescribePrefixLists](~~205046~~)查询可以使用的前缀列表ID。\n\nN的取值范围：1~100。\n\n注意事项：\n\n- 安全组的网络类型为经典网络时，不支持设置前缀列表。关于安全组以及前缀列表使用限制的更多信息，请参见[安全组使用限制](~~25412#SecurityGroupQuota1~~)。\n\n- 当您指定了`SourceCidrIp`、`Ipv6SourceCidrIp`或`SourceGroupId`参数中的一个时，将忽略该参数。","type":"string","required":false,"example":"pl-x1j1k5ykzqlixdcy****"},"PortRange":{"description":"安全组开放的传输层协议相关的目的端口范围。取值范围：\n\n- TCP/UDP：取值范围为1~65535。使用正斜线（/）隔开起始端口和终止端口。例如：1/200。\n- ICMP：-1/-1。\n- GRE：-1/-1。\n- IpProtocol取值为ALL：-1/-1。\n\n了解端口的应用场景，请参见[典型应用的常用端口](~~40724~~)。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"80/80"},"DestCidrIp":{"description":"目的端IPv4 CIDR地址段。支持CIDR格式和IPv4格式的IP地址范围。\n\n用于支持五元组规则，请参见[安全组五元组规则](~~97439~~)。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"10.0.0.0/8"},"Ipv6DestCidrIp":{"description":"目的端IPv6 CIDR地址段。支持CIDR格式和IPv6格式的IP地址范围。\n\n用于支持五元组规则，请参见[安全组五元组规则](~~97439~~)。\n\nN的取值范围：1~100。\n\n> 仅在支持IPv6的VPC类型ECS实例上有效，且该参数与`DestCidrIp`参数不可同时设置。","type":"string","required":false,"example":"2001:250:6000::***"},"SourcePortRange":{"description":"安全组开放的传输层协议相关的源端端口范围。取值范围：\n\n- TCP/UDP协议：取值范围为1~65535。使用正斜线（/）隔开起始端口和终止端口。例如：1/200。\n- ICMP协议：-1/-1。\n- GRE协议：-1/-1。\n- IpProtocol取值为ALL：-1/-1。\n\n用于支持五元组规则，请参见[安全组五元组规则](~~97439~~)。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"7000/8000"},"SourceGroupOwnerAccount":{"description":"跨账户设置安全组规则时，源端安全组所属的阿里云账户。\n\n- 如果`SourceGroupOwnerAccount`及`SourceGroupOwnerId`均未设置，则认为是设置您其他安全组的访问权限。\n\n- 如果已经设置参数`SourceCidrIp`，则参数`SourceGroupOwnerAccount`无效。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"test@aliyun.com"},"SourceGroupOwnerId":{"description":"跨账户设置安全组规则时，源端安全组所属的阿里云账户ID。\n\n- 如果`SourceGroupOwnerAccount`及`SourceGroupOwnerId`均未设置，则认为是设置您其他安全组的访问权限。\n\n- 如果已经设置参数`SourceCidrIp`，则参数`SourceGroupOwnerAccount`无效。\n\nN的取值范围：1~100。","type":"integer","format":"int64","required":false,"example":"1234567890"},"NicType":{"description":"经典网络类型安全组规则的网卡类型。取值范围：\n\n- internet：公网网卡。\n\n- intranet：内网网卡。\n\n专有网络VPC类型安全组规则无需设置网卡类型，默认为intranet，只能为intranet。\n\n设置安全组之间互相访问时，即仅指定了DestGroupId参数时，只能为intranet。\n\n默认值：internet。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"intranet"},"Description":{"description":"安全组规则的描述信息。长度为1~512个字符。\n\nN的取值范围：1~100。","type":"string","required":false,"example":"This is description."}},"required":false},"required":false,"maxItems":100}},{"name":"Policy","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.Policy`来设置访问权限。","type":"string","deprecated":true,"required":false,"example":"accept"}},{"name":"Priority","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.Priority`来指定安全组规则优先级。","type":"string","deprecated":true,"required":false,"example":"1"}},{"name":"IpProtocol","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.IpProtocol`来指定传输层协议。","type":"string","deprecated":true,"required":false,"docRequired":false,"example":"ALL"}},{"name":"SourceCidrIp","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.SourceCidrIp`来指定源端IPv4 CIDR地址块。","type":"string","deprecated":true,"required":false,"example":"10.0.0.0/8"}},{"name":"Ipv6SourceCidrIp","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.Ipv6SourceCidrIp`来指定源端IPv6 CIDR地址块。","type":"string","deprecated":true,"required":false,"example":"2001:250:6000::***"}},{"name":"SourceGroupId","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.SourceGroupId`来指定源端安全组ID。","type":"string","deprecated":true,"required":false,"example":"sg-bp67acfmxazb4p****"}},{"name":"SourcePrefixListId","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.SourcePrefixListId`来指定源端前缀列表ID。","type":"string","deprecated":true,"required":false,"example":"pl-x1j1k5ykzqlixdcy****"}},{"name":"PortRange","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.PortRange`来指定端口范围。","type":"string","deprecated":true,"required":false,"docRequired":false,"example":"22/22"}},{"name":"DestCidrIp","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.DestCidrIp`来指定目的端IPv4 CIDR地址段。","type":"string","deprecated":true,"required":false,"example":"10.0.0.0/8"}},{"name":"Ipv6DestCidrIp","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.Ipv6SourceCidrIp`来指定源端IPv6 CIDR地址块。","type":"string","deprecated":true,"required":false,"example":"2001:250:6000::***"}},{"name":"SourcePortRange","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.SourcePortRange`来指定源端端口范围。","type":"string","deprecated":true,"required":false,"example":"22/22"}},{"name":"SourceGroupOwnerAccount","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.SourceGroupOwnerAccount`来指定源端安全组所属的阿里云账户。","type":"string","deprecated":true,"required":false,"example":"test@aliyun.com"}},{"name":"SourceGroupOwnerId","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.SourceGroupOwnerId`来指定源端安全组所属的阿里云账户ID。","type":"integer","format":"int64","deprecated":true,"required":false,"example":"1234567890"}},{"name":"NicType","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.NicType`来指定网卡类型。","type":"string","deprecated":true,"required":false,"example":"intranet"}},{"name":"Description","in":"query","schema":{"description":"已废弃。请使用`Permissions.N.Description`来指定安全组规则的描述。","type":"string","deprecated":true,"required":false,"example":"This is description."}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3****"}}}}},"errorCodes":{"400":[{"errorCode":"OperationDenied","errorMessage":"The specified IpProtocol does not exist or IpProtocol and PortRange do not match."},{"errorCode":"InvalidIpProtocol.Malformed","errorMessage":"The specified parameter PortRange is not valid."},{"errorCode":"InvalidSourceCidrIp.Malformed","errorMessage":"The specified parameter SourceCidrIp is not valid."},{"errorCode":"InvalidPolicy.Malformed","errorMessage":"The specified parameter Policy is not valid."},{"errorCode":"InvalidNicType.ValueNotSupported","errorMessage":"The specified NicType does not exist."},{"errorCode":"InvalidNicType.Mismatch","errorMessage":"The specified NicType conflicts with the authorization record."},{"errorCode":"InvalidSourceGroupId.Mismatch","errorMessage":"Specified security group and source group are not in the same VPC."},{"errorCode":"InvalidSourceGroup.NotFound","errorMessage":"Specified source security group does not exist."},{"errorCode":"InvalidPriority.Malformed","errorMessage":"The parameter Priority is invalid."},{"errorCode":"InvalidPriority.ValueNotSupported","errorMessage":"The specified parameter %s is invalid."},{"errorCode":"InvalidSecurityGroupDiscription.Malformed","errorMessage":"The specified security group rule description parameter %s is not valid."},{"errorCode":"InvalidSecurityGroup.InvalidNetworkType","errorMessage":"The specified security group network type is not support this operation, please check the security group network types. For VPC security groups, ClassicLink must be enabled."},{"errorCode":"MissingParameter.Source","errorMessage":"One of the parameters SourceCidrIp, Ipv6SourceCidrIp, SourceGroupId or SourcePrefixListId in %s must be specified."},{"errorCode":"InvalidParam.PortRange","errorMessage":"The specified parameter %s is not valid. It should be two integers less than 65535 in ?/? format."},{"errorCode":"InvalidIpProtocol.ValueNotSupported","errorMessage":"The parameter %s must be specified with case insensitive TCP, UDP, ICMP, GRE or All."},{"errorCode":"InvalidSecurityGroupId.Malformed","errorMessage":"The specified parameter SecurityGroupId is not valid."},{"errorCode":"InvalidParamter.Conflict","errorMessage":"The specified SourceCidrIp should be different from the DestCidrIp."},{"errorCode":"InvalidSourcePortRange.Malformed","errorMessage":"The specified parameter SourcePortRange is not valid."},{"errorCode":"InvalidPortRange.Malformed","errorMessage":"The specified parameter PortRange must set."},{"errorCode":"InvalidParam.SourceIp","errorMessage":"The Parameters SourceCidrIp and Ipv6SourceCidrIp in %s cannot be set at the same time."},{"errorCode":"InvalidParam.DestIp","errorMessage":"The Parameters DestCidrIp and Ipv6DestCidrIp in %s cannot be set at the same time."},{"errorCode":"InvalidParam.Ipv6DestCidrIp","errorMessage":"The specified parameter %s is not valid."},{"errorCode":"InvalidParam.Ipv6SourceCidrIp","errorMessage":"The specified parameter %s is not valid."},{"errorCode":"InvalidParam.Ipv4ProtocolConflictWithIpv6Address","errorMessage":"IPv6 address cannot be specified for IPv4-specific protocol."},{"errorCode":"InvalidParam.Ipv6ProtocolConflictWithIpv4Address","errorMessage":"IPv4 address cannot be specified for IPv6-specific protocol."},{"errorCode":"InvalidParameter.Ipv6CidrIp","errorMessage":"The specified Ipv6CidrIp is not valid."},{"errorCode":"InvalidGroupAuthParameter.OperationDenied","errorMessage":"The security group can not authorize to enterprise level security group."},{"errorCode":"InvalidDestCidrIp.Malformed","errorMessage":"The specified parameter DestCidrIp is not valid."},{"errorCode":"InvalidParameter.Conflict","errorMessage":"IPv6 and IPv4 addresses cannot exist at the same time."},{"errorCode":"InvalidParam.PrefixListAddressFamilyMismatch","errorMessage":"The address family of the specified prefix list does not match the specified CidrIp."},{"errorCode":"NotSupported.ClassicNetworkPrefixList","errorMessage":"The prefix list is not supported when the network type of security group is classic."},{"errorCode":"AuthorizedGroupRule.LimitExceed","errorMessage":"You have reached the limit on the number of group authorization rules that you can add to a security group.When authorization object of rule is security group, the limit is 20."},{"errorCode":"InvalidParam.SourceCidrIp","errorMessage":"The specified parameter %s is not valid."},{"errorCode":"InvalidParam.DestCidrIp","errorMessage":"The specified parameter %s is not valid."},{"errorCode":"MissingParameter","errorMessage":"%s"},{"errorCode":"InvalidParam.Permissions","errorMessage":"The specified parameter Permissions cannot coexist with other parameters."},{"errorCode":"InvalidParam.DuplicatePermissions","errorMessage":"There are duplicate permissions in the specified parameter Permissions."},{"errorCode":"InvalidGroupParameter.OperationDenied","errorMessage":"The attributes Policy, SourceGroupId, DestGroupId of enterprise level security groups are not allowed to be set or modified."}],"403":[{"errorCode":"InvalidSourceGroupId.Mismatch","errorMessage":"NicType is required or NicType expects intranet."},{"errorCode":"MissingParameter","errorMessage":"The input parameter SourceGroupId or SourceCidrIp cannot be both blank."},{"errorCode":"AuthorizationLimitExceed","errorMessage":"The limit of authorization records in the security group reaches."},{"errorCode":"InvalidParamter.Conflict","errorMessage":"The specified SecurityGroupId should be different from the SourceGroupId."},{"errorCode":"InvalidNetworkType.Mismatch","errorMessage":"The specified SecurityGroup network type should be same with SourceGroup network type (vpc or classic)."},{"errorCode":"InvalidNetworkType.Conflict","errorMessage":"The specified SecurityGroup network type should be same with SourceGroup network type (vpc or classic)."},{"errorCode":"InvalidOperation.ResourceManagedByCloudProduct","errorMessage":"%s"},{"errorCode":"LimitExceed.PrefixListAssociationResource","errorMessage":"The number of resources associated with the prefix list exceeds the limit."}],"404":[{"errorCode":"InvalidSecurityGroupId.NotFound","errorMessage":"The specified SecurityGroupId does not exist."},{"errorCode":"InvalidSourceGroupId.NotFound","errorMessage":"The SourceGroupId provided does not exist in our records."},{"errorCode":"InvalidPrefixListId.NotFound","errorMessage":"The specified prefix list was not found."}],"500":[{"errorCode":"InternalError","errorMessage":"The request processing has failed due to some unknown error."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3****\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<AuthorizeSecurityGroupResponse>\\n    <RequestId>473469C7-AA6F-4DC5-B3DB-A3DC0DE3****</RequestId>\\n</AuthorizeSecurityGroupResponse>\",\"errorExample\":\"\"}]","title":"增加安全组入方向规则","description":"安全组的API文档中，流量的发起端为源端（Source），数据传输的接收端为目的端（Dest）。\n\n调用该接口时，您需要了解：\n\n- 出方向和入方向安全组规则数量不能超过200条。具体限制请参见[安全组使用限制](~~25412#SecurityGroupQuota1~~)。  \n\n- 安全组规则优先级（Priority）可选范围为1~100。数字越小，代表优先级越高。\n\n- 优先级相同的安全组规则，以拒绝访问（drop）的规则优先。\n\n- 源端设备可以是指定的IP地址范围（SourceCidrIp、Ipv6SourceCidrIp、SourcePrefixListId），也可以是其他安全组（SourceGroupId）中的ECS实例。\n\n- 企业安全组不支持授权其他安全组访问。\n\n- 普通安全组支持授权的安全组数量最多为20个。\n\n- 如果指定的安全组规则已存在，此次调用成功，但不会增加规则。\n\n- `Permissions.N`前缀的字段和对应不带前缀的字段不能同时指定，建议您使用`Permissions.N`前缀的字段。\n\n- 以下任意一组参数可以确定一条安全组规则，只指定一个参数无法确定一条安全组规则。 \n\n    - 设置指定IP地址段的访问权限。此时，VPC类型安全组的网卡类型（NicType）应设置为内网（intranet）。经典网络类型安全组的网卡类型（NicType）可设置为公网（internet）或内网（intranet）。如以下请求示例：IpProtocol、PortRange、（可选）SourcePortRange、NicType、Policy和SourceCidrIp。\n\n        ```\n        http(s)://ecs.aliyuncs.com/?Action=AuthorizeSecurityGroup\n        &SecurityGroupId=sg-bp67acfmxazb4p****\n        &Permissions.1.SourceCidrIp=10.0.0.0/8\n        &Permissions.1.IpProtocol=TCP\n        &Permissions.1.PortRange=22/22\n        &Permissions.1.NicType=intranet\n        &Permissions.1.Policy=Accept\n        &<公共请求参数>\n        ```\n\n    - 设置其他安全组的访问权限。此时，网卡类型（NicType）只能为内网（intranet）。经典网络类型安全组之间互访时，可以设置同一地域中其他安全组对您的安全组的访问权限。这个安全组可以是您的也可以是其他阿里云账户（SourceGroupOwnerAccount）的。VPC类型安全组之间互访时，可以设置同一VPC内其他安全组访问该安全组的访问权限。如以下请求示例：IpProtocol、PortRange、（可选）SourcePortRange、NicType、Policy、SourceGroupOwnerAccount和SourceGroupId。\n\n        ```\n        http(s)://ecs.aliyuncs.com/?Action=AuthorizeSecurityGroup\n        &SecurityGroupId=sg-bp67acfmxazb4p****\n        &Permissions.1.SourceGroupId=sg-1651FBB**\n        &Permissions.1.SourceGroupOwnerAccount=test@aliyun.com\n        &Permissions.1.IpProtocol=TCP\n        &Permissions.1.PortRange=22/22\n        &Permissions.1.NicType=intranet\n        &Permissions.1.Policy=Drop\n        &<公共请求参数>\n        ```\n\n    - 在安全组规则中设置前缀列表的访问权限。此时，前缀列表仅支持网络类型为VPC的安全组，网卡类型（NicType）只可设置为内网（intranet）。如以下请求示例：IpProtocol、PortRange、（可选）SourcePortRange、NicType、Policy和SourcePrefixListId。\n\n        ```\n        http(s)://ecs.aliyuncs.com/?Action=AuthorizeSecurityGroup\n        &SecurityGroupId=sg-bp67acfmxazb4p****\n        &Permissions.1.SourcePrefixListId=pl-x1j1k5ykzqlixdcy****\n        &Permissions.1.SourceGroupOwnerAccount=test@aliyun.com\n        &Permissions.1.IpProtocol=TCP\n        &Permissions.1.PortRange=22/22\n        &Permissions.1.NicType=intranet\n        &Permissions.1.Policy=Drop\n        &<公共请求参数>\n       ```\n\n- 更多关于安全组规则的设置示例，请参见[应用案例](~~25475~~)和[安全组五元组规则介绍](~~97439~~)。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}