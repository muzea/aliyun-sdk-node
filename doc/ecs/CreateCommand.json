{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"29249","abilityTreeNodes":["FEATUREecsXZ3H4M"]},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。 ","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"RegionId","in":"query","schema":{"description":"地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。 ","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"Name","in":"query","schema":{"description":"命令名称，支持全字符集。长度不得超过128个字符。","type":"string","required":true,"example":"testName"}},{"name":"Description","in":"query","schema":{"description":"命令描述，支持全字符集。长度不得超过512个字符。","type":"string","required":false,"example":"testDescription"}},{"name":"Type","in":"query","schema":{"description":"命令的类型。取值范围： \n\n- RunBatScript：创建一个在Windows实例中运行的Bat脚本。\n- RunPowerShellScript：创建一个在Windows实例中运行的PowerShell脚本。\n- RunShellScript：创建一个在Linux实例中运行的Shell脚本。\n         ","type":"string","required":true,"example":"RunShellScript"}},{"name":"CommandContent","in":"query","schema":{"description":"命令Base64编码后的内容。\n\n- 该参数的值必须使用Base64编码后传输，且脚本内容的大小在Base64编码之后不能超过18 KB。\n- 命令内容支持使用自定义参数形式，具体通过指定参数`EnableParameter=true`启用自定义参数功能：\n    - 自定义参数用`{{}}`包含的方式定义，在`{{}}`内参数名前后的空格以及换行符会被忽略。\n    - 自定义参数个数不能超过20个。\n    - 自定义参数名允许a-zA-Z0-9-_的组合，不支持acs::前缀指定非内置环境参数，不支持其余字符，参数名不区分大小写。\n    - 单个参数名不能超过64字节。\n\n- 您可以指定内置环境参数作为自定义参数，执行命令时无需手动对参数赋值，云助手将为您自动替换为环境中对应的值。支持指定以下内置环境参数：\n    - `{{ACS::RegionId}}`：地域ID。\n    - `{{ACS::AccountId}}`：阿里云主账号UID。\n    - `{{ACS::InstanceId}}`：实例ID。命令下发到多个实例时，如需指定`{{ACS::InstanceId}}`作为内置环境参数，需确保云助手Agent不低于以下版本：\n        - Linux：2.2.3.309\n        - Windows：2.1.3.309\n    - `{{ACS::InstanceName}}`：实例名称。命令下发到多个实例时，如需指定`{{ACS::InstanceName}}`作为内置环境参数，需确保云助手Agent不低于以下版本：\n        - Linux：2.2.3.344\n        - Windows：2.1.3.344\n\n    - `{{ACS::InvokeId}}`：命令执行ID。如需指定`{{ACS::InvokeId}}`作为内置环境参数，需确保云助手Agent不低于以下版本：\n        - Linux：2.2.3.309\n        - Windows：2.1.3.309\n     \n    - `{{ACS::CommandId}}` ：命令ID。通过调用[RunCommand](~~141751~~)接口执行命令时，如需指定`{{ACS::CommandId}}`作为内置环境参数，需确保云助手Agent不低于以下版本：\n        - Linux：2.2.3.309\n        - Windows：2.1.3.309\n","type":"string","required":true,"example":"ZWNobyAxMjM="}},{"name":"WorkingDir","in":"query","schema":{"description":"您创建的命令在ECS实例中运行的目录。长度不得超过200个字符。\n\n默认值： \n- Linux实例：管理员root用户的home目录下，具体为`/root`目录。  \n- Windows实例：云助手Agent进程所在目录，例如`C:\\Windows\\System32`。\n\n>设置为其他目录时，请确保实例中存在该目录。","type":"string","required":false,"example":"/home/user"}},{"name":"Timeout","in":"query","schema":{"description":"您创建的命令在ECS实例中执行时最大的超时时间，单位为秒。当因为某种原因无法运行您创建的命令时，会出现超时现象。超时后，会强制终止命令进程，即取消命令的PID。\n\n默认值：60。","type":"integer","format":"int64","required":false,"example":"60"}},{"name":"EnableParameter","in":"query","schema":{"description":"创建的命令是否使用自定义参数。\n\n默认值：false。","type":"boolean","required":false,"example":"false","default":"false"}},{"name":"ContentEncoding","in":"query","schema":{"description":"命令内容（CommandContent）的编码方式。取值范围：\n\n- PlainText：不编码，采用明文传输。\n\n- Base64：Base64编码。\n\n默认值：Base64。\n\n>错填该取值会当作Base64处理。","type":"string","required":false,"example":"PlainText"}},{"name":"ResourceGroupId","in":"query","schema":{"description":"命令所属的资源组ID。","type":"string","required":false,"example":"rg-123******"}},{"name":"Tag","in":"query","style":"repeatList","schema":{"description":"标签列表。","type":"array","items":{"description":"标签列表。","type":"object","properties":{"Key":{"description":"命令的标签键。N的取值范围为1~20。一旦传入该值，则不允许为空字符串。\n\n使用一个标签过滤资源，查询到该标签下的资源数量不能超过1000个。使用多个标签过滤资源，查询到同时绑定了多个标签的资源数量不能超过1000个。如果资源数量超过1000个，您需要使用[ListTagResources](~~110425~~)接口进行查询。\n\n最多支持64个字符，不能以`aliyun`或`acs:`开头，不能包含`http://`或`https://`。\n\n","type":"string","required":false,"example":"TestKey"},"Value":{"description":"命令的标签值。N的取值范围为1~20。该值可以为空字符串。\n\n最多支持128个字符，不能包含`http://`或`https://`。","type":"string","required":false,"example":"TestValue"}},"required":false},"required":false,"maxItems":21}}],"responses":{"200":{"schema":{"type":"object","properties":{"CommandId":{"description":"命令ID。","type":"string","example":"c-7d2a745b412b4601b2d47f6a768d****"},"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3****"}}}}},"errorCodes":{"400":[{"errorCode":"RegionId.ApiNotSupported","errorMessage":"The api is not supported in this region."},{"errorCode":"CmdParam.EmptyKey","errorMessage":"You must specify the parameter names."},{"errorCode":"CmdParam.InvalidParamName","errorMessage":"Invalid parameter name. The name can contain only lowercase letters (a to z), uppercase letters (A to Z), numbers (0 to 9), hyphens (-), and underscores (_)."},{"errorCode":"CmdContent.DecodeError","errorMessage":"The CommandContent can not be base64 decoded."},{"errorCode":"InvalidParameter.WorkingDir","errorMessage":"The specified parameter WorkingDir is not valid."}],"403":[{"errorCode":"CmdContent.ExceedLimit","errorMessage":"The length of the command content exceeds the upper limit."},{"errorCode":"CmdName.ExceedLimit","errorMessage":"The length of the command name exceeds the upper limit."},{"errorCode":"CmdDesc.ExceedLimit","errorMessage":"The length of the command description exceeds the upper limit."},{"errorCode":"CmdCount.ExceedQuota","errorMessage":"The total number of commands in the current region exceeds the quota."},{"errorCode":"CmdParamCount.ExceedLimit","errorMessage":"The maximum number of custom parameters is exceeded."},{"errorCode":"CmdParamName.ExceedLimit","errorMessage":"The maximum length of a parameter name is exceeded."},{"errorCode":"Operation.Forbidden","errorMessage":"The operation is not permitted."},{"errorCode":"InvalidStatus.ResourceGroup","errorMessage":"You cannot perform an operation on a resource group that is being created or deleted."},{"errorCode":"InvalidParameterCharacter.CommandName","errorMessage":"The command Name contains illegal characters."},{"errorCode":"InvalidParameterCharacter.CommandDescription","errorMessage":"The command Description contains illegal characters."},{"errorCode":"InvalidParameterCharacter.CommandWorkingDir","errorMessage":"The command WorkingDir contains illegal characters."}],"404":[{"errorCode":"InvalidCmdType.NotFound","errorMessage":"The specified command type does not exist."},{"errorCode":"InvalidRegionId.NotFound","errorMessage":"The RegionId provided does not exist in our records."},{"errorCode":"InvalidResourceGroup.NotFound","errorMessage":"The ResourceGroup provided does not exist in our records."}],"500":[{"errorCode":"InternalError.Dispatch","errorMessage":"An error occurred when you dispatched the request."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"CommandId\\\": \\\"c-7d2a745b412b4601b2d47f6a768d****\\\",\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3****\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateCommandResponse>\\n    <CommandId>c-7d2a745b412b4601b2d47f6a768d****</CommandId>\\n    <RequestId>473469C7-AA6F-4DC5-B3DB-A3DC0DE3****</RequestId>\\n</CreateCommandResponse>\",\"errorExample\":\"\"}]","title":"新建一条云助手命令","summary":"调用CreateCommand新建一条云助手命令。","description":"## 接口说明\n\n- 您可以创建以下类型的命令： \n    - Windows实例适用的Bat脚本（RunBatScript）。\n    - Windows实例适用的PowerShell脚本（RunPowerShellScript）。\n    - Linux实例适用的Shell脚本（RunShellScript）。\n- 您可以通过指定参数Timeout为命令设置在ECS实例中执行时最大的超时时间，命令执行超时后，[云助手Agent](~~64921~~)会强制终止命令进程，即取消命令的PID。\n    - 对于单次执行，超时后，该命令针对指定的ECS实例的执行状态（[InvokeRecordStatus](~~64845~~)）变为执行失败（Failed）。  \n    - 对于定时执行： \n        - 定时执行的超时时间对每一次执行记录均有效。 \n        - 某次执行超时后，该次执行记录的状态（[InvokeRecordStatus](~~64845~~)）变为执行失败（Failed）。  \n        - 上次执行超时与否不影响下一次执行。 \n- 在一个地域下，您最多可以保有500～50,000条云助手命令，您也可以申请提升配额，关于如何查询及提升配额，请参见[配额管理](~~184116~~)。\n- 您可以通过指定参数WorkingDir为命令指定执行路径。对于Linux实例，默认在管理员root用户的home目录下，具体为`/root`目录。对于Windows实例，默认在云助手Agent进程所在目录，例如：`C:\\Windows\\System32`。\n- 您可以通过指定参数EnableParameter=true启用自定义参数功能。在设置CommandContent时可以通过{{parameter}}的形式表示自定义参数，并在运行命令（[InvokeCommand](~~64841~~)）时，传入自定义参数键值对。例如，您在创建命令时，创建了`echo {{name}}`命令，在 InvokeCommand时，通过Parameters参数传入键值对`<name, Jack>`。则自定义参数将自动替换命令，您会得到一条新的命令，并在实例中执行`echo Jack`。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}