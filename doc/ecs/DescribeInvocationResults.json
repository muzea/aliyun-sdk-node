{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"get","abilityTreeCode":"29282","abilityTreeNodes":["FEATUREecsPW0L5N"]},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"ResourceGroupId","in":"query","schema":{"description":"命令执行的资源组ID。传入该参数后，需要在执行命令时指定ResourceGroupId，支持筛选出对应的命令执行结果。","type":"string","required":false,"example":"rg-bp67acfmxazb4p****"}},{"name":"RegionId","in":"query","schema":{"description":"地域ID。您可以调用[DescribeRegions](~~25609~~)查看最新的阿里云地域列表。","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"InvokeId","in":"query","schema":{"description":"命令执行ID。您可以通过接口[DescribeInvocations](~~64840~~)查询InvokeId。","type":"string","required":false,"example":"t-hz0jdfwd9f****"}},{"name":"InstanceId","in":"query","schema":{"description":"实例ID。","type":"string","required":false,"example":"i-bp1i7gg30r52z2em****"}},{"name":"CommandId","in":"query","schema":{"description":"命令ID。\n","type":"string","required":false,"example":"c-hz0jdfwcsr****"}},{"name":"InvokeRecordStatus","in":"query","schema":{"description":"命令执行状态。取值范围：\n\n- Running：运行中。\n    - 定时执行：未手动停止定时执行命令前，执行状态一直为进行中。\n    - 单次执行：一旦有进行中的命令进程，总的执行状态就为进行中。\n- Finished：已完成。\n    - 定时执行：命令进程不可能为执行完成。\n    - 单次执行：所有实例全部完成执行。或者手动停止部分实例的命令进程，其余实例全部执行完成。\n- Success：\n    - 单次执行的命令：命令执行完成，且退出码为0。\n    - 定时执行的命令：上一次执行成功且退出码为0，且指定的执行时间已结束。\n- Failed：执行失败。\n    - 定时执行：命令进程不可能为执行失败。\n    - 单次执行：所有实例全部执行失败。\n- PartialFailed：部分执行失败。\n    - 定时执行：命令进程不可能为部分失败。\n    - 单次执行：部分实例有执行失败的命令进程，则总执行状态为部分失败。\n- Stopped：命令执行已停止。\n- Stopping：正在停止执行的命令。","type":"string","required":false,"example":"Running"}},{"name":"IncludeHistory","in":"query","schema":{"description":"是否返回命令定时执行的历史记录。取值范围：\n\n - true：表示返回命令定时执行的结果。当取值为true时，参数InvokeId的取值不能为空，且必须为定时执行（RepeatMode为Period）或系统每一次启动后执行（RepeatMode为EveryReboot）的命令执行ID。\n - false：表示不返回。\n\n默认值为false。","type":"boolean","required":false,"example":"false"}},{"name":"ContentEncoding","in":"query","schema":{"description":"设置返回数据中`CommandContent`字段和`Output`字段的编码方式，取值范围：\n- PlainText：返回原始命令内容和输出信息。\n- Base64：返回Base64编码后的命令内容和输出信息。\n\n默认值为Base64。","type":"string","required":false,"example":"PlainText"}},{"name":"PageNumber","in":"query","schema":{"description":"当前页码。\n\n起始值为1。\n\n默认值为1。","type":"integer","format":"int64","required":false,"example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询时设置的每页行数。\n\n最大值为50。\n\n默认值为10。","type":"integer","format":"int64","required":false,"example":"1"}},{"name":"MaxResults","in":"query","schema":{"description":"分页查询时每页的最大条目数。\n\n最大值为50。\n\n默认值为10。","type":"integer","format":"int32","required":false,"example":"10"}},{"name":"NextToken","in":"query","schema":{"description":"查询凭证（Token），取值为上一次API调用返回的NextToken参数值。","type":"string","required":false,"example":"AAAAAdDWBF2"}},{"name":"Tag","in":"query","style":"repeatList","schema":{"description":"标签列表","type":"array","items":{"description":"标签列表","type":"object","properties":{"Key":{"description":"命令执行的标签键。N的取值范围为1~20。一旦传入该值，则不允许为空字符串。\n\n使用一个标签过滤资源，查询到该标签下的资源数量不能超过1000个；使用多个标签过滤资源，查询到同时绑定了多个标签的资源数量不能超过1000个。如果资源数量超过1000个，您需要使用[ListTagResources](~~110425~~)接口进行查询。\n\n最多支持64个字符，不能以`aliyun`或`acs:`开头，不能包含`http://`或`https://`。","type":"string","required":false,"example":"TestKey"},"Value":{"description":"命令执行的标签值。N的取值范围为1~20。该值可以为空字符串。\n\n最多支持128个字符，不能包含`http://`或`https://`。","type":"string","required":false,"example":"TestValue"}},"required":false},"required":false,"maxItems":21}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE*****"},"Invocation":{"description":"命令执行结果的集合。","type":"object","properties":{"PageSize":{"description":"分页查询时设置的每页行数。","type":"integer","format":"int64","example":"1"},"PageNumber":{"description":"当前页码。","type":"integer","format":"int64","example":"1"},"TotalCount":{"description":"命令总个数。","type":"integer","format":"int64","example":"1"},"NextToken":{"description":"本次调用返回的查询凭证值。","type":"string","example":"AAAAAdDWBF2"},"InvocationResults":{"type":"object","properties":{"InvocationResult":{"description":"命令执行结果集。","type":"array","items":{"type":"object","properties":{"InvocationStatus":{"description":"单台实例的命令进度状态，可能值：\n- Pending：系统正在校验或发送命令。\n- Invalid：指定命令类型或参数有误。\n- Aborted：向实例发送命令失败。实例必须在运行中，且命令可以1分钟内发送完成。\n- Running：命令正在实例上执行。\n- Success：\n    - 单次执行的命令：命令执行完成，且退出码为0。\n    - 定时执行的命令：上一次执行成功且退出码为0，且指定的执行时间已结束。\n- Failed：\n    - 单次执行的命令：命令执行完成，且退出码非0。\n    - 定时执行的命令：上一次执行成功且退出码非0，且指定的执行时间将中止。\n- Error：命令执行时发生异常无法继续。\n- Timeout：命令执行超时。\n- Cancelled：命令的执行动作已经取消，命令未曾启动。\n- Stopping：正在停止执行的命令。\n- Terminated：命令执行时被终止。\n- Scheduled：\n    - 单次执行的命令：不适用，不会出现。\n    - 定时执行的命令：等待执行。","type":"string","example":"Success"},"Repeats":{"description":"命令在该实例上执行的次数。\n- 若执行方式为立即执行，则值为0或1。\n- 若执行方式为定时执行，则值为执行过多少次。","type":"integer","format":"int32","example":"0"},"CommandId":{"description":"命令ID。","type":"string","example":"c-hz0jdfwcsr****"},"InstanceId":{"description":"实例ID。","type":"string","example":"i-bp1i7gg30r52z2em****"},"Output":{"description":"命令执行后的输出信息。\n\n- 若ContentEncoding指定PlainText，返回原始输出信息。\n- 若ContentEncoding指定Base64，返回Base64编码后的输出信息。","type":"string","example":"MTU6MzA6MDEK"},"Dropped":{"description":"`Output`字段中文字长度超出24 KB后，截断并丢弃的文字长度。","type":"integer","format":"int32","example":"0"},"StopTime":{"description":"若调用了`StopInvocation`以停止命令执行，表示调用的时间。","type":"string","example":"2020-01-19T09:15:47Z"},"ExitCode":{"description":"命令的退出码。\n\n- Linux实例为Shell命令的退出码。\n- Windows实例为Bat或者PowerShell命令的退出码。","type":"integer","format":"int64","example":"0"},"StartTime":{"description":"命令在实例中开始执行的时间。","type":"string","example":"2019-12-20T06:15:55Z"},"ErrorInfo":{"description":"命令的下发失败或执行失败原因的详情，可能值：\n- 空：命令执行正常。\n- the specified instance does not exists：指定的实例不存在或已释放。\n- the instance has released when create task：执行命令期间，该实例被释放。\n- the instance is not running when create task：命令执行时，该实例不在运行中。\n- the command is not applicable：命令不适用于指定的实例。\n- the specified account does not exists：指定的账号不存在。\n- the specified directory does not exists：指定的目录不存在。\n- the cron job expression is invalid：指定的执行时间表达式不合法。\n- the aliyun service is not running on the instance：云助手Agent未运行。\n- the aliyun service in the instance does not response：云助手Agent无响应。\n- the aliyun service in the instance is upgrading now：云助手Agent正在升级中。\n- the aliyun service in the instance need upgrade：云助手Agent需要升级。\n- the command delivery has been timeout：发送命令超时。\n- the command execution has been timeout：命令执行超时。\n- the command execution got an exception：命令执行发生异常。\n- the command execution has been interrupted：命令执行被中断。\n- the command execution exit code is not zero：命令执行结束，退出码非0。\n- the specified instance has been released：下发文件期间，该实例被释放。","type":"string","example":"the specified instance does not exists"},"ErrorCode":{"description":"命令下发失败或执行失败原因的代码，可能值：\n- 空：命令执行正常。\n- InstanceNotExists：指定的实例不存在或已释放。\n- InstanceReleased：执行命令期间，该实例被释放。\n- InstanceNotRunning：命令执行时，该实例不在运行中。\n- CommandNotApplicable：命令不适用于指定的实例。\n- AccountNotExists：指定的执行命令的用户名不存在。\n- DirectoryNotExists：指定的目录不存在。\n- BadCronExpression：指定的执行时间表达式不合法。\n- ClientNotRunning：云助手Agent未运行。\n- ClientNotResponse：云助手Agent无响应。\n- ClientIsUpgrading：云助手Agent正在升级中。\n- ClientNeedUpgrade：云助手Agent需要升级。\n- DeliveryTimeout：发送命令超时。\n- ExecutionTimeout：命令执行超时。\n- ExecutionException：命令执行发生异常。\n- ExecutionInterrupted：命令执行被中断。\n- ExitCodeNonzero：命令执行结束，退出码非0。\n- SecurityGroupRuleDenied：安全组规则拒绝访问云助手服务。","type":"string","example":"InstanceNotExists"},"FinishedTime":{"description":"命令执行的完成时间。如果命令执行出现超时情况，命令执行的完成时间以`StartTime`延迟执行命令的超时时间`Timeout`为准。","type":"string","example":"2019-12-20T06:15:56Z"},"InvokeId":{"description":"命令执行ID。","type":"string","example":"t-hz0jdfwd9f****"},"InvokeRecordStatus":{"description":"命令执行状态。可能值：\n\n- Running：运行中。\n    - 定时执行：未手动停止定时执行命令前，执行状态一直为进行中。\n    - 单次执行：一旦有进行中的命令进程，总的执行状态就为进行中。\n- Finished：已完成。\n    - 定时执行：命令进程不可能为执行完成。\n    - 单次执行：所有实例全部完成执行。或者手动停止部分实例的命令进程，其余实例全部执行完成。\n- Failed：执行失败。\n    - 定时执行：命令进程不可能为执行失败。\n    - 单次执行：所有实例全部执行失败。\n- PartialFailed：部分执行失败。\n    - 定时执行：命令进程不可能为部分失败。\n    - 单次执行：部分实例有执行失败的命令进程，则总执行状态为部分失败。\n- Stopped：命令执行已停止。\n- Stopping：正在停止执行的命令。","type":"string","example":"Running"},"Username":{"description":"在ECS实例中执行命令的用户名称。","type":"string","example":"test"},"ContainerId":{"description":"容器ID。","type":"string","example":"ab141ddfbacfe02d9dbc25966ed971536124527097398d419a6746873fea****"},"ContainerName":{"description":"容器名称。","type":"string","example":"test-container"},"TerminationMode":{"description":"停止任务（手动停止或执行超时打断）时的模式。可能值：\n- Process：停止当前脚本进程。\n- ProcessTree：停止当前进程树（脚本进程以及它创建的所有子进程的集合）。","type":"string","example":"ProcessTree"},"Tags":{"type":"object","properties":{"Tag":{"description":"命令执行的标签信息。","type":"array","items":{"description":"命令执行的标签信息。","type":"object","properties":{"TagKey":{"description":"命令执行的标签键。","type":"string","example":"owner"},"TagValue":{"description":"命令执行的标签值。","type":"string","example":"zhangsan"}}}}}}}}}}}}}}}}},"errorCodes":{"400":[{"errorCode":"RegionId.ApiNotSupported","errorMessage":"The api is not supported in this region."},{"errorCode":"NumberExceed.Tags","errorMessage":"The Tags parameter number is exceed."},{"errorCode":"Duplicate.TagKey","errorMessage":"The Tag.N.Key contain duplicate key."},{"errorCode":"InvalidTagKey.Malformed","errorMessage":"The specified Tag.n.Key is not valid."},{"errorCode":"InvalidTagValue.Malformed","errorMessage":"The specified Tag.n.Value is not valid."},{"errorCode":"MissingParameter.TagKey","errorMessage":"You must specify Tag.N.Key."},{"errorCode":"InvalidParam.PageNumber","errorMessage":"The specified parameter is invalid."},{"errorCode":"InvalidParam.PageSize","errorMessage":"The specified parameter is invalid."},{"errorCode":"InvalidParameter.NextToken","errorMessage":"The specified parameter NextToken is not valid."},{"errorCode":"InvalidParameter.MaxResults","errorMessage":"The specified parameter MaxResults is not valid."}],"403":[{"errorCode":"Operation.Forbidden","errorMessage":"The operation is not permitted."}],"404":[{"errorCode":"InvalidRegionId.NotFound","errorMessage":"The RegionId provided does not exist in our records."}],"500":[{"errorCode":"InternalError.Dispatch","errorMessage":"An error occurred when you dispatched the request."},{"errorCode":"ServiceUnavailable","errorMessage":"The request has failed due to a temporary failure of the server."},{"errorCode":"InternalError","errorMessage":"The request processing has failed due to some unknown error."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE*****\\\",\\n  \\\"Invocation\\\": {\\n    \\\"PageSize\\\": 1,\\n    \\\"PageNumber\\\": 1,\\n    \\\"TotalCount\\\": 1,\\n    \\\"NextToken\\\": \\\"AAAAAdDWBF2\\\",\\n    \\\"InvocationResults\\\": {\\n      \\\"InvocationResult\\\": [\\n        {\\n          \\\"InvocationStatus\\\": \\\"Success\\\",\\n          \\\"Repeats\\\": 0,\\n          \\\"CommandId\\\": \\\"c-hz0jdfwcsr****\\\",\\n          \\\"InstanceId\\\": \\\"i-bp1i7gg30r52z2em****\\\",\\n          \\\"Output\\\": \\\"MTU6MzA6MDEK\\\",\\n          \\\"Dropped\\\": 0,\\n          \\\"StopTime\\\": \\\"2020-01-19T09:15:47Z\\\",\\n          \\\"ExitCode\\\": 0,\\n          \\\"StartTime\\\": \\\"2019-12-20T06:15:55Z\\\",\\n          \\\"ErrorInfo\\\": \\\"the specified instance does not exists\\\",\\n          \\\"ErrorCode\\\": \\\"InstanceNotExists\\\",\\n          \\\"FinishedTime\\\": \\\"2019-12-20T06:15:56Z\\\",\\n          \\\"InvokeId\\\": \\\"t-hz0jdfwd9f****\\\",\\n          \\\"InvokeRecordStatus\\\": \\\"Running\\\",\\n          \\\"Username\\\": \\\"test\\\",\\n          \\\"ContainerId\\\": \\\"ab141ddfbacfe02d9dbc25966ed971536124527097398d419a6746873fea****\\\",\\n          \\\"ContainerName\\\": \\\"test-container\\\",\\n          \\\"TerminationMode\\\": \\\"ProcessTree\\\",\\n          \\\"Tags\\\": {\\n            \\\"Tag\\\": [\\n              {\\n                \\\"TagKey\\\": \\\"owner\\\",\\n                \\\"TagValue\\\": \\\"zhangsan\\\"\\n              }\\n            ]\\n          }\\n        }\\n      ]\\n    }\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeInvocationResultsResponse>\\n    <RequestId>473469C7-AA6F-4DC5-B3DB-A3DC0DE*****</RequestId>\\n    <Invocation>\\n        <InvocationResults>\\n            <InvocationResult>\\n                <Dropped>0</Dropped>\\n                <InvocationStatus>Success</InvocationStatus>\\n                <InstanceId>i-bp1i7gg30r52z2em****</InstanceId>\\n                <ExitCode>0</ExitCode>\\n                <ErrorInfo>the specified instance does not exists</ErrorInfo>\\n                <StartTime>2019-12-20T06:15:55Z</StartTime>\\n                <Repeats>0</Repeats>\\n                <InvokeRecordStatus>Running</InvokeRecordStatus>\\n                <FinishedTime>2019-12-20T06:15:56Z</FinishedTime>\\n                <Output>MTU6MzA6MDEK</Output>\\n                <CommandId>c-hz0jdfwcsr****</CommandId>\\n                <ErrorCode>InstanceNotExists</ErrorCode>\\n                <InvokeId>t-hz0jdfwd9f****</InvokeId>\\n                <StopTime>2020-01-19T09:15:47Z</StopTime>\\n                <Username>test</Username>\\n                <ContainerId>ab141ddfbacfe02d9dbc25966ed971536124527097398d419a6746873fea****</ContainerId>\\n                <ContainerName>test-container</ContainerName>\\n                <Tags>\\n                    <TagKey>owner</TagKey>\\n                    <TagValue>zhangsan</TagValue>\\n                </Tags>\\n            </InvocationResult>\\n        </InvocationResults>\\n        <TotalCount>1</TotalCount>\\n        <PageSize>1</PageSize>\\n        <PageNumber>1</PageNumber>\\n    </Invocation>\\n</DescribeInvocationResultsResponse>\",\"errorExample\":\"\"}]","title":"查看云助手命令执行结果","summary":"调用DescribeInvocationResults查看一条或多条云助手命令的执行结果，即在ECS实例中的实际执行结果。","description":"## 接口说明\n\n- 当您执行命令后，不代表命令一定成功执行，并且一定有预期的命令效果。您需要通过本接口查看实际的具体执行结果，以实际输出结果为准。\n- 您可以查询最近4周的执行信息，执行信息的保留上限为10万条。\n- 您可以通过[云助手任务状态事件订阅](~~2669130~~)的方式，通过事件获取任务结果，避免频繁轮询，用以提升效率。\n- 支持以下两种方式查看返回数据：\n    - 方式一：分页查询首页时，仅需设置`MaxResults`以限制返回信息的条目数，返回结果中的`NextToken`将作为查询后续页的凭证。查询后续页时，将`NextToken`参数设置为上一次返回结果中获取到的`NextToken`作为查询凭证，并设置`MaxResults`限制返回条目数。\n    - 方式二：通过`PageSize`设置单页返回的条目数，再通过`PageNumber`设置页码。以上两种方式只能任选其中之一。如果设置了`MaxResults`或`NextToken`参数，则请求参数`PageSize`和`PageNumber`将失效，且返回数据中的`TotalCount`无效。\n- `DescribeInvocations`和`DescribeInvocationResults`差异点：\n    - 当一次`RunCommand`/`InvokeCommand`调用指定有多个实例时：\n        - 使用`DescribeInvocations`可以获得任务在各个实例上的执行状态、多个实例任务状态的聚合状态；\n        - 使用`DescribeInvocationResults`仅能获得各个实例上的单独的执行状态，不包含多实例的聚合状态；\n    - 当一次`RunCommand`/`InvokeCommand`调用指定有一个实例时：\n        - `DescribeInvocations`与`DescribeInvocationResults`区别不大，完全可以互相替换。\n    - 当需要查看定时性（周期性）任务、开机自动执行任务（`RepeatMode=Period, EveryReboot`）的每一次执行情况时，仅能用`DescribeInvocationResults`可以查询获得执行的过往历史记录（需指定`IncludeHistory=true`），而`DescribeInvocations`仅支持返回最新的任务状态。\n    - 当需要查看命令的内容、参数时，仅有`DescribeInvocations`返回`CommandContent`。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}