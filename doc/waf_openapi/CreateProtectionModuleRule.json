{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{},"parameters":[{"name":"Domain","in":"query","schema":{"description":"要添加防护规则配置的域名。\n\n> 您可以调用[DescribeDomainNames](~~86373~~)查询所有已添加到WAF进行防护的域名。","type":"string","required":true,"example":"www.example.com"}},{"name":"DefenseType","in":"query","schema":{"description":"要配置的防护功能模块。取值：\n\n- **waf-codec**：表示规则防护引擎解码设置。\n\n- **tamperproof**：表示网站防篡改规则配置。\n\n- **dlp**：表示防敏感信息泄漏规则配置。\n\n- **ng_account**：表示账户安全规则配置。\n\n- **antifraud**：表示数据风控防护请求配置。\n\n- **antifraud_js**：表示数据风控JS插入页面配置。\n\n- **bot_algorithm**：表示Bot管理的智能算法规则。\n\n- **bot_wxbb_pkg**：表示App防护的版本防护规则。\n\n- **bot_wxbb**：表示App防护的路径防护规则。\n\n- **ac_custom**：表示自定义防护策略规则配置。\n\n- **whitelist**：表示白名单规则配置。","type":"string","required":true,"example":"ac_custom"}},{"name":"Rule","in":"query","schema":{"description":"规则配置内容，以一系列参数构造的JSON格式转化成字符串。\n\n> 根据所指定的防护功能模块配置（**DefenseType**）不同，具体涉及的参数有所不同。详细信息，请参见Rule参数具体说明。","type":"string","required":true,"example":" {\"action\":\"monitor\",\"name\":\"test\",\"scene\":\"custom_acl\",\"conditions\":[{\"opCode\":1,\"key\":\"URL\",\"values\":\"/example\"}]}"}},{"name":"InstanceId","in":"query","schema":{"description":"WAF实例ID。\n\n> 您可以调用[DescribeInstanceInfo](~~140857~~)查询当前WAF实例的ID。","type":"string","required":true,"example":"waf-cn-0xldbqt****"}},{"name":"ResourceGroupId","in":"query","schema":{"description":"WAF实例在资源管理服务中所属的资源组ID。默认为空，即属于默认资源组。\n\n关于资源组的更多信息，请参见[创建资源组](~~94485~~)。","type":"string","required":false,"example":"rg-atstuj3rtop****"}},{"name":"RegionId","in":"query","schema":{"description":"WAF实例所属地域。取值：\n\n- **cn-hangzhou**：表示中国内地。\n\n- **ap-southeast-1**：表示非中国内地。","type":"string","required":false,"example":"cn-hangzhou","default":"cn-hangzhou"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"本次请求的ID。","type":"string","example":"D7861F61-5B61-46CE-A47C-6B19****5EB0"}}}}},"errorCodes":{},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"D7861F61-5B61-46CE-A47C-6B19****5EB0\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateProtectionModuleRuleResponse>\\n    <RequestId>D7861F61-5B61-46CE-A47C-6B19160D5EB0</RequestId>\\n</CreateProtectionModuleRuleResponse>\",\"errorExample\":\"\"}]","title":"在WAF防护功能模块中创建配置规则","summary":"在指定的WAF防护功能模块创建配置规则，如Web入侵防护、数据安全、高级防护、Bot、访问控制、限流。","description":"本接口用于在指定的WAF防护功能模块（包括Web入侵防护、数据安全、高级防护、Bot管理、访问控制或限流等模块）中创建规则配置。您可以通过设置**DefenseType**参数值指定防护功能模块配置。具体参数值的含义，请参见请求参数**DefenseType**的描述。\n请注意，为了确保系统的文档性，对单用户QPS限制为10次/秒。超过限制，API调用将会被限流，这可能影响您的业务，请合理调用。","requestParamsDescription":"**Rule参数具体说明**\n\n - 规则防护引擎解码设置（**waf-codec**）对应的JSON字符串中包含以下参数：\n\n    - **codecList**：Array类型 | 必选 | 启用的解码配置项。您可在Web应用防火墙控制台中查看该参数支持填写的参数值。\n\n   - **示例**\n    ```\n    {\n        \"codecList\":[\"url\",\"base64\"]\n    }\n    ```\n\n- 网站防篡改规则配置（**tamperproof**）对应的JSON字符串中包含以下参数：\n\n    - **uri**：String类型 | 必选 | 所需防护的具体URL。\n    - **name**：String类型 | 必选 | 规则名称。\n\n    - **示例**\n\n    ```\n    {\n        \"name\":\"example\",\n        \"uri\":\"http://www.aliyundoc.com/example\"\n    }\n    ```\n\n- 防敏感信息泄露规则配置（**dlp**）对应的JSON字符串中包含以下参数：\n\n    - **name**：String类型 | 必选 | 规则名称。\n    - **conditions**：Array类型 | 必选 | 以JSON字符串格式描述匹配条件，支持设置最多两条匹配条件且条件间的关系为并且。其中包含以下具体参数：\n\n        - **key**：匹配项。取值：\n\n            - **0**：表示防护的URL。\n            - **10**：表示敏感信息。\n            - **11**：表示响应码。\n            > 您无法在**conditions**参数中同时为响应码（**11**）和敏感信息（**10**）设置匹配条件。\n\n        - **operation**：匹配逻辑。取值固定为**1**，表示包含。\n\n        - **value**：以JSON字符串描述匹配条件值，支持填写多个条件值。其中包含以下具体参数：\n\n            - **v**：仅适用于匹配项（**key**）为URL（**0**）或响应码（**11**）的场景。\n                - URL：当`\"key\":0`时，参数值为URL地址。\n                - 响应码：当`\"key\":11`，参数取值范围包括**400**、**401**、**402**、**403**、**404**、**405-499**、**500**、**501**、**502**、**503**、**504**、**505-599**。\n            - **k**：仅适用于匹配项（**key**）为敏感信息（**10**）的场景。取值范围：\n                - **100**：表示身份证。\n                - **101**：表示信用卡。\n                - **102**：表示电话号码。\n                - **103**：表示默认敏感词。\n\n    - **action**：匹配动作。取值：\n        - **3**：表示告警。\n        - **10**：表示敏感信息过滤，该动作仅适用于包含敏感信息（`\"key\":10`）的匹配条件场景。\n        - **11**：表示返回系统内置拦截页面，该动作仅适用于包含响应码（`\"key\":11`）的匹配条件场景。\n\n    - **示例**\n\n  ```\n  {\n\t\"name\":\"example\",\n\t\"conditions\":[{\"key\":11,\"operation\":1,\"value\":[{\"v\":401}]},{\"key\":\"0\",\"operation\":1,\"value\":[{\"v\":\"www.aliyundoc.com\"}]}],\n\t\"action\":3\n  }\n  ```\n\n- 账户安全规则配置（**ng_account**）对应的JSON字符串中包含以下参数：\n\n    - **url_path**：String类型 | 必选 | 检测接口，以URL路径表示，必须以正斜线（/）开头。\n    - **method**：String类型 | 必选 | 检测的请求方式，包括POST、GET、PUT、DELETE。支持设定多个请求方式，以英文逗号（,）分隔。\n    - **account_left**：String类型 | 必选 | 账号参数名。\n    - **password_left**：String类型 | 可选 | 密码参数名。\n    - **action**：String类型 | 必选 | 防护动作。取值：\n        - **monitor**：表示预警。\n        - **block**：表示拦截。\n\n    - **示例**\n\n    ```\n    {\n        \"url_path\":\"/example\",\n        \"method\":\"POST,GET,PUT,DELETE\",\n        \"account_left\":\"aaa\",\n        \"password_left:\"123\",\n        \"action\":\"monitor\"\n    }\n    ``` \n\n- 数据风控防护请求配置（**antifraud**）对应的JSON字符串中包含以下参数：\n\n    - **uri**：String类型 | 必选 | 具体的防护请求URL。\n    \n    - **示例**\n\n    ```\n    {\n        \"uri\": \"http://1.example.com/example\"\n    }\n    ```\n\n- 数据风控JS插入页面配置（**antifraud_js**）对应的JSON字符串中包含以下参数：\n\n    - **uri**：String类型 | 必选 | 需要插入数据风控JS页面的URL，系统将为所指定的URL路径下的所有页面插入数据风控JS，必须以正斜线（/）开头。\n\n    - **示例**\n\n    ```\n    {\n        \"uri\": \"/example/example\"\n    }\n    ```\n\n- Bot管理的智能算法规则配置（**bot_algorithm**）对应的JSON字符串中包含以下参数：\n\n    - **name**：String类型 | 必选 | 规则名称。\n    - **algorithmName**：String类型 | 必选 | 算法名称。取值：\n        - **RR**：表示专项资源爬虫识别算法。\n        - **PR**：表示定向路径爬虫识别算法。\n        - **DPR**：表示参数轮询爬虫识别算法。\n        - **SR**：表示动态IP爬虫识别算法。\n        - **IND**：表示代理设备爬虫识别算法。\n        - **Periodicity**：表示周期性爬虫识别算法。\n    - **timeInterval**：Integer类型 | 必选 | 检测周期。取值：30、60、120、300、600，单位：秒。\n    - **action**：String类型 | 必选 | 处置动作。取值：\n        - **monitor**：表示观察。\n        - **captcha**：表示滑块。\n        - **js**：表示JavaScript校验。\n        - **block**：表示阻断。选择阻断作为处置动作时，必须传入阻断时长（**blocktime**）参数。\n    - **blocktime**：Integer类型 | 可选 | 阻断时长。单位：分钟。取值范围：1~600。\n    - **config**：String类型 | 必选 | 算法配置信息，以JSON字符串格式表示。算法配置信息中的具体子参数与所选择的算法名称（**algorithmName**）相关。\n        - 专项资源爬虫识别算法（**RR**）对应的配置信息应包含以下子参数：\n            - **resourceType**：Integer类型 | 可选 | 请求的资源类型。取值：\n                - **1**：表示动态资源类型。\n                - **2**：表示静态资源类型。\n                - **-1**：表示自定义资源类型。选择自定义资源组时，需要再传入**extensions**参数，以字符串格式指定具体的资源后缀名，多个后缀名间以英文逗号（,）分隔，例如`css,jpg,xls`。\n            - **minRequestCountPerIp**：Integer类型 | 必选 | 检测周期中检测IP的范围，大于等于一定访问请求数量的IP才会被检测。通过该参数指定访问请求数量的最小值。取值范围：5~10000。\n            - **minRatio**：Float类型 | 必选 | 风险判定条件，即IP访问请求中访问指定资源类型的占比阈值（对应专项资源爬虫识别算法）或IP访问请求中访问指定路径的占比阈值（对应定向路径爬虫识别算法），超过阈值后判定为风险。取值范围：0.01~1。\n        - 定向路径爬虫识别算法（**PR**）对应的配置信息应包含以下子参数：\n            - **keyPathConfiguration**：Array类型 | 可选 | 请求的路径信息，支持指定最多10条路径，只在使用定向路径爬虫识别算法时需传入该子参数。以JSON字符串格式表示，具体包含以下参数：\n                - **method**：String类型 | 必选 | 请求方法。取值：**POST**、**GET**、**PUT**、**DELETE**、**HEAD**、**OPTIONS**。\n                - **url**：String类型 | 必选 | 请求路径关键字，必须以正斜线（/）开头。\n                - **matchType**：String类型 | 必选 | 匹配方式，与请求路径关键字（**url**）参数结合指定请求路径。取值：**all**（精准匹配）、**prefix**（前缀匹配）、**regex**（正则匹配）。\n            - **minRequestCountPerIp**：Integer类型 | 必选 | 检测周期中检测IP的范围，大于等于一定访问请求数量的IP才会被检测。通过该参数指定访问请求数量的最小值。取值范围：5~10000。\n            - **minRatio**：Float类型 | 必选 | 风险判定条件，即IP访问请求中访问指定资源类型的占比阈值（对应专项资源爬虫识别算法）或IP访问请求中访问指定路径的占比阈值（对应定向路径爬虫识别算法），超过阈值后判定为风险。取值范围：0.01~1。\n        - 参数轮询爬虫识别算法（**DPR**）对应的配置信息应包含以下子参数：\n            - **method**：String类型 | 必选 | 请求方法。取值：**POST**、**GET**、**PUT**、**DELETE**、**HEAD**、**OPTIONS**。\n            - **urlPattern**：String类型 | 必选 | 关键参数路径，必须以正斜线（/）开头。用{}表示关键参数，配置多个{}时将拼接这些参数作为关键参数。例如，`/company/{}/{}/{}/user.php?uid={}`。\n            - **minRequestCountPerIp**：Integer类型 | 必选 | 检测周期中检测IP的范围，大于等于一定访问请求数量的IP才会被检测。通过该参数指定访问请求数量的最小值。取值范围：5~10000。\n            - **minRatio**：Float类型 | 必选 | 风险判定条件，即IP访问请求中不同关键参数值的计数占比阈值，超过阈值后判定为风险。取值范围：0.01~1。\n        - 动态IP爬虫识别算法（**SR**）对应的配置信息应包含以下子参数：\n            - **maxRequestCountPerSrSession**：Integer类型 | 必选 | 通过设定每个会话中存在的最小请求次数定义异常会话，即单个会话中的请求次数小于该值即判定为异常会话。取值范围：1~8。\n            - **minSrSessionCountPerIp**：Integer类型 | 必选 | 风险判定条件，即IP访问请求中存在的异常会话数量阈值，单个IP访问请求中的异常会话次数超过该值后判定为风险。取值范围：5~300。\n        - 代理设备爬虫识别算法（**IND**）对应的配置信息应包含以下子参数：\n            - **minIpCount**：Integer类型 | 必选 | 恶意设备判定条件，即设备使用WIFI关联的IP变换个数阈值，超过该阈值后判定为风险。取值范围：5~500。\n            - **keyPathConfiguration**：Array类型 | 可选 | 检测路径信息，支持指定最多10条路径。以JSON字符串格式表示，具体包含以下参数：\n                - **method**：String类型 | 必选 | 请求方法。取值：**POST**、**GET**、**PUT**、**DELETE**、**HEAD**、**OPTIONS**。\n                - **url**：String类型 | 必选 | 检测路径关键字，必须以正斜线（/）开头。\n                - **matchType**：String类型 | 必选 | 匹配方式，与检测路径关键字（**url**）参数结合指定请求路径。取值：**all**（精准匹配）、**prefix**（前缀匹配）、**regex**（正则匹配）。\n        - 周期性爬虫识别算法（**Periodicity**）对应的配置信息应包含以下子参数：\n            - **minRequestCountPerIp**：Integer类型 | 必选 | 检测周期中检测IP的范围，大于等于一定访问请求数量的IP才会被检测。通过该参数指定访问请求数量的最小值。取值范围：5~10000。\n            - **level**：Integer类型 | 必选 | 风险判定等级，即访问IP的周期性特征的明显程度。取值：\n                - **0**：表示明显。\n                - **1**：表示中等。\n                - **2**：表示较弱。\n    - **示例**\n    ```\n    {\n        \"name\":\"代理设备爬虫识别\",\n        \"algorithmName\":\"IND\",\n        \"timeInterval\":\"60\",\n        \"action\":\"monitor\",\n        \"config\":{\n            \"minIpCount\":5,\n            \"keyPathConfiguration\":[{\"url\":\"/index\",\"method\":\"GET\",\"matchType\":\"prefix\"}]\n        }\n    }\n    ```\n\n- App防护的版本防护规则配置（**bot_wxbb_pkg**）对应的JSON字符串中包含以下参数：\n\n    - **name**：String类型 | 必选 | 规则名称。\n    - **action**：String类型 | 必选 | 处置动作。取值：\n        - **test**：表示观察。\n        - **close**：表示阻断。\n    - **nameList**：Array类型 | 必选 | 合法版本信息，最多指定五条规则。以JSON字符串方式表示，具体包含以下参数：\n        - **name**：String类型 | 必选 | 合法包名称。\n        - **signList**：Array类型 | 必选 | 对应的包签名，最多填写15个，以英文逗号（,）分隔。\n\n    - **示例**\n    ```\n    {\n        \"name\":\"test\",\n        \"action\":\"close\",\n        \"nameList\":[{\n            \"name\":\"apk-xxxx\",\n            \"signList\":[\"xxxxxx\",\"xxxxx\",\"xxxx\",\"xx\"]\n        }]\n    }\n    ```\n\n- App防护的路径防护规则配置（**bot_wxbb**）对应的JSON字符串中包含以下参数：\n\n    - **name**：String类型 | 必选 | 规则名称。\n    - **uri**：String类型 | 必选 | 防护路径，必须以正斜线（/）开头。\n    - **matchType**：String类型 | 必选 | 匹配方式。取值：**all**（精准匹配）、**prefix**（前缀匹配）、**regex**（正则匹配）。\n    - **arg**：String类型 | 必选 | 参数包含，与匹配方式（**matchType**）参数结合指定防护路径配置。\n    - **action**：String类型 | 必选 | 处置动作。取值：\n        - **test**：表示观察。\n        - **close**：表示阻断。\n    - **hasTag**：Boolean类型 | 必选 | 是否需要自定义加签字段。\n        - **true**：表示是。选择需要自定义加签字段时，需传入**wxbbVmpFieldType**和**wxbbVmpFieldValue**参数指定加签字段的类型和对应值。\n        - **false**：表示否。\n    - **wxbbVmpFieldType**：Integer类型 | 可选 | 自定义加签字段类型。当**hasTag**参数值为**true**时，必须传入参数。取值：\n        - **0**：表示header。\n        - **1**：表示参数。\n        - **2**：表示cookie。\n    - **wxbbVmpFieldValue**：String类型 | 可选 | 自定义加签字段值。当**hasTag**参数值为**true**时，必须传入参数。\n    - **blockInvalidSign**：Integer类型 | 必选 | 是否对非法签名执行处置动作，固定值**1**。路径防护规则的默认防护策略。\n    - **blockProxy**：Integer类型 | 可选 | 是否对代理执行处置动作，固定值**1**。如果无需对代理行为执行处置动作时无需传入该参数。\n    -  **blockSimulator**：Integer类型 | 可选 | 是否对模拟器执行处置动作，固定值**1**。如果无需对模拟器行为执行处置动作时无需传入该参数。\n\n    - **示例**\n\n    ```\n    {\n        \"name\":\"test\",\n        \"uri\":\"/index\",\n        \"matchType\":\"all\",\n        \"arg\":\"test\",\n        \"action\":\"close\",\n        \"hasTag\":true,\n        \"wxbbVmpFieldType\":2,\n        \"wxbbVmpFieldValue\":\"test\",\n        \"blockInvalidSign\":1,\n        \"blockProxy\":1\n    }\n    ```\n\n- 自定义防护策略规则配置（**ac_custom**），通过其对应的JSON字符串中的**scene**参数来设置ACL访问控制规则和CC攻击防护规则。\n\n    - 设置ACL访问控制规则（**scene**参数值为**custom_acl**），其对应的JSON字符串中包含以下参数：\n\n        - **name**：String类型 | 必选 | 规则名称。\n        - **scene**：String类型 | 必选 | 防护类型。设置ACL访问控制规则时。取值固定为**custom_acl**。\n        - **action**：String类型 | 必选 | 处置动作。取值：\n            - **monitor**：表示观察。\n            - **captcha**：表示滑块。\n            - **captcha_strict**：表示严格滑块。\n            - **js**：表示JS验证。\n            - **block**：表示阻断。\n\n        - **conditions**：Array类型 | 必选 | 匹配条件，支持填写最多五个匹配条件。以JSON字符串格式进行描述，具体包含以下参数：\n\n            - **key**：匹配字段。取值范围：**URL**、**IP**、**Referer**、**User-Agent**、**Params**、**Cookie**、**Content-Type**、**Content-Length**、**X-Forwarded-For**、**Post-Body**、**Http-Method**、**Header**、**URLPath**。\n\n            - **opCode**：逻辑符。取值：\n\n            > 并不是每一个自定义规则的匹配字段（**key**）都能对应配置全部的逻辑符（**opcode**）。关于不同匹配字段支持使用的逻辑符，请以[WAF控制台](https://yundun.console.aliyun.com/?p=wafnext)自定义规则中匹配字段和逻辑符的关联关系为准。\n\n                - **11**：表示等于。\n                - **10**：表示不等于。\n                - **41**：表示等于多值之一。\n                - **50**：表示不等于任一值。\n                - **1**：表示包含。\n                - **0**：表示不包含。\n                - **51**：表示包含多值之一。\n                - **52**：表示不包含任一值。\n                - **82**：表示存在。\n                - **2**：表示不存在。\n                - **21**：表示长度等于。\n                - **22**：表示长度大于。\n                - **20**：表示长度小于。\n                - **60**：表示正则不匹配。\n                - **61**：表示正则匹配。\n                - **72**：表示前缀匹配。\n                - **81**：表示后缀匹配。\n                - **80**：表示内容为空。\n\n            - **values**：匹配内容。根据需要填写相应的内容，以String类型表示。\n\n        \t> 匹配条件参数中的逻辑符（**opCode**）、匹配内容（**values**）参数取值范围与所指定的匹配字段（**key**）相关。关于支持的匹配条件配置详细信息，请参见[匹配条件字段说明](~~147945~~)。\n\n        - **示例**\n        ```\n        {\n            \"action\":\"monitor\",\n            \"name\":\"test\",\n            \"scene\":\"custom_acl\",\n            \"conditions\":[{\"opCode\":1,\"key\":\"URL\",\"values\":\"/example\"}]\n        }\n        ```\n\n    - 设置CC攻击防护规则（**scene**参数值为**custom_cc**），对应的JSON字符串中包含以下参数：\n\n        - **name**：String类型 | 必选 | 规则名称。\n        - **scene**：String类型 | 必选 | 防护类型。设置CC攻击防护规则时，固定为**custom_cc**。\n        - **conditions**：Array类型 | 必选 | 匹配条件，支持填写最多五个匹配条件。以JSON字符串格式进行描述，具体包含以下参数：\n\n            - **key**：匹配字段。取值范围：**URL**、**IP**、**Referer**、**User-Agent**、**Params**、**Cookie**、**Content-Type**、**Content-Length**、**X-Forwarded-For**、**Post-Body**、**Http-Method**、**Header**、**URLPath**。\n\n            - **opCode**：逻辑符。取值：\n\n            > 并不是每一个自定义规则的匹配字段（**key**）都能对应配置全部的逻辑符（**opcode**）。关于不同匹配字段支持使用的逻辑符，请以[WAF控制台](https://yundun.console.aliyun.com/?p=wafnext)自定义规则中匹配字段和逻辑符的关联关系为准。\n    \n                - **11**：表示等于。\n                - **10**：表示不等于。\n                - **41**：表示等于多值之一。\n                - **50**：表示不等于任一值。\n                - **1**：表示包含。\n                - **0**：表示不包含。\n                - **51**：表示包含多值之一。\n                - **52**：表示不包含任一值。\n                - **82**：表示存在。\n                - **2**：表示不存在。\n                - **21**：表示长度等于。\n                - **22**：表示长度大于。\n                - **20**：表示长度小于。\n                - **60**：表示正则不匹配。\n                - **61**：表示正则匹配。\n                - **72**：表示前缀匹配。\n                - **81**：表示后缀匹配。\n                - **80**：表示内容为空。\n\n            - **values**：匹配内容。根据需要填写相应的内容，以String类型表示。\n\n        \t> 匹配条件参数中的逻辑符（**opCode**）、匹配内容（**values**）参数取值范围与所指定的匹配字段（**key**）相关。\n\n        - **action**：String类型 | 必选 | 处置动作。取值：\n\n            - **monitor**：表示观察。\n            - **captcha**：表示滑块。\n            - **captcha_strict**：表示严格滑块。\n            - **js**：表示JS验证。\n            - **block**：表示阻断。\n\n        - **ratelimit**：JSON格式 | 必选 | 频率设置。以JSON字符串格式进行描述，具体包含以下参数：\n\n            - **target**：String类型 | 必选 | 统计对象类型。取值：\n                - **remote_addr**：表示IP。\n                - **cookie.acw_tc**：表示Session。\n                - **queryarg**：表示自定义参数。选择自定义参数时，必须在**subkey**参数中填写需要统计的自定义参数名称。\n                - **cookie**：表示自定义cookie。选择自定义cookie时，必选在**subkey**参数中填写需要统计的cookie内容。\n                - **header**：表示自定义header。选择自定义header时，必选在**subkey**参数中填写需要统计的header内容。\n            - **subkey**：String类型 | 可选 | 当**target**参数值为**cookie**、**header**或**queryarg**时，必选在**subkey**参数中填写对应的信息。\n            - **interval**： Integer类型 | 必选 | 统计时长（单位：秒），即访问次数的统计周期，与阈值（**threshold**）参数配合。\n            - **threshold**：Integer类型 | 必选 | 在检测时长内，允许单个统计对象访问被防护地址的次数阈值。\n            - **status**：JSON格式 | 可选 | 响应码频率设置。以JSON字符串格式进行描述，具体包含以下参数：\n                - **code**：Integer类型 | 必选 |  指定响应码。\n                - **count**：Integer类型 | 可选 | 出现次数阈值，即表示当指定的响应码出现次数超过该阈值时命中防护规则。取值范围：1~999999999。**count**参数与**ratio**参数两者选其一，不可同时配置。\n                - **ratio**：Integer类型 | 可选 | 出现比例阈值（百分比），即表示当指定的响应码出现比例超过该阈值时命中防护规则。取值范围：1~100。**count**参数与**ratio**参数两者选其一，不可同时配置。\n            - **scope**：String类型 | 必选 | 生效范围。取值：\n                - **rule**：表示当前特征匹配范围内。\n                - **domain**：表示当前规则作用的域名范围内。\n            - **ttl**：Integer类型 | 必选 | 处置动作的生效时长（单位：秒）。取值范围：60~86400。\n\n        - **示例**\n\n        ```\n        {\n            \"name\":\"CC防护\",\n            \"conditions\":[{\"opCode\":1,\"key\":\"URL\",\"values\":\"/example\"}],\n            \"action\":\"block\", \n            \"scene\":\"custom_cc\",  \n            \"ratelimit\":{\n                \"target\": \"remote_addr\", \n                \"interval\": 300,\n                \"threshold\": 2000,\n                \"status\": {\n                    \"code\": 404,\n                    \"count\": 200\n                },\n                \"scope\": \"rule\",\n                \"ttl\": 1800\n            }\n        }\n        ```\n\n- 网站白名单规则配置（**whitelist**）对应的JSON字符串中包含以下参数：\n\n    - **name**：String类型 | 必选 | 规则名称。\n    - **tags**：Array类型 | 必选 | 不检测模块。不同类型的白名单规则支持设置的不检测模块（**tags**）不同，具体说明如下：\n\n        > **tags**的取值只能包含具体白名单类型下罗列的取值。例如，**tags**取值不允许同时包含**regular**和**cc**，因为**regular**属于Web入侵防护白名单下的取值、**cc**属于访问控制/限流白名单下的取值。\n\n        - 如需设置全局白名单，**tags**取值：\n            - **waf**：表示不检测所有防护模块。\n\n        - 如需设置Web入侵防护白名单，**tags**取值（可设置多个）：\n            - **regular**：表示不检测规则防护引擎（包含所有防护规则）。\n            - **regular_rule**：表示不检测规则防护引擎中的指定防护规则（如选择该取值，必须通过**regularRules**参数设置不检测的规则ID）。\n            - **regular_type**：表示不检测规则防护引擎中指定类型的防护规则（如选择该取值，必须通过**regularTypes**参数设置不检测的规则类型）。\n            - **deeplearning**：表示不检测深度学习引擎。\n\n        - 如需设置访问控制/限流白名单，**tags**取值（可设置多个）：\n            - **cc**：表示不检测CC安全防护模块。\n            - **customrule**：表示不检测自定义防护策略。\n            - **blacklist**：表示不检测IP黑名单模块。\n            - **antiscan**：表示不检测扫描防护模块。\n\n        - 如需设置数据安全白名单，**tags**取值（可设置多个）：\n            - **dlp**：表示不检测防敏感信息泄露模块。\n            - **tamperproof**：表示不检测网站防篡改模块。\n            - **account**：表示不检测账户安全模块。\n\n        - 如需设置Bot防护白名单，**tags**取值（可设置多个）：\n            - **bot_intelligence**：表示不检测爬虫威胁情报模块。\n            - **bot_algorithm**：表示不检测典型爬虫行为识别模块。\n            - **bot_wxbb**：表示不检测App防护模块。\n            - **antifraud**：表示不检测数据风控模块。\n\n    - **regularRules**：Array类型 | 可选 | 不检测的防护规则ID列表。如果**tags**参数的取值中包含**regular_rule**，必须填写该参数。您可以在[WAF控制台](https://yundun.console.aliyun.com/?p=wafnext)的**防护规则组**页面，通过**新建规则组**，查询WAF包含的所有Web攻击防护规则，获取相关规则的ID。具体操作，请参见[自定义防护规则组](~~99262~~)。\n    - **regularTypes**：Array类型 | 可选 | 不检测的防护规则类型列表。如果**tags**参数取值中包含**regular_type**，必须填写该参数。取值：\n        - **sqli**: 表示SQL注入。\n        - **xss**: 表示跨站脚本。\n        - **code_exec**: 表示代码执行。\n        - **lfilei**: 表示本地文件包含。\n        - **rfilei**: 表示远程文件包含。\n        - **webshell**: 表示WebShell。\n        - **vvip**: 表示定制的防护规则。\n        - **other**: 表示其他类型。\n\t\t\n    - **conditions**：Array类型 | 必选 | 匹配条件，支持填写最多五个匹配条件。以JSON字符串格式进行描述，具体包含以下参数：\n\n        - **key**：匹配字段。取值范围：**URL**、**IP**、**Referer**、**User-Agent**、**Params**、**Cookie**、**Content-Type**、**Content-Length**、**X-Forwarded-For**、**Post-Body**、**Http-Method**、**Header**、**URLPath**。\n\n        - **opCode**：逻辑符。取值：\n\n        > 并不是每一个自定义规则的匹配字段（**key**）都能对应配置全部的逻辑符（**opcode**）。关于不同匹配字段支持使用的逻辑符，请以[WAF控制台](https://yundun.console.aliyun.com/?p=wafnext)自定义规则中匹配字段和逻辑符的关联关系为准。\n\n            - **11**：表示等于。\n            - **10**：表示不等于。\n            - **41**：表示等于多值之一。\n            - **50**：表示不等于任一值。\n            - **1**：表示包含或属于。\n            - **0**：表示不包含或不属于。\n            - **51**：表示包含多值之一。\n            - **52**：表示不包含任一值。\n            - **82**：表示存在。\n            - **2**：表示不存在。\n            - **21**：表示长度等于。\n            - **22**：表示长度大于。\n            - **20**：表示长度小于。\n            - **60**：表示正则不匹配。\n            - **61**：表示正则匹配。\n            - **72**：表示前缀匹配。\n            - **81**：表示后缀匹配。\n            - **80**：表示内容为空。\n            - **30**：表示值小于。\n            - **31**：表示值大于。\n\n        - **values**：匹配内容。根据需要填写相应的内容，以String类型表示。\n\n    > 匹配条件参数中的逻辑符（**opCode**）、匹配内容（**values**）参数取值范围与所指定的匹配字段（**key**）相关。\n\n    - **示例**\n  \n    ```\n    {\n        \"name\": \"test\",\n        \"tags\": [\"cc\",\"customrule\"],\n        \"conditions\":[{\"opCode\":1,\"key\":\"URL\",\"values\":\"/example\"}],\n   }\n   ``` \n\n\n调用API时，除了本文中该API的请求参数，还需加入阿里云API公共请求参数。公共请求参数的详细介绍，请参见[公共参数](~~162719~~)。\n\n调用API的请求格式，请参见本文**示例**中的请求示例。","responseParamsDescription":" ","extraInfo":" "}