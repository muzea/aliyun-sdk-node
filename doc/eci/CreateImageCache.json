{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"17725","abilityTreeNodes":["FEATUREeciIGQQJ4"]},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"地域ID。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"RegionId","in":"query","schema":{"description":"地域ID。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"ZoneId","in":"query","schema":{"description":"可用区。","type":"string","required":false,"example":"cn-hangzhou-g"}},{"name":"SecurityGroupId","in":"query","schema":{"description":"安全组ID。","type":"string","required":false,"docRequired":true,"example":"sg-uf66jeqopgqa9hdn****"}},{"name":"VSwitchId","in":"query","schema":{"description":"交换机ID。支持指定多个交换机ID（单次最多10个），各交换机ID之间可以用半角逗号（,）进行分割，例如`vsw-***,vsw-***`。","type":"string","required":false,"docRequired":true,"example":"vsw-uf6h3rbwbm90urjwa****"}},{"name":"ImageCacheName","in":"query","schema":{"description":"镜像缓存名称。","type":"string","required":true,"docRequired":true,"example":"testcache"}},{"name":"EipInstanceId","in":"query","schema":{"description":"弹性公网IP。如果需要拉取公网镜像，需要确保ECI实例能够访问公网，您可以配置EIP或者NAT网关实现公网访问。","type":"string","required":false,"example":"eip-2zedsm5mfl3uhdj2d****"}},{"name":"ResourceGroupId","in":"query","schema":{"description":"资源组ID。","type":"string","required":false,"example":"rg-aekzh43v*****"}},{"name":"ClientToken","in":"query","schema":{"description":"保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持ASCII字符，且不能超过64个字符。更多信息，请参见[如何保证幂等性](~~25693~~)。","type":"string","required":false,"example":"123e4567-xxx-xxx-xxxx-42665544xxxx"}},{"name":"ImageCacheSize","in":"query","schema":{"description":"镜像缓存的大小。默认为20 GiB。","type":"integer","format":"int32","required":false,"example":"20"}},{"name":"RetentionDays","in":"query","schema":{"description":"镜像缓存保留时间，过期将会被清理，默认永不过期。\n\n> 创建失败的镜像缓存仅保留一天。","type":"integer","format":"int32","required":false,"example":"7"}},{"name":"AutoMatchImageCache","in":"query","schema":{"description":"是否开启镜像缓存复用。开启后，新创建的镜像缓存可以复用已有镜像缓存的镜像层，加快镜像缓存的制作速度。取值范围：\n\n- true：开启\n\n- false：不开启\n\n默认为false。","type":"boolean","required":false,"example":"true"}},{"name":"ImageRegistryCredential","in":"query","style":"repeatList","schema":{"description":"镜像仓库信息。","type":"array","items":{"description":"镜像仓库信息。","type":"object","properties":{"Password":{"description":"镜像仓库密码。","type":"string","required":false,"example":"password"},"Server":{"description":"不带 `http://` 或  `https://` 前缀的镜像仓库地址。","type":"string","required":false,"example":"registry-vpc.cn-hangzhou.aliyuncs.com"},"UserName":{"description":"镜像仓库用户名。","type":"string","required":false,"example":"username"}},"required":false},"required":false,"maxItems":11}},{"name":"Image","in":"query","style":"repeatList","schema":{"description":"用于制作镜像缓存的容器镜像。","type":"array","items":{"description":"用于制作镜像缓存的容器镜像。","type":"string","required":false,"example":"registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl"},"required":true,"example":"registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl","maxItems":101}},{"name":"Tag","in":"query","style":"repeatList","schema":{"description":"镜像缓存标签信息，最多20个。","type":"array","items":{"description":"镜像缓存标签信息，最多20个。","type":"object","properties":{"Key":{"description":"镜像缓存标签键。","type":"string","required":false,"example":"imc"},"Value":{"description":"镜像缓存标签值。","type":"string","required":false,"example":"test"}},"required":false},"required":false,"maxItems":21}},{"name":"Flash","in":"query","schema":{"description":"是否开启极速镜像缓存功能，开启后，可以加速镜像缓存创建。取值范围：\n\n- true：开启\n\n- false：不开启\n\n默认为false。","type":"boolean","required":false,"example":"true"}},{"name":"AcrRegistryInfo","in":"query","style":"repeatList","schema":{"description":"ACR实例信息。更多信息，请参见[免密拉取ACR镜像](~~194250~~)。","type":"array","items":{"description":"ACR实例信息。","type":"object","properties":{"Domain":{"description":"ACR企业版实例的域名。默认为相应实例的所有域名。支持指定个别域名，多个以半角逗号分隔。","type":"array","items":{"description":"ACR企业版实例的域名。默认为相应实例的所有域名。支持指定个别域名，多个以半角逗号分隔。","type":"string","required":false,"example":"test****-registry.cn-beijing.cr.aliyuncs.com"},"required":false,"example":"test****-registry.cn-beijing.cr.aliyuncs.com","maxItems":100},"InstanceName":{"description":"ACR企业版实例的名称。","type":"string","required":false,"example":"test****"},"InstanceId":{"description":"ACR企业版实例ID。","type":"string","required":false,"example":"cri-nwj395hgf6f3****"},"RegionId":{"description":"ACR企业版实例所属地域。","type":"string","required":false,"example":"cn-beijing"},"ArnService":{"description":"ECI实例等资源归属账号下的RAM角色的ARN。","type":"string","required":false,"example":"acs:ram::1609982529******:role/role-assume"},"ArnUser":{"description":"ACR实例归属账号下的RAM角色的ARN。","type":"string","required":false,"example":"acs:ram::1298452580******:role/role-acr"}},"required":false},"required":false,"maxItems":21}},{"name":"Annotations","in":"query","schema":{"description":"注解。该参数暂不对外使用。","type":"string","required":false,"example":"hide"}},{"name":"PlainHttpRegistry","in":"query","schema":{"description":"自建镜像仓库地址。使用HTTP协议的自建镜像仓库中的镜像创建镜像缓存时，需配置该参数，使得ECI使用HTTP协议拉取镜像，避免因协议不同而导致镜像拉取失败。","type":"string","required":false,"example":"\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\""}},{"name":"InsecureRegistry","in":"query","schema":{"description":"自建镜像仓库地址。\n\n使用自签发证书的自建镜像仓库中的镜像创建镜像缓存时，需配置该参数来跳过证书认证，避免因证书认证失败而导致镜像拉取失败。","type":"string","required":false,"example":"\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\""}},{"name":"StandardCopyCount","in":"query","schema":{"description":"普通快照副本数。默认情况下，一个镜像缓存对应一个快照。如果该镜像缓存将用于批量创建多个ECI实例，建议您配置该参数实现快照多副本。推荐每1000个ECI实例增加一个快照副本。\n\n> 未开启极速镜像缓存功能（Flash取值为false）时，创镜像缓存的过程中仅生成普通快照。","type":"integer","format":"int32","required":false,"example":"7"}},{"name":"FlashCopyCount","in":"query","schema":{"description":"本地快照副本数。默认情况下，一个镜像缓存对应一个快照。如果该镜像缓存将用于批量创建多个ECI实例，建议您配置该参数实现快照多副本。推荐每1000个ECI实例增加一个快照副本。\n\n> 开启极速镜像缓存功能（Flash取值为true）时，创建镜像缓存的过程中将先创建本地快照，在本地快照创建完成后开始创建普通快照，待普通快照创建完成后会自动删除本地快照。","type":"integer","format":"int32","required":false,"example":"7"}},{"name":"EliminationStrategy","in":"query","schema":{"description":"镜像缓存的淘汰策略。默认为空，表示一直保留。\n\n支持配置为LRU，表示可以被自动删除。当镜像缓存数量达到配额限制时，系统将自动删除最不常用的EliminationStrategy为LRU的镜像缓存。","type":"string","required":false,"example":"LRU"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID，唯一标识。","type":"string","example":"0E234675-3465-4CC3-9D0F-9A864BC391DD"},"ImageCacheId":{"description":"镜像缓存ID。","type":"string","example":"imc-2zebxkiifuyzzlhl****"},"ContainerGroupId":{"description":"用于中转创建镜像缓存的ECI实例ID。\n","type":"string","example":"eci-2zebxkiifuyzzlhl****"}}}}},"errorCodes":{"400":[{"errorCode":"Account.Arrearage","errorMessage":"Your account has an outstanding payment."},{"errorCode":"DryRunOperation","errorMessage":"Request validation has been passed with DryRun flag set."},{"errorCode":"InvalidParameter.CPU.Memory","errorMessage":"The specified cpu and memory are not allowed"},{"errorCode":"IncorrectStatus","errorMessage":"%s"},{"errorCode":"ServiceNotEnabled","errorMessage":"%s"},{"errorCode":"DiskVolume.NotSupport","errorMessage":"The disk volume is not supported."},{"errorCode":"RamRole.NotSupport","errorMessage":"The RAM role is not supported."},{"errorCode":"ImageCache.IncorrectStatus","errorMessage":"%s"},{"errorCode":"ImageCacheNotSupport","errorMessage":"Image cache is not available for all users. If you want to enable this function, contact us."},{"errorCode":"EipAddressPoolIpNotEnough","errorMessage":"The ip address of specified PublicIpAddressPool is not enough."},{"errorCode":"OperationConflict","errorMessage":"The request was denied. It conflicts with a previous request."}],"403":[{"errorCode":"OperationDenied.VswZoneMisMatch","errorMessage":"The specified VSwitchId is not in the specified Zone."},{"errorCode":"QuotaExceeded","errorMessage":"%s quota exceeded."},{"errorCode":"Zone.NotOnSale","errorMessage":"The specified zone is not available for purchase."},{"errorCode":"Forbidden.RiskControl","errorMessage":"This operation has been identified as an abnormal operation and cannot be processed."},{"errorCode":"Forbidden.SubUser","errorMessage":"The specified action is not available for you."},{"errorCode":"Forbidden.OnlyForInvitedTest","errorMessage":"Eci create action is only open to invited users during public beta."},{"errorCode":"OperationDenied.SecurityGroupMisMatch","errorMessage":"The specified VSwitchId and SecurityGroupId are not in the same VPC."},{"errorCode":"InvalidVSwitchId.IpNotEnough","errorMessage":"The specified VSwitch does not have enough IP addresses."},{"errorCode":"Forbidden.UserBussinessStatus","errorMessage":"This operation is not allowed, because you have overdue bills. Pay the overdue bill and try again."},{"errorCode":"Forbidden.UserNotRealNameAuthentication","errorMessage":"This operation is not allowed, because you have not passed the real-name verification."},{"errorCode":"InvalidUser.PassRoleForbidden","errorMessage":"The RAM user is not authorized to assume a RAM role."},{"errorCode":"OperationDenied.NoStock","errorMessage":"Sales of this resource are temporarily suspended in the specified zone. We recommend that you use the multi-zone creation function to avoid the risk of insufficient resource. For more information, see https://help.aliyun.com/document_detail/157290.html"},{"errorCode":"NoPermission","errorMessage":"The RAM role AliyunECIContainerGroupRole does not belong to eci.aliyuncs.com. Please check and try again."},{"errorCode":"SecurityRisk.3DVerification","errorMessage":"We have detected a security risk with your default credit or debit card. Please proceed with verification via the link in your email."},{"errorCode":"CreateServiceLinkedRole.Denied","errorMessage":"Please make sure the account has ram:CreateServiceLinkedRole permission."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"0E234675-3465-4CC3-9D0F-9A864BC391DD\\\",\\n  \\\"ImageCacheId\\\": \\\"imc-2zebxkiifuyzzlhl****\\\",\\n  \\\"ContainerGroupId\\\": \\\"eci-2zebxkiifuyzzlhl****\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateImageCacheResponse>\\n    <ImageCacheId>imc-2zebxkiifuyzzlhl****</ImageCacheId>\\n    <RequestId>0E234675-3465-4CC3-9D0F-9A864BC391DD</RequestId>\\n    <ContainerGroupId>eci-2zebxkiifuyzzlhl****</ContainerGroupId>\\n</CreateImageCacheResponse>\",\"errorExample\":\"\"}]","title":"创建一个镜像缓存","summary":"调用CreateImageCache接口创建一个镜像缓存，以便后续创建ECI实例可以加速镜像拉取，减少实例启动耗时。","description":"### 注意事项\n\n- 创建镜像缓存涉及资源计费。建议您提前了解相关计费信息。更多信息，请参见[镜像缓存计费](~~447682~~)。\n- 创建镜像缓存前，您需要评估待缓存镜像的总大小，如果镜像总大小超过设置的缓存大小，将会创建失败。\n- 创建镜像缓存时，系统将自动创建一个ECI实例和一块ESSD PL1类型的云盘用于中转创建镜像缓存。创建过程中请勿删除ECI实例和云盘，否则镜像缓存将创建失败。\n- 创建镜像缓存将生成对应的快照。请勿删除快照，否则镜像缓存将会失效。\n- 如果使用SDK，则对应版本为：Java 1.0.10以上，Python 1.0.7以上。\n\n### 使用建议\n- 对于使用自定义域名的ACR企业版镜像，需要指定ACR实例（设置AcrRegistryInfo相关参数）来配置免密。设置AcrRegistryInfo相关参数时，必须设置AcrRegistryInfo.N.InstanceId。\n- 如果该镜像缓存将用于批量创建多个（超过1000个）ECI实例，建议您设置StandardCopyCount和FlashCopyCount实现快照多副本功能。快照多副本按增量数据收费，由于本次创建的多个快照副本数据均一致，因此使用快照多副本功能不会增加额外费用。\n\n> 调用CreateImageCache创建镜像缓存时，系统将自动为您创建一个服务关联角色AliyunServiceRoleForECI，用于访问ECS、VPC等相关云服务。更多信息，请参见[弹性容器实例服务关联角色](~~212914~~)。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}