{"summary":"操作审计默认为每个阿里云账号记录最近90天的事件。为了能够追溯90天以前的事件，您可以创建跟踪，将操作事件投递到对象存储OSS、日志服务SLS或大数据计算服务MaxCompute，以便对事件进行分析。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"create"},"parameters":[{"name":"Name","in":"query","schema":{"description":"创建的跟踪名称。  \n长度为6～36个字符，必须以小写英文字母开头，可包含小写英文字母、数字、短划线（-）和下划线（_）。\n>同一个账号内跟踪名称不可重复。","type":"string","required":true,"docRequired":true,"example":"trail-test"}},{"name":"OssBucketName","in":"query","schema":{"description":"跟踪投递的OSS存储空间。  \n长度为3～63个字符，必须以小写英文字母或者数字开头，可包含小写英文字母、数字和短划线（-）。  \n\n> OssBucketName、SlsProjectArn、MaxComputeProjectArn需至少指定其中一个参数。","type":"string","required":false,"example":"audit-log"}},{"name":"OssKeyPrefix","in":"query","schema":{"description":"跟踪投递的OSS存储空间文件名的前缀，可为空。  \n长度为6～32个字符，必须以英文字母开头，可包含英文字母、数字、短划线（-）、正斜线（/）和下划线（_）。","type":"string","required":false,"example":"at-product-account-audit-B"}},{"name":"OssWriteRoleArn","in":"query","schema":{"description":"操作审计向对象存储OSS存储空间投递操作事件时，扮演的角色ARN。\n\n- 如果不指定该参数，操作审计会通过创建服务关联角色来创建相应的资源。更多信息，请参见[操作审计服务关联角色](~~169244~~)。  \n- 如果指定了该参数，当您需要将事件投递到本账号时，需要为RAM角色授予操作审计服务关联角色权限。当您需要将事件投递到其他账号时，需要为RAM角色绑定操作事件投递的系统权限策略。关于如何进行跨账号投递，请参见[将多个阿里云账号的事件投递到同一账号](~~207462~~)。","type":"string","required":false,"docRequired":false,"example":"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail"}},{"name":"SlsProjectArn","in":"query","schema":{"description":"跟踪投递的日志服务项目的ARN。  \n\n> OssBucketName、SlsProjectArn、MaxComputeProjectArn需至少指定其中一个参数。","type":"string","required":false,"example":"acs:log:cn-shanghai:151266687691****:project/test-project"}},{"name":"SlsWriteRoleArn","in":"query","schema":{"description":"操作审计向日志服务项目投递操作事件时，扮演的角色ARN。\n\n- 如果不指定该参数，操作审计会通过创建服务关联角色来创建相应的资源。更多信息，请参见[操作审计服务关联角色](~~169244~~)。\n- 如果指定了该参数，当您需要将事件投递到本账号时，需要为RAM角色授予操作审计服务关联角色权限。当您需要将事件投递到其他账号时，需要为RAM角色绑定操作事件投递的系统权限策略。关于如何进行跨账号投递，请参见[将多个阿里云账号的事件投递到同一账号](~~207462~~)。","type":"string","required":false,"example":"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail"}},{"name":"EventRW","in":"query","schema":{"description":"投递事件的读写类型，取值：\n- Write（默认值）：写类型。\n- Read：读类型。\n- All：读类型和写类型。","type":"string","required":false,"example":"Write"}},{"name":"TrailRegion","in":"query","schema":{"description":"跟踪的地域。  \n默认值为All，表示跟踪全部地域的事件。  \n您也可以指定具体的地域。关于地域的更多信息，请调用[DescribeRegions](~~213597~~)接口查询。","type":"string","required":false,"example":"All"}},{"name":"IsOrganizationTrail","in":"query","schema":{"description":"是否创建多账号跟踪，取值：\n\n- true：创建多账号跟踪。\n- false（默认值）：创建单账号跟踪。","type":"boolean","required":false,"example":"false"}},{"name":"MaxComputeProjectArn","in":"query","schema":{"description":"跟踪投递的大数据计算服务项目的ARN。  \n\n> OssBucketName、SlsProjectArn、MaxComputeProjectArn需至少指定其中一个参数。\n\n> MaxComputeProjectArn中指定的大数据计算服务项目名称必须以actiontrail_作为前缀。","type":"string","required":false,"example":"acs:odps:cn-hangzhou:151266687691****:project/actiontrail_****"}},{"name":"MaxComputeWriteRoleArn","in":"query","schema":{"description":"操作审计向大数据计算服务项目投递操作事件时，扮演的角色ARN。\n\n- 如果不指定该参数，操作审计会通过创建服务关联角色来创建相应的资源。更多信息，请参见[操作审计服务关联角色](~~169244~~)。\n- 如果指定了该参数，当您需要将事件投递到本账号时，需要为RAM角色授予操作审计服务关联角色权限。当您需要将事件投递到其他账号时，需要为RAM角色绑定操作事件投递的系统权限策略。关于如何进行跨账号投递，请参见[将多个阿里云账号的事件投递到同一账号](~~207462~~)。","type":"string","required":false,"example":"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail"}}],"responses":{"200":{"schema":{"type":"object","properties":{"SlsProjectArn":{"description":"跟踪投递的日志服务项目的ARN。","type":"string","example":"acs:log:cn-hangzhou:151266687691****:project/test-project"},"OssWriteRoleArn":{"description":"操作审计向对象存储OSS存储空间投递操作事件时，扮演的角色ARN。","type":"string","example":"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail"},"EventRW":{"description":"投递事件的读写类型。","type":"string","example":"Write"},"RequestId":{"description":"请求ID。","type":"string","example":"442DDADF-DA58-4029-8E8B-82C73E9A7A70"},"HomeRegion":{"description":"跟踪的Home地域。","type":"string","example":"cn-hangzhou"},"OssKeyPrefix":{"description":"OSS存储空间文件名的前缀。","type":"string","example":"at-product-account-audit-B"},"OssBucketName":{"description":"OSS存储空间。","type":"string","example":"audit-log"},"SlsWriteRoleArn":{"description":"操作审计向日志服务项目投递操作事件时，扮演的角色ARN。","type":"string","example":"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail"},"TrailRegion":{"description":"跟踪的地域。","type":"string","example":"All"},"Name":{"description":"跟踪名称。","type":"string","example":"trail-test"},"MaxComputeProjectArn":{"description":"跟踪投递的大数据计算服务项目的ARN。","type":"string","example":"acs:odps:cn-hangzhou:151266687691****:project/actiontrail_****"},"MaxComputeWriteRoleArn":{"description":"操作审计向大数据计算服务项目投递操作事件时，扮演的角色ARN。","type":"string","example":"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidDeliveryConfigurationException","errorMessage":"You must specify at least one Log Service project or OSS bucket for a Trail."},{"errorCode":"InvalidPrefixException","errorMessage":"The specified OSS bucket prefix is invalid."},{"errorCode":"InvalidQueryParameter","errorMessage":"The specified query parameter is invalid."},{"errorCode":"InvalidTrailNameException","errorMessage":"The specified Trail name is invalid."},{"errorCode":"RepeatOssBucket","errorMessage":"The specified OSS bucket is already in use. We recommend that you modify the existing Trail or specify another bucket."},{"errorCode":"SlsProjectDoesNotExistException","errorMessage":"The specified Log Service project does not exist."},{"errorCode":"TrailAlreadyExistsException","errorMessage":"The specified Trail name already exists."},{"errorCode":"MaximumNumberOfOrganizationTrailExceeded","errorMessage":"Your account can create only one organization trail."},{"errorCode":"NotAllowCreateOrganizationTrail","errorMessage":"Your account does not allow you to create organization trail. Submit a ticket to get customer support."}],"403":[{"errorCode":"InsufficientBucketPolicyException","errorMessage":"Access to the specified OSS bucket was denied."},{"errorCode":"InsufficientSlsPolicyException","errorMessage":"Access to the specified Log Service project was denied."},{"errorCode":"MaximumNumberOfTrailsExceededException","errorMessage":"The number of Trails in the same region exceeds the upper limit (5)."}],"404":[{"errorCode":"BucketDoesNotExistException","errorMessage":"The specified OSS bucket does not exist."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"SlsProjectArn\\\": \\\"acs:log:cn-hangzhou:151266687691****:project/test-project\\\",\\n  \\\"OssWriteRoleArn\\\": \\\"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail\\\",\\n  \\\"EventRW\\\": \\\"Write\\\",\\n  \\\"RequestId\\\": \\\"442DDADF-DA58-4029-8E8B-82C73E9A7A70\\\",\\n  \\\"HomeRegion\\\": \\\"cn-hangzhou\\\",\\n  \\\"OssKeyPrefix\\\": \\\"at-product-account-audit-B\\\",\\n  \\\"OssBucketName\\\": \\\"audit-log\\\",\\n  \\\"SlsWriteRoleArn\\\": \\\"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail\\\",\\n  \\\"TrailRegion\\\": \\\"All\\\",\\n  \\\"Name\\\": \\\"trail-test\\\",\\n  \\\"MaxComputeProjectArn\\\": \\\"acs:odps:cn-hangzhou:151266687691****:project/actiontrail_****\\\",\\n  \\\"MaxComputeWriteRoleArn\\\": \\\"acs:ram::151266687691****:role/aliyunserviceroleforactiontrail\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"\",\"errorExample\":\"\"}]","title":"创建跟踪","description":"> 通过API创建的跟踪默认处于**已关闭**状态，您需要调用接口[StartLogging](~~432246~~)开启跟踪，操作审计才能投递操作事件至目标云产品。\n\n### 前提条件\n创建跟踪之前，请您确保至少完成下列的一项存储配置：\n- 投递到对象存储OSS\n\n  请确保您已开通对象存储，且已创建存储空间（Bucket）。\n\n- 投递到日志服务SLS\n   \n  请确保您已开通日志服务，且已创建日志项目。  \n  > 创建跟踪时，操作审计会自动在目标日志项目下创建一个名为`actiontrail_<跟踪名称>`的日志库（Logstore），该日志库禁止其他数据写入，保证审计数据的准确性。\n\n- 投递到大数据计算服务MaxCompute\n\n  请确保您已开通大数据计算服务MaxCompute。\n\n  > 创建跟踪时，操作审计会自动在项目管理中创建一个名为`actiontrail_<账号ID>`的项目，该项目禁止其他数据写入，保证审计数据的准确性。\n\n### 使用说明\n本文将提供一个示例，为您创建一个名为`trail-test`的单账号跟踪，将操作事件投递到名为`audit-log`的OSS存储空间中。","requestParamsDescription":"关于公共请求参数的详情，请参见[公共参数](~~185885~~)。","responseParamsDescription":" ","extraInfo":" "}