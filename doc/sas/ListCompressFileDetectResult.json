{"summary":"获取压缩包内文件检测结果列表。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"list","riskType":"none","chargeType":"free","abilityTreeCode":"215080","abilityTreeNodes":["FEATUREsasNPORLE"]},"parameters":[{"name":"SourceIp","in":"query","schema":{"description":"访问源IP地址。","type":"string","required":false,"example":"27.9.XX.XX"}},{"name":"HashKey","in":"query","schema":{"description":"文件标识，目前仅支持 md5。","type":"string","required":false,"example":"0a212417e65c26ff133cfff28f6c****"}},{"name":"CurrentPage","in":"query","schema":{"description":"分页查询时，显示的当前页的页码。默认值为1。","type":"integer","format":"int32","required":true,"minimum":"1","example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询时，显示的每页数据的最大条数。默认值为20。","type":"integer","format":"int32","required":true,"maximum":"100","minimum":"1","example":"20"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"本次调用请求的ID，是由阿里云为该请求生成的唯一标识符，可用于排查和定位问题。","type":"string","example":"E10BAF1C-A6C5-51E2-866C-76D5922E****"},"PageInfo":{"description":"分页信息。","type":"object","properties":{"CurrentPage":{"description":"分页查询时，显示的当前页的页码。","type":"integer","format":"int32","example":"1"},"PageSize":{"description":"分页查询时，每页最多显示的数据条数。","type":"integer","format":"int32","example":"20"},"TotalCount":{"description":"数据的总条数。","type":"integer","format":"int32","example":"55"}}},"ResultList":{"description":"压缩包内文件检测结果列表。","type":"array","items":{"description":"文件检测结果信息。","type":"object","properties":{"HashKey":{"description":"文件标识。","type":"string","example":"0a212417e65c26ff133cfff28f6c****"},"Result":{"description":"文件检测结果。取值：\n\n- **0**：安全文件\n- **1**：可疑文件\n- **3**：检测中，请等待\n\n","type":"integer","format":"int32","example":"0"},"Score":{"description":"文件检测分数。分数区间及危险等级的对应关系如下：\n\n- 0~60：安全\n- 61~70：风险\n- 71~80：可疑\n- 81~100：恶意\n\n><notice>分数越高，文件越可疑。></notice>","type":"integer","format":"int32","example":"100"},"VirusType":{"description":"病毒类型。取值：\n\n- **Trojan**：自变异木马\n- **WebShell**：网站后门\n- **Backdoor**：后门程序\n- **RansomWare**：勒索病毒\n- **Scanner**：扫描器\n- **Stealer**：窃密工具\n- **Malbaseware**：被污染的基础软件\n- **Hacktool**：黑客工具\n- **Engtest**：引擎测试程序\n- **Downloader**：下载器木马\n- **Virus**：感染型病毒\n- **Miner**：挖矿程序\n- **Worm**：蠕虫病毒\n- **DDoS**：DDOS木马\n- **Malware**：恶意程序\n- **Backdoor**：反弹shell后门\n- **RiskWare**：风险软件\n- **Proxytool**：代理工具\n- **Suspicious**：可疑程序\n- **MalScript**：恶意脚本\n- **Rootkit**：Rootkit\n- **Exploit**：漏洞利用程序","type":"string","example":"WebShell"},"Ext":{"description":"检测结果扩展信息。","type":"string","example":"{\n    \"HighLight\":\n    [\n        [\n            23245,\n            23212\n        ]\n    ],\n    \"FileLabel\":\n    [\n        \"PE32\",\n        \"Zip\",\n        \"SFX\",\n        \"encrypted\"\n    ]\n}"},"Path":{"description":"文件在压缩包内的路径。","type":"string","example":"/root/1.zip/test****"}}}}}}}},"errorCodes":{"400":[{"errorCode":"RequestTooFrequently","errorMessage":"Request too frequently, please try again later"},{"errorCode":"GetResultFail","errorMessage":"Get result fail, found no detect record for this file or result has been expired"},{"errorCode":"InvalidApiDetectType","errorMessage":"Unsupported Api Detect Type."}],"403":[{"errorCode":"NoPermission","errorMessage":"caller has no permission"}],"500":[{"errorCode":"ServerError","errorMessage":"ServerError"},{"errorCode":"SystemBusy","errorMessage":"System busy, please try again later."}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"E10BAF1C-A6C5-51E2-866C-76D5922E****\\\",\\n  \\\"PageInfo\\\": {\\n    \\\"CurrentPage\\\": 1,\\n    \\\"PageSize\\\": 20,\\n    \\\"TotalCount\\\": 55\\n  },\\n  \\\"ResultList\\\": [\\n    {\\n      \\\"HashKey\\\": \\\"0a212417e65c26ff133cfff28f6c****\\\",\\n      \\\"Result\\\": 0,\\n      \\\"Score\\\": 100,\\n      \\\"VirusType\\\": \\\"WebShell\\\",\\n      \\\"Ext\\\": \\\"{\\\\n    \\\\\\\"HighLight\\\\\\\":\\\\n    [\\\\n        [\\\\n            23245,\\\\n            23212\\\\n        ]\\\\n    ],\\\\n    \\\\\\\"FileLabel\\\\\\\":\\\\n    [\\\\n        \\\\\\\"PE32\\\\\\\",\\\\n        \\\\\\\"Zip\\\\\\\",\\\\n        \\\\\\\"SFX\\\\\\\",\\\\n        \\\\\\\"encrypted\\\\\\\"\\\\n    ]\\\\n}\\\",\\n      \\\"Path\\\": \\\"/root/1.zip/test****\\\"\\n    }\\n  ]\\n}\",\"type\":\"json\"}]","title":"获取压缩包内文件检测结果列表","description":"推送过检测并且被识别为压缩包的文件才能通过此接口获取文件检测结果列表，检测结果将保留5小时，5小时内可重复查询。推送检测请参考接口CreateFileDetect。获压缩包文件本身检测结果请参考接口GetFileDetectResult。\n\n文件检测相关接口均包含HashKey参数，表示文件唯一标识，目前仅支持文件完整内容的十六进制md5值，请在使用接口前计算该值。\n\n计算文件内容的十六进制md5值可以参考以下两个步骤：\n\n1.使用MD5算法对数据进行加密，生成128位的散列值。现有工具库包括Java的MessageDigest工具、Python的hashlib库等。\n\n2.将生成的散列值转换为16进制字符串形式。现有工具库包括Java的Codec工具、Python的hex函数等。"}