{"summary":"查询镜像恶意文件详细信息。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get","abilityTreeCode":"91981","abilityTreeNodes":["FEATUREsasF0IRDR"]},"parameters":[{"name":"MaliciousMd5","in":"query","schema":{"description":"指定恶意文件的MD5值。\n> 调用[DescribeGroupedMaliciousFiles](~~DescribeGroupedMaliciousFiles~~)接口可以获取恶意文件的MD5值。","type":"string","required":false,"example":"d836968041f7683b5459****"}},{"name":"CurrentPage","in":"query","schema":{"description":"指定分页查询时，显示的当前页的页码。起始值为**1**，默认值为**1**。","type":"integer","format":"int32","required":true,"example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"指定分页查询时，每页显示的数据的最大条数。默认值为**20**。\n","type":"string","required":true,"example":"20"}},{"name":"Lang","in":"query","schema":{"description":"请求和接收消息的语言类型。取值：\n- **zh**：中文\n- **en**：英文","type":"string","required":false,"example":"zh"}},{"name":"RepoRegionId","in":"query","schema":{"description":"指定镜像仓库的地域ID。取值：\n- **cn-beijing**：华北2（北京）\n- **cn-zhangjiakou**：华北3（张家口）\n- **cn-hangzhou**：华东1（杭州）\n- **cn-shanghai**：华东2（上海）\n- **cn-shenzhen**：华南1（深圳）\n- **cn-hongkong**：中国香港\n- **ap-southeast-1**：新加坡\n- **ap-southeast-5**：印度尼西亚（雅加达）\n- **us-east-1**：美国（弗吉尼亚）\n- **us-west-1**：美国（硅谷）\n- **eu-central-1**：德国（法兰克福）\n- **eu-west-1**：英国（伦敦）\n- **ap-south-1**：印度（孟买）\n","type":"string","required":false,"example":"cn-hangzhou"}},{"name":"RepoInstanceId","in":"query","schema":{"description":"指定容器镜像实例ID。\n> 调用容器镜像服务的[ListRepository](~~145293~~)接口，通过返回参数**InstanceId**的值可以获取容器镜像实例ID。","type":"string","required":false,"example":"cri-datvailb****"}},{"name":"RepoId","in":"query","schema":{"description":"指定镜像仓库ID。\n> 调用容器镜像服务的[ListRepository](~~145293~~)接口，通过返回参数**RepoId**的值可以获取镜像仓库ID。","type":"string","required":false,"example":"crr-vridcl4****"}},{"name":"RepoName","in":"query","schema":{"description":"指定镜像仓库名称。\n> 支持模糊查询。","type":"string","required":false,"example":" centos"}},{"name":"RepoNamespace","in":"query","schema":{"description":"指定镜像仓库命名空间名称。\n> 支持模糊查询。","type":"string","required":false,"example":"hanghai-namespace"}},{"name":"ImageTag","in":"query","schema":{"description":"指定镜像标签。","type":"string","required":false,"example":"0.2"}},{"name":"ImageDigest","in":"query","schema":{"description":"指定镜像摘要。","type":"string","required":false,"example":"6a5e103187b31a94592a47a5858617f7a179ead61df7606****"}},{"name":"ImageLayer","in":"query","schema":{"description":"指定镜像的层。","type":"string","required":false,"example":"27213ad375b53628dd152a5ca****"}},{"name":"ClusterId","in":"query","schema":{"description":"指定要查询的容器集群的ID。\n> 您可以调用[DescribeGroupedContainerInstances](~~DescribeGroupedContainerInstances~~)接口获取该参数。","type":"string","required":false,"example":"c60b77fe62093480db6164a3c2fa5****"}},{"name":"ScanRange","in":"query","style":"repeatList","schema":{"description":"扫描范围集合。","type":"array","items":{"description":"扫描范围。取值：\n\n- **container**：容器\n- **image**：镜像","type":"string","required":false,"example":"image"},"required":false,"maxItems":2}},{"name":"ClusterName","in":"query","schema":{"description":"集群名称。","type":"string","required":false,"example":"minikube"}},{"name":"ContainerId","in":"query","schema":{"description":"容器编号。","type":"string","required":false,"example":"cc20a1024011c44b6a8710d6f8b****"}},{"name":"Pod","in":"query","schema":{"description":"容器组。","type":"string","required":false,"example":"22222-7xsqq"}},{"name":"Namespace","in":"query","schema":{"description":"命名空间。","type":"string","required":false,"example":"test-002"}},{"name":"Image","in":"query","schema":{"description":"容器镜像名称。","type":"string","required":false,"example":"registry.cn-wulanchabu.aliyuncs.com/sas_test/huxin-test-001:nuxeo6-****"}},{"name":"Levels","in":"query","schema":{"description":"紧急程度。多个采用英文半角逗号隔开，取值：\n* **serious**：紧急\n* **suspicious**：可疑\n* **remind**：提醒","type":"string","required":false,"example":"serious,suspicious"}},{"name":"Status","in":"query","schema":{"description":"镜像恶意样本处理状态。取值：\n- **0**：未处理\n- **1**：已处理\n- **2**：验证中\n- **3**：已加白","type":"string","required":false,"example":"0"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"本次调用请求的ID，是由阿里云为该请求生成的唯一标识符，可用于排查和定位问题。","type":"string","example":"ACF97412-FD09-4D1F-994F-34DF12BREF20"},"PageInfo":{"description":"分页信息。","type":"object","properties":{"CurrentPage":{"description":"指定分页查询时，显示的当前页的页码。起始值为**1**，默认值为**1**。","type":"integer","format":"int32","example":"1"},"PageSize":{"description":"指定分页查询时，每页显示的数据的最大条数。默认值为**20**。","type":"integer","format":"int32","example":"20"},"TotalCount":{"description":"检测出恶意样本的镜像总数。","type":"integer","format":"int32","example":"2"},"Count":{"description":"当前页返回的存在镜像恶意样本的镜像数量。","type":"integer","format":"int32","example":"2"}}},"AffectedMaliciousFileImagesResponse":{"description":"检测出恶意样本的镜像列表信息。","type":"array","items":{"description":"检测出恶意样本的镜像信息。","type":"object","properties":{"Status":{"description":"镜像恶意样本处理状态。取值：\n- **0**：未处理\n- **1**：已处理\n- **2**：验证中\n- **3**：已加白","type":"integer","format":"int32","example":"1"},"Digest":{"description":"镜像摘要。","type":"string","example":"6a5e1031a5858617f7d8a179ead6****"},"LatestVerifyTimestamp":{"description":"最新验证时间戳。","type":"integer","format":"int64","example":"1596522711000"},"RepoInstanceId":{"description":"容器镜像实例ID。","type":"string","example":"cri-datvail3m****"},"Namespace":{"description":"镜像仓库命名空间。","type":"string","example":"hanghai-namespace"},"Tag":{"description":"镜像标签。","type":"string","example":"0.2"},"RepoRegionId":{"description":"镜像仓库的RegionId。","type":"string","example":"cn-shanghai"},"ImageUuid":{"description":"镜像UUID。","type":"string","example":"e05c0de798217637868ef4****"},"FirstScanTimestamp":{"description":"首次扫描时间戳。","type":"integer","format":"int64","example":"1594907349000"},"MaliciousMd5":{"description":"恶意文件的MD5值。","type":"string","example":"d836968041f768300d9605a****"},"FilePath":{"description":"镜像文件路径。","type":"string","example":"/d836968041f7683b5605a****"},"RepoId":{"description":"镜像仓库ID。","type":"string","example":"crr-vridcl4****"},"Layer":{"description":"镜像的层。","type":"string","example":"27213ad3447f0209dd152a5cadea****"},"LatestScanTimestamp":{"description":"最新扫描时间戳。","type":"integer","format":"int64","example":"1596522785000"},"RepoName":{"description":"镜像仓库名称。","type":"string","example":"centos"},"Level":{"description":"镜像恶意样本的紧急程度。取值：\n- **serious**：紧急\n- **suspicious**：可疑\n- **remind**：提醒","type":"string","example":"serious"},"DownloadUrl":{"description":"恶意样本下载链接。","type":"string","example":"https://aegis-metadata-file.oss-cn-shanghai.aliyuncs.com/"},"HighLight":{"description":"高亮显示文本。","type":"string","example":"{\"ruleVersion\":\"highlight_20210908\",\"ruleId\":600106,\"events\":[[2,54]]}"},"ContainerId":{"description":"容器编号。","type":"string","example":"04d20e98c8e2c93b7b864372084320a15a58c8671e53c972ce3a71d9c163****"},"Image":{"description":"镜像名称。","type":"string","example":"registry.cn-wulanchabu.aliyuncs.com/sas_test/huxin-test-001:nuxeo6-conta****"},"Pod":{"description":"容器组。","type":"string","example":"22222-7xsqq"},"ClusterId":{"description":"集群编号。","type":"string","example":"c08d5fc1a329a4b88950a253d082f1****"},"ClusterName":{"description":"集群名称。","type":"string","example":"docker-law"},"InstanceName":{"description":"服务器实例的名称。","type":"string","example":"sql-test-001"},"InternetIp":{"description":"服务器的公网IP地址。","type":"string","example":"47.101.XX.XX"},"IntranetIp":{"description":"服务器的私网IP地址。","type":"string","example":"172.22.XX.XX"},"TargetId":{"description":"扫描对象ID。","type":"string","example":"m-bp17m0pc0xprzbwo****"},"TargetName":{"description":"扫描对象名称。","type":"string","example":"source-test-obj-9LaLJ"},"TargetType":{"description":"扫描对象类型。取值：\n\n- **ECS_IMAGE**：镜像。\n- **ECS_SNAPSHOT**：快照","type":"string","example":"ECS_IMAGE"},"Uuid":{"description":"服务器的UUID。","type":"string","example":"48a473c4-1650-4931-a822-7e6c2c28****"},"Id":{"description":"告警事件ID。","type":"integer","format":"int64","example":"1000040"}}}}}}}},"errorCodes":{"403":[{"errorCode":"NoPermission","errorMessage":"caller has no permission"}],"500":[{"errorCode":"ServerError","errorMessage":"ServerError"}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"ACF97412-FD09-4D1F-994F-34DF12BREF20\\\",\\n  \\\"PageInfo\\\": {\\n    \\\"CurrentPage\\\": 1,\\n    \\\"PageSize\\\": 20,\\n    \\\"TotalCount\\\": 2,\\n    \\\"Count\\\": 2\\n  },\\n  \\\"AffectedMaliciousFileImagesResponse\\\": [\\n    {\\n      \\\"Status\\\": 1,\\n      \\\"Digest\\\": \\\"6a5e1031a5858617f7d8a179ead6****\\\",\\n      \\\"LatestVerifyTimestamp\\\": 1596522711000,\\n      \\\"RepoInstanceId\\\": \\\"cri-datvail3m****\\\",\\n      \\\"Namespace\\\": \\\"hanghai-namespace\\\",\\n      \\\"Tag\\\": \\\"0.2\\\",\\n      \\\"RepoRegionId\\\": \\\"cn-shanghai\\\",\\n      \\\"ImageUuid\\\": \\\"e05c0de798217637868ef4****\\\",\\n      \\\"FirstScanTimestamp\\\": 1594907349000,\\n      \\\"MaliciousMd5\\\": \\\"d836968041f768300d9605a****\\\",\\n      \\\"FilePath\\\": \\\"/d836968041f7683b5605a****\\\",\\n      \\\"RepoId\\\": \\\"crr-vridcl4****\\\",\\n      \\\"Layer\\\": \\\"27213ad3447f0209dd152a5cadea****\\\",\\n      \\\"LatestScanTimestamp\\\": 1596522785000,\\n      \\\"RepoName\\\": \\\"centos\\\",\\n      \\\"Level\\\": \\\"serious\\\",\\n      \\\"DownloadUrl\\\": \\\"https://aegis-metadata-file.oss-cn-shanghai.aliyuncs.com/\\\",\\n      \\\"HighLight\\\": \\\"{\\\\\\\"ruleVersion\\\\\\\":\\\\\\\"highlight_20210908\\\\\\\",\\\\\\\"ruleId\\\\\\\":600106,\\\\\\\"events\\\\\\\":[[2,54]]}\\\",\\n      \\\"ContainerId\\\": \\\"04d20e98c8e2c93b7b864372084320a15a58c8671e53c972ce3a71d9c163****\\\",\\n      \\\"Image\\\": \\\"registry.cn-wulanchabu.aliyuncs.com/sas_test/huxin-test-001:nuxeo6-conta****\\\",\\n      \\\"Pod\\\": \\\"22222-7xsqq\\\",\\n      \\\"ClusterId\\\": \\\"c08d5fc1a329a4b88950a253d082f1****\\\",\\n      \\\"ClusterName\\\": \\\"docker-law\\\",\\n      \\\"InstanceName\\\": \\\"sql-test-001\\\",\\n      \\\"InternetIp\\\": \\\"47.101.XX.XX\\\",\\n      \\\"IntranetIp\\\": \\\"172.22.XX.XX\\\",\\n      \\\"TargetId\\\": \\\"m-bp17m0pc0xprzbwo****\\\",\\n      \\\"TargetName\\\": \\\"source-test-obj-9LaLJ\\\",\\n      \\\"TargetType\\\": \\\"ECS_IMAGE\\\",\\n      \\\"Uuid\\\": \\\"48a473c4-1650-4931-a822-7e6c2c28****\\\",\\n      \\\"Id\\\": 1000040\\n    }\\n  ]\\n}\",\"type\":\"json\"}]","title":"查询镜像恶意文件详细信息"}