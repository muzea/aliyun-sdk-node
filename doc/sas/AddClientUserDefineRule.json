{"summary":"创建用户自定义防御规则。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","systemTags":{"operationType":"create"},"parameters":[{"name":"Name","in":"query","schema":{"description":"自定义规则名称。","type":"string","required":true,"example":"规则1"}},{"name":"Type","in":"query","schema":{"description":"规则类型。取值：\n\n- **1**：进程hash\n- **2**：命令行\n- **3**：进程网络\n- **4**：文件读写\n- **5**：操作注册表\n- **6**：加载动态链接库\n- **7**：文件重命名","type":"integer","format":"int32","required":true,"example":"1"}},{"name":"Md5List","in":"query","allowEmptyValue":true,"schema":{"description":"进程hash列表。","type":"string","required":false,"example":"0c9045b5bec90f9825f1f3f64dd4****"}},{"name":"ActionType","in":"query","schema":{"description":"操作类型。取值：\n\n- **0**：加白\n- **1**：加黑","type":"integer","format":"int32","required":true,"example":"1"}},{"name":"ProcPath","in":"query","allowEmptyValue":true,"schema":{"description":"进程路径。","type":"string","required":false,"example":"c:/windows/system32/i****"}},{"name":"Cmdline","in":"query","allowEmptyValue":true,"schema":{"description":"命令行。","type":"string","required":false,"example":"/usr/sbin/s****"}},{"name":"Platform","in":"query","schema":{"description":"操作系统类型。取值：\n\n- **windows**：Widows\n- **linux**：Linux\n- **all**：全部","type":"string","required":false,"example":"linux"}},{"name":"IP","in":"query","schema":{"description":"IP地址。","type":"string","required":false,"example":"10.240.XX.XX"}},{"name":"Port","in":"query","schema":{"description":"端口号。已废弃。","type":"integer","format":"int32","required":false,"example":"22"}},{"name":"FilePath","in":"query","schema":{"description":"文件路径。","type":"string","required":false,"example":"/etc/pam****"}},{"name":"RegistryKey","in":"query","schema":{"description":"注册表键。","type":"string","required":false,"example":"HKEY_DYN_****"}},{"name":"RegistryContent","in":"query","schema":{"description":"注册表值。","type":"string","required":false,"example":"*SECOH-QAD.exe*"}},{"name":"NewFilePath","in":"query","schema":{"description":"文件重命名的新文件路径。","type":"string","required":false,"example":"/etc/pam****"}},{"name":"ParentProcPath","in":"query","schema":{"description":"父进程路径。","type":"string","required":false,"example":"c:/windows/system32/i****"}},{"name":"ParentCmdline","in":"query","schema":{"description":"父命令行。","type":"string","required":false,"example":"/usr/sbin/s****"}},{"name":"PortStr","in":"query","schema":{"description":"端口号。取值范围：**1~65535**。","type":"string","required":false,"example":"80"}},{"name":"Domain","in":"query","schema":{"description":"域名。","type":"string","required":false,"example":"example.com"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"阿里云为该请求生成的唯一标识符。","type":"string","example":"379a9b8f-107b-4630-9e95-2299a1ea****"},"UserDefineRuleAddResult":{"description":"自定义规则标识。","type":"object","properties":{"SwitchId":{"description":"规则对应的开关ID。","type":"string","example":"USER-DEFINE-RULE-SWITCH-TYPE_200****"},"Id":{"description":"规则ID。","type":"integer","format":"int64","example":"1"},"Platform":{"description":"操作系统类型。取值：\n\n- **windows**：widows\n- **linux**：linux\n- **all**：全部","type":"string","example":"linux"}}}}}}},"errorCodes":{"400":[{"errorCode":"InvalidPlatform","errorMessage":"Invalid Platform value."},{"errorCode":"InvalidUserDefineRuleName","errorMessage":"Invalid Name value."},{"errorCode":"UserDefineRuleNameTooLong","errorMessage":"User define rule name too long."},{"errorCode":"InvalidUserDefineRuleActionType","errorMessage":"Invalid ActionType value."},{"errorCode":"InvalidUserDefineRuleType","errorMessage":"Invalid Type value."},{"errorCode":"InvalidUserDefineRuleMd5List","errorMessage":"Invalid Md5List value."},{"errorCode":"UserDefineRuleMd5TooMany","errorMessage":"Too many user define rule md5s."},{"errorCode":"InvalidProcPath","errorMessage":"Process path is invalid."},{"errorCode":"UserDefineRuleProcPathMustContainsLetter","errorMessage":"User define rule process path must contain letter."},{"errorCode":"InvalidUserDefineRuleProcPath","errorMessage":"User define rule process path is invalid."},{"errorCode":"InvalidCmdline","errorMessage":"Command line is invalid."},{"errorCode":"UserDefineRuleCmdlineTooLong","errorMessage":"User define rule command line too long."},{"errorCode":"InvalidIP","errorMessage":"Invalid IP value."},{"errorCode":"InvalidPort","errorMessage":"Invalid PortStr value."},{"errorCode":"InvalidFilePath","errorMessage":"Invalid FilePath value."},{"errorCode":"UserDefineRuleFilePathTooLong","errorMessage":"User define rule file path too long."},{"errorCode":"UserDefineRulesTooMany","errorMessage":"Too many rules."}],"403":[{"errorCode":"NoPermission","errorMessage":"caller has no permission"}],"500":[{"errorCode":"ServerError","errorMessage":"ServerError"}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"379a9b8f-107b-4630-9e95-2299a1ea****\\\",\\n  \\\"UserDefineRuleAddResult\\\": {\\n    \\\"SwitchId\\\": \\\"USER-DEFINE-RULE-SWITCH-TYPE_200****\\\",\\n    \\\"Id\\\": 1,\\n    \\\"Platform\\\": \\\"linux\\\"\\n  }\\n}\",\"type\":\"json\"}]","title":"添加用户自定义规则"}