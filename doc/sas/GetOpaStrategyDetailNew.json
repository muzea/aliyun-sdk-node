{"summary":"获取风险镜像阻断策略详情。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get","riskType":"none","chargeType":"free"},"parameters":[{"name":"StrategyId","in":"query","schema":{"description":"策略ID。\n>调用[ListOpaClusterStrategyNew](~~2623574~~)接口可以获取该参数。","type":"integer","format":"int64","required":false,"example":"1349"}}],"responses":{"200":{"schema":{"title":"PlainResult<OpaStrategyDetailResponse>","description":"PlainResult<OpaStrategyDetailResponse>","type":"object","properties":{"Data":{"description":"返回数据。","type":"object","properties":{"StrategyId":{"description":"策略ID。","type":"integer","format":"int64","example":"1005"},"StrategyTemplateId":{"description":"策略模板ID。","type":"integer","format":"int64","example":"1204"},"ClusterId":{"description":"集群ID。","type":"string","example":"c8ca91e0907d94efaba7fb0827eb9****"},"StrategyName":{"description":"策略名称。","type":"string","example":"test001"},"Description":{"description":"描述。","type":"string","example":"Custom defense configuration"},"ClusterName":{"description":"集群名称。","type":"string","example":"test"},"UnScanedImage":{"description":"策略是否支持未扫描镜像。取值：\n\n- **true**：支持\n- **false**：不支持","type":"boolean","example":"true"},"MaliciousImage":{"description":"策略是否支持互联网恶意镜像。取值：\n\n- **true**：支持\n- **false**：不支持","type":"boolean","example":"true"},"ImageName":{"description":"镜像名称。","type":"array","items":{"description":"镜像名称。","type":"string","example":"opa-test"}},"Label":{"description":"镜像标签。","type":"array","items":{"description":"镜像标签。","type":"string","example":"app.kubernetes.io/instance:devops"}},"RuleAction":{"description":"策略命中执行动作。取值：\n- **1**：告警\n- **2**：拦截\n- **3**：放行","type":"integer","format":"int32","example":"1"},"WhiteList":{"description":"镜像标签白名单。","type":"array","items":{"description":"镜像标签白名单。","type":"string","example":"test-tag"}},"AlarmDetail":{"description":"策略配置信息。","type":"object","properties":{"Baseline":{"description":"基线配置信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","example":"low"}},"Item":{"description":"基线项目信息。","type":"array","items":{"description":"基线项目信息。","type":"object","properties":{"Id":{"description":"基线检查项ID。","type":"string","example":"ak_leak"},"Name":{"description":"基线检查项名称。","type":"string","example":"Access Key plaintext storage"}}}}}},"Vul":{"description":"漏洞配置信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","example":"medium"}},"Item":{"description":"漏洞项目信息。","type":"array","items":{"description":"漏洞项目信息。","type":"object","properties":{"Id":{"description":"漏洞ID。","type":"string","example":"AVD-2023-1680169"},"Name":{"description":"漏洞名称。","type":"string","example":"ezOffice evoInterfaceServlet Info Leak"}}}},"RiskClass":{"description":"漏洞类型列表。","type":"array","items":{"description":"漏洞类型列表。","type":"object","properties":{"Id":{"description":"漏洞类型ID。取值：\n- **cve**：系统漏洞\n- **app**：应用漏洞","type":"string","example":"cve"},"Name":{"description":"漏洞类型名称。取值：\n- **系统漏洞**\n- **应用漏洞**","type":"string","example":"系统漏洞"}}}}}},"MaliciousFile":{"description":"恶意样本配置信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","example":"high"}},"Item":{"description":"恶意样本项目信息。","type":"array","items":{"description":"恶意样本项目信息。","type":"object","properties":{"Id":{"description":"恶意样本ID。","type":"string","example":"1811"},"Name":{"description":"恶意样本名称。","type":"string","example":"abnormal binary file\n"}}}}}},"SensitiveFile":{"description":"敏感文件信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级，取值：\n\n- **high**：高危\n\n- **medium**：中危\n\n- **low**：低危","type":"string","example":"low"}},"Item":{"description":"敏感文件检查项列表。","type":"array","items":{"description":"敏感文件检查项列表。","type":"object","properties":{"Id":{"description":"敏感文件类型ID。\n> 您可通过调用[GetSensitiveDefineRuleConfig](~~GetSensitiveDefineRuleConfig~~)接口查询该值。","type":"string","example":"key"},"Name":{"description":"敏感文件类型名称。\n> 您可通过调用[GetSensitiveDefineRuleConfig](~~GetSensitiveDefineRuleConfig~~)接口查询该值。","type":"string","example":"name"}}}}}},"BuildRisk":{"description":"镜像风险构建命令信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","example":"high"}},"Item":{"description":"风险项列表。","type":"array","items":{"description":"风险项列表。","type":"object","properties":{"Id":{"description":"镜像风险构建命令类型ID。\n> 您可通过调用[ListImageBuildRiskItem](~~ListImageBuildRiskItem~~)接口查询该值。","type":"string","example":"key"},"Name":{"description":"镜像风险构建命令类型名称。\n> 您可通过调用[ListImageBuildRiskItem](~~ListImageBuildRiskItem~~)接口查询该值。","type":"string","example":"name"}}}}}}}},"Scopes":{"title":"作用域","description":"作用范围。","type":"array","items":{"description":"策略作用范围列表。","type":"object","properties":{"ClusterId":{"description":"集群的ID。","type":"string","example":"c1fdb5fd8d**7163"},"AllNamespace":{"description":"是否包含所有命名空间。取值：\n\n- **1**：是\n- **0**：否","type":"integer","format":"int32","example":"1"},"NamespaceList":{"description":"命名空间列表。","type":"array","items":{"description":"命名空间。","type":"string","example":"namespace1"}},"AckPolicyInstanceId":{"description":"集群内策略略实例ID。","type":"string","example":"ack-0"}}}},"Lang":{"description":"指定请求和接收消息的语言类型，默认值为**zh**。取值：\n- **zh**：中文\n- **en**：英文","type":"string","example":"zh"},"CurrentPage":{"description":"设置从返回结果的第几页开始显示查询结果。默认值为**1**，表示从第1页开始显示。","type":"integer","format":"int32","example":"4"},"PageSize":{"description":"分页查询时，每页最多显示的数据条数。","type":"integer","format":"int32","example":"20"}}},"Success":{"description":"接口调用是否成功。取值：\n\n- **true**：接口调用成功。\n- **false**：接口调用失败。","type":"boolean","example":"true"},"Code":{"description":"结果代码，**200**表示成功，若为别的值则表示失败，调用方可根据此字段判断失败原因。","type":"string","example":"200"},"Message":{"description":"接口请求返回的信息。","type":"string","example":"success"},"RequestId":{"description":"本次调用请求的ID，是由阿里云为该请求生成的唯一标识符，可用于排查和定位问题。","type":"string","example":"E819FD71-D240-5E54-AA7F-20FED2ECBEB6"},"HttpStatusCode":{"description":"HTTP状态码","type":"integer","format":"int32","example":"200"}}}}},"errorCodes":{"403":[{"errorCode":"NoPermission","errorMessage":"caller has no permission"}],"500":[{"errorCode":"ServerError","errorMessage":"ServerError"}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"Data\\\": {\\n    \\\"StrategyId\\\": 1005,\\n    \\\"StrategyTemplateId\\\": 1204,\\n    \\\"ClusterId\\\": \\\"c8ca91e0907d94efaba7fb0827eb9****\\\",\\n    \\\"StrategyName\\\": \\\"test001\\\",\\n    \\\"Description\\\": \\\"Custom defense configuration\\\",\\n    \\\"ClusterName\\\": \\\"test\\\",\\n    \\\"UnScanedImage\\\": true,\\n    \\\"MaliciousImage\\\": true,\\n    \\\"ImageName\\\": [\\n      \\\"opa-test\\\"\\n    ],\\n    \\\"Label\\\": [\\n      \\\"app.kubernetes.io/instance:devops\\\"\\n    ],\\n    \\\"RuleAction\\\": 1,\\n    \\\"WhiteList\\\": [\\n      \\\"test-tag\\\"\\n    ],\\n    \\\"AlarmDetail\\\": {\\n      \\\"Baseline\\\": {\\n        \\\"RiskLevel\\\": [\\n          \\\"low\\\"\\n        ],\\n        \\\"Item\\\": [\\n          {\\n            \\\"Id\\\": \\\"ak_leak\\\",\\n            \\\"Name\\\": \\\"Access Key plaintext storage\\\"\\n          }\\n        ]\\n      },\\n      \\\"Vul\\\": {\\n        \\\"RiskLevel\\\": [\\n          \\\"medium\\\"\\n        ],\\n        \\\"Item\\\": [\\n          {\\n            \\\"Id\\\": \\\"AVD-2023-1680169\\\",\\n            \\\"Name\\\": \\\"ezOffice evoInterfaceServlet Info Leak\\\"\\n          }\\n        ],\\n        \\\"RiskClass\\\": [\\n          {\\n            \\\"Id\\\": \\\"cve\\\",\\n            \\\"Name\\\": \\\"系统漏洞\\\"\\n          }\\n        ]\\n      },\\n      \\\"MaliciousFile\\\": {\\n        \\\"RiskLevel\\\": [\\n          \\\"high\\\"\\n        ],\\n        \\\"Item\\\": [\\n          {\\n            \\\"Id\\\": \\\"1811\\\",\\n            \\\"Name\\\": \\\"abnormal binary file\\\\n\\\"\\n          }\\n        ]\\n      },\\n      \\\"SensitiveFile\\\": {\\n        \\\"RiskLevel\\\": [\\n          \\\"low\\\"\\n        ],\\n        \\\"Item\\\": [\\n          {\\n            \\\"Id\\\": \\\"key\\\",\\n            \\\"Name\\\": \\\"name\\\"\\n          }\\n        ]\\n      },\\n      \\\"BuildRisk\\\": {\\n        \\\"RiskLevel\\\": [\\n          \\\"high\\\"\\n        ],\\n        \\\"Item\\\": [\\n          {\\n            \\\"Id\\\": \\\"key\\\",\\n            \\\"Name\\\": \\\"name\\\"\\n          }\\n        ]\\n      }\\n    },\\n    \\\"Scopes\\\": [\\n      {\\n        \\\"ClusterId\\\": \\\"c1fdb5fd8d**7163\\\",\\n        \\\"AllNamespace\\\": 1,\\n        \\\"NamespaceList\\\": [\\n          \\\"namespace1\\\"\\n        ],\\n        \\\"AckPolicyInstanceId\\\": \\\"ack-0\\\"\\n      }\\n    ],\\n    \\\"Lang\\\": \\\"zh\\\",\\n    \\\"CurrentPage\\\": 4,\\n    \\\"PageSize\\\": 20\\n  },\\n  \\\"Success\\\": true,\\n  \\\"Code\\\": \\\"200\\\",\\n  \\\"Message\\\": \\\"success\\\",\\n  \\\"RequestId\\\": \\\"E819FD71-D240-5E54-AA7F-20FED2ECBEB6\\\",\\n  \\\"HttpStatusCode\\\": 200\\n}\",\"type\":\"json\"}]","title":"获取风险镜像阻断策略详情"}