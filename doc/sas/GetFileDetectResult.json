{"summary":"通过HashKey批量获取文件检测结果。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get","abilityTreeCode":"140704","abilityTreeNodes":["FEATUREsasNPORLE"]},"parameters":[{"name":"SourceIp","in":"query","schema":{"description":"访问源IP地址。","type":"string","required":false,"example":"183.46.XX.XX"}},{"name":"HashKeyList","in":"query","style":"repeatList","schema":{"description":"文件标识列表，目前仅支持md5。列表最多传入100个元素。","type":"array","items":{"description":"文件标识，目前仅支持md5。","type":"string","required":false,"example":"0a212417e65c26ff133cfff28f9c****"},"required":true,"maxItems":200}},{"name":"Type","in":"query","schema":{"description":"需要检测的文件类型。取值：\n\n-  **0**：不确定的文件类型","type":"integer","format":"int32","required":true,"example":"0"}}],"responses":{"200":{"schema":{"description":"返回信息。","type":"object","properties":{"RequestId":{"description":"本次调用请求的ID，是由阿里云为该请求生成的唯一标识符，可用于排查和定位问题。","type":"string","example":"24A20733-10A0-4AF6-BE6B-E3322413BB68"},"ResultList":{"description":"检测结果列表。","type":"array","items":{"description":"文件检测结果信息。","type":"object","properties":{"HashKey":{"description":"文件标识，仅支持文件md5。","type":"string","example":"0a212417e65c26ff133cfff28f6c****"},"Result":{"description":"文件检测结果。取值：\n\n- **0**：安全文件\n- **1**：可疑文件\n- **3**：检测中，请等待\n\n","type":"integer","format":"int32","example":"0"},"Score":{"description":"文件检测分数。分数区间及危险等级的对应关系如下：\n\n- 0~60：安全\n- 61~70：风险\n- 71~80：可疑\n- 81~100：恶意\n\n><notice>分数越高，文件越可疑。></notice>","type":"integer","format":"int32","example":"100"},"VirusType":{"description":"病毒类型。取值：\n\n- **Trojan**：自变异木马\n- **WebShell**：网站后门\n- **Backdoor**：后门程序\n- **RansomWare**：勒索病毒\n- **Scanner**：扫描器\n- **Stealer**：窃密工具\n- **Malbaseware**：被污染的基础软件\n- **Hacktool**：黑客工具\n- **Engtest**：引擎测试程序\n- **Downloader**：下载器木马\n- **Virus**：感染型病毒\n- **Miner**：挖矿程序\n- **Worm**：蠕虫病毒\n- **DDoS**：DDOS木马\n- **Malware**：恶意程序\n- **Backdoor**：反弹shell后门\n- **RiskWare**：风险软件\n- **Proxytool**：代理工具\n- **Suspicious**：可疑程序\n- **MalScript**：恶意脚本\n- **Rootkit**：Rootkit\n- **Exploit**：漏洞利用程序","type":"string","example":"WebShell"},"Code":{"description":"结果代码，**200**表示成功，若为别的值则表示失败，调用方可根据此字段判断失败原因。","type":"string","example":"200"},"Message":{"description":"错误码的详细信息。","type":"string","example":"successful"},"Ext":{"description":"检测结果扩展信息。","type":"string","example":"{\n    \"HighLight\":\n    [\n        [\n            23245,\n            23212\n        ]\n    ],\n    \"FileLabel\":\n    [\n        \"PE32\",\n        \"Zip\",\n        \"SFX\",\n        \"encrypted\"\n    ]\n}"},"Compress":{"description":"是否识别为压缩包。\n\n- **true**：是。\n\n- **false**：否。","type":"boolean","example":"false"}}}}}}}},"errorCodes":{"400":[{"errorCode":"RequestTooFrequently","errorMessage":"Request too frequently, please try again later"},{"errorCode":"GetResultFail","errorMessage":"Get result fail, found no detect record for this file or result has been expired"},{"errorCode":"InvalidApiDetectType","errorMessage":"Unsupported Api Detect Type."}],"403":[{"errorCode":"NoPermission","errorMessage":"caller has no permission"}],"500":[{"errorCode":"ServerError","errorMessage":"ServerError"},{"errorCode":"SystemBusy","errorMessage":"System busy, please try again later."}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"24A20733-10A0-4AF6-BE6B-E3322413BB68\\\",\\n  \\\"ResultList\\\": [\\n    {\\n      \\\"HashKey\\\": \\\"0a212417e65c26ff133cfff28f6c****\\\",\\n      \\\"Result\\\": 0,\\n      \\\"Score\\\": 100,\\n      \\\"VirusType\\\": \\\"WebShell\\\",\\n      \\\"Code\\\": \\\"200\\\",\\n      \\\"Message\\\": \\\"successful\\\",\\n      \\\"Ext\\\": \\\"{\\\\n    \\\\\\\"HighLight\\\\\\\":\\\\n    [\\\\n        [\\\\n            23245,\\\\n            23212\\\\n        ]\\\\n    ],\\\\n    \\\\\\\"FileLabel\\\\\\\":\\\\n    [\\\\n        \\\\\\\"PE32\\\\\\\",\\\\n        \\\\\\\"Zip\\\\\\\",\\\\n        \\\\\\\"SFX\\\\\\\",\\\\n        \\\\\\\"encrypted\\\\\\\"\\\\n    ]\\\\n}\\\",\\n      \\\"Compress\\\": false\\n    }\\n  ]\\n}\",\"type\":\"json\"}]","title":"获取文件检测结果","description":"推送检测过的文件才能获取检测结果，检测结果将保留5小时，5小时内可重复查询。推送检测接口请参考[CreateFileDetect](~~CreateFileDetect~~)。\n\n文件检测相关接口均包含HashKey参数，表示文件唯一标识，目前仅支持文件完整内容的十六进制md5值，请在使用接口前计算该值。\n\n可以通过Ext扩展字段里的FileLabel对文件属性进行筛选，例如通过组合encrypted、Zip这两个属性筛选加密的压缩包。支持的文件标签-压缩文件类型：Zip、RAR、7-Zip、XAR、ZLib、GZip、tar。\n\n可以通过Ext扩展字段里的Highlight字段定位Webshell文件的恶意代码段。Highlight字段为列表类型，列表中每个元素对应一段代码范围，数字表示相对文件头部的偏移字符数。\n\n计算文件内容的十六进制md5值可以参考以下两个步骤：\n\n1.使用MD5算法对数据进行加密，生成128位的散列值。现有工具库包括Java的MessageDigest工具、Python的hashlib库等。\n\n2.将生成的散列值转换为16进制字符串形式。现有工具库包括Java的Codec工具、Python的hex函数等。"}