{"summary":"创建风险镜像阻断策略。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"create","riskType":"none","chargeType":"free"},"parameters":[{"name":"StrategyId","in":"query","schema":{"description":"策略ID。\n>调用[ListOpaClusterStrategyNew](~~2623574~~)接口可以获取该参数。\n\n<notice>创建策略时此参数无效。></notice>","type":"integer","format":"int64","required":false,"example":"16"}},{"name":"StrategyTemplateId","in":"query","schema":{"description":"策略模板ID。\n>调用[GetOpaStrategyTemplateSummary](~~2539952~~)接口可以获取该参数。","type":"integer","format":"int64","required":false,"example":"109"}},{"name":"ClusterId","in":"query","schema":{"description":"集群ID。\n><notice>已废弃。></notice>","type":"string","required":false,"example":"cfa7e2fb8c221483ba59e098c34c6****"}},{"name":"StrategyName","in":"query","schema":{"description":"策略名称。","type":"string","required":false,"example":"default"}},{"name":"Description","in":"query","schema":{"description":"策略描述。","type":"string","required":false,"example":"default policy"}},{"name":"ClusterName","in":"query","schema":{"description":"集群名称。\n\n><notice>已废弃。></notice>","type":"string","required":false,"example":"*"}},{"name":"UnScanedImage","in":"query","schema":{"description":"该策略是否支持未扫描镜像。取值：\n\n- **true**：支持\n- **false**：不支持","type":"boolean","required":false,"example":"true"}},{"name":"MaliciousImage","in":"query","schema":{"description":"该策略是否支持互联网恶意镜像。取值：\n\n- **true**：支持\n- **false**：不支持","type":"boolean","required":false,"example":"true"}},{"name":"ImageName","in":"query","style":"repeatList","schema":{"description":"镜像名称列表。","type":"array","items":{"description":"镜像名称。\n> 您可通过调用[GetOpaClusterImageList](~~2539885~~)接口查询该值。","type":"string","required":false,"example":"testImage"},"required":false,"maxItems":100}},{"name":"Label","in":"query","style":"repeatList","schema":{"description":"容器标签列表。","type":"array","items":{"description":"容器标签。\n> 您可通过调用[GetOpaClusterLabelList](~~2539885~~)接口查询该值。","type":"string","required":false,"example":"app.kubernetes.io/component:collector"},"required":false,"maxItems":100}},{"name":"RuleAction","in":"query","schema":{"description":"策略命中时执行操作。取值：\n\n- **1**：告警\n- **2**：拦截\n- **3**：放行","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"WhiteList","in":"query","style":"repeatList","schema":{"description":"白名单列表。","type":"array","items":{"description":"策略白名单。","type":"string","required":false,"example":"repo-06"},"required":false,"maxItems":100}},{"name":"AlarmDetail","in":"query","style":"json","schema":{"description":"策略包含的告警内容详情。","type":"object","properties":{"Baseline":{"description":"基线。","type":"object","properties":{"RiskLevel":{"description":"风险等级。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","required":false,"example":"high"},"required":false},"Item":{"description":"基线检查项列表。","type":"array","items":{"description":"基线检查项。","type":"object","properties":{"Id":{"description":"基线检查项ID。\n> 您可通过调用[GetOpaClusterBaseLineList](~~2539883~~)接口查询该值。","type":"string","required":false,"example":"hc.image.checklist.identify.hc_exploit_couchdb_linux.item"},"Name":{"description":"基线检查项名称。\n> 您可通过调用[GetOpaClusterBaseLineList](~~2539883~~)接口查询该值。","type":"string","required":false,"example":"Unauthorized access to CouchDB configuration risk"}},"required":false},"required":false}},"required":false},"Vul":{"description":"漏洞项目信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","required":false,"example":"high"},"required":false},"Item":{"description":"漏洞列表。","type":"array","items":{"description":"漏洞对象。","type":"object","properties":{"Id":{"description":"漏洞ID。\n> 您可通过调用[DescribeVulListPage](~~471928~~)接口查询该值。","type":"string","required":false,"example":"CVE-2023-36034"},"Name":{"description":"漏洞名称。\n> 您可通过调用[DescribeVulListPage](~~471928~~)接口查询该值。","type":"string","required":false,"example":"Microsoft Edge vul"}},"required":false},"required":false},"RiskClass":{"description":"漏洞类型列表。","type":"array","items":{"description":"漏洞类型列表。","type":"object","properties":{"Id":{"description":"漏洞类型ID。取值：\n- **cve**：系统漏洞\n- **app**：应用漏洞","type":"string","required":false,"example":"cve"},"Name":{"description":"漏洞类型名称。取值：\n- **系统漏洞**\n- **应用漏洞**","type":"string","required":false,"example":"系统漏洞"}},"required":false},"required":false}},"required":false},"MaliciousFile":{"description":"恶意样本信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","required":false,"example":"high"},"required":false},"Item":{"description":"恶意样本列表。","type":"array","items":{"description":"恶意样本。","type":"object","properties":{"Id":{"description":"恶意样本ID。\n> 您可通过调用[DescribeMatchedMaliciousNames](~~DescribeMatchedMaliciousNames~~)接口查询该值。","type":"string","required":false,"example":"3685699"},"Name":{"description":"恶意样本名称。\n> 您可通过调用[DescribeMatchedMaliciousNames](~~DescribeMatchedMaliciousNames~~)接口查询该值。","type":"string","required":false,"example":"abnormal binary file"}},"required":false},"required":false}},"required":false},"SensitiveFile":{"description":"敏感文件信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级，取值：\n\n- **high**：高危\n\n- **medium**：中危\n\n- **low**：低危","type":"string","required":false,"example":"low"},"required":false},"Item":{"description":"敏感文件检查项列表。","type":"array","items":{"description":"敏感文件检查项列表。","type":"object","properties":{"Id":{"description":"敏感文件类型ID。\n> 您可通过调用[GetSensitiveDefineRuleConfig](~~GetSensitiveDefineRuleConfig~~)接口查询该值。","type":"string","required":false,"example":"key"},"Name":{"description":"敏感文件类型名称。\n> 您可通过调用[GetSensitiveDefineRuleConfig](~~GetSensitiveDefineRuleConfig~~)接口查询该值。","type":"string","required":false,"example":"name"}},"required":false},"required":false}},"required":false},"BuildRisk":{"description":"镜像风险构建命令信息。","type":"object","properties":{"RiskLevel":{"description":"风险等级列表。","type":"array","items":{"description":"风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","required":false,"example":"low"},"required":false},"Item":{"description":"风险项列表。","type":"array","items":{"description":"风险项列表。","type":"object","properties":{"Id":{"description":"镜像风险构建命令类型ID。\n> 您可通过调用[ListImageBuildRiskItem](~~ListImageBuildRiskItem~~)接口查询该值。","type":"string","required":false,"example":"key"},"Name":{"description":"镜像风险构建命令类型名称。\n> 您可通过调用[ListImageBuildRiskItem](~~ListImageBuildRiskItem~~)接口查询该值。","type":"string","required":false,"example":"name"}},"required":false},"required":false}},"required":false}},"required":false}},{"name":"Scopes","in":"query","style":"repeatList","schema":{"title":"作用域","description":"策略作用范围列表。","type":"array","items":{"description":"策略作用范围。","type":"object","properties":{"ClusterId":{"description":"策略包含的集群ID。\n> 您可以调用[DescribeGroupedContainerInstances](~~421736~~)接口获取该参数。","type":"string","required":false,"example":"cc50d***015d2"},"AllNamespace":{"description":"是否包含所有命名空间。取值：\n\n- **1**：是\n- **0**：否","type":"integer","format":"int32","required":false,"example":"1"},"NamespaceList":{"description":"命名空间列表。\n\n><notice>本参数只有当AllNamespace为0时有效。></notice>","type":"array","items":{"description":"命名空间。\n> 您可以调用[GetOpaClusterNamespaceList](~~2539886~~)接口获取该参数。","type":"string","required":false,"example":"namespace1"},"required":false,"maxItems":100},"AckPolicyInstanceId":{"description":"集群内策略略实例ID。\n\n><notice>创建时无需此参数。></notice>","type":"string","required":false,"example":"ack-p-1"}},"required":false},"required":false,"maxItems":100}}],"responses":{"200":{"schema":{"title":"BaseResult","description":"BaseResult","type":"object","properties":{"Success":{"description":"操作是否成功。取值：\n- **true**：成功\n- **false**：失败","type":"boolean","example":"true"},"Code":{"description":"结果代码，**200**表示成功，若为别的值则表示失败，调用方可根据此字段判断失败原因。","type":"string","example":"200"},"Message":{"description":"返回结果的提示信息。","type":"string","example":"success"},"RequestId":{"description":"本次调用请求的ID，是由阿里云为该请求生成的唯一标识符，可用于排查和定位问题。","type":"string","example":"CD380235-A0B8-540D-A0D5-D62884469E3C"},"HttpStatusCode":{"description":"HTTP状态码。","type":"integer","format":"int32","example":"200"},"Data":{"description":"保存失败时，失败的集群ID列表。","type":"array","items":{"description":"保存失败时，失败的集群ID。","type":"string","example":"['cb8cd***b07ee5']"}}}}}},"errorCodes":{"403":[{"errorCode":"NoPermission","errorMessage":"caller has no permission"}],"500":[{"errorCode":"ServerError","errorMessage":"ServerError"}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"Success\\\": true,\\n  \\\"Code\\\": \\\"200\\\",\\n  \\\"Message\\\": \\\"success\\\",\\n  \\\"RequestId\\\": \\\"CD380235-A0B8-540D-A0D5-D62884469E3C\\\",\\n  \\\"HttpStatusCode\\\": 200,\\n  \\\"Data\\\": [\\n    \\\"['cb8cd***b07ee5']\\\"\\n  ]\\n}\",\"type\":\"json\"}]","title":"创建风险镜像阻断策略"}