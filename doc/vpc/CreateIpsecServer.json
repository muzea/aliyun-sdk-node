{"summary":"调用CreateIpsecServer接口创建IPsec服务端。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create"},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"VPN网关所属地域ID。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"VpnGatewayId","in":"query","schema":{"description":"VPN网关实例ID。","type":"string","required":true,"docRequired":true,"example":"vpn-bp17lofy9fd0dnvzv****"}},{"name":"LocalSubnet","in":"query","schema":{"description":"本端网段，指需要和客户端网段互连的VPC侧的网段。\n\n多个网段之间用半角逗号（,）分隔，例如：192.168.1.0/24,192.168.2.0/24。","type":"string","required":true,"docRequired":true,"example":"192.168.0.0/24"}},{"name":"ClientIpPool","in":"query","schema":{"description":"客户端网段，指给客户端虚拟网卡分配访问地址的地址段。\n\n> 客户端网段不能和VPC侧网段冲突。","type":"string","required":true,"docRequired":true,"example":"10.0.0.0/24"}},{"name":"IpSecServerName","in":"query","schema":{"description":"IPsec服务端名称。\n\n名称长度为1～100个字符。","type":"string","required":false,"example":"test","maxLength":100}},{"name":"EffectImmediately","in":"query","schema":{"description":"配置是否立即生效。取值：\n\n- **true**：配置完成后立即进行协商。\n\n- **false**（默认值）：当有流量进入时进行协商。","type":"boolean","required":false,"example":"true"}},{"name":"IkeConfig","in":"query","schema":{"description":"第一阶段协商参数配置。取值：\n\n- **IkeVersion**：IKE协议的版本。取值：**ikev1**或**ikev2**，默认值：**ikev2**。\n\n- **IkeMode**：IKE版本的协商模式。默认值：**main**。\n\n- **IkeEncAlg**：第一阶段协商的加密算法。默认值：**aes**。\n\n- **IkeAuthAlg**：第一阶段协商的认证算法。默认值：**sha1**。\n\n- **IkePfs**：第一阶段协商使用的Diffie-Hellman密钥交换算法。默认值：**group2**。\n\n- **IkeLifetime**：第一阶段协商出的SA的生存周期。单位：秒，取值范围：**0**~**86400**，默认值：**86400**。\n\n- **LocalId**：IPsec服务端标识。支持FQDN和IP地址格式，默认值为VPN网关公网IP地址。\n\n- **RemoteId**：对端标识。支持FQDN和IP地址格式，默认值为空。","type":"string","required":false,"example":"{\"IkeVersion\":\"ikev2\",\"IkeMode\":\"main\",\"IkeEncAlg\":\"aes\",\"IkeAuthAlg\":\"sha1\",\"IkePfs\":\"group2\",\"IkeLifetime\":86400}"}},{"name":"IpsecConfig","in":"query","schema":{"description":"第二阶段协商参数配置。取值：\n\n- **IpsecEncAlg**：第二阶段协商的加密算法。默认值：**aes**。\n\n- **IpsecAuthAlg**：第二阶段协商的认证算法。默认值：**sha1**。\n\n- **IpsecPfs**：转发所有协议的报文。第二阶段协商使用的Diffie-Hellman密钥交换算法。默认值：**group2**。\n\n- **IpsecLifetime**：第二阶段协商出的SA的生存周期。单位：秒，取值范围：**0**~**86400**，默认值：**86400**。","type":"string","required":false,"example":"{\"IpsecEncAlg\":\"aes\",\"IpsecAuthAlg\":\"sha1\",\"IpsecPfs\":\"group2\",\"IpsecLifetime\":86400}"}},{"name":"PskEnabled","in":"query","schema":{"description":"是否开启预共享密钥认证方式。取值：**true**，表示开启预共享密钥认证方式。\n\n> 本参数必填。","type":"boolean","required":false,"example":"true"}},{"name":"Psk","in":"query","schema":{"description":"预共享密钥。\n\n用于IPsec服务端与客户端之间的身份认证。密钥长度为1~100个字符。\n\n若您未指定预共享密钥，系统会随机生成一个16位的字符串作为预共享密钥。您可以调用[ListIpsecServers](~~2794120~~)接口查询系统生成的密钥信息。\n\n> IPsec服务端的预共享密钥需和客户端的认证密钥一致，否则IPsec服务端和客户端之间无法建立连接。","type":"string","required":false,"example":"Cfd123****"}},{"name":"ClientToken","in":"query","schema":{"description":"客户端Token，用于保证请求的幂等性。\n\n从您的客户端生成一个参数值，确保不同请求间该参数值唯一。ClientToken只支持ASCII字符。\n\n> 若您未指定，则系统自动使用API请求的**RequestId**作为**ClientToken**标识。每次API请求的**RequestId**不一样。","type":"string","required":false,"example":"d7d24a21-f4ba-4454-9173-b38****"}},{"name":"DryRun","in":"query","schema":{"description":"是否只预检此次请求，取值：\n\n- **true**：只预检此次请求，不会创建IPsec服务端。检查项包括是否填写了必需参数、请求格式、业务限制等。如果检查不通过，则返回对应错误信息。如果检查通过，则返回`DryRunOperation`。\n\n- **false**（默认值）：发送正常请求，通过检查后直接创建IPsec服务端。","type":"string","required":false,"example":"false"}}],"responses":{"200":{"schema":{"description":"返回结果。","type":"object","properties":{"CreationTime":{"description":"IPsec服务端创建时间。\n\nT表示分隔符，Z表示的是UTC，即世界标准时间。","type":"string","example":"2021-02-22T03:24:28Z"},"IpsecServerId":{"description":"IPsec服务端ID。","type":"string","example":"iss-bp1jougp8cfsbo8y9****"},"RequestId":{"description":"请求ID。","type":"string","example":"690A967E-D4CD-4B69-8C78-94FE828BA10B"},"IpsecServerName":{"description":"IPsec服务端名称。","type":"string","example":"test"},"VpnGatewayId":{"description":"VPN网关实例ID。","type":"string","example":"vpn-bp17lofy9fd0dnvzv****"},"RegionId":{"description":"VPN网关所属地域ID。","type":"string","example":"cn-hangzhou"}}}}},"errorCodes":{"400":[{"errorCode":"OperationUnsupported.IPsecServer","errorMessage":"The current version of the VPN gateway does not support IPsec server."},{"errorCode":"VpnGateway.SslVpnDisabled","errorMessage":"The VPN gateway has not enabled SSL VPN."},{"errorCode":"VpnGateway.Configuring","errorMessage":"The specified service is configuring."},{"errorCode":"VpnGateway.FinancialLocked","errorMessage":"The specified service is financial locked."},{"errorCode":"OperationFailed.IPsecServerExist","errorMessage":"An IPsec server already exists in the VPN gateway."},{"errorCode":"OperationUnsupported.IpsecPfs","errorMessage":"The specified IPsec Pfs is unsupported."},{"errorCode":"IllegalParam.AuthMethod","errorMessage":"One authentication method (Psk or IDaaS) should be specified at least."},{"errorCode":"IllegalParam.LocalSubnet","errorMessage":"The specified \"LocalSubnet\" (%s) is invalid."},{"errorCode":"IllegalParam.ClientIpPool","errorMessage":"The specified ClientIpPool (%s) is invalid."},{"errorCode":"MissingParam.IDaaSInstanceId","errorMessage":"The input parameter IDaaSInstanceId is mandatory when enable multi-factor authentication."},{"errorCode":"OperationFailed.NoRamPermission","errorMessage":"Vpn Service has no permission to operate your IDaaS instances."},{"errorCode":"ClientIpPool.NetmaskInvalid","errorMessage":"The netmask length of client IP pool must be greater than or equal to 16 and less than or equal to 29."},{"errorCode":"VpnRouteEntry.Conflict","errorMessage":"The specified client IP pool conflicts with VPN connection or SSL server."},{"errorCode":"ClientIpPool.SubnetInvalid","errorMessage":"The specified client IP pool cannot be used."},{"errorCode":"InvalidClientIpPool.Conflict","errorMessage":"The specified client IP pool conflicts with other resources in the same VPC."},{"errorCode":"OperationFailed.AddVpcRoute","errorMessage":"It is failed to add VPC route after this operation."},{"errorCode":"QuotaExceeded.VpnRouteEntry","errorMessage":"The number of route entries to the VPN gateway in the VPC routing table has reached the quota limit."},{"errorCode":"SystemBusy","errorMessage":"The system is busy. Please try again later."},{"errorCode":"EnableHaCheck.IpsecServerCidrContainsVpcRouteDest","errorMessage":"Ipsec server client cidr contains vpc route prefix. The vpc route prefix is %s."},{"errorCode":"VpnGateway.IPsecServerAndVpnConnectionConflict","errorMessage":"The IPSec connection and IPSec server cannot be configured on the same VPN gateway at the same time."}],"403":[{"errorCode":"Forbidden","errorMessage":"User not authorized to operate on the specified resource."}],"404":[{"errorCode":"InvalidVpnGatewayInstanceId.NotFound","errorMessage":"The specified vpn gateway instance id does not exist."},{"errorCode":"InvalidIDaaSInstanceId.NotFound","errorMessage":"The specified IDaaS instance ID does not exist."}],"409":[{"errorCode":"OperationConflict","errorMessage":"The operation against this instance is too frequent, please try again later."}]},"staticInfo":{"returnType":"asynchronous","callback":"Vpc::2016-04-28::DescribeVpnGateway","callbackInterval":2000,"maxCallbackTimes":60},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"CreationTime\\\": \\\"2021-02-22T03:24:28Z\\\",\\n  \\\"IpsecServerId\\\": \\\"iss-bp1jougp8cfsbo8y9****\\\",\\n  \\\"RequestId\\\": \\\"690A967E-D4CD-4B69-8C78-94FE828BA10B\\\",\\n  \\\"IpsecServerName\\\": \\\"test\\\",\\n  \\\"VpnGatewayId\\\": \\\"vpn-bp17lofy9fd0dnvzv****\\\",\\n  \\\"RegionId\\\": \\\"cn-hangzhou\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateIpsecServerResponse>\\n    <CreationTime>2021-02-22T03:24:28Z</CreationTime>\\n    <IpsecServerId>iss-bp1jougp8cfsbo8y9****</IpsecServerId>\\n    <RequestId>690A967E-D4CD-4B69-8C78-94FE828BA10B</RequestId>\\n    <IpsecServerName>test</IpsecServerName>\\n    <VpnGatewayId>vpn-bp17lofy9fd0dnvzv****</VpnGatewayId>\\n    <RegionId>cn-hangzhou</RegionId>\\n</CreateIpsecServerResponse>\",\"errorExample\":\"\"}]","title":"创建IPsec服务端","description":"- 创建IPsec服务端前，您需要先创建VPN网关并确保已开启VPN网关的SSL-VPN功能。具体操作，请参见[CreateVpnGateway](~~2794049~~)。\n- 创建IPsec服务端前，需确保VPN网关实例下不存在IPsec连接。具体操作，请参见[DeleteVpnConnection](~~2526948~~)。\n- **CreateIpsecServer**接口属于异步接口，即系统先返回一个实例ID，但该IPsec服务端尚未创建成功，系统后台的创建任务仍在进行。您可以调用[DescribeVpnGateway](~~2794055~~)查询VPN网关实例的状态，来确定IPsec服务端的创建状态：\n    - 当VPN网关实例处于**updating**状态时，表示IPsec服务端正在创建中。\n    - 当VPN网关实例处于**active**状态时，表示IPsec服务端创建成功。\n- **CreateIpsecServer**接口不支持在同一VPN网关下并发创建IPsec服务端。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}