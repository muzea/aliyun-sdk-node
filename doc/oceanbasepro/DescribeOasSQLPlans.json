{"summary":"根据 SQLID 查询诊断系统存储的 SQL 执行计划信息。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"InstanceId","in":"formData","schema":{"description":"OceanBase 集群 ID。","type":"string","required":true,"docRequired":true,"example":"ob317v4uif****"}},{"name":"TenantId","in":"formData","schema":{"description":"租户 ID。","type":"string","required":true,"docRequired":true,"example":"t4louaeei****"}},{"name":"StartTime","in":"formData","schema":{"description":"查询 SQL 执行计划的起始时间。\n\n该时间只支持 UTC 时间，格式为：YYYY-MM-DDThh:mm:ssZ。","type":"string","required":true,"docRequired":true,"example":"2023-04-12T04:38:38Z"}},{"name":"EndTime","in":"formData","schema":{"description":"查询 SQL 执行计划的结束时间。  \n该时间只支持 UTC 时间，格式为：YYYY-MM-DDThh:mm:ssZ。","type":"string","required":true,"docRequired":true,"example":"2023-04-12T05:38:38Z"}},{"name":"DbName","in":"formData","schema":{"description":"数据库名称。","type":"string","required":true,"docRequired":true,"example":"test_db"}},{"name":"SqlId","in":"formData","schema":{"description":"SQL ID。","type":"string","required":true,"docRequired":true,"example":"8D6E84****0B8FB1823D199E2CA1****"}},{"name":"AcceptLanguage","in":"formData","schema":{"description":"支持的语言。取值：\n- 中文：zh-CN\n- 英文：en-US","type":"string","required":false,"example":"zh-CN"}},{"name":"DynamicSql","in":"formData","schema":{"title":"是否动态SQL","description":"是否为动态 SQL。","type":"boolean","required":false,"example":"false"}},{"name":"PlanUnionHash","in":"formData","schema":{"type":"string","required":false}},{"name":"ReturnBriefInfo","in":"formData","schema":{"type":"boolean","required":false}}],"responses":{"200":{"schema":{"title":"","description":"请求的返回结果。","type":"object","properties":{"RequestId":{"title":"","description":"请求 ID。","type":"string","example":"EE205C00-30E4-****-****-87E3A8A2AA0C"},"Data":{"description":"SQL 执行计划信息列表。","type":"array","items":{"description":"SQL 执行计划信息。","type":"object","properties":{"PlanHash":{"description":"SQL 执行计划在诊断系统内部的标识。","type":"string","example":"1758****24913166****"},"Plans":{"title":"执行计划列表","description":"执行计划列表。","type":"array","items":{"description":"请求的返回结果。","type":"object","properties":{"Uid":{"title":"Plan的唯一标识","description":"Plan 的唯一标识。","type":"string","example":"AAAAAAAAAAI****AAFoT2QAF--7W****"},"PlanId":{"description":"计划 ID。","type":"integer","format":"int64","example":"590****"},"FirstLoadTime":{"title":"Plan首次被加载的时间","description":"Plan 首次被加载的时间。","type":"string","example":"2023-04-12T04:46:38Z"},"PlanType":{"title":"Plan的类型：LOCAL、REMOTE、DIST","description":"Plan 类型：LOCAL、REMOTE、DIST。","type":"string","example":"LOCAL"},"PlanHash":{"description":"SQL 执行计划在诊断系统内部的标识。","type":"string","example":"-86290582****886880"},"PlanSize":{"description":"计划大小。","type":"integer","format":"int64","example":"10****"},"SchemaVersion":{"description":"Schema 版本。","type":"integer","format":"int64","example":"16838****3550464"},"MergedVersion":{"description":"合并版本。","type":"integer","format":"int64","example":"513"},"ObServerId":{"description":"server  ID。","type":"integer","format":"int64","example":"2"},"ObDbId":{"description":"数据库 ID。","type":"integer","format":"int64","example":"11006****828"},"ServerId":{"description":"后端服务器实例 ID。","type":"integer","format":"int64","example":"2"},"FirstLoadTimeUs":{"description":"首次加载时间。","type":"integer","format":"int64","example":"1684****03289441"},"HitDiagnosis":{"description":"是否命中诊断。","type":"boolean","example":"false"},"OutlineData":{"title":"Plan的outline_data字段","description":"SQL 执行计划的 outline_data 字段。","type":"string","example":"/*+ BEGIN_OUTLINE_DATA INDEX(@\\\"SEL$1\\"},"OutlineId":{"description":"Outline ID。","type":"integer","format":"int64","example":"-1"},"CollectTimeUs":{"description":"收集时间。","type":"integer","format":"int64","example":"1684368****00000"},"Server":{"title":"server信息","description":"SQL 执行所在的 Server。","type":"string","example":"i-bp1db1a9us038****jio"},"HitPercentage":{"description":"命中率。","type":"number","format":"double","example":"100.0"},"Executions":{"description":"期间的总执行次数。","type":"integer","format":"int64","example":"1"},"ExecPs":{"description":"期间的平均每秒执行次数。","type":"number","format":"double","example":"0.31"},"AvgDiskReads":{"description":"期间内的平均物理读次数。","type":"number","format":"double","example":"0.0"},"AvgDiskWrites":{"description":"期间内的平均物理写入次数。","type":"number","format":"double","example":"0.0"},"AvgBufferGets":{"description":"计划在期间内的平均缓存读次数。","type":"number","format":"double","example":"30137.03"},"AvgApplicationWaitTime":{"description":"期间内的平均 Application 事件等待时间（毫秒）。","type":"number","format":"double","example":"0.0"},"AvgConcurrencyWaitTime":{"description":"期间内的平均 Concurrency 事件等待时间（毫秒）。","type":"number","format":"double","example":"0.0"},"AvgUserIoWaitTime":{"description":"期间内的平均 UserIo 事件等待时间（毫秒）。","type":"number","format":"double","example":"0.0"},"AvgRowProcessed":{"description":"期间内的平均行处理等待时间（毫秒）。","type":"number","format":"double","example":"1.0"},"AvgElapsedTime":{"description":"期间内的平均间隔等待时间（毫秒）。","type":"number","format":"double","example":"1876.78"},"AvgCpuTime":{"description":"期间内的平均 CPU 时间（毫秒）。","type":"number","format":"double","example":"1875.34"},"LargeQueryPercentage":{"description":"长时间执行查询的完成百分比。","type":"number","format":"double","example":"0.0"},"DelayedLargeQueryPercentage":{"description":"长时间执行查询的延迟百分比。","type":"number","format":"double","example":"0.0"},"TimeoutPercentage":{"description":"超时百分比。","type":"number","format":"double","example":"0.0"},"TableScan":{"description":"是否全表扫描。","type":"boolean","example":"false"},"PlanUnionHash":{"description":"SQL 执行计划在诊断系统内部的唯一标识。","type":"string","example":"\"52c7c53****53e61b3f7586b17****ad\""},"SqlId":{"description":"SQL ID。","type":"string","example":"46939C87ECA****95ED0FF64F44B****"}}}},"MergedVersion":{"description":"合并版本。","type":"integer","format":"int64","example":"513"},"FirstLoadTime":{"title":"首次加载时间","description":"首次加载时间","type":"string","example":"2023-04-12T04:46:38Z"},"PlanType":{"title":"执行计划类型","description":"执行计划类型。","type":"string","example":"LOCAL"},"HitDiagnosis":{"description":"是否命中诊断。","type":"boolean","example":"false"},"HitPercentage":{"description":"命中率。","type":"number","format":"double","example":"100.0"},"AvgCpuTime":{"description":"期间内的平均 CPU 时间（毫秒）。","type":"number","format":"double","example":"1875.34"},"PlanExplain":{"title":"执行计划","description":"执行计划。","type":"object","properties":{"PlanJsonString":{"description":"SQL 执行计划的 JSON 字符串。","type":"string","example":"\"PlanJsonString\":\"{\\\"RootOperations\\\":[{\\\"Children\\\":[{\\\"Children\\\":[{\\\"Cost\\\":2000,\\\"ObjectName\\\":\\\"TR\\\",\\\"Operator\\\":\\\"PHY_TABLE_SCAN\\\",\\\"Property\\\":\\\"table_rows:8593, physical_range_rows:85, logical_range_rows:85, index_back_rows:0, output_rows:85, est_method:default_stat, avaiable_index_name[ALL_VIRTUAL_AGENT]\\\",\\\"Rows\\\":86},{\\\"Children\\\":[{\\\"Cost\\\":2000,\\\"ObjectName\\\":\\\"NA\\\",\\\"Operator\\\":\\\"PHY_TABLE_SCAN\\\",\\\"Property\\\":\\\"table_rows:1750, physical_range_rows:17, logical_range_rows:17, index_back_rows:0, output_rows:17, est_method:default_stat, avaiable_index_name[ALL_VIRTUAL_AGENT]\\\",\\\"Rows\\\":18}],\\\"Cost\\\":2013,\\\"ObjectName\\\":\\\"NULL\\\",\\\"Operator\\\":\\\"PHY_SORT\\\",\\\"Property\\\":\\\"NULL\\\",\\\"Rows\\\":18}],\\\"Cost\\\":4024,\\\"ObjectName\\\":\\\"NULL\\\",\\\"Operator\\\":\\\"PHY_MERGE_JOIN\\\",\\\"Property\\\":\\\"NULL\\\",\\\"Rows\\\":26}],\\\"Cost\\\":4025,\\\"ObjectName\\\":\\\"NULL\\\",\\\"Operator\\\":\\\"PHY_SCALAR_AGGREGATE\\\",\\\"Property\\\":\\\"NULL\\\",\\\"Rows\\\":1}]}\""}}},"Executions":{"description":"执行次数。","type":"integer","format":"int64","example":"1"},"PlanUnionHash":{"description":"SQL 执行计划在诊断系统内部的唯一标识。","type":"string","example":"\"52c7c53****53e61b3f7586b17****ad\""},"QuerySql":{"description":"查询语句。\n> <br>暂未使用，恒为空。","type":"string","example":"\"select 1 from t\""},"Bounded":{"description":"是否绑定该执行计划。","type":"boolean","example":"false"}}}}}}}},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"EE205C00-30E4-****-****-87E3A8A2AA0C\\\",\\n  \\\"Data\\\": [\\n    {\\n      \\\"PlanHash\\\": \\\"1758****24913166****\\\",\\n      \\\"Plans\\\": [\\n        {\\n          \\\"Uid\\\": \\\"AAAAAAAAAAI****AAFoT2QAF--7W****\\\",\\n          \\\"PlanId\\\": 0,\\n          \\\"FirstLoadTime\\\": \\\"2023-04-12T04:46:38Z\\\",\\n          \\\"PlanType\\\": \\\"LOCAL\\\",\\n          \\\"PlanHash\\\": \\\"-86290582****886880\\\",\\n          \\\"PlanSize\\\": 0,\\n          \\\"SchemaVersion\\\": 0,\\n          \\\"MergedVersion\\\": 513,\\n          \\\"ObServerId\\\": 2,\\n          \\\"ObDbId\\\": 0,\\n          \\\"ServerId\\\": 2,\\n          \\\"FirstLoadTimeUs\\\": 0,\\n          \\\"HitDiagnosis\\\": false,\\n          \\\"OutlineData\\\": \\\"/*+ BEGIN_OUTLINE_DATA INDEX(@\\\\\\\\\\\\\\\"SEL$1\\\\\\\\\\\",\\n          \\\"OutlineId\\\": -1,\\n          \\\"CollectTimeUs\\\": 0,\\n          \\\"Server\\\": \\\"i-bp1db1a9us038****jio\\\",\\n          \\\"HitPercentage\\\": 100,\\n          \\\"Executions\\\": 1,\\n          \\\"ExecPs\\\": 0.31,\\n          \\\"AvgDiskReads\\\": 0,\\n          \\\"AvgDiskWrites\\\": 0,\\n          \\\"AvgBufferGets\\\": 30137.03,\\n          \\\"AvgApplicationWaitTime\\\": 0,\\n          \\\"AvgConcurrencyWaitTime\\\": 0,\\n          \\\"AvgUserIoWaitTime\\\": 0,\\n          \\\"AvgRowProcessed\\\": 1,\\n          \\\"AvgElapsedTime\\\": 1876.78,\\n          \\\"AvgCpuTime\\\": 1875.34,\\n          \\\"LargeQueryPercentage\\\": 0,\\n          \\\"DelayedLargeQueryPercentage\\\": 0,\\n          \\\"TimeoutPercentage\\\": 0,\\n          \\\"TableScan\\\": false,\\n          \\\"PlanUnionHash\\\": \\\"\\\\\\\"52c7c53****53e61b3f7586b17****ad\\\\\\\"\\\",\\n          \\\"SqlId\\\": \\\"46939C87ECA****95ED0FF64F44B****\\\"\\n        }\\n      ],\\n      \\\"MergedVersion\\\": 513,\\n      \\\"FirstLoadTime\\\": \\\"2023-04-12T04:46:38Z\\\",\\n      \\\"PlanType\\\": \\\"LOCAL\\\",\\n      \\\"HitDiagnosis\\\": false,\\n      \\\"HitPercentage\\\": 100,\\n      \\\"AvgCpuTime\\\": 1875.34,\\n      \\\"PlanExplain\\\": {\\n        \\\"PlanJsonString\\\": \\\"\\\\\\\"PlanJsonString\\\\\\\":\\\\\\\"{\\\\\\\\\\\\\\\"RootOperations\\\\\\\\\\\\\\\":[{\\\\\\\\\\\\\\\"Children\\\\\\\\\\\\\\\":[{\\\\\\\\\\\\\\\"Children\\\\\\\\\\\\\\\":[{\\\\\\\\\\\\\\\"Cost\\\\\\\\\\\\\\\":2000,\\\\\\\\\\\\\\\"ObjectName\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"TR\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Operator\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"PHY_TABLE_SCAN\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Property\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"table_rows:8593, physical_range_rows:85, logical_range_rows:85, index_back_rows:0, output_rows:85, est_method:default_stat, avaiable_index_name[ALL_VIRTUAL_AGENT]\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Rows\\\\\\\\\\\\\\\":86},{\\\\\\\\\\\\\\\"Children\\\\\\\\\\\\\\\":[{\\\\\\\\\\\\\\\"Cost\\\\\\\\\\\\\\\":2000,\\\\\\\\\\\\\\\"ObjectName\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"NA\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Operator\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"PHY_TABLE_SCAN\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Property\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"table_rows:1750, physical_range_rows:17, logical_range_rows:17, index_back_rows:0, output_rows:17, est_method:default_stat, avaiable_index_name[ALL_VIRTUAL_AGENT]\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Rows\\\\\\\\\\\\\\\":18}],\\\\\\\\\\\\\\\"Cost\\\\\\\\\\\\\\\":2013,\\\\\\\\\\\\\\\"ObjectName\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"NULL\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Operator\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"PHY_SORT\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Property\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"NULL\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Rows\\\\\\\\\\\\\\\":18}],\\\\\\\\\\\\\\\"Cost\\\\\\\\\\\\\\\":4024,\\\\\\\\\\\\\\\"ObjectName\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"NULL\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Operator\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"PHY_MERGE_JOIN\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Property\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"NULL\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Rows\\\\\\\\\\\\\\\":26}],\\\\\\\\\\\\\\\"Cost\\\\\\\\\\\\\\\":4025,\\\\\\\\\\\\\\\"ObjectName\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"NULL\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Operator\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"PHY_SCALAR_AGGREGATE\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Property\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"NULL\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"Rows\\\\\\\\\\\\\\\":1}]}\\\\\\\"\\\"\\n      },\\n      \\\"Executions\\\": 1,\\n      \\\"PlanUnionHash\\\": \\\"\\\\\\\"52c7c53****53e61b3f7586b17****ad\\\\\\\"\\\",\\n      \\\"QuerySql\\\": \\\"\\\\\\\"select 1 from t\\\\\\\"\\\",\\n      \\\"Bounded\\\": false\\n    }\\n  ]\\n}\",\"type\":\"json\"}]","title":"查询 SQL 执行计划"}