{"summary":"查询诊断系统判定认为可能存在性能问题的 SQL 列表。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"list"},"parameters":[{"name":"InstanceId","in":"formData","schema":{"title":"OceanBase集群ID。","description":"OceanBase集群ID。","type":"string","required":true,"example":"obsd23j4f****"}},{"name":"TenantId","in":"formData","schema":{"title":"租户ID","description":"租户 ID。","type":"string","required":true,"docRequired":true,"example":"t4louaeei****"}},{"name":"StartTime","in":"formData","schema":{"title":"起始时间","description":"查询可疑 SQL 参数的起始时间。  \n该时间只支持 UTC 时间，格式为：YYYY-MM-DDThh:mm:ssZ。","type":"string","required":true,"docRequired":true,"example":"2021-06-13T15:40:43Z"}},{"name":"EndTime","in":"formData","schema":{"title":"结束时间","description":"查询可疑 SQL 参数的结束时间。  \n该时间只支持 UTC 时间，格式为：YYYY-MM-DDThh:mm:ssZ。","type":"string","required":true,"docRequired":true,"example":"2021-09-13T15:40:43Z"}},{"name":"DbName","in":"formData","schema":{"title":"数据库名称","description":"数据库名称。","type":"string","required":false,"example":"testdb"}},{"name":"SearchKeyWord","in":"formData","schema":{"title":"关键字查询","description":"关键字查询。","type":"string","required":false,"example":"update"}},{"name":"SearchParameter","in":"formData","schema":{"title":"参数查询","description":"参数查询。","type":"string","required":false,"example":"cputime"}},{"name":"SearchRule","in":"formData","schema":{"title":"查询规则","description":"查询规则。  \n该参数取值包括：\"=\"，\">\"， “>=”， “<”，“<=\"","type":"string","required":false,"example":">"}},{"name":"SearchValue","in":"formData","schema":{"title":"查询值","description":"查询值。","type":"string","required":false,"example":"0.01"}},{"name":"SQLId","in":"formData","schema":{"title":"SQLID","description":"SQLID。","type":"string","required":false,"example":"8D6E84****0B8FB1823D199E2CA1****"}},{"name":"NodeIp","in":"formData","schema":{"title":"节点ip","description":"节点 IP。","type":"string","required":false,"example":"i-bp19y05****pacyqnlrc"}},{"name":"PageSize","in":"formData","schema":{"title":"分页查询时设置的每页行数。 最大值：100 默认值：10","description":"分页查询时设置的每页行数。\n- 最大值：100。\n- 默认值：10。","type":"integer","format":"int32","required":false,"example":"10"}},{"name":"PageNumber","in":"formData","schema":{"title":"分页查询的页码。 起始值：1 默认值：1","description":"分页查询的页码。\n- 起始值：1。\n- 默认值：1。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"FilterCondition","in":"formData","style":"json","schema":{"title":"过滤条件","description":"过滤条件。  \n> <br> - OceanBase 的所有字段均支持过滤。<br> - 将参数的键值以  JSON 的格式写在 JSON 字符串中，以对该参数进行过滤。","type":"object","required":false,"enumValueTitles":{"UserName":"UserName","Event":"Event","SQLType":"SQLType","ClientIp":"ClientIp"},"example":"{\n  \"UserName\":testUser\n}"}},{"name":"SortColumn","in":"formData","schema":{"title":"排序列","description":"排序列。","type":"string","required":false,"example":"cputime"}},{"name":"SortOrder","in":"formData","schema":{"title":"排序规则","description":"排序规则。","type":"string","required":false,"enumValueTitles":{"{     \"dbname\":test,     \"SQLType\":null\t\t }":"{     \"dbname\":test,     \"SQLType\":null\t\t }"},"example":"desc"}},{"name":"AcceptLanguage","in":"formData","schema":{"description":"支持的语言。取值：\n- 中文：zh-CN\n- 英文：en-US","type":"string","required":false,"example":"zh-CN"}}],"responses":{"200":{"schema":{"title":"请求的返回结果","description":"请求的返回结果。","type":"object","properties":{"TotalCount":{"title":"总数量","description":"总数量。","type":"integer","format":"int64","example":"2"},"RequestId":{"title":"请求ID","description":"请求 ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E"},"AnomalySQLList":{"title":"可疑SQL列表","description":"可疑 SQL 列表。","type":"array","items":{"description":"请求的返回结果。","type":"object","properties":{"Key":{"title":"返回数据序号","description":"返回数据序号","type":"integer","format":"int64","example":"1"},"DiagnosisRule":{"title":"诊断规则","description":"诊断规则","type":"string","example":"全表扫描有索引未用"},"SQLText":{"title":"sql文本","description":"SQL 文本。","type":"string","example":"SELECT  ****   FROM ****   WHERE **** = ? AND **** = ?   ORDER BY **** ASC"},"Suggestion":{"title":"建议","description":"建议。","type":"string","example":"请确认业务场景、数据分布变化、请求量突涨、执行计划变化等情况"},"DbName":{"title":"数据库名","description":"数据库名。","type":"string","example":"database1"},"RequestTimeUTCString":{"title":"请求时间（零时区）","description":"请求时间（零时区）。","type":"string","example":"2022-01-11T07:08:00Z"},"CpuTime":{"title":"平均CPU时间（ms）","description":"平均 CPU 时间。单位：毫秒。","type":"number","format":"float","example":"50.13"},"SQLId":{"title":"SQLID","description":"SQLID。","type":"string","example":"99E9D3BF****B486239E6C7BC79B****"},"Diagnosis":{"title":"诊断信息","description":"诊断信息。","type":"string","example":"全表扫描有索引未用"},"RequestTime":{"title":"请求时间","description":"请求时间。单位：毫秒。","type":"number","format":"float","example":"50.00"},"Executions":{"title":"执行次数","description":"执行次数。","type":"integer","format":"int64","example":"89043"},"UserName":{"title":"用户名","description":"用户名。","type":"string","example":"tester"}}}}}}}},"errorCodes":{"2014":[{"errorCode":"InternalError","errorMessage":"The request processing has failed due to some unknown error."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"TotalCount\\\": 2,\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E\\\",\\n  \\\"AnomalySQLList\\\": [\\n    {\\n      \\\"Key\\\": 1,\\n      \\\"DiagnosisRule\\\": \\\"全表扫描有索引未用\\\",\\n      \\\"SQLText\\\": \\\"SELECT  ****   FROM ****   WHERE **** = ? AND **** = ?   ORDER BY **** ASC\\\",\\n      \\\"Suggestion\\\": \\\"请确认业务场景、数据分布变化、请求量突涨、执行计划变化等情况\\\",\\n      \\\"DbName\\\": \\\"database1\\\",\\n      \\\"RequestTimeUTCString\\\": \\\"2022-01-11T07:08:00Z\\\",\\n      \\\"CpuTime\\\": 50.13,\\n      \\\"SQLId\\\": \\\"99E9D3BF****B486239E6C7BC79B****\\\",\\n      \\\"Diagnosis\\\": \\\"全表扫描有索引未用\\\",\\n      \\\"RequestTime\\\": 50,\\n      \\\"Executions\\\": 89043,\\n      \\\"UserName\\\": \\\"tester\\\"\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeAnomalySQLListResponse>\\n    <TotalCount>2</TotalCount>\\n    <RequestId>473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E</RequestId>\\n    <AnomalySQLList>\\n        <Key>1</Key>\\n        <DiagnosisRule>整体占比超过百分比</DiagnosisRule>\\n        <SQLText>SELECT  ****   FROM ****   WHERE **** = ? AND **** = ?   ORDER BY **** ASC</SQLText>\\n        <Suggestion>请确认业务场景、数据分布变化、请求量突涨、执行计划变化等情况</Suggestion>\\n        <DbName>database1</DbName>\\n        <RequestTimeUTCString>2022-01-11T07:08:00Z</RequestTimeUTCString>\\n        <SQLId>99E9D3BF****B486239E6C7BC79B****</SQLId>\\n        <Diagnosis>总执行次数=80199,平均CPU耗时=6.8毫秒,整体CPU消耗占比87%</Diagnosis>\\n        <RequestTime>1641884880000</RequestTime>\\n        <Executions>89043</Executions>\\n        <UserName>tester</UserName>\\n    </AnomalySQLList>\\n</DescribeAnomalySQLListResponse>\",\"errorExample\":\"\"}]","title":"查询可疑 SQL 列表","description":"为优化用户体验，云数据库对 SQL 诊断功能进行了升级，本接口已下线并由新的接口替代，详情请参见 <props=\"china\">[【通知】云数据库诊断管理 API 接口下线](https://help.aliyun.com/document_detail/2352272.html?spm=a2c4g.292641.0.0.8d3622f8LtqWiM)</props><props=\"intl\">[【通知】云数据库诊断管理 API 接口下线](https://www.alibabacloud.com/help/zh/apsaradb-for-oceanbase/latest/notice-cloud-database-diagnosis-management-api-interface-downline)</props>。"}