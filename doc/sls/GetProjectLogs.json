{"summary":"查询目标Project下的日志，该接口是Project级别的SQL查询接口。","path":"/logs","methods":["get"],"schemes":["http","https"],"security":[{"AK":[]}],"consumes":["application/json"],"produces":["application/json"],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get","riskType":"none","chargeType":"free","abilityTreeCode":"8913","abilityTreeNodes":["FEATUREslsCAO32E"]},"parameters":[{"name":"project","in":"host","schema":{"title":"project 名称。","description":"Project名称。","type":"string","required":true,"example":"ali-test-project"}},{"name":"query","in":"query","schema":{"title":"标准SQL语句。例如日志库名称为nginx-moni，查询时间区间在2022-03-01 10:41:40到2022-03-01 10:56:40之间的访问数量。","description":"标准SQL语句。例如日志库名称为nginx-moni，查询时间区间在2022-03-01 10:41:40到2022-03-01 10:56:40之间的访问数量。","type":"string","required":true,"example":"SELECT COUNT(*) as pv FROM nginx-moni where __time__ > 1646102500 and __time__ < 1646103400"}},{"name":"powerSql","in":"query","schema":{"title":"是否使用SQL独享版。更多信息，请参见开启SQL独享版。\n\ntrue：使用SQL独享版。\nfalse（默认值）：使用SQL普通版。\n除通过powerSql参数配置SQL独享版外，您还可以使用query参数。","description":"是否使用SQL独享版。更多信息，请参见[开启SQL独享版](~~223777~~)。\n\n- true：使用SQL独享版。\n- false（默认值）：使用SQL普通版。\n\n除通过powerSql参数配置SQL独享版外，您还可以使用**query**参数。","type":"boolean","required":false,"example":"false","default":"false"}}],"responses":{"200":{"headers":{"x-log-progress":{"schema":{"title":"查询结果的状态，包括：  Complete：查询已经完成，返回结果为完整结果。 Incomplete：查询已经完成，返回结果为不完整结果，需要重复请求以获得完整结果。","type":"string","example":"Complete"}},"x-log-count":{"schema":{"title":"当前查询结果的日志总数。","type":"integer","format":"int64","example":"10000"}},"x-log-processed-rows":{"schema":{"title":"本次查询处理的行数。","type":"integer","format":"int64","example":"10000"}},"x-log-elapsed-millisecond":{"schema":{"title":"本次查询消耗的毫秒时间。","type":"integer","format":"int64","example":"5"}},"Server":{"schema":{"title":"服务器名称。","type":"string","example":"nginx"}},"Content-Type":{"schema":{"title":"返回的响应体的内容格式。","type":"string","example":"application/json"}},"Content-Length":{"schema":{"title":"响应内容长度。","type":"string","example":"0"}},"Connection":{"schema":{"title":"是否长链接。取值包括：  close：不是长链接，则每个HTTP请求都会重新建立TCP连接。 keep-alive：长链接，TCP连接建立后保持连接状态，节省连接所需时间和带宽。","type":"string","example":"close"}},"Date":{"schema":{"title":"返回响应的时间。","type":"string","example":"Sun, 27 May 2018 08:25:04 GMT"}},"x-log-requestid":{"schema":{"title":"服务端产生的标识，该请求的唯一ID。","type":"string","example":"5B0A6B60BB6EE39764D458B5"}}},"schema":{"title":"返回日志列表，列表中每一项对应一条返回的日志。","description":"查询到的日志。","type":"array","items":{"title":"每条日志是一个 Map<String,String>, 示例 {\n  \"__time__\" : 1409529660,\n  \"__source__\" : \"192.168.1.100\",\n  \"Key1\" : \"error\",\n  \"Key2\" : \"Value2\"\n}","description":"查询到的日志。","type":"object","additionalProperties":{"type":"string","description":"查询到的日志。","example":"[ { \"__time__\" : 1409529660, \"__source__\" : \"192.168.1.100\", \"Key1\" : \"error\", \"Key2\" : \"Value2\" }, { \"__time__\" : 1409529680, \"__source__\" : \"192.168.1.100\", \"Key3\" : \"error\", \"Key4\" : \"Value4\" } ]"},"example":"[ {   \"__time__\" : 1409529660,   \"__source__\" : \"192.168.1.100\",   \"Key1\" : \"error\",   \"Key2\" : \"Value2\" }, {   \"__time__\" : 1409529680,   \"__source__\" : \"192.168.1.100\",   \"Key3\" : \"error\",   \"Key4\" : \"Value4\" } ]"}}}},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"type\":\"json\",\"example\":\"[\\n  {\\n    \\\"key\\\": \\\"[ { \\\\\\\"__time__\\\\\\\" : 1409529660, \\\\\\\"__source__\\\\\\\" : \\\\\\\"192.168.1.100\\\\\\\", \\\\\\\"Key1\\\\\\\" : \\\\\\\"error\\\\\\\", \\\\\\\"Key2\\\\\\\" : \\\\\\\"Value2\\\\\\\" }, { \\\\\\\"__time__\\\\\\\" : 1409529680, \\\\\\\"__source__\\\\\\\" : \\\\\\\"192.168.1.100\\\\\\\", \\\\\\\"Key3\\\\\\\" : \\\\\\\"error\\\\\\\", \\\\\\\"Key4\\\\\\\" : \\\\\\\"Value4\\\\\\\" } ]\\\"\\n  }\\n]\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"\",\"errorExample\":\"\"}]","title":"获取目标Project下的日志","description":"### 接口说明\n- 请求语法中Host由Project名称和日志服务Endpoint构成，您需要在Host中指定Project。\n- 已创建并获取AccessKey。更多信息，请参见[访问密钥](~~29009~~)。\n\n 阿里云账号AccessKey拥有所有API的访问权限，风险很高。强烈建议您创建并使用RAM用户进行API访问或日常运维。RAM用户需具备操作日志服务资源的权限。具体操作，请参见[创建RAM用户及授权](~~47664~~)。\n- 已明确您查询日志所属的Project名称、所属地域等。如何查询，请参见[管理Project](~~48984~~)。\n- 查询日志前，已配置索引。具体操作，请参见[创建索引](~~90732~~)。\n- 日志服务查询日志时存在使用限制。请设计合理查询与分析语句、设置合理查询区间等。更多信息，请参见[查询日志使用限制](~~43772~~)和[分析日志使用限制](~~53608~~)。\n- 参数query是一个标准的SQL查询语句。\n- 查询的Logstore在查询语句的from条件中指定。可以将Logstore看做是SQL中的表。\n- 在查询的SQL条件中必须指定要查询的时间范围，时间范围由__date__（Timestamp类型）或__time__（Integer类型，单位是秒）来指定。\n### 鉴权资源\n下表列出了API对应的授权信息。您可以在RAM权限策略语句的Action元素中添加该信息，用于为RAM用户或RAM角色授予调用此API的权限。\n|动作（Action）  | 授权策略中的资源描述方式（Resource）  |\n| :------------ | :------------ |\n| `log:GetProjectLogs`  | `acs:log:{#regionId}:{#accountId}:project/{#ProjectName}`  |","requestParamsDescription":"**请求示例：** \n\n~~~\nGET /logs?query=SELECT COUNT(*) as pv FROM nginx-moni where __time__ > 1646102500 and __time__ < 1646103400&powerSql=false HTTP/1.1\nHost:ali-test-project.ch-hangzhou.log.aliyuncs.com\nContent-Type:application/json\n~~~","extraInfo":"| HttpStatusCode  | ErrorCode  | ErrorMessage  | 错误码描述  |\n| :------------ | :------------ | :------------ | :------------ |\n|  400 |  ParameterInvalid|  Parameter is invalid. | 请求的参数错误。 |\n\n更多信息，请参见[通用错误码](~~29013~~)。"}