{"methods":["post","get"],"schemes":["https"],"security":[{"AK":[]}],"systemTags":{"operationType":"get"},"parameters":[{"name":"DurationSeconds","in":"query","schema":{"description":"Token有效期。单位：秒。\n\nToken有效期最小值为900秒，最大值为要扮演角色的`MaxSessionDuration`时间。默认值为3600秒。\n\n您可以通过CreateRole或UpdateRole设置角色最大会话时间`MaxSessionDuration`。更多信息，请参见[CreateRole](~~28710~~)或[UpdateRole](~~28712~~)。","type":"integer","format":"int64","required":false,"example":"3600"}},{"name":"Policy","in":"query","schema":{"description":"为STS Token额外添加的一个权限策略，进一步限制STS Token的权限。具体如下：\n\n- 如果指定该权限策略，则STS Token最终的权限策略取RAM角色权限策略与该权限策略的交集。\n- 如果不指定该权限策略，则STS Token最终的权限策略取RAM角色的权限策略。\n\n长度为1~2048个字符。\n\n关于权限策略元素和示例，请参见[权限策略基本元素](~~93738~~)和[权限策略示例库](~~210969~~)。","type":"string","required":false,"example":"{\"Statement\": [{\"Action\": [\"*\"],\"Effect\": \"Allow\",\"Resource\": [\"*\"]}],\"Version\":\"1\"}"}},{"name":"RoleArn","in":"query","schema":{"description":"要扮演的RAM角色ARN。\n\n该角色是可信实体为阿里云账号类型的RAM角色。更多信息，请参见[创建可信实体为阿里云账号的RAM角色](~~93691~~)或[CreateRole](~~28710~~)。\n\n格式：`acs:ram::<account_id>:role/<role_name>` 。\n\n您可以通过RAM控制台或API查看角色ARN。具体如下：\n\n- RAM控制台：请参见[查看RAM角色的ARN](~~39744~~)。\n- API：请参见[ListRoles](~~28713~~)或[GetRole](~~28711~~)。","type":"string","required":true,"example":"acs:ram::123456789012****:role/adminrole"}},{"name":"RoleSessionName","in":"query","schema":{"description":"角色会话名称。\n\n该参数为用户自定义参数。通常设置为调用该API的用户身份，例如：用户名。在操作审计日志中，即使是同一个RAM角色执行的操作，也可以根据不同的`RoleSessionName`来区分实际操作者，以实现用户级别的访问审计。\n\n长度为2~64个字符，可包含英文字母、数字和特殊字符`.@-_`。","type":"string","required":true,"example":"alice"}},{"name":"ExternalId","in":"query","schema":{"description":"角色外部ID。\n\n该参数为外部提供的用于表示角色的参数信息，主要功能是防止混淆代理人问题。更多信息，请参见[使用ExternalId防止混淆代理人问题](~~2361741~~)。\n\n长度为2~1224个字符，可包含英文字母、数字和特殊字符`=,.@:/-_`。正则为：`[\\w+=,.@:\\/-]*`。","type":"string","required":false,"example":"abcd1234"}}],"responses":{"200":{"headers":{},"schema":{"description":"返回参数。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"6894B13B-6D71-4EF5-88FA-F32781734A7F"},"AssumedRoleUser":{"description":"角色扮演时的临时身份。","type":"object","properties":{"AssumedRoleId":{"description":"临时身份的ID。","type":"string","example":"34458433936495****:alice"},"Arn":{"description":"临时身份的ARN。","type":"string","example":"acs:ram::123456789012****:role/adminrole/alice"}}},"Credentials":{"description":"访问凭证。\n","type":"object","properties":{"SecurityToken":{"description":"安全令牌。\n> 安全令牌的长度不固定，我们强烈建议您不要对安全令牌的最大长度做任何限制。","type":"string","example":"********"},"Expiration":{"description":"Token到期失效时间（UTC时间）。","type":"string","example":"2015-04-09T11:52:19Z"},"AccessKeySecret":{"description":"访问密钥。","type":"string","example":"wyLTSmsyPGP1ohvvw8xYgB29dlGI8KMiH2pK****"},"AccessKeyId":{"description":"访问密钥ID。","type":"string","example":"STS.L4aBSCSJVMuKg5U1****"}}}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParameter.DurationSeconds","errorMessage":"The Min/Max value of DurationSeconds is 15min/1hr."},{"errorCode":"InvalidParameter.ExternalId","errorMessage":"The parameter ExternalId is wrongly formed."},{"errorCode":"InvalidParameter.RoleArn","errorMessage":"The parameter RoleArn is wrongly formed."},{"errorCode":"InvalidParameter.RoleSessionName","errorMessage":"The parameter RoleSessionName is wrongly formed."},{"errorCode":"InvalidParameter.SerialNumber","errorMessage":"The parameter SerialNumber is wrongly formed."},{"errorCode":"InvalidParameter.TokenCode","errorMessage":"The parameter TokenCode is wrongly formed."},{"errorCode":"InvalidParameter.PolicyGrammar","errorMessage":"The parameter Policy has not passed grammar check."},{"errorCode":"InvalidParameter.PolicySize","errorMessage":"The size of Policy must be smaller than 2048 bytes."},{"errorCode":"InvalidParameter.ContentType","errorMessage":"The ContentType request header must be either \"application/json\" or \"application/x-www-form-urlencoded\"."}],"403":[{"errorCode":"NoPermission","errorMessage":"You are not authorized to do this action. You should be authorized by RAM."},{"errorCode":"AuthenticationFail.ApiUsername","errorMessage":"The specified api username is not legal."},{"errorCode":"AuthenticationFail.ApiPassword","errorMessage":"The specified api password is not legal."}],"404":[{"errorCode":"EntityNotExist.Role","errorMessage":"The specified Role not exists ."}],"500":[{"errorCode":"InternalError","errorMessage":"STS Server Internal Error happened, please send the RequestId to us."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"6894B13B-6D71-4EF5-88FA-F32781734A7F\\\",\\n  \\\"AssumedRoleUser\\\": {\\n    \\\"AssumedRoleId\\\": \\\"34458433936495****:alice\\\",\\n    \\\"Arn\\\": \\\"acs:ram::123456789012****:role/adminrole/alice\\\"\\n  },\\n  \\\"Credentials\\\": {\\n    \\\"SecurityToken\\\": \\\"********\\\",\\n    \\\"Expiration\\\": \\\"2015-04-09T11:52:19Z\\\",\\n    \\\"AccessKeySecret\\\": \\\"wyLTSmsyPGP1ohvvw8xYgB29dlGI8KMiH2pK****\\\",\\n    \\\"AccessKeyId\\\": \\\"STS.L4aBSCSJVMuKg5U1****\\\"\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<AssumeRoleResponse>\\n    <Credentials>\\n        <AccessKeyId>STS.L4aBSCSJVMuKg5U1****</AccessKeyId>\\n        <AccessKeySecret>wyLTSmsyPGP1ohvvw8xYgB29dlGI8KMiH2pK****</AccessKeySecret>\\n        <Expiration>2015-04-09T11:52:19Z</Expiration>\\n        <SecurityToken>********</SecurityToken>\\n    </Credentials>\\n    <AssumedRoleUser>\\n        <Arn>acs:ram::123456789012****:role/adminrole/alice</Arn>\\n        <AssumedRoleId>34458433936495****:alice</AssumedRoleId>\\n    </AssumedRoleUser>\\n    <RequestId>6894B13B-6D71-4EF5-88FA-F32781734A7F</RequestId>\\n</AssumeRoleResponse>\",\"errorExample\":\"\"}]","title":"获取扮演角色的临时身份凭证","summary":"通过调用AssumeRole接口，获取一个扮演RAM角色的临时身份凭证（STS Token）。","description":"### 前提条件\n\n该接口不能使用阿里云账号（主账号）调用，只能使用RAM用户或RAM角色调用，请确保已为调用者（RAM用户或RAM角色）授予STS的管理权限（AliyunSTSAssumeRoleAccess）。\n\n否则，会报如下错误：\n\n`You are not authorized to do this action. You should be authorized by RAM.`\n\n问题原因和解决方法如下：\n\n- 该调用者缺少允许STS扮演角色的权限策略：请为该调用者添加系统策略（AliyunSTSAssumeRoleAccess）或自定义策略。具体操作，请参见[能否指定RAM用户具体可以扮演哪个RAM角色](~~39744~~)、[为RAM用户授权](~~116146~~)。\n- RAM角色的信任策略不包含调用者，即RAM角色不允许该调用者扮演：请为RAM角色添加允许该调用者扮演的信任策略。具体操作，请参见[修改RAM角色的信任策略](~~116819~~)。\n\n### 最佳实践\n\nSTS Token自颁发后将在一段时间内有效，建议您设置合理的Token有效期，并在有效期内重复使用，以避免业务请求速率上升后，STS Token颁发的速率限制影响到业务。具体速率限制，请参见[STS服务调用次数是否有上限](~~39744~~)。您可以通过请求参数`DurationSeconds`设置Token有效期。\n\n在移动端上传或下载OSS文件等场景下，其访问量较大，即使重复使用STS Token也可能无法满足限流要求。为避免STS的限流成为OSS访问量的瓶颈，您可以尝试OSS的**在URL中包含签名**的方案。更多信息，请参见[在URL中包含签名](~~31952~~)和[服务端签名后直传](~~31926~~)。","requestParamsDescription":"关于公共请求参数的详情，请参见[公共请求参数](~~315526~~)。"}