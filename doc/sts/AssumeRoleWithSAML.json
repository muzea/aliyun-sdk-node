{"methods":["post","get"],"schemes":["https"],"security":[{"Anonymous":[]}],"operationType":"readAndWrite","systemTags":{"operationType":"get"},"parameters":[{"name":"SAMLProviderArn","in":"query","schema":{"description":"RAM中创建的SAML身份提供商的ARN。\n\n格式：`acs:ram::<account_id>:saml-provider/<saml_provider_id>`。\n\n您可以通过RAM控制台或API查看身份提供商的ARN。具体如下：\n\n- RAM控制台：请参见[查看SAML身份提供商基本信息](~~116795~~)。\n- API：请参见[GetSAMLProvider](~~186833~~)或[ListSAMLProviders](~~186851~~)。","type":"string","required":false,"docRequired":true,"example":"acs:ram::123456789012****:saml-provider/company1"}},{"name":"RoleArn","in":"query","schema":{"description":"要扮演的RAM角色的ARN。\n\n该角色是可信实体为SAML身份提供商的RAM角色。更多信息，请参见[创建可信实体为身份提供商的RAM角色](~~116805~~)或[CreateRole](~~28710~~)。\n\n格式：`acs:ram::<account_id>:role/<role_name>`。\n\n您可以通过RAM控制台或API查看角色ARN。具体如下：\n\n- RAM控制台：请参见[如何查看RAM角色的ARN？](~~39744~~)。\n- API：请参见[ListRoles](~~28713~~)或[GetRole](~~28711~~)。","type":"string","required":false,"docRequired":true,"example":"acs:ram::123456789012****:role/adminrole"}},{"name":"SAMLAssertion","in":"query","schema":{"description":"Base64编码后的SAML断言。\n\n长度为4~100000个字符。\n\n> 需要从IdP获取完整的SAML响应，不能是单独的SAML断言字段。","type":"string","required":false,"docRequired":true,"example":"base64_encoded_saml_assertion"}},{"name":"Policy","in":"query","schema":{"description":"为STS Token额外添加的一个权限策略，进一步限制STS Token的权限。具体如下：\n\n- 如果指定该权限策略，则STS Token最终的权限取RAM角色权限策略与该权限策略的交集。\n- 如果不指定该权限策略，则STS Token最终的权限就是RAM角色的权限。\n\n长度为1~2048个字符。","type":"string","required":false,"example":"url_encoded_policy"}},{"name":"DurationSeconds","in":"query","schema":{"description":"Token有效期。单位：秒。\n\nToken有效期最小值为900秒，最大值为`MaxSessionDuration`设置的时间，默认值为3600秒。\n\n您可以通过CreateRole或UpdateRole接口设置角色最大会话时间`MaxSessionDuration`。更多信息，请参见[CreateRole](~~28710~~)或[UpdateRole](~~28712~~)。","type":"integer","format":"int64","required":false,"example":"3600"}}],"responses":{"200":{"schema":{"description":"返回参数。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"6894B13B-6D71-4EF5-88FA-F32781734A7F"},"SAMLAssertionInfo":{"description":"SAML断言中的部分信息。","type":"object","properties":{"SubjectType":{"description":"SAML断言中`NameID`的格式。当前缀为`urn:oasis:names:tc:SAML:2.0:nameid-format:`时，前缀会被移除。例如：`persistent/transient`。","type":"string","example":"persistent"},"Subject":{"description":"SAML断言中`Subject - NameID`字段的值。","type":"string","example":"alice@example.com"},"Issuer":{"description":"SAML断言中`Issuer`字段的值。","type":"string","example":"http://example.com/adfs/services/trust"},"Recipient":{"description":"SAML断言中`Subject - SubjectConfirmation - SubjectConfirmationData`字段中`Recipient`属性的值。","type":"string","example":"https://signin.aliyun.com/saml-role/SSO"}}},"AssumedRoleUser":{"description":"角色扮演临时身份。","type":"object","properties":{"AssumedRoleId":{"description":"临时身份的ID。","type":"string","example":"34458433936495****:alice"},"Arn":{"description":"临时身份的ARN。","type":"string","example":"acs:sts::123456789012****:assumed-role/AdminRole/alice"}}},"Credentials":{"description":"访问凭证。","type":"object","properties":{"SecurityToken":{"description":"安全令牌。\n> 安全令牌的长度不固定，我们强烈建议您不要对安全令牌的最大长度做任何限制。","type":"string","example":"********"},"Expiration":{"description":"Token到期失效时间（UTC时间）。","type":"string","example":"2015-04-09T11:52:19Z"},"AccessKeySecret":{"description":"访问密钥。","type":"string","example":"wyLTSmsyPGP1ohvvw8xYgB29dlGI8KMiH2pK****"},"AccessKeyId":{"description":"访问密钥ID。","type":"string","example":"STS.L4aBSCSJVMuKg5U1****"}}}}}}},"errorCodes":{"500":[{"errorCode":"InternalError","errorMessage":"STS Server Internal Error happened, please send the RequestId to us."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"6894B13B-6D71-4EF5-88FA-F32781734A7F\\\",\\n  \\\"SAMLAssertionInfo\\\": {\\n    \\\"SubjectType\\\": \\\"persistent\\\",\\n    \\\"Subject\\\": \\\"alice@example.com\\\",\\n    \\\"Issuer\\\": \\\"http://example.com/adfs/services/trust\\\",\\n    \\\"Recipient\\\": \\\"https://signin.aliyun.com/saml-role/SSO\\\"\\n  },\\n  \\\"AssumedRoleUser\\\": {\\n    \\\"AssumedRoleId\\\": \\\"34458433936495****:alice\\\",\\n    \\\"Arn\\\": \\\"acs:sts::123456789012****:assumed-role/AdminRole/alice\\\"\\n  },\\n  \\\"Credentials\\\": {\\n    \\\"SecurityToken\\\": \\\"********\\\",\\n    \\\"Expiration\\\": \\\"2015-04-09T11:52:19Z\\\",\\n    \\\"AccessKeySecret\\\": \\\"wyLTSmsyPGP1ohvvw8xYgB29dlGI8KMiH2pK****\\\",\\n    \\\"AccessKeyId\\\": \\\"STS.L4aBSCSJVMuKg5U1****\\\"\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<AssumeRoleWithSAMLResponse>\\n    <Credentials>\\n        <AccessKeyId>STS.L4aBSCSJVMuKg5U1****</AccessKeyId>\\n        <AccessKeySecret>wyLTSmsyPGP1ohvvw8xYgB29dlGI8KMiH2pK****</AccessKeySecret>\\n        <Expiration>2015-04-09T11:52:19Z</Expiration>\\n        <SecurityToken>********</SecurityToken>\\n    </Credentials>\\n    <AssumedRoleUser>\\n        <arn>acs:sts::1234567890123456:assumed-role/AdminRole/alice</arn>\\n        <AssumedRoleId>34458433936495****:alice</AssumedRoleId>\\n    </AssumedRoleUser>\\n    <SAMLAssertionInfo>\\n        <SubjectType>persistent</SubjectType>\\n        <Subject>alice@example.com</Subject>\\n        <Recipient>https://signin.aliyun.com/saml-role/SSO</Recipient>\\n        <Issuer>http://example.com/adfs/services/trust</Issuer>\\n    </SAMLAssertionInfo>\\n    <RequestId>6894B13B-6D71-4EF5-88FA-F32781734A7F</RequestId>\\n</AssumeRoleWithSAMLResponse>\",\"errorExample\":\"\"}]","title":"SAML角色SSO时获取扮演角色的临时身份凭证","summary":"进行SAML角色SSO时，通过调用AssumeRoleWithSAML接口，获取扮演RAM角色的临时身份凭证（STS Token）。","description":"### 前提条件\n\n- 确保已从外部身份提供商（IdP）获取到SAML响应。\n- 确保已在RAM中创建了SAML身份提供商。具体操作，请参见[创建SAML身份提供商](~~116083~~)或[CreateSAMLProvider](~~186846~~) 。\n- 确保已在RAM中创建了可信实体为SAML身份提供商的RAM角色。具体操作，请参见[创建可信实体为身份提供商的RAM角色](~~116805~~)或[CreateRole](~~28710~~) 。","requestParamsDescription":"> 由于AssumeRoleWithSAML接口使用SAML断言进行身份认证，可以匿名访问，因此不需要提供公共请求参数中的`Signature`、`SignatureMethod`、`SignatureVersion`和`AccessKeyId`参数。关于公共请求参数的详情，请参见[公共请求参数](~~315526~~)。"}