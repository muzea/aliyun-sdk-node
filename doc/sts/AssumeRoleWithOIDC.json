{"summary":"进行OIDC角色SSO时，通过调用AssumeRoleWithOIDC接口，获取扮演RAM角色的临时身份凭证（STS Token）。","methods":["get","post"],"schemes":["https"],"security":[{"ARS_OIDC":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"OIDCProviderArn","in":"query","schema":{"title":"OIDC Provider的ARN","description":"OIDC身份提供商的ARN。\n\n您可以通过RAM控制台或API查看OIDC身份提供商的ARN。具体如下：\n\n- RAM控制台：请参见[查看OIDC身份提供商信息](~~327123~~)。\n- API：请参见[GetOIDCProvider](~~327126~~)或[ListOIDCProviders](~~327127~~) 。","type":"string","required":false,"docRequired":true,"example":"acs:ram::113511544585****:oidc-provider/TestOidcIdp"}},{"name":"RoleArn","in":"query","schema":{"title":"需要扮演的角色的ARN","description":"需要扮演的RAM角色ARN。\n\n您可以通过RAM控制台或API查看角色ARN。具体如下：\n\n- RAM控制台：请参见[如何查看RAM角色的ARN](~~39744~~)。\n- API：请参见[ListRoles](~~28713~~)或[GetRole](~~28711~~) 。","type":"string","required":false,"docRequired":true,"example":"acs:ram::113511544585****:role/testoidc"}},{"name":"OIDCToken","in":"query","schema":{"title":"OIDC的ID Token，需输入原始Token，无需Base64解码","description":"由外部IdP签发的OIDC令牌（OIDC Token）。\n\n长度：4~20000个字符。\n\n> 需要输入原始OIDC Token，无需Base64解码。","type":"string","required":false,"docRequired":true,"example":"eyJraWQiOiJKQzl3eHpyaHFKMGd0****"}},{"name":"Policy","in":"query","schema":{"title":"权限策略。 生成STS Token时可以指定一个额外的权限策略，以进一步限制STS Token的权限。若不指定则返回的Token拥有指定角色的所有权限。","description":"为STS Token额外添加的一个权限策略，进一步限制STS Token的权限。具体如下：\n\n- 如果指定该权限策略，则STS Token最终的权限取RAM角色权限策略与该权限策略的交集。\n- 如果不指定该权限策略，则STS Token最终的权限就是RAM角色的权限。\n\n长度：1~2048个字符。","type":"string","required":false,"example":"{\"Statement\": [{\"Action\": [\"*\"],\"Effect\": \"Allow\",\"Resource\": [\"*\"]}],\"Version\":\"1\"}"}},{"name":"DurationSeconds","in":"query","schema":{"title":"Session过期时间，单位为秒。","description":"Token有效期。单位：秒。\n\n默认值：3600。最小值：900。最大值：`MaxSessionDuration`设置的时间。\n\n关于设置角色最大会话时间`MaxSessionDuration`的具体操作，请参见[CreateRole](~~28710~~)或[UpdateRole](~~28712~~)。","type":"integer","format":"int64","required":false,"example":"3600"}},{"name":"RoleSessionName","in":"query","schema":{"title":"用户自定义参数。此参数用来区分不同的令牌，可用于用户级别的访问审计。","description":"角色会话名称。\n\n该参数为用户自定义参数。通常设置为调用该API的用户身份，例如：用户名。在操作审计日志中，即使是同一个RAM角色执行的操作，也可以根据不同的RoleSessionName来区分实际操作者，以实现用户级别的访问审计。\n\n格式：包含英文字母、数字、半角句号（.）、at（@）、短划线（-）和下划线（_）。\n\n长度：2~64个字符。","type":"string","required":true,"docRequired":true,"example":"TestOidcAssumedRoleSession"}}],"responses":{"200":{"schema":{"description":"返回参数。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"3D57EAD2-8723-1F26-B69C-F8707D8B565D"},"OIDCTokenInfo":{"description":"解析的OIDC Token信息。","type":"object","properties":{"Subject":{"description":"OIDC主体。\n\n对应OIDC Token中的`sub`字段值。\n","type":"string","example":"KryrkIdjylZb7agUgCEf****"},"Issuer":{"description":"OIDC颁发者URL。\n\n对应OIDC Token中的`iss`字段值。","type":"string","example":"https://dev-xxxxxx.okta.com"},"ClientIds":{"description":"OIDC受众。多个之间用半角逗号（,）分隔。\n\n对应OIDC Token中的`aud`字段值。","type":"string","example":"496271242565057****"},"ExpirationTime":{"description":"OIDC Token的过期时间。","type":"string","example":"2021-10-20T04:27:09Z"},"IssuanceTime":{"description":"OIDC Token的签发时间。","type":"string","example":"2021-10-20T03:27:09Z"},"VerificationInfo":{"description":"OIDC Token的检验信息。更多信息，请参见[管理OIDC身份提供商](~~327123~~)。","type":"string","example":"Success"}}},"AssumedRoleUser":{"description":"角色扮演临时身份。","type":"object","properties":{"AssumedRoleId":{"description":"临时身份的ID。","type":"string","example":"33157794895460****"},"Arn":{"description":"临时身份的ARN。","type":"string","example":"acs:ram::113511544585****:role/testoidc/TestOidcAssumedRoleSession"}}},"Credentials":{"description":"临时访问凭证（STS Token）。","type":"object","properties":{"SecurityToken":{"description":"安全令牌。\n> 安全令牌的长度不固定，我们强烈建议您不要对安全令牌的最大长度做任何限制。","type":"string","example":"CAIShwJ1q6Ft5B2yfSjIr5bSEsj4g7BihPWGWHz****"},"Expiration":{"description":"Token到期失效时间（UTC时间）。","type":"string","example":"2021-10-20T04:27:09Z"},"AccessKeySecret":{"description":"访问密钥。","type":"string","example":"CVwjCkNzTMupZ8NbTCxCBRq3K16jtcWFTJAyBEv2****"},"AccessKeyId":{"description":"访问密钥ID。","type":"string","example":"STS.NUgYrLnoC37mZZCNnAbez****"}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"3D57EAD2-8723-1F26-B69C-F8707D8B565D\\\",\\n  \\\"OIDCTokenInfo\\\": {\\n    \\\"Subject\\\": \\\"KryrkIdjylZb7agUgCEf****\\\",\\n    \\\"Issuer\\\": \\\"https://dev-xxxxxx.okta.com\\\",\\n    \\\"ClientIds\\\": \\\"496271242565057****\\\",\\n    \\\"ExpirationTime\\\": \\\"2021-10-20T04:27:09Z\\\",\\n    \\\"IssuanceTime\\\": \\\"2021-10-20T03:27:09Z\\\",\\n    \\\"VerificationInfo\\\": \\\"Success\\\"\\n  },\\n  \\\"AssumedRoleUser\\\": {\\n    \\\"AssumedRoleId\\\": \\\"33157794895460****\\\",\\n    \\\"Arn\\\": \\\"acs:ram::113511544585****:role/testoidc/TestOidcAssumedRoleSession\\\"\\n  },\\n  \\\"Credentials\\\": {\\n    \\\"SecurityToken\\\": \\\"CAIShwJ1q6Ft5B2yfSjIr5bSEsj4g7BihPWGWHz****\\\",\\n    \\\"Expiration\\\": \\\"2021-10-20T04:27:09Z\\\",\\n    \\\"AccessKeySecret\\\": \\\"CVwjCkNzTMupZ8NbTCxCBRq3K16jtcWFTJAyBEv2****\\\",\\n    \\\"AccessKeyId\\\": \\\"STS.NUgYrLnoC37mZZCNnAbez****\\\"\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<AssumeRoleWithOIDCResponse>\\n\\t<RequestId>3D57EAD2-8723-1F26-B69C-F8707D8B565D</RequestId>\\n\\t<OIDCTokenInfo>\\n\\t\\t<Subject>KryrkIdjylZb7agUgCEf****</Subject>\\n\\t\\t<Issuer>https://dev-xxxxxx.okta.com</Issuer>\\n\\t\\t<ClientIds>496271242565057****</ClientIds>\\n\\t</OIDCTokenInfo>\\n\\t<AssumedRoleUser>\\n\\t\\t<AssumedRoleId>33157794895460****</AssumedRoleId>\\n\\t\\t<Arn>acs:ram::113511544585****:role/testoidc/TestOidcAssumedRoleSession</Arn>\\n\\t</AssumedRoleUser>\\n\\t<Credentials>\\n\\t\\t<SecurityToken>CAIShwJ1q6Ft5B2yfSjIr5bSEsj4g7BihPWGWHz****</SecurityToken>\\n\\t\\t<Expiration>2021-10-20T04:27:09Z</Expiration>\\n\\t\\t<AccessKeySecret>CVwjCkNzTMupZ8NbTCxCBRq3K16jtcWFTJAyBEv2****</AccessKeySecret>\\n\\t\\t<AccessKeyId>STS.NUgYrLnoC37mZZCNnAbez****</AccessKeyId>\\n\\t</Credentials>\\n</AssumeRoleWithOIDCResponse>\\t\\n\",\"errorExample\":\"\"}]","title":"OIDC角色SSO时获取扮演角色的临时身份凭证","description":"### 前提条件\n\n- 确保已从外部身份提供商（IdP）获取到OIDC令牌（OIDC Token）。\n- 确保已在RAM中创建了OIDC身份提供商。具体操作，请参见[创建OIDC身份提供商](~~327123~~)或[CreateOIDCProvider](~~327135~~) 。\n- 确保已在RAM中创建了可信实体为OIDC身份提供商的RAM角色。具体操作，请参见[创建可信实体为身份提供商的RAM角色](~~116805~~)或[CreateRole](~~28710~~) 。","requestParamsDescription":"> 由于AssumeRoleWithOIDC接口使用OIDC Token进行身份认证，可以匿名访问，因此不需要提供公共请求参数中的`Signature`、`SignatureMethod`、`SignatureVersion`和`AccessKeyId`参数。关于公共请求参数的详情，请参见[公共请求参数](~~315526~~)。"}