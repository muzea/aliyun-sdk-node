{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"Lang","in":"query","schema":{"description":"请求和接收消息的语言类型。取值：\n- **zh**（默认）：表示中文。\n- **en**：表示英文。","type":"string","required":false,"example":"zh"}},{"name":"Lang","in":"query","schema":{"description":"请求和接收消息的语言类型。取值：\n- **zh**（默认）：表示中文。\n- **en**：表示英文。","type":"string","required":false,"example":"zh"}},{"name":"StartTime","in":"query","schema":{"description":"设置查询开始时间。使用秒级时间戳格式表示。","type":"string","required":true,"example":"1534408189"}},{"name":"EndTime","in":"query","schema":{"description":"设置查询结束时间。使用秒级时间戳格式表示。","type":"string","required":true,"example":"1534408267"}},{"name":"Direction","in":"query","schema":{"description":"入侵防御事件的流量的方向。取值：\n- **in**：表示进方向。\n- **out**：表示出方向。\n\n>不设置该参数表示查询所有流量方向。","type":"string","required":false,"example":"in"}},{"name":"PageSize","in":"query","schema":{"description":"设置分页查询每页包含多少条结果。\n\n默认值为**6**，表示每页包含6条结果。最大值为**10**。","type":"string","required":false,"example":"6"}},{"name":"CurrentPage","in":"query","schema":{"description":"设置分页查询返回第几页数据。\n默认值为**1**，表示返回第1页数据。","type":"string","required":false,"example":"1"}},{"name":"DataType","in":"query","schema":{"description":"风险事件类型。  \n唯一取值：**session**，表示入侵防御事件。\n","type":"string","required":true,"example":"session"}},{"name":"RuleSource","in":"query","schema":{"description":"入侵防御事件的检测规则来源。取值：\n- **1**：表示基础防御。\n- **2**：表示虚拟补丁。\n- **4**：表示威胁情报。\n\n> 不设置该参数表示查询所有规则来源。","type":"string","required":false,"example":"1"}},{"name":"RuleResult","in":"query","schema":{"description":"云防火墙的防御状态。取值：\n- **1**：表示告警。\n- **2**：表示拦截。\n\n> 不设置该参数表示查询所有防御状态。\n","type":"string","required":false,"example":"1"}},{"name":"SrcIP","in":"query","schema":{"description":"要查询的源IP。设置该参数表示查询包含了这条源IP的入侵防御事件。","type":"string","required":false,"example":"192.0.XX.XX"}},{"name":"DstIP","in":"query","schema":{"description":"要查询的目的IP。设置该参数表示查询包含了这条目的IP的入侵防御事件。","type":"string","required":false,"example":"192.0.XX.XX"}},{"name":"VulLevel","in":"query","schema":{"description":"入侵防御事件的安全等级。取值：\n- **1**：表示低危。\n- **2**：表示中危。\n- **3**：表示高危。\n\n> 不设置该参数表示查询所有安全等级。","type":"string","required":false,"example":"1"}},{"name":"FirewallType","in":"query","schema":{"description":"云防火墙类型。取值：\n- **VpcFirewall**：表示VPC边界防火墙。\n- **InternetFirewall**（默认）：表示互联网边界防火墙。","type":"string","required":false,"example":"InternetFirewall"}},{"name":"SrcNetworkInstanceId","in":"query","schema":{"description":"源VPC实例ID。\n> 仅在FirewallType为VpcFirewall时，需要设置该参数。","type":"string","required":false,"example":"vpc-uf6e9a9zyokj2ywuo****"}},{"name":"DstNetworkInstanceId","in":"query","schema":{"description":"目的VPC实例ID。\n> 仅在FirewallType为VpcFirewall时，需要设置该参数。","type":"string","required":false,"example":"vpc-uf6e9a9zyokj2ywuo****"}},{"name":"AttackType","in":"query","schema":{"description":"入侵防御事件的攻击类型。取值：\n- **1**：表示异常连接。\n- **2**：表示命令执行。\n- **3**：表示暴力破解。\n- **4**：表示扫描。\n- **5**：表示其它。\n- **6**：表示信息泄露。\n- **7**：表示Dos攻击。\n- **8**：表示溢出攻击。\n- **9**：表示Web攻击。\n- **10**：表示木马后门。\n- **11**：表示病毒蠕虫。\n- **12**：表示挖矿行为。\n- **13**：表示反弹Shell。\n\n>不设置该参数表示查询全部攻击类型。","type":"string","required":false,"example":"1"}},{"name":"NoLocation","in":"query","schema":{"description":"是否查询IP地址位置信息。\n- **true**： 表示不查询IP地理位置信息。\n- **false**（默认）：表示查询IP地理位置信息。\n","type":"string","required":false,"example":"false"}},{"name":"AttackApp","in":"query","style":"repeatList","schema":{"description":"被攻击应用的名称的列表，使用`[\"AttackApp1\",\"AttackApp2\"]`格式表示。","type":"array","items":{"description":"被攻击应用的名称的列表，使用`[\"AttackApp1\",\"AttackApp2\"]`格式表示。","type":"string","required":false,"example":"Redis"},"required":false,"example":"[\"MySql\",\"DNS\"]","maxItems":100}},{"name":"BuyVersion","in":"query","schema":{"description":"购买版本。取值：\n- **2**：高级版。\n- **3**：企业版。\n- **4**：旗舰版。\n- **10**：按量付费版。\n","type":"integer","format":"int64","required":false,"example":"10"}},{"name":"Sort","in":"query","schema":{"description":"根据指定字段排序。取值：\n\n- **VulLevel**（默认）：根据风险等级排序。\n\n- **LastTime**：根据最近发生时间排序。","type":"string","required":false,"example":"LastTime"}},{"name":"Order","in":"query","schema":{"description":"排序方式。取值：\n\n- **asc**：升序。\n\n-  **desc**（默认）：降序。","type":"string","required":false,"example":"desc"}},{"name":"EventName","in":"query","schema":{"description":"入侵防御事件名称。","type":"string","required":false,"example":"木马后门通信"}}],"responses":{"200":{"schema":{"description":"入侵防御事件的详细数据。","type":"object","properties":{"TotalCount":{"description":"风险事件的总数量。","type":"integer","format":"int32","example":"20"},"RequestId":{"description":"本次请求的ID。","type":"string","example":"B14757D0-4640-4B44-AC67-7F558FE7E6EF"},"DataList":{"description":"返回数据列表。","type":"array","items":{"description":"返回数据列表。","type":"object","properties":{"Direction":{"description":"该入侵防御事件的流量方向。取值：\n- **in**：表示进方向。\n- **out**：表示出方向。","type":"string","example":"in"},"EventName":{"description":"入侵防御事件名称。","type":"string","example":"Web目录穿越攻击"},"DstIP":{"description":"查询到的目的IP。表示入侵防御事件中包含了这条目的IP。","type":"string","example":"192.0.XX.XX"},"AttackType":{"description":"该入侵防御事件的攻击类型。取值：\n- **1**：表示异常连接。\n- **2**：表示命令执行。\n- **3**：表示暴力破解。\n- **4**：表示扫描。\n- **5**：表示其它。\n- **6**：表示信息泄露。\n- **7**：表示Dos攻击。\n- **8**：表示溢出攻击。\n- **9**：表示Web攻击。\n- **10**：表示木马后门。\n- **11**：表示病毒蠕虫。\n- **12**：表示挖矿行为。\n- **13**：表示反弹Shell。","type":"integer","format":"int32","example":"1"},"Tag":{"description":"重保情报标签。","type":"string","example":"重保情报"},"RuleId":{"description":"本次入侵防御事件的防护规则ID。","type":"string","example":"1000****"},"EventId":{"description":"入侵防御事件ID。","type":"string","example":"2b58efae-4c4b-4d96-9544-a586fb1f****"},"ResourceType":{"description":"该入侵防御事件的公网IP类型。取值：\n -  **EIP**：表示弹性公网IP。\n - **EcsPublicIP**：表示ECS公网IP。\n - **EcsEIP**：表示ECS EIP。\n - **NatPublicIP**：表示NAT公网IP。\n - **NatEIP**：表示NAT EIP。\n - **SlbPublicIp**：表示SLB 公网IP。","type":"string","example":"EcsPublicIP"},"FirstEventTime":{"description":"入侵事件首次发生时间。使用秒级时间戳格式表示。","type":"integer","format":"int32","example":"1534408189"},"Description":{"description":"该入侵防御事件的描述。","type":"string","example":"检测到HTTP请求的Web访问中使用了目录穿越攻击。"},"EventCount":{"description":"入侵防御事件数。","type":"integer","format":"int32","example":"100"},"VulLevel":{"description":"该入侵防御事件的安全等级。取值：\n- **1**：表示低危。\n- **2**：表示中危。\n- **3**：表示高危。","type":"integer","format":"int32","example":"1"},"AttackApp":{"description":"被攻击应用的名称。","type":"string","example":"MySql"},"RuleSource":{"description":"本次入侵防御事件的检测规则来源。取值：\n- **1**：表示基础防御。\n- **2**：表示虚拟补丁。\n- **4**：表示威胁情报。","type":"integer","format":"int32","example":"1"},"RuleResult":{"description":"防御状态。取值：\n- **1**：表示告警。\n- **2**：表示拦截。\n","type":"integer","format":"int32","example":"2"},"SrcIP":{"description":"查询到的源IP。表示入侵防御事件中包含了这条源IP。","type":"string","example":"192.0.XX.XX"},"LastEventTime":{"description":"入侵防御事件上次发生的时间。使用秒级时间戳格式表示。","type":"integer","format":"int32","example":"1534408267"},"ResourcePrivateIPList":{"description":"该入侵防御事件的私网IP信息，以**RegionNo**、**ResourceInstanceId**、**ResourceInstanceName**和**ResourcePrivateIP**的数组形式返回该IP信息。  \n其中，**RegionNo**表示该IP所属的地域ID，**ResourceInstanceId**表示该IP所属的实例ID，**ResourceInstanceName**表示该IP所属的实例名，**ResourcePrivateIP**表示该IP。","type":"array","items":{"description":"该入侵防御事件的私网IP信息，以**RegionNo**、**ResourceInstanceId**、**ResourceInstanceName**和**ResourcePrivateIP**的数组形式返回该IP信息。  \n其中，**RegionNo**表示该IP所属的地域ID，**ResourceInstanceId**表示该IP所属的实例ID，**ResourceInstanceName**表示该IP所属的实例名，**ResourcePrivateIP**表示该IP。","type":"object","properties":{"ResourceInstanceName":{"description":"实例名。","type":"string","example":"LD-shenzhen-zy****"},"ResourcePrivateIP":{"description":"私网IP。","type":"string","example":"10.255.XX.XX"},"ResourceInstanceId":{"description":"实例ID。","type":"string","example":"i-wz92jf4scg2zb74p****"},"RegionNo":{"description":"地域ID。表示私网IP所属的地域ID。","type":"string","example":"cn-hangzhou"}}}},"SrcPrivateIPList":{"description":"入侵防御事件的源私网IP列表。","type":"array","items":{"description":"入侵防御事件的源私网IP列表。\n>只有出方向会返回该参数的值。","type":"string","example":"[\"192.168.XX.XX\",\"192.168.XX.XX\"]"}},"VpcSrcInfo":{"description":"该入侵防御事件的源VPC信息，该结构体包含**EcsInstanceId**、**EcsInstanceName**、**NetworkInstanceId**、**NetworkInstanceName**和**RegionNo**参数。  \n其中，**EcsInstanceId**表示该VPC中的ECS实例ID，**EcsInstanceName**表示该VPC中的ECS实例名，**NetworkInstanceId**表示该VPC实例ID，**NetworkInstanceName**表示该VPC实例名，**RegionNo**表示该VPC实例所属的地域ID。","type":"object","properties":{"EcsInstanceName":{"description":"ECS实例名。","type":"string","example":"LD-shenzhen-zy****"},"NetworkInstanceName":{"description":"VPC实例名。","type":"string","example":"VPC-SH-TX****"},"NetworkInstanceId":{"description":"VPC实例ID。","type":"string","example":"vpc-uf6e9a9zyokj2ywuo****"},"EcsInstanceId":{"description":"ECS实例ID。","type":"string","example":"i-wz92jf4scg2zb74p****"},"RegionNo":{"description":"地域ID。表示源VPC实例所属的地域ID。","type":"string","example":"cn-hangzhou"}}},"VpcDstInfo":{"description":"该入侵防御事件的目的VPC信息，该结构体包含**EcsInstanceId**、**EcsInstanceName**、**NetworkInstanceId**、**NetworkInstanceName**和**RegionNo**参数。  \n其中，**EcsInstanceId**表示该VPC中的ECS实例ID，**EcsInstanceName**表示该VPC中的ECS实例名，**NetworkInstanceId**表示该VPC实例ID，**NetworkInstanceName**表示该VPC实例名，**RegionNo**表示该VPC实例所属的地域ID。","type":"object","properties":{"EcsInstanceName":{"description":"ECS实例名。","type":"string","example":"LD-shenzhen-zy****"},"NetworkInstanceName":{"description":"VPC实例名。","type":"string","example":"VPC-SH-TX****"},"NetworkInstanceId":{"description":"VPC实例ID。","type":"string","example":"vpc-uf6e9a9zyokj2ywuo****"},"EcsInstanceId":{"description":"ECS实例ID。","type":"string","example":"i-wz92jf4scg2zb74p****"},"RegionNo":{"description":"地域ID。表示目的VPC实例所属的地域ID。","type":"string","example":"cn-hangzhou"}}},"IPLocationInfo":{"description":"IP地理位置信息，该结构体包含**CityId**、**CityName**、**CountryId**和**CountryName**参数。  \n其中，**CityId**表示该IP所属的城市ID，**CityName**表示该IP所属的城市名，**CountryId**表示该IP所属的国家ID，**CountryName**表示该IP所属的国家名。","type":"object","properties":{"CityId":{"description":"城市ID。","type":"string","example":"510100"},"CountryName":{"description":"国家名。","type":"string","example":"中国"},"CityName":{"description":"城市名。","type":"string","example":"四川省成都"},"CountryId":{"description":"国家ID。","type":"string","example":"CN"}}},"SrcIPTag":{"description":"源IP标签，用于标识是否为云产品回源IP。","type":"string","example":"WAF Back-to-origin Address"}}}}}}}},"errorCodes":{"400":[{"errorCode":"ErrorAliUid","errorMessage":"The aliuid is invalid."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"TotalCount\\\": 20,\\n  \\\"RequestId\\\": \\\"B14757D0-4640-4B44-AC67-7F558FE7E6EF\\\",\\n  \\\"DataList\\\": [\\n    {\\n      \\\"Direction\\\": \\\"in\\\",\\n      \\\"EventName\\\": \\\"Web目录穿越攻击\\\",\\n      \\\"DstIP\\\": \\\"192.0.XX.XX\\\",\\n      \\\"AttackType\\\": 1,\\n      \\\"Tag\\\": \\\"重保情报\\\",\\n      \\\"RuleId\\\": \\\"1000****\\\",\\n      \\\"EventId\\\": \\\"2b58efae-4c4b-4d96-9544-a586fb1f****\\\",\\n      \\\"ResourceType\\\": \\\"EcsPublicIP\\\",\\n      \\\"FirstEventTime\\\": 1534408189,\\n      \\\"Description\\\": \\\"检测到HTTP请求的Web访问中使用了目录穿越攻击。\\\",\\n      \\\"EventCount\\\": 100,\\n      \\\"VulLevel\\\": 1,\\n      \\\"AttackApp\\\": \\\"MySql\\\",\\n      \\\"RuleSource\\\": 1,\\n      \\\"RuleResult\\\": 2,\\n      \\\"SrcIP\\\": \\\"192.0.XX.XX\\\",\\n      \\\"LastEventTime\\\": 1534408267,\\n      \\\"ResourcePrivateIPList\\\": [\\n        {\\n          \\\"ResourceInstanceName\\\": \\\"LD-shenzhen-zy****\\\",\\n          \\\"ResourcePrivateIP\\\": \\\"10.255.XX.XX\\\",\\n          \\\"ResourceInstanceId\\\": \\\"i-wz92jf4scg2zb74p****\\\",\\n          \\\"RegionNo\\\": \\\"cn-hangzhou\\\"\\n        }\\n      ],\\n      \\\"SrcPrivateIPList\\\": [\\n        \\\"[\\\\\\\"192.168.XX.XX\\\\\\\",\\\\\\\"192.168.XX.XX\\\\\\\"]\\\"\\n      ],\\n      \\\"VpcSrcInfo\\\": {\\n        \\\"EcsInstanceName\\\": \\\"LD-shenzhen-zy****\\\",\\n        \\\"NetworkInstanceName\\\": \\\"VPC-SH-TX****\\\",\\n        \\\"NetworkInstanceId\\\": \\\"vpc-uf6e9a9zyokj2ywuo****\\\",\\n        \\\"EcsInstanceId\\\": \\\"i-wz92jf4scg2zb74p****\\\",\\n        \\\"RegionNo\\\": \\\"cn-hangzhou\\\"\\n      },\\n      \\\"VpcDstInfo\\\": {\\n        \\\"EcsInstanceName\\\": \\\"LD-shenzhen-zy****\\\",\\n        \\\"NetworkInstanceName\\\": \\\"VPC-SH-TX****\\\",\\n        \\\"NetworkInstanceId\\\": \\\"vpc-uf6e9a9zyokj2ywuo****\\\",\\n        \\\"EcsInstanceId\\\": \\\"i-wz92jf4scg2zb74p****\\\",\\n        \\\"RegionNo\\\": \\\"cn-hangzhou\\\"\\n      },\\n      \\\"IPLocationInfo\\\": {\\n        \\\"CityId\\\": \\\"510100\\\",\\n        \\\"CountryName\\\": \\\"中国\\\",\\n        \\\"CityName\\\": \\\"四川省成都\\\",\\n        \\\"CountryId\\\": \\\"CN\\\"\\n      },\\n      \\\"SrcIPTag\\\": \\\"WAF Back-to-origin Address\\\"\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeRiskEventGroupResponse>\\n    <TotalCount>20</TotalCount>\\n    <RequestId>B14757D0-4640-4B44-AC67-7F558FE7E6EF</RequestId>\\n    <DataList>\\n        <Direction>in</Direction>\\n        <EventName>WEB目录穿越攻击</EventName>\\n        <DstIP>192.0.XX.XX</DstIP>\\n        <AttackType>1</AttackType>\\n        <Tag>重保情报</Tag>\\n        <RuleId>1000****</RuleId>\\n        <EventId>2b58efae-4c4b-4d96-9544-a586fb1f****</EventId>\\n        <ResourceType>EcsPublicIP</ResourceType>\\n        <FirstEventTime>1534408189</FirstEventTime>\\n        <Description>检测到HTTP请求的WEB访问中使用了目录穿越攻击。</Description>\\n        <EventCount>100</EventCount>\\n        <VulLevel>1</VulLevel>\\n        <AttackApp>MySql</AttackApp>\\n        <RuleSource>1</RuleSource>\\n        <RuleResult>2</RuleResult>\\n        <SrcIP>192.0.XX.XX</SrcIP>\\n        <LastEventTime>1534408267</LastEventTime>\\n        <ResourcePrivateIPList>\\n            <ResourceInstanceName>LD-shenzhen-zy****</ResourceInstanceName>\\n            <ResourcePrivateIP>10.255.XX.XX</ResourcePrivateIP>\\n            <ResourceInstanceId>i-wz92jf4scg2zb74p****</ResourceInstanceId>\\n            <RegionNo>cn-hangzhou</RegionNo>\\n        </ResourcePrivateIPList>\\n        <SrcPrivateIPList>[\\\"192.168.XX.XX\\\",\\\"192.168.XX.XX\\\"]</SrcPrivateIPList>\\n        <VpcSrcInfo>\\n            <EcsInstanceName>LD-shenzhen-zy****</EcsInstanceName>\\n            <NetworkInstanceName>VPC-SH-TX****</NetworkInstanceName>\\n            <NetworkInstanceId>vpc-uf6e9a9zyokj2ywuo****</NetworkInstanceId>\\n            <EcsInstanceId>i-wz92jf4scg2zb74p****</EcsInstanceId>\\n            <RegionNo>cn-hangzhou</RegionNo>\\n        </VpcSrcInfo>\\n        <VpcDstInfo>\\n            <EcsInstanceName>LD-shenzhen-zy****</EcsInstanceName>\\n            <NetworkInstanceName>VPC-SH-TX****</NetworkInstanceName>\\n            <NetworkInstanceId>vpc-uf6e9a9zyokj2ywuo****</NetworkInstanceId>\\n            <EcsInstanceId>i-wz92jf4scg2zb74p****</EcsInstanceId>\\n            <RegionNo>cn-hangzhou</RegionNo>\\n        </VpcDstInfo>\\n        <IPLocationInfo>\\n            <CityId>510100</CityId>\\n            <CountryName>中国</CountryName>\\n            <CityName>四川省成都</CityName>\\n            <CountryId>CN</CountryId>\\n        </IPLocationInfo>\\n    </DataList>\\n</DescribeRiskEventGroupResponse>\",\"errorExample\":\"\"}]","title":"获取入侵防御事件的详细数据","summary":"获取入侵防御事件的详细数据。","description":"本接口用于查询和下载入侵防御详细数据，建议一次查询5~10条。为避免查询超时，如果无需返回IP地理位置信息，请设置参数NoLocation为true。\n\n## QPS限制\n本接口的单用户QPS限制为10次/秒。超过限制，API调用会被限流，这可能会影响您的业务，请合理调用。","requestParamsDescription":"调用API时，除了本文中该API的请求参数，还需加入阿里云API公共请求参数。公共请求参数的详细介绍，请参见[公共参数](~~94763~~)。 \n调用API的请求格式，请参见本文**示例**中的请求示例。 ","responseParamsDescription":" ","extraInfo":" "}