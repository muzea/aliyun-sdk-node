{"summary":"获取云防火墙支持防护的漏洞列表。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"SourceIp","in":"query","schema":{"description":"访问源的IP地址。","type":"string","deprecated":true,"required":false,"example":"112.239.XX.XX"}},{"name":"Lang","in":"query","schema":{"description":"返回消息的语言类型。取值：\n\n- **zh**（默认）：中文\n- **en**：英文","type":"string","required":false,"example":"zh"}},{"name":"Lang","in":"query","schema":{"description":"返回消息的语言类型。取值：\n\n- **zh**（默认）：中文\n- **en**：英文","type":"string","required":false,"example":"zh"}},{"name":"StartTime","in":"query","schema":{"description":"设置查询开始时间。使用秒级时间戳格式表示。","type":"string","required":true,"example":"1655778046"}},{"name":"EndTime","in":"query","schema":{"description":"设置查询结束时间。使用秒级时间戳格式表示。","type":"string","required":true,"example":"1646063922"}},{"name":"VulnStatus","in":"query","schema":{"description":"漏洞防护状态。取值：\n\n- **partProtected** ：部分防护中\n- **protected** ：防护中\n- **unProtected** ：未防护","type":"string","required":false,"enumValueTitles":{"protected":"protected","unProtected":"unProtected","partProtected":"partProtected"},"example":"protected"}},{"name":"VulnCveName","in":"query","schema":{"description":"漏洞CVE编号。","type":"string","required":false,"enumValueTitles":{},"example":"CVE-2022-2992"}},{"name":"AttackType","in":"query","schema":{"description":"漏洞防护事件的攻击类型。取值：\n- **1**：异常连接\n- **2**：命令执行\n- **3**：暴力破解\n- **4**：扫描\n- **5**：其它\n- **6**：信息泄露\n- **7**：DoS攻击\n- **8**：溢出攻击\n- **9**：Web攻击\n- **10**：木马后门\n- **11**：病毒蠕虫\n- **12**：挖矿行为\n- **13**：反弹Shell\n\n>不设置该参数表示查询全部攻击类型。","type":"string","required":false,"example":"13"}},{"name":"VulnType","in":"query","schema":{"description":"漏洞类型。取值：\n\n- **App**：应用漏洞\n- **emg**：应急漏洞\n- **cms**：Web-CMS漏洞","type":"string","required":false,"example":"emg"}},{"name":"VulnLevel","in":"query","schema":{"description":"漏洞风险等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","required":false,"example":"medium"}},{"name":"CurrentPage","in":"query","schema":{"description":"分页查询时的当前页的页码。默认值为1。","type":"string","required":false,"example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询时，显示的每页数据的最大条数。支持最大取值为50。","type":"string","required":false,"example":"10"}},{"name":"SortKey","in":"query","schema":{"description":"排序依据。唯一取值：**attackCnt**，表示攻击次数。","type":"string","required":false,"example":"attackCnt"}},{"name":"Order","in":"query","schema":{"description":"排序方式。取值：\n\n- **asc**：升序。\n-  **desc**（默认）：降序。","type":"string","required":false,"example":"desc"}},{"name":"VulnResource","in":"query","schema":{"description":"漏洞影响的资产数。","type":"string","required":false,"example":"1"}},{"name":"UserType","in":"query","schema":{"description":"用户类型。唯一取值：**buy**，表示付费型。","type":"string","required":false,"example":"buy"}},{"name":"BuyVersion","in":"query","schema":{"description":"云防火墙的版本。按量付费版本填10，其它版本不需要填写。","type":"integer","format":"int64","required":false,"example":"10"}},{"name":"MemberUid","in":"query","schema":{"description":"云防火墙成员账号的UID。","type":"string","required":false,"example":"258039427902****"}}],"responses":{"200":{"headers":{},"schema":{"description":"DescribeVulnerabilityProtectedList 应答","type":"object","properties":{"RequestId":{"description":"结果的请求ID。","type":"string","example":"D355C631-1537-59C5-A56E-F6C5037B99E5"},"TotalCount":{"description":"云防火墙已检测的漏洞总数量。","type":"integer","format":"int32","example":"5"},"ZeroResourceCount":{"description":"检测到的漏洞资产数为0的个数。","type":"integer","format":"int32","example":"1"},"VulnList":{"description":"漏洞信息集合。","type":"array","items":{"description":"漏洞信息。","type":"object","properties":{"VulnName":{"description":"漏洞名称。","type":"string","example":"fastjson <= 1.2.80 反序列化任意代码执行漏洞"},"AttackType":{"description":"漏洞防护事件的攻击类型。取值：\n- **1**：异常连接\n- **2**：命令执行\n- **3**：暴力破解\n- **4**：扫描\n- **5**：其它\n- **6**：信息泄露\n- **7**：DoS攻击\n- **8**：溢出攻击\n- **9**：Web攻击\n- **10**：木马后门\n- **11**：病毒蠕虫\n- **12**：挖矿行为\n- **13**：反弹Shell","type":"integer","format":"int32","example":"13"},"NeedRuleClass":{"description":"需要开启的RuleClass等级。取值：\n\n- **1**（默认）：宽松\n- **2**：中等\n- **3**：严格","type":"integer","format":"int32","example":"1"},"VulnType":{"description":"漏洞类型。取值：\n\n- **emg**：应急漏洞\n- **webcms**：Web-CMS漏洞\n- **app**：应用漏洞","type":"string","example":"emg"},"VulnKey":{"description":"漏洞编码。","type":"string","example":"dedecms-archive.helper.php-vul"},"VulnLevel":{"description":"漏洞等级。取值：\n\n- **high**：高危\n- **medium**：中危\n- **low**：低危","type":"string","example":"high"},"NeedOpenBasicRule":{"description":"漏洞对应基础防御规则的状态。取值：\n\n- **true**：开启\n- **false**：关闭\n> 当取值为true时，一键防护时需要设置该漏洞对应的基础防御状态为拦截。","type":"boolean","example":"false"},"CveId":{"description":"CVE编号列表。","type":"string","example":"12112131123, 1231123112"},"FirstTime":{"description":"首次发生攻击的时间。","type":"integer","format":"int64","example":"1608687364"},"BasicRuleIds":{"description":"关联的规则ID。","type":"string","example":"12,12"},"LastTime":{"description":"最近一次的攻击时间。","type":"integer","format":"int64","example":"1608687364"},"NeedOpenVirtualPatcheUuids":{"description":"需要升级为拦截模式的虚拟补丁规则UUID。","type":"string","example":"UUID-1231231234"},"NeedOpenBasicRuleUuids":{"description":"需要升级为拦截模式的基础防御规则UUID。","type":"string","example":"UUID-1231231"},"NeedOpenVirtualPatche":{"description":"漏洞对应虚拟补丁的状态。取值：\n\n- **true**：开启\n- **false**：关闭\n> 当取值为true时，一键防护时需要设置该漏洞对应的虚拟补丁状态为拦截。","type":"boolean","example":"true"},"VirtualPatcheIds":{"description":"关联的规则ID。","type":"string","example":"13,13"},"HighlightTag":{"description":"该漏洞是否需要重要关注。取值：\n\n- **0**：不需要\n- **1**：需要","type":"integer","format":"int32","example":"0"},"NeedOpenRunMode":{"description":"一键防护时是否需要设置威胁引擎运行模式。取值：\n\n- **true**：需要\n\n- **false**：不需要","type":"boolean","example":"true"},"VulnStatus":{"description":"漏洞防护状态。取值：\n\n- **partProtected**：部分防护中\n- **protected**：防护中\n- **unProtected**：未防护","type":"string","example":"protected"},"AttackCnt":{"description":"漏洞的攻击次数。","type":"integer","format":"int32","example":"0"},"ResourceCnt":{"description":"存在漏洞的资产数。","type":"integer","format":"int32","example":"0"},"MemberUid":{"description":"当前阿里云账号的成员账号UID。","type":"string","example":"119384235299****"},"ResourceList":{"description":"漏洞资产列表。","type":"array","items":{"description":"漏洞资产。","type":"object","properties":{"ResourceType":{"description":"漏洞资产类型。取值：\n\n- **SLB**\n- **EIP**\n- **ECS**","type":"string","example":"EIP"},"Eip":{"description":"实例的EIP。","type":"string","example":"203.107.XX.XX"},"InternetIp":{"description":"实例的公网IP。","type":"string","example":"47.96.XX.XX"},"VulnStatus":{"description":"漏洞防护状态。取值：\n\n- **partProtected**：部分防护中\n- **protected**：防护中\n- **unProtected**：未防护","type":"string","example":"protected"},"ResourceId":{"description":"实例ID。","type":"string","example":"vfw-m5e7dbc4y****"},"ResourceName":{"description":"实例的名称。","type":"string","example":"ECS"},"IntranetIp":{"description":"实例的私网IP。","type":"string","example":"192.168.XX.XX"},"RegionId":{"description":"云防火墙所在的地域ID。\n> 关于云防火墙支持地域的详细信息，请参见[支持的地域](~~195657~~)。","type":"string","example":"cn-beijing"}}}}}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"D355C631-1537-59C5-A56E-F6C5037B99E5\\\",\\n  \\\"TotalCount\\\": 5,\\n  \\\"ZeroResourceCount\\\": 1,\\n  \\\"VulnList\\\": [\\n    {\\n      \\\"VulnName\\\": \\\"fastjson <= 1.2.80 反序列化任意代码执行漏洞\\\",\\n      \\\"AttackType\\\": 13,\\n      \\\"NeedRuleClass\\\": 1,\\n      \\\"VulnType\\\": \\\"emg\\\",\\n      \\\"VulnKey\\\": \\\"dedecms-archive.helper.php-vul\\\",\\n      \\\"VulnLevel\\\": \\\"high\\\",\\n      \\\"NeedOpenBasicRule\\\": false,\\n      \\\"CveId\\\": \\\"12112131123, 1231123112\\\",\\n      \\\"FirstTime\\\": 1608687364,\\n      \\\"BasicRuleIds\\\": \\\"12,12\\\",\\n      \\\"LastTime\\\": 1608687364,\\n      \\\"NeedOpenVirtualPatcheUuids\\\": \\\"UUID-1231231234\\\",\\n      \\\"NeedOpenBasicRuleUuids\\\": \\\"UUID-1231231\\\",\\n      \\\"NeedOpenVirtualPatche\\\": true,\\n      \\\"VirtualPatcheIds\\\": \\\"13,13\\\",\\n      \\\"HighlightTag\\\": 0,\\n      \\\"NeedOpenRunMode\\\": true,\\n      \\\"VulnStatus\\\": \\\"protected\\\",\\n      \\\"AttackCnt\\\": 0,\\n      \\\"ResourceCnt\\\": 0,\\n      \\\"MemberUid\\\": \\\"119384235299****\\\",\\n      \\\"ResourceList\\\": [\\n        {\\n          \\\"ResourceType\\\": \\\"EIP\\\",\\n          \\\"Eip\\\": \\\"203.107.XX.XX\\\",\\n          \\\"InternetIp\\\": \\\"47.96.XX.XX\\\",\\n          \\\"VulnStatus\\\": \\\"protected\\\",\\n          \\\"ResourceId\\\": \\\"vfw-m5e7dbc4y****\\\",\\n          \\\"ResourceName\\\": \\\"ECS\\\",\\n          \\\"IntranetIp\\\": \\\"192.168.XX.XX\\\",\\n          \\\"RegionId\\\": \\\"cn-beijing\\\"\\n        }\\n      ]\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeVulnerabilityProtectedListResponse>\\n    <RequestId>D355C631-1537-59C5-A56E-F6C5037B99E5</RequestId>\\n    <TotalCount>5</TotalCount>\\n    <ZeroResourceCount>1</ZeroResourceCount>\\n    <VulnList>\\n        <VulnName>fastjson &lt;= 1.2.80 反序列化任意代码执行漏洞</VulnName>\\n        <AttackType>13</AttackType>\\n        <NeedRuleClass>1</NeedRuleClass>\\n        <VulnType>emg</VulnType>\\n        <VulnKey>dedecms-archive.helper.php-vul</VulnKey>\\n        <VulnLevel>high</VulnLevel>\\n        <NeedOpenBasicRule>false</NeedOpenBasicRule>\\n        <CveId>12112131123, 1231123112</CveId>\\n        <FirstTime>1608687364</FirstTime>\\n        <BasicRuleIds>12,12</BasicRuleIds>\\n        <LastTime>1608687364</LastTime>\\n        <NeedOpenVirtualPatcheUuids>UUID-1231231234</NeedOpenVirtualPatcheUuids>\\n        <NeedOpenBasicRuleUuids>UUID-1231231</NeedOpenBasicRuleUuids>\\n        <NeedOpenVirtualPatche>true</NeedOpenVirtualPatche>\\n        <VirtualPatcheIds>13,13</VirtualPatcheIds>\\n        <HighlightTag>0</HighlightTag>\\n        <NeedOpenRunMode>true</NeedOpenRunMode>\\n        <VulnStatus>protected</VulnStatus>\\n        <AttackCnt>0</AttackCnt>\\n        <ResourceCnt>0</ResourceCnt>\\n        <ResourceList>\\n            <ResourceType>EIP</ResourceType>\\n            <Eip>203.107.XX.XX</Eip>\\n            <InternetIp>47.96.XX.XX</InternetIp>\\n            <VulnStatus>protected</VulnStatus>\\n            <ResourceId>vfw-m5e7dbc4y****</ResourceId>\\n            <ResourceName>ECS</ResourceName>\\n            <IntranetIp>192.168.XX.XX</IntranetIp>\\n            <RegionId>cn-beijing</RegionId>\\n        </ResourceList>\\n    </VulnList>\\n</DescribeVulnerabilityProtectedListResponse>\",\"errorExample\":\"\"}]","title":"获取漏洞防护列表"}