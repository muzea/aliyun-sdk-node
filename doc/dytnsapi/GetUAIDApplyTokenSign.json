{"summary":"该API仅提供三网运营商获取UAID能力中，获取授权Token环节的签名功能。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{},"parameters":[{"name":"AuthCode","in":"query","schema":{"description":"授权码。\n\n> 在**号码分析服务**->[**标签广场**](https://dytns.console.aliyun.com/analysis/square)选择标签，提交使用申请，申请通过后，会获得该授权码。","type":"string","required":true,"example":"HwD97InG"}},{"name":"OutId","in":"query","schema":{"description":"外部流水号。\n> 对应移动（CM）运营商中的traceId、msgId，三者保持一致即可","type":"string","required":true,"example":"b8b5b3a*******0b9893484fdf412c99"}},{"name":"ClientType","in":"query","schema":{"description":"客户端类型。\n- Android：30100\n- IOS：30300\n- H5：20200\n- WEB：10010","type":"string","required":true,"example":"30300"}},{"name":"ParamKey","in":"query","schema":{"description":"运营商为电信（CT）时必传，具体参考电信运营商文档。","type":"string","required":false,"example":"955EC1A869852EA8BC66F********D7C6E92017BBD5B001C736EFEAFB775C232"}},{"name":"ParamStr","in":"query","schema":{"description":"运营商为电信（CT）时必传，具体参考电信运营商文档。","type":"string","required":false,"example":"B2F0D4CD7A216D16CE2AF4BBC********29A454FDDD991F919106C12CB89ABA8"}},{"name":"Time","in":"query","schema":{"description":"事件发生的时间戳，精确到毫秒。  \n格式：yyyyMMddHHmmssSSS。","type":"string","required":true,"example":"20121227180001165"}},{"name":"Carrier","in":"query","schema":{"description":"用户所处的运营商。取值：\n- **CM**：中国移动。\n- **CU**：中国联通。\n- **CT**：中国电信。","type":"string","required":true,"example":"CM"}},{"name":"Format","in":"query","schema":{"description":"请求方式，运营商为电信（CT）时必传。\n取值：\n\n- json\n- jsonp","type":"string","required":false,"example":"json"}}],"responses":{"200":{"schema":{"type":"object","properties":{"AccessDeniedDetail":{"description":"访问被拒绝详细信息。","type":"string","example":"-"},"RequestId":{"description":"请求ID。","type":"string","example":"68A40250-50CD-034C-B728-0BD******177"},"Message":{"description":"返回状态码描述。","type":"string","example":"OK"},"Data":{"description":"返回结果。","type":"object","properties":{"OutId":{"description":"外部流水号。","type":"string","example":"b8b5b3a*******0b9893484fdf412c99"},"Sign":{"description":"签名值","type":"string","example":"D2E204D74EEB373E468632********23F592C4C9"},"Carrier":{"description":"用户所处的运营商。取值：\n- **CM**：中国移动。\n- **CU**：中国联通。\n- **CT**：中国电信。","type":"string","example":"CM"}}},"Code":{"description":"请求状态码。取值：\n- **OK**：请求成功。","type":"string","example":"OK"}}}}},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"AccessDeniedDetail\\\": \\\"-\\\",\\n  \\\"RequestId\\\": \\\"68A40250-50CD-034C-B728-0BD******177\\\",\\n  \\\"Message\\\": \\\"OK\\\",\\n  \\\"Data\\\": {\\n    \\\"OutId\\\": \\\"b8b5b3a*******0b9893484fdf412c99\\\",\\n    \\\"Sign\\\": \\\"D2E204D74EEB373E468632********23F592C4C9\\\",\\n    \\\"Carrier\\\": \\\"CM\\\"\\n  },\\n  \\\"Code\\\": \\\"OK\\\"\\n}\",\"type\":\"json\"}]","title":"获取UAID授权Token的签名值","description":"该API仅提供三网运营商获取UAID能力中，**获取授权Token环节的签名功能**。\n - 获取授权Token的其他必要参数，请参考对应运营商文档自行生成\n - 获取授权Token的请求，请参考对应运营商文档，注意需要从用户移动终端的蜂窝移动网络环境下请求\n - 获取授权Token请求后，请参考[UAIDVerification](~~UAIDVerification~~) 接口进行最终的UAID获取。\n\n### 如何通过客户端/H5方式请求授权Token\n\n<notice>发起请求授权Token时，客户端或H5页面必须切换到蜂窝移动网络。</notice>\n\n#### 移动（CM）\n通信协议：HTTPS + application/Json  \n方法：POST  \n地址：https://msg.cmpassport.com/h5/getMobile  \n\n##### 请求参数\n参数示例：  \n\n`{\n  \"traceId\": \"mfawsxtcmyplwzpayzzvdvbsowxmkynr\",\n  \"appId\": \"300011580392\",\n  \"sign\": \"2c61b3c58ffbeed97461e31be4fd931a\",\n  \"msgId\": \"redbyxsdetddwaaffajcwwapspykftzx\",\n  \"expandParams\": \"\",\n  \"businessType\": \"3\",\n  \"version\": \"1.0\",\n  \"timestamp\": \"20201125101540980\"\n}`  \n  \n参数描述：  \n- version：使用`1.0`\n- timestamp：请求消息发送的系统时间，精确到毫秒，对应该API下方入参`Time`的内容及其格式，两者需要保持一致\n- appId：使用`300012406312`\n- businessType：使用`3`\n- traceId：外部流水号，对应该API下方入参`OutId`的内容，两者需要保持一致\n- sign：调用该API获取\n- msgId：外部流水号，对应该API下方入参`OutId`的内容，两者需要保持一致\n\n##### 响应参数\n响应示例：  \n`{\n  \"header\": {\n    \"appId\": \"300011580392\",\n    \"msgId\": \"redbyxsdetddwaaffajcwwapspykftzx\",\n    \"timestamp\": \"20201125101607932\"\n  },\n  \"body\": {\n    \"resultCode\": \"103000\",\n    \"expandParams\": \"\",\n    \"resultDesc\": \"成功\",\n    \"token\": \"H5HTTPS4187AE9743AFCB14F8D99B9D65ED9E01\"\n  }\n}`\n\n直接获取`body`中的`token`即可。\n\n#### 联通（CU）\n分两步获取token\n##### 第一步：获取authurl\n通过第一步请求，获取门户服务器获取鉴权服务器地址`authurl`  \n\n通信协议：HTTPS + application/Json  \n方法：GRT  \n地址：https://nisportal.10010.com:9001/api  \n###### 请求参数\n参数示例：  \njson方式请求：`?appId=1554778161153`  \njsonp方式请求：`?appId=1554778161153&callback=callbackFunction`  \n\n参数描述：\n- appId：使用1554778161153\n- callback：jsonp回调函数名。仅当使用jsonp格式时需要传此参数\n###### 响应参数\n响应示例：  \njson方式请求：\n`{\"authurl\": \"https://enrichgw.10010.com/d93222629f52ec79\"}`  \njsonp方式请求：\n`callbackFunction({\"authurl\":\"https://enrichgw.10010.com/d93222629f52ec79\"})`  \n\n获取返回结果中的`authurl`。\n\n##### 第二步：获取token\n通信协议：HTTPS + application/Json  \n方法：GRT  \n地址：${authurl}+\"/api\"  \n\n请求地址示例：`https://enrichgw.10010.com/d93222629f52ec79/api`\n###### 请求参数\n参数示例：  \njson方式请求：`?appId=1554778161153`  \njsonp方式请求：`?appId=1554778161153&callback=callbackFunction`  \n\n参数描述：\n- appId：使用1554778161153\n- callback：jsonp回调函数名。仅当使用jsonp格式时需要传此参数\n###### 响应参数\n响应示例：  \njson方式请求：\n`{\n    \"province\": \"1\",\n    \"code\": \"7nHS1nggx2WP613750206700RN6oiRN1\"\n}`  \njsonp方式请求：\n`callbackFunction({\"province\":\"1\",\"code\":\"7nHS3Dnkd1BS701851092400RN6oiRN1\"})`\n\n获取返回结果中的`code`即可。\n\n\n\n#### 电信（CT）\n通信协议：HTTPS + application/x-www-form-urlencoded;charset=UTF  \n方法：GET  \n地址：https://id6.me/gw/preuniq.do\n\n##### 请求参数\n参数示例：  \n`?clientType=30100&appId=9390188202&format=json&sign=D63C166FA19E1996EF********09C6A5397C10B4&paramKey=1D7C25EB8B0B8B4CB3CF8DC60628F6549********786B0AF1FEF93FA1335057A35BF5F0B39A3867EAA9BE14B3898********8B01DE34965060445B6E1F66401D714650E4AB161CD6DCF4A72********3B856F22A192B8B0C39D7A55B961062E68C89C928894F119B25********7C548355FE9DB82852EB93C939F2200B48CD17&paramStr=140********95AF8E138B94754CB4CF83BA6FB********52B258BFDFD38BF233&version=1.1`  \n\n参数描述：  \n- appId：使用`9390188202`\n- clientType：客户端类型，对应该API下方入参`ClientType`的内容，两者需要保持一致\n- format：使用`json`或`jsonp`\n- version：使用`1.1`\n- sign：调用该API获取\n- paramKey：密钥A的密文；密钥A为接入端随机生成字符串，长度为16位；`paramKey = RSA1024(\"${密钥A}\", \"${天翼账号平台公钥}\")`；填充模式为`RSA/ECB/PKCS1Padding`；下载[电信RSA公钥](https://id.189.cn/source/files/API.pem)\n- paramStr：不公开请求参数密文； timeStamp为时间戳，精确到毫秒，对应该API下方入参`Time`的值，但格式不同（参考值`1697791988302`）；callback为使用jsonp格式时的回调方法，仅当format取值为jsonp时需要填写。`paramStr = AES(\"timeStamp=${timeStamp}&callback=${callback}\", \"${密钥A}\")`；填充模式为`AES/CBC/PKCS5Padding`，初始向量为`0000000000000000`\n\n##### 响应参数\n响应示例：  \n`callback?result=10000&msg=success&data=a35336711c70456cb883f4f224e9a259`  \n\n`data`为加密的业务结果数据，`data = AES(业务结果, 密钥A)`，使用密钥A进行AES解密（AES/CBC/PKCS5Padding）。  \n  \n解密后业务结果示例：  \n`{\"accessCode\": \"H5HTTPS4187AE9743AFCB14F8D99B9D65ED9E01\"}`\n  \n此时获取`accessCode`即可。"}