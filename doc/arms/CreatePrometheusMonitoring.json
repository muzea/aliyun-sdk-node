{"summary":"创建Prometheus实例的监控配置。","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create","riskType":"none","chargeType":"free"},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"地域ID。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"ClusterId","in":"query","schema":{"title":"prometheus实例ID","description":"prometheus实例ID","type":"string","required":true,"docRequired":true,"example":"cc7a37ee31aea4ed1a059eff8034b****"}},{"name":"Type","in":"query","schema":{"title":"容器服务类型的实例支持：serviceMonitor、podMonitor、customJob、probe\necs类型的实例支持：customJob、probe","description":"容器服务类型的实例支持：serviceMonitor、podMonitor、customJob、probe。\necs类型的实例支持：customJob、probe。","type":"string","required":true,"docRequired":true,"example":"serviceMonitor"}},{"name":"Status","in":"query","schema":{"title":"run, stop。\n为空时，默认是run。\nprobe不支持状态设置，该参数不填。","description":"监控配置状态：run, stop。\n为空时，默认是run。\nprobe暂不支持配置状态，此字段为空。","type":"string","required":false,"docRequired":false,"example":"run"}},{"name":"ConfigYaml","in":"formData","schema":{"title":"serviceMonitor、podMonitor、customJob、probe对应的 yaml串。\nprobe时，容器服务类型实例的metadata.namespace为\"arms-prom\"，ecs类型实例的metadata.namespace为{userId}-{vpcId}，托管ask实例的metadata.namespace为ask-{clusterId}。\n\nserviceMonitor示例：\n`\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: tomcat-demo\n  namespace: default\nspec:\n  endpoints:\n    - interval: 30s\n      path: /metrics\n      port: tomcat-monitor\n  namespaceSelector:\n    any: true\n  selector:\n    matchLabels:\n      app: tomcat\n`\n\npodMonitor示例：\n`\napiVersion: \"monitoring.coreos.com/v1\"\nkind: \"PodMonitor\"\nmetadata:\n  name: \"podmonitor-demo\"\n  namespace: \"default\"\nspec:\n  namespaceSelector:\n    any: true\n  podMetricsEndpoints:\n    - interval: \"30s\"\n      path: \"/metrics\"\n      port: \"tomcat-monitor\"\n  selector:\n    matchLabels:\n      app: \"nginx2-exporter\"\n`\n\ncustomJob示例：\n`\nscrape_configs:\n- job_name: prometheus1\n  honor_timestamps: false\n  honor_labels: false\n  scheme: http\n  metrics_path: /metric\n  static_configs:\n  - targets:\n    - 127.0.0.1:9090\n`\n\nprobe示例：\n`\napiVersion: monitoring.coreos.com/v1\nkind: Probe\nmetadata:\n  name: name1-tcp-blackbox #规则：xxx-{tcp/http/ping}-blackbox\n  namespace: arms-prom #可选，服务端自动填写\nspec:\n  interval: 30s\n  jobName: blackbox\n  module: tcp_connect\n  prober:\n    path: /blackbox/probe\n    scheme: http\n    url: 'localhost:9335'\n  targets:\n    staticConfig:\n      static:\n        - 'arms-prom-admin.arms-prom:9335'\n`","description":"监控配置yaml串。","type":"string","required":true,"docRequired":true,"example":"参见请求参数补充说明。"}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"Schema of Response","type":"object","properties":{"RequestId":{"title":"Id of the request","description":"Id of the request","type":"string","example":"21E85B16-75A6-429A-9F65-8AAC9A54****"},"Code":{"description":"状态码。200表示成功。","type":"integer","format":"int32","example":"200"},"Data":{"title":"返回成功增加的remoewrite名称，或异常信息。","description":"返回成功增加的监控配置名称，或异常信息。","type":"string","example":"name1"},"Message":{"description":"返回结果的提示信息。","type":"string","example":"message"}}}}},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"21E85B16-75A6-429A-9F65-8AAC9A54****\\\",\\n  \\\"Code\\\": 200,\\n  \\\"Data\\\": \\\"name1\\\",\\n  \\\"Message\\\": \\\"message\\\"\\n}\",\"type\":\"json\"}]","title":"创建Prometheus实例的监控配置","requestParamsDescription":"serviceMonitor示例：\n```\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: tomcat-demo\n  namespace: default\nspec:\n  endpoints:\n    - interval: 30s\n      path: /metrics\n      port: tomcat-monitor\n  namespaceSelector:\n    any: true\n  selector:\n    matchLabels:\n      app: tomcat\n```\n\npodMonitor示例：\n```\napiVersion: \"monitoring.coreos.com/v1\"\nkind: \"PodMonitor\"\nmetadata:\n  name: \"podmonitor-demo\"\n  namespace: \"default\"\nspec:\n  namespaceSelector:\n    any: true\n  podMetricsEndpoints:\n    - interval: \"30s\"\n      path: \"/metrics\"\n      port: \"tomcat-monitor\"\n  selector:\n    matchLabels:\n      app: \"nginx2-exporter\"\n```\n\ncustomJob示例：\n```\nscrape_configs:\n  - job_name: prometheus1\n    honor_timestamps: false\n    honor_labels: false\n    scheme: http\n    metrics_path: /metric\n    static_configs:\n      - targets:\n          - 127.0.0.1:9090\n```\n  \nprobe示例：\n```\napiVersion: monitoring.coreos.com/v1\nkind: Probe\nmetadata:\n  name: name1-tcp-blackbox #规则：xxx-{tcp/http/ping}-blackbox\n  namespace: arms-prom # 可选\nspec:\n  interval: 30s\n  jobName: blackbox\n  module: tcp_connect\n  prober:\n    path: /blackbox/probe\n    scheme: http\n    url: 'localhost:9335'\n  targets:\n    staticConfig:\n      static:\n        - 'arms-prom-admin.arms-prom:9335'\n```"}