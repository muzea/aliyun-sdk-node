{"summary":"创建或修改告警规则。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create"},"parameters":[{"name":"AlertId","in":"formData","schema":{"title":"告警规则ID","description":"告警规则ID。\n\n- 不填代表创建新的告警规则。\n- 填写代表修改指定告警规则信息。","type":"integer","format":"int64","required":false,"example":"546xxx"}},{"name":"AlertName","in":"formData","schema":{"title":"告警规则名称","description":"告警规则名称。","type":"string","required":true,"example":"Alert Rule Demo"}},{"name":"RegionId","in":"formData","schema":{"title":"地域","description":"地域ID。","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"AlertType","in":"formData","schema":{"title":"告警规则类型","description":"告警规则类型：\n\n- APPLICATION\\_MONITORING\\_ALERT_RULE：应用监控告警规则。\n- BROWSER\\_MONITORING\\_ALERT_RULE：前端监控告警规则。\n- PROMETHEUS\\_MONITORING\\_ALERT_RULE：Prometheus监控告警规则。\n- XTRACE_MONITORING_ALERT_RULE：可观测链路OpenTelemetry版监控告警规则。\n- EBPF_MONITORING_ALERT_RULE：EBPF监控告警规则。\n- RUM_MONITORING_ALERT_RULE：用户体验监控告警规则。","type":"string","required":true,"enumValueTitles":{"APPLICATION_MONITORING_ALERT_RULE":"APPLICATION_MONITORING_ALERT_RULE","BROWSER_MONITORING_ALERT_RULE":"前端监控告警规则","XTRACE_MONITORING_ALERT_RULE":"可观测链路OpenTelemetry版监控告警规则","RUM_MONITORING_ALERT_RULE":"用户体验监控告警规则","EBPF_MONITORING_ALERT_RULE":"EBPF_MONITORING_ALERT_RULE","PROMETHEUS_MONITORING_ALERT_RULE":"可观测监控 Prometheus 版告警规则"},"example":"APPLICATION_MONITORING_ALERT_RULE","enum":["PROMETHEUS_MONITORING_ALERT_RULE","APPLICATION_MONITORING_ALERT_RULE","BROWSER_MONITORING_ALERT_RULE","prometheus monitoring alert","application monitoring alert","browser monitoring alert","XTRACE_MONITORING_ALERT_RULE","EBPF_MONITORING_ALERT_RULE","RUM_MONITORING_ALERT_RULE"]}},{"name":"AlertStatus","in":"formData","schema":{"description":"设置告警规则运行状态。\n\n- RUNNING（默认）：启动\n- STOPPED：停止\n","type":"string","required":false,"example":"RUNNING"}},{"name":"NotifyStrategy","in":"formData","schema":{"description":"指定通知策略。\n\n- null：不指定通知策略。当完成创建告警规则后，您可以通过新建通知策略并指定匹配规则和匹配条件（如告警规则名称等）来匹配该告警规则。当该告警规则被触发产生告警事件后，告警信息会被发送给通知策略中指定的联系人或联系人组。\n- 通知策略ID：指定某个通知策略。若选择此项，ARMS会自动在对应的通知策略添加一条匹配规则，匹配规则内容为告警规则ID（以告警规则名称的方式呈现），以确保当前告警规则产生的告警事件一定可以被选择的通知策略匹配到。","type":"string","required":false,"example":"569xxx"}},{"name":"Pids","in":"formData","schema":{"description":"应用监控或前端监控告警规则关联应用的PID。","type":"string","required":false,"example":"[\"b590lhguqs@40d8deedfa9******\"]"}},{"name":"AutoAddNewApplication","in":"formData","schema":{"description":"应用监控或前端监控是否开启新创建应用追加到此告警规则功能。\n\n- `true`：开启\n- `false`：不开启","type":"boolean","required":false,"example":"false"}},{"name":"MetricsType","in":"formData","schema":{"description":"应用监控或前端监控告警规则的告警指标类型。详细信息请参见下方表格。","type":"string","required":false,"example":"jvm"}},{"name":"Filters","in":"formData","schema":{"description":"应用监控或前端监控告警规则的筛选条件。\n格式如下：\n\n```\n\"DimFilters\": [ \n{ \n \"FilterOpt\": \"ALL\",\n \"FilterValues\": [],         //过滤条件Value。\n \"FilterKey\": \"rootIp\"     //过滤条件Key。\n}\n]\n```\n**FilterOpt**取值如下：\n- STATIC： 固定匹配此维度值。\n- ALL：遍历所有维度值。注意：区间检测不支持遍历操作。\n- DISABLE：聚合所有维度值为一个值（求和）。","type":"string","required":false,"example":"{\"DimFilters\": [             {               \"FilterOpt\": \"ALL\",               \"FilterValues\": [],               \"FilterKey\": \"rootIp\"             }           ]         }"}},{"name":"AlertRuleContent","in":"formData","schema":{"description":"应用监控或前端监控的告警规则内容。**AlertRuleContent**模板如下，模板中各字段含义请参见表格下方的补充说明。\n\n```json\n{ \n    \"Condition\": \"OR\",\n     \"AlertRuleItems\": [\n             { \"Operator\": \"CURRENT_LTE\",\n                 \"MetricKey\": \"appstat.jvm.threadcount\",\n                 \"Value\": 1000,\n                 \"Aggregate\": \"AVG\",\n                  \"N\": 10,\n                  \"Tolerability\": 169\n            } \n       ]  \n  }\n```\n\n> 不同的**MetricsType**，**AlertRuleItems.MetricKey**可使用的条件字段不同。应用监控和前端监控支持的指标类型以及各指标对应的告警规则字段，请参见表格下方的补充说明。","type":"string","required":false,"example":"{ \n    \"Condition\": \"OR\",\n     \"AlertRuleItems\": [\n             { \"Operator\": \"CURRENT_LTE\",\n                 \"MetricKey\": \"appstat.jvm.threadcount\",\n                 \"Value\": 1000,\n                 \"Aggregate\": \"AVG\",\n                  \"N\": 10,\n                  \"Tolerability\": 169\n            } \n       ]  \n  }"}},{"name":"AlertCheckType","in":"formData","schema":{"description":"Prometheus监控告警规则的告警检查类型。\n\n- STATIC： 静态阈值类型。 使用静态阈值时，必须指定**MetricsKey**参数，请参考表格下方关于Prometheus监控的**MetricsKey**参数说明填写。\n\n- CUSTOM：自定义PromQL类型。使用自定义PromQL时，必须指定**PromQL**、**Duration**和**Message**参数，用以创建Prometheus告警规则。","type":"string","required":false,"example":"STATIC"}},{"name":"ClusterId","in":"formData","schema":{"description":"Prometheus监控告警规则的集群ID。","type":"string","required":false,"example":"ceba9b9ea5b924dd0b6726d2de6******"}},{"name":"AlertGroup","in":"formData","schema":{"description":"Prometheus告警规则的告警分组ID。\n\n- -1：自定义PromQL\n- 1：Kubernetes负载\n- 15：Kubernetes节点","type":"integer","format":"int64","required":false,"example":"-1"}},{"name":"PromQL","in":"formData","schema":{"description":"Prometheus告警规则的PromQL语句。","type":"string","required":false,"example":"node_memory_MemAvailable_bytes{} / node_memory_MemTotal_bytes{} * 100"}},{"name":"Duration","in":"formData","schema":{"description":"Prometheus告警规则的持续时间，单位为分钟，取值范围[0,1440]。","type":"integer","format":"int64","required":false,"example":"1"}},{"name":"Level","in":"formData","schema":{"description":"Prometheus告警规则的等级。\n\n- P1：一般用于影响核心业务可用性，影响范围很大，可能导致严重后果的重大问题的告警通知。\n- P2：一般用于部分业务出错，会对系统可用性造成一定影响，但是影响范围相对有限的问题的告警通知。\n- P3：一般用于对可能导致业务出错或者受影响的问题的告警通知，或者在相对重要程度较低的业务发送的告警通知。\n- P4： 用于需要通知，但是优先级较低，也不会对业务造成影响的场景发送告警通知。\n- 默认：如果不需要区分告警等级，可以使用默认级别。","type":"string","required":false,"example":"P2"}},{"name":"Message","in":"formData","schema":{"description":"Prometheus告警规则的告警内容。","type":"string","required":false,"example":"命名空间: {{$labels.namespace}} / Pod: {{$labels.pod_name}} / 容器: {{$labels.container}} 内存使用率超过80%, 当前值{{ printf \\\\\\\"%.2f\\\\\\\" $value }}%"}},{"name":"Labels","in":"formData","schema":{"description":"Prometheus告警规则的标签。","type":"string","required":false,"example":"[  { \"Value\": \"cms_polardb\",             \"Name\": \"_aliyun_cloud_product\"           }         ]"}},{"name":"Annotations","in":"formData","schema":{"description":"Prometheus告警规则的注释。","type":"string","required":false,"example":"[ { \"Value\": \"PolarDB 慢查询数量\",             \"Name\": \"_aliyun_display_name\"           }"}},{"name":"MetricsKey","in":"formData","schema":{"description":"告警指标。新建Prometheus告警规则时，如果**AlertCheckType**设置为**STATIC**，**MetricsKey**必填。\n\n> 不同的**AlertGroup**，对应的告警指标不同，**AlertGroup**和**MetricsKey**的对应关系请参见表格下方的补充说明。","type":"string","required":false,"example":"pop.status.error"}},{"name":"Tags","in":"formData","style":"repeatList","schema":{"description":"告警规则标签（阿里云统一标签）。","type":"array","items":{"description":"标签。","type":"object","properties":{"Key":{"description":"标签的键(key)。","type":"string","required":false,"example":"owner"},"Value":{"description":"标签的值(value)。","type":"string","required":false,"example":"John"}},"required":false},"required":false,"maxItems":21}},{"name":"MarkTags","in":"formData","style":"repeatList","schema":{"description":"应用标签。用于应用监控告警规则，筛选告警规则关联的应用。","type":"array","items":{"description":"关联应用标签。","type":"object","properties":{"Key":{"description":"标签键。","type":"string","required":false,"example":"service"},"Value":{"description":"标签值。","type":"string","required":false,"example":"proudct"}},"required":false},"required":false,"maxItems":100}},{"name":"DataConfig","in":"formData","schema":{"description":"数据配置。dataRevision字段指定指标无数据时的数据修复方式。\n\n- 补零    0\n- 补一    1 \n- 补null  2  （默认，不触发告警）","type":"string","required":false,"example":"{\n    \"dataRevision\": 2\n}"}},{"name":"Notice","in":"formData","schema":{"description":"生效时间及通知时间。用于兼容旧版规则。","type":"string","required":false,"example":"-"}},{"name":"AlertPiplines","in":"formData","schema":{"description":"报警发送通道配置。用于兼容旧版规则。","type":"string","required":false,"example":"-"}},{"name":"NotifyMode","in":"formData","schema":{"description":"通知模式。普通模式或极简模式。","type":"string","required":false,"example":"NORMAL_MODE","default":"NORMAL_MODE","enum":["DIRECTED_MODE","NORMAL_MODE"]}},{"name":"Product","in":"formData","schema":{"title":"创建Prometheus告警规则时传入，后台会校验是否存在此产品，用于区分云产品过滤查询","description":"创建Prometheus告警规则时传入，后台会校验是否存在此产品，用于区分云产品过滤查询","type":"string","required":false}},{"name":"AutoAddTargetConfig","in":"formData","schema":{"type":"string","required":false}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"返回数据结构体","type":"object","properties":{"RequestId":{"title":"Id of the request","description":"请求ID。","type":"string","example":"337B8F7E-0A64-5768-9225-E9B3CF******"},"AlertRule":{"description":"告警规则对象。","type":"object","properties":{"AlertId":{"title":"告警规则ID","description":"告警规则ID。","type":"number","format":"float","example":"5510445"},"AlertName":{"title":"告警规则名称","description":"告警规则名称。","type":"string","example":"arms-test"},"UserId":{"title":"用户UID","description":"用户UID。","type":"string","example":"1131971649******"},"RegionId":{"title":"地域","description":"地域ID。","type":"string","example":"cn-hangzhou"},"AlertType":{"title":"告警规则类型","description":"告警规则类型：\n\n- APPLICATION\\_MONITORING\\_ALERT_RULE：应用监控告警规则。\n- BROWSER\\_MONITORING\\_ALERT_RULE：前端监控告警规则。\n- PROMETHEUS\\_MONITORING\\_ALERT_RULE：Prometheus监控告警规则。","type":"string","example":"APPLICATION_MONITORING_ALERT_RULE"},"AlertStatus":{"title":"告警规则状态","description":"告警规则运行状态。\n\n- RUNNING：运行中\n- STOPPED：已停止\n- PAUSED：被暂停\n\n> PAUSED状态说明告警规则状态异常，被系统主动暂停，可能原因有告警规则唯独值过大或者关联集群已经被删除等。","type":"string","example":"RUNNING"},"CreatedTime":{"title":"创建时间","description":"告警规则创建时间的时间戳，单位为秒。","type":"integer","format":"int64","example":"1641438611000"},"UpdatedTime":{"title":"更新时间","description":"告警规则更新时间的时间戳，单位为秒。","type":"integer","format":"int64","example":"1641438611000"},"Extend":{"title":"扩展字段","description":"扩展字段。","type":"string","example":"{\\\"alarmContext\\\":\\\"{\\\\\\\"content\\\\\\\":\\\\\\\"报警名称:$报警名称\\\\\\\\n筛选条件: $筛选\\\\\\\\n报警时间: $报警时间\\\\\\\\n报警内容: $报警内容\\\\\\\\n注意！：该报警未收到恢复邮件之前，正在持续报警中，24小时后会再次提醒您！\\\\\\\",\\\\\\\"subTitle\\\\\\\":\\\\\\\"\\\\\\\"}\\\",\\\"alertWays\\\":\\\"[0,1]\\\",\\\"contactGroupIds\\\":\\\"381,5075\\\",\\\"notice\\\":\\\"{\\\\\\\"endTime\\\\\\\":1480607940000,\\\\\\\"noticeEndTime\\\\\\\":1480607940000,\\\\\\\"noticeStartTime\\\\\\\":1480521600000,\\\\\\\"startTime\\\\\\\":1480521600000}\\\"}"},"NotifyStrategy":{"title":"通知策略ID","description":"通知策略名称。","type":"string","example":"ALERT_MANAGER"},"Pids":{"title":"应用监控/前端监控-告警关联应用ID","description":"应用监控或前端监控告警关联应用的PID。","type":"array","items":{"description":"应用的PID。","type":"string","example":"b590lhguqs@40d8deedfa9******"}},"AutoAddNewApplication":{"title":"应用监控/前端监控-是否开启新创建应用追加到此告警规则","description":"应用监控或前端监控是否开启新创建应用追加到此告警规则功能。\n\n- `true`：开启\n- `false`：不开启","type":"boolean","example":"false"},"MetricsType":{"title":"应用监控/前端监控-告警指标类型","description":"应用监控或前端监控告警规则的告警指标类型。","type":"string","example":"JVM"},"AlertRuleContent":{"title":"应用监控/前端监控-告警规则内容","description":"应用监控或前端监控的告警规则内容。","type":"object","properties":{"Condition":{"title":"应用监控/前端监控-多个告警条件触发逻辑","description":"应用监控或前端监控多个告警条件之间的触发逻辑。\n\n- OR：满足下述任何一个条件。\n- AND：同时满足下述条件。","type":"string","example":"OR"},"AlertRuleItems":{"title":"应用监控/前端监控-告警条件","description":"应用监控或前端监控告警规则的告警条件。","type":"array","items":{"description":"告警条件对象。","type":"object","properties":{"N":{"title":"应用监控/前端监控-最近N分钟","description":"最近N分钟。","type":"number","format":"float","example":"1"},"MetricKey":{"title":"应用监控/前端监控-具体告警条件的指标","description":"具体告警条件的指标。","type":"string","example":"JVM非堆总使用内存量"},"Aggregate":{"title":"应用监控/前端监控-聚合方式","description":"告警条件聚合方式。\n\n- AVG：平均\n- SUM：求和\n- MAX：最大值\n- MIN：最小值\n","type":"string","example":"AVG"},"Operator":{"title":"应用监控/前端监控-判断条件","description":"告警条件的判断条件。\n\n- CURRENT_GTE：大于或等于\n- CURRENT_LTE：小于或等于\n- PREVIOUS_UP：环比上升百分比\n- PREVIOUS_DOWN：环比下降百分比\n- HOH_UP：与上小时同比上升百分比\n- HOH_DOWN：与上小时同比下降百分比\n- DOD_UP：与昨日同比上升百分比\n- DOD_DOWN：与昨日同比下降百分比","type":"string","example":"CURRENT_GTE"},"Value":{"title":"应用监控/前端监控-阈值","description":"告警条件阈值。","type":"string","example":"1"}}}}}},"Filters":{"title":"应用监控/前端监控-告警条件-过滤项","description":"应用监控或前端监控告警规则的过滤项。","type":"object","properties":{"DimFilters":{"description":"应用监控或前端监控告警规则的过滤项信息。","type":"array","items":{"description":"应用监控或前端监控告警规则的过滤条件对象。","type":"object","properties":{"FilterKey":{"description":"过滤条件Key。","type":"string","example":"rootIp"},"FilterOpt":{"description":"过滤条件操作关系。","type":"string","example":"ALL"},"FilterValues":{"description":"过滤条件参数信息。","type":"array","items":{"description":"过滤条件参数。","type":"string","example":"[]"}}}}},"CustomSLSFilters":{"description":"前端监控告警规则的自定义过滤条件。","type":"array","items":{"description":"自定义过滤条件对象。","type":"object","properties":{"Key":{"description":"过滤条件Key。","type":"string","example":"username"},"Opt":{"description":"过滤条件操作关系。\n\n- =：等于\n- not：不等于","type":"string","example":"="},"Value":{"description":"过滤条件参数值。","type":"string","example":"test"},"T":{"description":"仅用于区分前端监控日志类型，其它过滤条件不包含此字段。","type":"string","example":"null"},"Show":{"description":"此筛选条件是否在前端展示。","type":"boolean","example":"false"}}}},"CustomSLSGroupByDimensions":{"description":"聚合维度信息。","type":"array","items":{"description":"聚合维度参数值。","type":"string","example":"[\"page\"]"}},"CustomSLSWheres":{"description":"设置的筛选条件信息。","type":"array","items":{"description":"设置的筛选条件参数值。","type":"string","example":"[\"t like '%api%'\"]"}}}},"AlertCheckType":{"title":"Prometheus告警-告警检查类型","description":"Prometheus监控告警规则的告警检查类型。\n\n- STATIC： 静态阈值类型。\n\n- CUSTOM：自定义PromQL类型。","type":"string","example":"STATIC"},"ClusterId":{"title":"Prometheus告警-集群ID","description":"Prometheus监控告警规则的集群ID。","type":"string","example":"ceba9b9ea5b924dd0b6726d2de6******"},"AlertGroup":{"title":"Prometheus告警-告警分组ID","description":"Prometheus告警规则的告警分组ID。\n\n- -1：自定义PromQL\n- 1：Kubernetes负载\n- 15：Kubernetes节点","type":"integer","format":"int64","example":"-1"},"PromQL":{"title":"Prometheus告警-PromQL语句","description":"Prometheus告警规则的PromQL语句。","type":"string","example":"node_memory_MemAvailable_bytes{} / node_memory_MemTotal_bytes{} * 100"},"Duration":{"title":"Prometheus告警-持续时间","description":"Prometheus告警规则的持续时间，单位为分钟。","type":"string","example":"1"},"Level":{"title":"Prometheus告警-等级","description":"Prometheus告警规则的等级。\n\n- P1：一般用于影响核心业务可用性，影响范围很大，可能导致严重后果的重大问题的告警通知。\n- P2：一般用于部分业务出错，会对系统可用性造成一定影响，但是影响范围相对有限的问题的告警通知。\n- P3：一般用于对可能导致业务出错或者受影响的问题的告警通知，或者在相对重要程度较低的业务发送的告警通知。\n- P4： 用于需要通知，但是优先级较低，也不会对业务造成影响的场景发送告警通知。\n- 默认：如果不需要区分告警等级，可以使用默认级别。","type":"string","example":"P2"},"Message":{"title":"Prometheus告警-告警内容","description":"Prometheus告警规则的告警内容。","type":"string","example":"命名空间: {{$labels.namespace}} / Pod: {{$labels.pod_name}} / 容器: {{$labels.container}} 内存使用率超过80%, 当前值{{ printf \\\\\\\"%.2f\\\\\\\" $value }}%"},"Labels":{"title":"Prometheus告警-Label","description":"Prometheus告警规则的标签。","type":"array","items":{"description":"标签结构体。","type":"object","properties":{"Name":{"title":"键","description":"标签键。","type":"string","example":"123"},"Value":{"title":"值","description":"标签值。","type":"string","example":"abc"}}}},"Annotations":{"title":"Prometheus告警-Annotation","description":"Prometheus告警规则的注释。","type":"array","items":{"description":"注释结构体。","type":"object","properties":{"Name":{"title":"键","description":"注释键。","type":"string","example":"123"},"Value":{"title":"值","description":"注释值。","type":"string","example":"abc"}}}},"Tags":{"description":"告警规则标签（阿里云统一标签）。","type":"array","items":{"description":"标签。","type":"object","properties":{"Key":{"description":"标签键。","type":"string","example":"owner"},"Value":{"description":"标签值。","type":"string","example":"John"}}}},"NotifyMode":{"description":"通知模式。","type":"string","example":"NORMAL_MODE"}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"337B8F7E-0A64-5768-9225-E9B3CF******\\\",\\n  \\\"AlertRule\\\": {\\n    \\\"AlertId\\\": 5510445,\\n    \\\"AlertName\\\": \\\"arms-test\\\",\\n    \\\"UserId\\\": \\\"1131971649******\\\",\\n    \\\"RegionId\\\": \\\"cn-hangzhou\\\",\\n    \\\"AlertType\\\": \\\"APPLICATION_MONITORING_ALERT_RULE\\\",\\n    \\\"AlertStatus\\\": \\\"RUNNING\\\",\\n    \\\"CreatedTime\\\": 1641438611000,\\n    \\\"UpdatedTime\\\": 1641438611000,\\n    \\\"Extend\\\": \\\"{\\\\\\\\\\\\\\\"alarmContext\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"content\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"报警名称:$报警名称\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n筛选条件: $筛选\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n报警时间: $报警时间\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n报警内容: $报警内容\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n注意！：该报警未收到恢复邮件之前，正在持续报警中，24小时后会再次提醒您！\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"subTitle\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"}\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"alertWays\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"[0,1]\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"contactGroupIds\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"381,5075\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"notice\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"endTime\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\":1480607940000,\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"noticeEndTime\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\":1480607940000,\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"noticeStartTime\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\":1480521600000,\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"startTime\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\":1480521600000}\\\\\\\\\\\\\\\"}\\\",\\n    \\\"NotifyStrategy\\\": \\\"ALERT_MANAGER\\\",\\n    \\\"Pids\\\": [\\n      \\\"b590lhguqs@40d8deedfa9******\\\"\\n    ],\\n    \\\"AutoAddNewApplication\\\": false,\\n    \\\"MetricsType\\\": \\\"JVM\\\",\\n    \\\"AlertRuleContent\\\": {\\n      \\\"Condition\\\": \\\"OR\\\",\\n      \\\"AlertRuleItems\\\": [\\n        {\\n          \\\"N\\\": 1,\\n          \\\"MetricKey\\\": \\\"JVM非堆总使用内存量\\\",\\n          \\\"Aggregate\\\": \\\"AVG\\\",\\n          \\\"Operator\\\": \\\"CURRENT_GTE\\\",\\n          \\\"Value\\\": \\\"1\\\"\\n        }\\n      ]\\n    },\\n    \\\"Filters\\\": {\\n      \\\"DimFilters\\\": [\\n        {\\n          \\\"FilterKey\\\": \\\"rootIp\\\",\\n          \\\"FilterOpt\\\": \\\"ALL\\\",\\n          \\\"FilterValues\\\": [\\n            \\\"[]\\\"\\n          ]\\n        }\\n      ],\\n      \\\"CustomSLSFilters\\\": [\\n        {\\n          \\\"Key\\\": \\\"username\\\",\\n          \\\"Opt\\\": \\\"=\\\",\\n          \\\"Value\\\": \\\"test\\\",\\n          \\\"T\\\": \\\"null\\\",\\n          \\\"Show\\\": false\\n        }\\n      ],\\n      \\\"CustomSLSGroupByDimensions\\\": [\\n        \\\"[\\\\\\\"page\\\\\\\"]\\\"\\n      ],\\n      \\\"CustomSLSWheres\\\": [\\n        \\\"[\\\\\\\"t like '%api%'\\\\\\\"]\\\"\\n      ]\\n    },\\n    \\\"AlertCheckType\\\": \\\"STATIC\\\",\\n    \\\"ClusterId\\\": \\\"ceba9b9ea5b924dd0b6726d2de6******\\\",\\n    \\\"AlertGroup\\\": -1,\\n    \\\"PromQL\\\": \\\"node_memory_MemAvailable_bytes{} / node_memory_MemTotal_bytes{} * 100\\\",\\n    \\\"Duration\\\": \\\"1\\\",\\n    \\\"Level\\\": \\\"P2\\\",\\n    \\\"Message\\\": \\\"命名空间: {{$labels.namespace}} / Pod: {{$labels.pod_name}} / 容器: {{$labels.container}} 内存使用率超过80%, 当前值{{ printf \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"%.2f\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\" $value }}%\\\",\\n    \\\"Labels\\\": [\\n      {\\n        \\\"Name\\\": \\\"123\\\",\\n        \\\"Value\\\": \\\"abc\\\"\\n      }\\n    ],\\n    \\\"Annotations\\\": [\\n      {\\n        \\\"Name\\\": \\\"123\\\",\\n        \\\"Value\\\": \\\"abc\\\"\\n      }\\n    ],\\n    \\\"Tags\\\": [\\n      {\\n        \\\"Key\\\": \\\"owner\\\",\\n        \\\"Value\\\": \\\"John\\\"\\n      }\\n    ],\\n    \\\"NotifyMode\\\": \\\"NORMAL_MODE\\\"\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateOrUpdateAlertRuleResponse>\\n    <RequestId>337B8F7E-0A64-5768-9225-E9B3CF******</RequestId>\\n    <AlertRule>\\n        <AlertId>5510445</AlertId>\\n        <AlertName>arms-test</AlertName>\\n        <UserId>1131971649******</UserId>\\n        <RegionId>cn-hangzhou</RegionId>\\n        <AlertType>APPLICATION_MONITORING_ALERT_RULE</AlertType>\\n        <AlertStatus>RUNNING</AlertStatus>\\n        <CreatedTime>1641438611000</CreatedTime>\\n        <UpdatedTime>1641438611000</UpdatedTime>\\n        <Extend>{\\\\\\\"alarmContext\\\\\\\":\\\\\\\"{\\\\\\\\\\\\\\\"content\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"报警名称:$报警名称\\\\\\\\\\\\\\\\n筛选条件: $筛选\\\\\\\\\\\\\\\\n报警时间: $报警时间\\\\\\\\\\\\\\\\n报警内容: $报警内容\\\\\\\\\\\\\\\\n注意！：该报警未收到恢复邮件之前，正在持续报警中，24小时后会再次提醒您！\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"subTitle\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}\\\\\\\",\\\\\\\"alertWays\\\\\\\":\\\\\\\"[0,1]\\\\\\\",\\\\\\\"contactGroupIds\\\\\\\":\\\\\\\"381,5075\\\\\\\",\\\\\\\"notice\\\\\\\":\\\\\\\"{\\\\\\\\\\\\\\\"endTime\\\\\\\\\\\\\\\":1480607940000,\\\\\\\\\\\\\\\"noticeEndTime\\\\\\\\\\\\\\\":1480607940000,\\\\\\\\\\\\\\\"noticeStartTime\\\\\\\\\\\\\\\":1480521600000,\\\\\\\\\\\\\\\"startTime\\\\\\\\\\\\\\\":1480521600000}\\\\\\\"}</Extend>\\n        <NotifyStrategy>ALERT_MANAGER</NotifyStrategy>\\n        <Pids>b590lhguqs@40d8deedfa9******</Pids>\\n        <AutoAddNewApplication>false</AutoAddNewApplication>\\n        <MetricsType>JVM</MetricsType>\\n        <AlertRuleContent>\\n            <Condition>\\\"|\\\"</Condition>\\n            <AlertRuleItems>\\n                <N>1</N>\\n                <MetricKey>JVM非堆总使用内存量</MetricKey>\\n                <Aggregate>AVG</Aggregate>\\n                <Operator>CURRENT_GTE</Operator>\\n                <Value>1</Value>\\n            </AlertRuleItems>\\n        </AlertRuleContent>\\n        <Filters>\\n            <DimFilters>\\n                <FilterKey>rootIp</FilterKey>\\n                <FilterOpt>ALL</FilterOpt>\\n                <FilterValues>[]</FilterValues>\\n            </DimFilters>\\n            <CustomSLSFilters>\\n                <Key>username</Key>\\n                <Opt>=</Opt>\\n                <Value>test</Value>\\n                <T>null</T>\\n                <Show>false</Show>\\n            </CustomSLSFilters>\\n            <CustomSLSGroupByDimensions>[\\\"page\\\"]</CustomSLSGroupByDimensions>\\n            <CustomSLSWheres>[\\\"t like '%api%'\\\"]</CustomSLSWheres>\\n        </Filters>\\n        <AlertCheckType>STATIC</AlertCheckType>\\n        <ClusterId>ceba9b9ea5b924dd0b6726d2de6******</ClusterId>\\n        <AlertGroup>-1</AlertGroup>\\n        <PromQL>node_memory_MemAvailable_bytes{} / node_memory_MemTotal_bytes{} * 100</PromQL>\\n        <Duration>1</Duration>\\n        <Level>P2</Level>\\n        <Message>命名空间: {{$labels.namespace}} / Pod: {{$labels.pod_name}} / 容器: {{$labels.container}} 内存使用率超过80%, 当前值{{ printf \\\\\\\\\\\\\\\"%.2f\\\\\\\\\\\\\\\" $value }}%</Message>\\n        <Labels>\\n            <Name>123</Name>\\n            <Value>abc</Value>\\n        </Labels>\\n        <Annotations>\\n            <Name>123</Name>\\n            <Value>abc</Value>\\n        </Annotations>\\n    </AlertRule>\\n</CreateOrUpdateAlertRuleResponse>\",\"errorExample\":\"\"}]","title":"创建或修改告警规则","requestParamsDescription":"### **AlertRuleContent**模版字段说明\n```\n{ \n    \"Condition\": \"OR\",\n     \"AlertRuleItems\": [\n             { \"Operator\": \"CURRENT_LTE\",\n                 \"MetricKey\": \"appstat.jvm.threadcount\",\n                 \"Value\": 1000,\n                 \"Aggregate\": \"AVG\",\n                  \"N\": 10,\n                  \"Tolerability\": 169\n            } \n       ]  \n  }\n```\n\n- Condition：多个告警条件之间的触发逻辑。\n\t- OR：满足下述任何一个条件。\n\t- AND：同时满足下述条件。\n- Operator：告警条件的判断条件。\n\t- CURRENT_GTE：大于或等于\n\t- CURRENT_LTE：小于或等于\n\t- PREVIOUS_UP：环比上升百分比\n\t- PREVIOUS_DOWN：环比下降百分比\n\t- HOH_UP：与上小时同比上升百分比\n\t- HOH_DOWN：与上小时同比下降百分比\n\t- DOD_UP：与昨日同比上升百分比\n\t- DOD_DOWN：与昨日同比下降百分比\n \t- INTERVAL_EXCEED：区间检测。注意：区间检测不支持多条件触发。\n- MetricKey：具体告警条件的指标。不同的**MetricsType**，对应的指标不同。对应关系请参见下方说明。\n- Value：告警条件阈值。\n- Aggregate：告警条件聚合方式。\n\t- AVG：平均\n\t- SUM：求和\n\t- MAX：最大值\n\t- MIN：最小值\n\t- CONTINUOUS：持续\n\t- AVG_WEIGHTED：错误率加权平均值\n- N：最近N分钟。\n- Tolerability：表示区间容忍度，取值在1~200之间。\n\n### 应用监控**MetricsType**和**AlertRuleContent.AlertRuleItems.MetricKey**对应关系\n\n| MetricsType | 指标类型 | AlertRuleContent.AlertRuleItems.MetricKey |\n|---|---|---|\n| jvm | JVM监控 |- appstat.jvm.gc.oldgccountinstant：JVM FullGC次数（瞬时值）<br />- appstat.jvm.gc.oldgctimeinstant：JVM FullGC耗时（瞬时值）<br />- appstat.jvm.gc.younggccountinstant：JVM YoungGC次数（瞬时值）<br />- appstat.jvm.gc.younggctimeinstant：JVM YoungGC耗时（瞬时值）<br />- appstat.jvm.heap_total：JVM堆内总内存量<br />- appstat.jvm.heap_used：JVM堆内使用内存量<br />- appstat.jvm.non_heap_committed：JVM非堆内存提交值<br />- appstat.jvm.non_heap_init：JVM非堆内存初始值<br />- appstat.jvm.non_heap_max：JVM非堆内存最大值<br />- appstat.jvm.non_heap_used：JVM非堆总使用内存量<br />- appstat.jvm.threadblockedcount：JVM阻塞线程数<br />- appstat.jvm.threadcount：JVM线程总数<br />- appstat.jvm.threaddeadlockcount：JVM死锁线程数<br />- appstat.jvm.threadnewcount：JVM新建线程数<br />- appstat.jvm.threadrunnablecount：JVM可运行线程数<br />- appstat.jvm.threadterminatedcount：JVM终结线程数<br />- appstat.jvm.threadtimedwaitcount：JVM超时等待线程数<br />- appstat.jvm.threadwaitcount：JVM等待线程数<br /> |\n| saehost | SAE主机监控 |- appstat.infra.sae.systemcpu：CPU使用率<br />- appstat.infra.sae.systemdiskiopsread：磁盘IOPS读<br />- appstat.infra.sae.systemdiskiopswrite：磁盘IOPS写<br />- appstat.infra.sae.systemdiskrate：磁盘使用率<br />- appstat.infra.sae.systemdiskread：磁盘IO吞吐率读<br />- appstat.infra.sae.systemdisktotal：磁盘总量<br />- appstat.infra.sae.systemdiskused：磁盘使用量<br />- appstat.infra.sae.systemdiskwrite：磁盘IO吞吐率写<br />- appstat.infra.sae.systemload：系统负载<br />- appstat.infra.sae.systemmemrate：内存使用率<br />- appstat.infra.sae.systemmemtotal：总内存<br />- appstat.infra.sae.systemmemused：已用内存<br />- appstat.infra.sae.systemnetrecv：网络接收字节<br />- appstat.infra.sae.systemnetrecvdrop：网络接收数据丢包<br />- appstat.infra.sae.systemnetrecverror：网络接收错误数据包<br />- appstat.infra.sae.systemnetrecvpacket：网络接收数据包<br />- appstat.infra.sae.systemnettran：网络发送字节<br />- appstat.infra.sae.systemnettrandrop：网络发送数据丢包<br />- appstat.infra.sae.systemnettranerror：网络发送错误数据包<br />- appstat.infra.sae.systemnettranpacket：网络发送数据包|\n| txn_db | SQL指标 |- appstat.sql.count：数据库调用次数<br />- appstat.sql.error：数据库调用错误次数<br />- appstat.sql.rt：数据库调用响应时间|\n| db | 数据库指标 |- appstat.database.count：数据库调用次数<br />- appstat.database.errcount：数据库调用错误次数<br />- appstat.database.rt：数据库调用响应时间|\n| threadpool | 线程池监控 |- appstat.threadpool.threadcorepoolsize：核心线程数<br />- appstat.threadpool.threadmaxpoolsize：最大线程数<br />- appstat.threadpool.threadpoolactivecount：活跃线程数<br />- appstat.threadpool.threadpoolqueuesize：队列大小<br />- appstat.threadpool.threadpoolsize：当前线程数<br />- appstat.threadpool.threadpooltaskcount：已执行任务数<br />- appstat.threadpool.threadpoolusedpercent：线程池使用率|\n| exception | 异常接口调用 |- appstat.exception.count：应用异常接口调用次数<br />- appstat.exception.rt：应用异常接口调用响应时间|\n| txn_type | 应用依赖服务统计 |- appstat.outcall.count：应用依赖服务调用次数<br />- appstat.outcall.errorrate：应用依赖服务调用错误率<br />- appstat.outcall.rt：应用依赖服务调用响应时间|\n| txn | 应用提供服务统计 |- appstat.transaction.count：调用次数<br />- appstat.transaction.error：调用错误次数<br />- appstat.transaction.errorrate：调用错误率<br />- appstat.transaction.rt：调用响应时间|\n| host | 主机监控 |- appstat.jvm.systemcpuusage：节点机CPU使用率<br />- appstat.jvm.systemcpuuser：节点机CPU用户态占用率<br />- appstat.jvm.systemdiskfree：节点机空闲磁盘<br />- appstat.jvm.systemdiskusage：节点机磁盘利用率<br />- appstat.jvm.systemload：节点机系统负载<br />- appstat.jvm.systemmemfree：节点机空闲内存<br />- appstat.jvm.systemmemusage：节点机内存利用率<br />- appstat.jvm.systemnetinerrs：节点机接受错误报文数<br />- appstat.jvm.systemnetouterrs：节点机发送错误报文数|\n| scheduler | 定时任务 |- appstat.scheduler.rt：运行时间<br />- appstat.scheduler.count：运行次数<br />- appstat.scheduler.error：运行异常次数<br />- appstat.scheduler.delay：调度延迟时间<br />|\n\n### 前端监控**MetricsType**和**AlertRuleContent.AlertRuleItems.MetricKey**对应关系\n\n| MetricsType | 指标类型 | AlertRuleContent.AlertRuleItems.MetricKey |\n|---|---|---|\n| api | API指标 |- webstat.api.detail.count：API请求次数<br />- webstat.api.detail.fail_time：API失败耗时<br />- webstat.api.detail.fail_uv：报错API的影响用户数<br />- webstat.api.detail.success_rate：API成功率<br />- webstat.api.detail.success_time：API成功耗时|\n| page.api | 页面API指标 |- webstat.api.detail.page_api.count：API请求次数<br />- webstat.api.detail.page_api.fail_time：API失败耗时<br />- webstat.api.detail.page_api.success_rate：API成功率<br />- webstat.api.detail.page_api.success_time：API成功耗时|\n| page | 页面指标 |- webstat.api.detail.page_api.fail_uv：报错API的影响用户数<br />- webstat.index.pv：页面访问量<br />- webstat.jserror.count：JS错误数<br />- webstat.jserror.rate：JS错误率<br />- webstat.msg.top.error_uv：JS错误影响用户数<br />- webstat.resource.sum：资源错误数<br />- webstat.satisfy.satisfy：页面满意度<br />- webstat.speed.avg_cfpt：页面自定义首屏时间<br />- webstat.speed.avg_ctti：页面自定义可交互时间<br />- webstat.speed.avg_dns：页面DNS查询时间<br />- webstat.speed.avg_dom：页面dom解析时间<br />- webstat.speed.avg_fmp：页面首屏时间<br />- webstat.speed.avg_fpt：页面首次渲染耗时<br />- webstat.speed.avg_load：页面完全加载时间<br />- webstat.speed.avg_ready：ready时间<br />- webstat.speed.avg_res：页面资源加载时间<br />- webstat.speed.avg_ssl：页面SSL建连时间<br />- webstat.speed.avg_t1：页面自定义t1时间<br />- webstat.speed.avg_t10：页面自定义t10时间<br />- webstat.speed.avg_t2：页面自定义t2时间<br />- webstat.speed.avg_t3：页面自定义t3时间<br />- webstat.speed.avg_t4：页面自定义t4时间<br />- webstat.speed.avg_t5：页面自定义t5时间<br />- webstat.speed.avg_t6：页面自定义t6时间<br />- webstat.speed.avg_t7：页面自定义t7时间<br />- webstat.speed.avg_t8：页面自定义t8时间<br />- webstat.speed.avg_t9：页面自定义t9时间<br />- webstat.speed.avg_tcp：页面tcp连接时间<br />- webstat.speed.avg_trans：页面内容传输时间<br />- webstat.speed.avg_ttfb：页面网络请求响应时间<br />- webstat.speed.avg_tti：页面首次可交互时间|\n| custom | 自定义指标 |- webstat.avg.avg_val：自定义上报均值<br />- webstat.sum.sum_val：自定义上报求和|\n\n### Prometheus监控**AlertGroup**和**MetricsKey**对应关系\n\n| AlertGroup | 告警分组 | MetricsKey |\n|---|---|---|\n| 1 | Kubernetes负载 |- prom.workload.container_cpu_usage：容器CPU使用率<br />- prom.workload.job_execute_error：Job执行失败<br />- prom.workload.pod_cpu_usage：Pod磁盘使用率<br />- prom.workload.pod_start_timeout：Pod启动超时失败<br />- prom.workload.pod_restart_frequent：Pod频繁重启<br />- prom.workload.pod_status_error：Pod状态异常<br />- prom.workload.container_memory_usage：容器内存使用率<br />- prom.workload.deployment_pod_survival：Deployment Pod可用率|\n| 15 | Kubernetes节点 |- prom.node.node_memory_usage：节点内存使用率<br />- prom.node.node_cpu_usage：节点CPU使用率<br />- prom.node.node_disk_usage：节点磁盘使用率<br />- prom.node.node_status_error：节点状态异常|"}