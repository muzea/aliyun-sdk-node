{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"none"},"parameters":[{"name":"Pid","in":"query","schema":{"description":"应用ID。\n\n在ARMS控制台的**应用监控**>**应用列表**页面单击目标应用名称。此时浏览器地址栏中的URL即包含应用的pid，格式为pid=xxx。由于浏览器进行了编码，因此需要对pid稍作修改。例如，如果URL中包含的pid为xxx%4074xxx，则需要将%40替换为@，即：xxx@74xxx。","type":"string","required":true,"docRequired":true,"example":"a2n80plglh@745eddxxx"}},{"name":"Settings","in":"query","style":"repeatList","schema":{"description":"自定义设置列表。","type":"array","items":{"description":"自定义设置列表。","type":"object","properties":{"Key":{"description":"自定义设置，各设置的详细字段见下文说明。\n\n- 调用链路采样相关\n- 总开关设置\n- 阈值设置\n- 高级设置\n- 线程设置\n- 内存快照设置\n- URL收敛设置\n- 业务日志关联设置","type":"string","required":false,"example":"sampling.enable"},"Value":{"description":"自定义设置，各设置的详细字段见下文说明。\n\n- 调用链路采样相关\n- 总开关设置\n- 阈值设置\n- 高级设置\n- 线程设置\n- 内存快照设置\n- URL收敛设置\n- 业务日志关联设置","type":"string","required":false,"example":"true"}},"required":false},"required":false,"maxItems":256}}],"responses":{"200":{"schema":{"type":"object","properties":{"Data":{"description":"操作是否成功。","type":"string","example":"success"},"RequestId":{"description":"请求ID。","type":"string","example":"78901766-3806-4E96-8E47-CFEF59E4****"},"Message":{"description":"返回信息。","type":"string","example":"message"},"Code":{"description":"接口状态码：2XX：成功                                 3XX：重定向                                 4XX：请求错误                                 5XX：服务器错误","type":"integer","format":"int64","example":"200"},"Success":{"description":"查询是否成功：\n\n- true：成功。\n- false：失败。","type":"boolean","example":"true"}}}}},"errorCodes":{"400":[{"errorCode":"ParameterMissing","errorMessage":"You must specify the parameter."},{"errorCode":"ParameterTraceAppSettingKeyIllegal","errorMessage":"The application configuration key is invalid."},{"errorCode":"ParameterTraceAppSettingValueIllegal","errorMessage":"The application configuration value is invalid."},{"errorCode":"InternalError","errorMessage":"InterPlease try again. Contact the DingTalk service account if the issue persists after multiple retries."}],"404":[{"errorCode":"AppNotExist","errorMessage":"The application does not exist."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Data\\\": \\\"success\\\",\\n  \\\"RequestId\\\": \\\"78901766-3806-4E96-8E47-CFEF59E4****\\\",\\n  \\\"Message\\\": \\\"message\\\",\\n  \\\"Code\\\": 200,\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<SaveTraceAppConfigResponse>\\n    <RequestId>78901766-3806-4E96-8E47-CFEF59E4****</RequestId>\\n    <Data>success</Data>\\n</SaveTraceAppConfigResponse>\",\"errorExample\":\"\"}]","title":"应用监控自定义设置","summary":"进行应用监控的自定义设置（如调用链采样设置、Agent开关等）。","requestParamsDescription":"**调用链路采样字段说明** \n| Key | 字段说明 | Value |\n|---|---|---|\n| sampling.enable | 采样开关 | 取值：<br />- `true`：开启采样开关。<br />- `false`：关闭采样开关。 |\n| sampling.rate | 采样率 | 0~100之间，默认为10。 |\n\n**总开关字段说明**\n| Key | 字段说明 | Value |\n|---|---|---|\n| enable | Agent总开关 | 取值：<br />- `true`：开启Agent总开关。<br />- `false`：关闭Agent总开关。 |\n\n**阈值字段说明**\n| Key | 字段说明 | Value |\n|---|---|---|\n| thresholds.limit | 限流阈值 | 默认为100。 |\n| thresholds.interface | 接口响应时间阈值 | 默认为500，单位为ms。 |\n| thresholds.sql | 慢SQL查询阈值 | 默认为500，单位为ms。 |\n\n**高级字段说明**\n| Key | 字段说明 | Value |\n|---|---|---|\n| defined.excludeurl | 无效接口调用过滤 | 支持以英文逗号（,）分隔多个接口调用。<br />默认值为：/\\*\\*/\\*.jpg,/\\*\\*/\\*.png,/\\*\\*/\\*.js,/\\*\\*/\\*.jpeg。 <br />示例：/service/taobao,/service/status。 |\n| callstack.maxLength | 方法堆栈最大长度 | 默认为128，支持最大长度400条。 |\n| exception.stacktrace | 同类异常堆栈区分深度 | 默认为2，基于此堆栈深度识别同类型的异常。修改此配置会造成非预期的统计行为，**请谨慎操作**。 |\n| callsql.maxLength | 采集SQL最大长度 | 默认为1024个字符，最小长度为256个字符，最大长度为4096个字符。 |\n| jdbc.tracesqlbindvalue | 采集SQL绑定值 | 取值：<br />- `true`：开启捕获PrepareStatement参数绑定变量值开关。<br />- `false`：关闭捕获PrepareStatement参数绑定变量值开关。  |\n| jdbc.tracesqlraw | 原始SQL | 取值：<br />- `true`：开启捕获原始SQL语句开关。<br />- `false`：关闭捕获原始SQL语句开关。  |\n| exception.whitelist | 异常过滤 | 使用正则表达式匹配异常类全名，多个异常请使用英文逗号（,）分隔。例如：java.lang.InterrupetedException,java.lang.IndexOutOfBoundsException。此处输入的异常不会显示在应用详情和异常分析页面的图表中。 |\n| error.skip | 错误数过滤 | 默认情况下，大于400的状态码会计入错误数，您可以设置需要忽略的状态码，多个错误码使用英文逗号（,）分隔，例如：429或429,512。Agent 2.5.7.2以上版本支持。 |\n| compress.enable | 调用链压缩 | 取值：<br />- `true`：开启调用链开关。<br />- `false`：关闭调用链压缩开关。 |\n| param.maxLength | 请求入参最大长度 | 默认为512。高于默认值会消耗额外的系统资源，**请谨慎操作**。 |\n| quantile.enable | 分位数统计 | 取值：<br />- `true`：开启分位数统计开关。<br />- `false`：关闭分位数统计开关。 |\n| threadpoolmonitor.enable | 线程池、连接池监控 | **需要应用重启生效**。<br />取值：<br />- `true`：开启线程池、连接池监控开关。<br />- `false`：关闭线程池、连接池监控开关。 |\n| async.autoTransmit | 自动透传异步 | **仅在探针版本大于等于2.8.3时生效**。<br />**需要应用重启生效**。该功能会对提交到线程池中的Runnable、Callable任务进行封装以传递上下文。存在一定风险，**请谨慎操作**。<br />取值：<br />- `true`：开启自动透传异步开关。<br />- `false`：关闭自动透传异步开关。 |\n| thread.match.package | 异步透传扫描包名 | **仅在探针版本大于等于2.7.1.3时生效**。<br />**需要应用重启生效**。当对应包名下的Runnable/Callable/Supplier在创建时，会自动捕获Trace上下文并传递到新线程。多个包名可采用英文逗号（,）分隔。 |\n| responseInject.enable | 请求中返回TraceId的开关 | 取值：<br />- `true`：开启返回TraceId的开关。<br />- `false`：关闭返回TraceId的开关。 |\n\n**线程字段说明**\n| Key | 字段说明 | Value |\n|---|---|---|\n| tprof.enableThreadProfiler | 线程分析总控开关 | 取值：<br />- `true`：开启线程分析总控开关。<br />- `false`：关闭线程分析总控开关。<br />开启后自动保存慢调用本地方法栈。 |\n| tprof.threadProfilerSlowInteractionRt | 慢调用监听触发阈值 | 默认为2000。耗时高于该阈值才启动线程分析，建议设为耗时的99分位线。低于2000ms会增加CPU消耗，不可小于500ms。 |\n| tprof.enableThreadStackRecorder | 线程分析方法栈 | 取值：<br />- `true`：开启线程分析方法栈。<br />- `false`：关闭线程分析方法栈。<br />开启后每隔5分钟采集一次方法栈。 |\n\n**应用日志关联字段说明**\n| Key | 字段说明 | Value |\n|---|---|---|\n| logging.enable | 关联业务日志与TraceId开关 | 取值：<br />- `true`：开启关联业务日志与TraceId开关。<br />- `false`：关闭关联业务日志与TraceId开关。<br />开启后业务日志中会自动生成调用链的TraceId，此设置在重启应用后生效。支持Log4j/Log4j2/Logback日志组件。业务应用需要在日志的Layout中通过声明%X{EagleEye-TraceID}来输出TraceId信息。|\n| SLS.project | 当前区域业务日志的project | 当前区域业务日志的project。 |\n| SLS.logStore | 当前区域业务日志的logstore | 当前区域业务日志的logstore。 |\n| SLS.index | 当前区域业务日志的关联索引 | 取值：<br />- 当指定全文索引时，不传。<br />- 指定字段索引时，取值为相应的字段名。例如：**SLS.index: tag**。<br />字段索引及全文索引的区别，请参见[配置索引](~~90732~~)。|\n\n**URL收敛字段说明**\n| Key | 字段说明 | Value |\n|---|---|---|\n| convergence.enable | 收敛URL | 取值：<br />- `true`：开启收敛URL。<br />- `false`：关闭收敛URL。 |\n| convergence.minServerSize | 收敛阈值 | 大于此阈值即进行收敛。 |\n| convergence.pattern | 收敛规则正则 | 可使用正则表达式设置收敛规则，多个正则表达式之间以英文逗号（,）分隔，直接填写URL原文表示不收敛此URL，例如：/service/(.\\*?)/demo。 |\n\n**Arthas诊断字段说明**\n\n****注：Arthas诊断相关配置仅在探针版本大于等于2.7.1.3时生效，其他前提条件请参见[Arthas诊断](~~300078~~)。****\n| Key | 字段说明 | Value |\n|---|---|---|\n| arthas.enable | Arthas开关 | 取值： <br />- `true`：开启Arthas开关。<br />- `false`：关闭Arthas开关。|\n| arthas.enableIps | 生效实时IP | 配置启用Arthas诊断的IP，如果填写，Arthas诊断仅对特定IP有效，不填写则默认对所有IP生效。多个IP请使用英文逗号（,）分割。|\n\n**持续剖析字段说明**\n\n****注：持续剖析相关配置仅在探针版本大于等于2.7.3.5时生效，其他前提条件请参见[持续剖析](~~473143~~)。****\n| Key | 字段说明 | Value |\n|---|---|---|\n| cp.enable | 持续剖析开关 | 取值： <br />- `true`：开启持续剖析开关。<br />- `false`：关闭持续剖析开关。 <br /> *该开关开启后，需要配置生效IP，否则该开关不会生效。配置模式包括以下两种。|\n\n<table>\n<tr><th bgcolor=#F5F5F5>模式</th><th bgcolor=#F5F5F5>Key</th><th bgcolor=#F5F5F5>字段说明</th><th bgcolor=#F5F5F5>Value</th></tr>\n<tr><td rowspan=2>IP白名单</td><td>cp.allowIPs</td><td>IP白名单</td><td>指定开启持续剖析的实例IP，多个IP请使用英文逗号（,）分割。<br />示例：192.168.0.1,192.168.0.2</td></tr>\n<tr><td>cp.allowNetwork</td><td>网段地址</td><td>请传递空字符串，否则将无法正常使用。</td></tr>\n<tr><td rowspan=2>网段地址</td><td>cp.allowIPs</td><td>IP白名单</td><td>请传递空字符串，否则将无法正常使用。</td></tr>\n<tr><td>cp.allowNetwork</td><td>网段地址</td><td>命中此网段地址范围的IP实例打开该功能。<br />示例：192.168.2.0/24</td></tr>\n</table>\n\n**信息脱敏字段说明**\n****注：信息脱敏相关配置仅在探针版本大于等于2.9.0时生效。****\n| Key | 字段说明 | Value |\n|---|---|---|\n| sanitizer.enable | 信息脱敏开关 | 取值： <br />- `true`：开启信息脱敏开关。<br />- `false`：关闭信息脱敏开关。|\n| sanitizer.keys | 脱敏规则 | 默认支持如示例规则，对key进行直接匹配，以password为例 ，规则等同于正则式 .\\*password.\\*，不分区大小写。多个规则之间以英文逗号分隔。<br />示例：password,secret,key,token,credentials|","responseParamsDescription":" ","extraInfo":" "}