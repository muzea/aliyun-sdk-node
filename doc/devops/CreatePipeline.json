{"summary":"创建流水线API，支持创建YAML化流水线。","path":"/organization/{organizationId}/pipelines","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{},"parameters":[{"name":"organizationId","in":"path","schema":{"description":"企业标识，也称企业id，字符串形式，可在云效访问链接中获取，如https://devops.aliyun.com/organization/【OrganizationId】","type":"string","required":true,"example":"5ebbc0228123212b59xxxxx"}},{"name":"name","in":"formData","schema":{"description":"流水线名称","type":"string","required":true,"example":"示例流水线"}},{"name":"content","in":"formData","schema":{"description":"流水线YAML描述，可参考文档https://help.aliyun.com/document_detail/2249317.html 编写","type":"string","required":true,"example":"sources:                                                  # sources 配置流水线源节点\n  my_repo:                                                # 流水线源唯一标识 id\n    type: codeup                                          # 流水线源类型\n    name: 代码源名称                                       # 代码源的展示名称            \n    endpoint: <your-codeup-repository-url>                # 代码源的 url\n    branch: master                                        # 代码源的默认分支\n    triggerEvents: push                                    # 代码源监听事件\n    certificate:                                          # certificate 认证信息\n      type: serviceConnection                              # 认证类型为服务连接\n      serviceConnection: <your-service-connection-id>      # 服务连接 id\nstages:                                       # stages 配置流水线阶段\n  build_stage:                                # 流水线阶段标识 id\n    name: 构建阶段                             # 流水线阶段的展示名称\n    jobs:                                     # jobs 配置流水线任务\n      build_job:                              # 流水线任务标识 id\n        name: 构建任务                         # 流水线任务的展示名称\n        runsOn: public/cn-beijing             # 流水线任务运行的集群环境\n        steps:                                # steps 配置流水线步骤\n          build_step:                         # 流水线步骤标识 id\n            step: JavaBuild                   # 选择执行步骤\n            name: java构建                     # 流水线执行步骤的展示名称\n            with:                             # 步骤的参数\n              run: |\n                mvn -B clean package -Dmaven.test.skip=true -Dautoconfig.skip\n          upload_step:\n            step: ArtifactUpload\n            name: 构建物上传\n            with:\n              uploadType: flowPublic\n              artifact: default\n              filePath:\n                - target/\n                - deploy.sh\n  deploy_stage:\n    name: 部署阶段\n    jobs:\n      deploy_job:\n        name: 主机组部署任务\n        component: VMDeploy                # 选择执行组件\n        with:                              # 执行组件的参数\n          artifact: $[stages.build_stage.build_job.upload_step.artifacts.default]\n          machineGroup: <your-machine-group-id>\n          artifactDownloadPath: /home/admin/app/package.tgz\n          executeUser: root\n          run: |\n            mkdir -p /home/admin/application/\n            tar zxvf /home/admin/app/package.tgz -C /home/admin/application/\n            sh /home/admin/application/deploy.sh restart"}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"Schema of Response","type":"object","properties":{"success":{"description":"true 接口调用成功，false 接口调用失败","type":"boolean","example":"true"},"errorCode":{"title":"错误码","description":"错误码","type":"string","example":"\"\""},"errorMessage":{"title":"错误信息","description":"错误信息","type":"string","example":"\"\""},"pipelinId":{"title":"流水线id","description":"流水线id","type":"integer","format":"int64","example":"11XXX"},"requestId":{"title":"请求id，每次请求都是唯一值，便于后续排查问题","description":"请求id，每次请求都是唯一值，便于后续排查问题","type":"string","example":"ASSDS-ASSASX-XSAXSA-XSAXSAXS\n"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParam.ParamNotPresent","errorMessage":"The parameter is invalid."},{"errorCode":"InvalidUser.NotFound","errorMessage":"The user that is invoking the API service is not a registered user."}],"403":[{"errorCode":"Forbidden.AccessDenied","errorMessage":"The user is not authorized to perform the operation."},{"errorCode":"Forbidden.UserNotAdminOrOwner","errorMessage":"The current user is not an admin or owner in the organization and is not authorized to perform the operation."},{"errorCode":"Forbidden.UserNotInCurrentOrganization","errorMessage":"The user is not in the organization and is not authorized to perform the operation."}],"404":[{"errorCode":"InvalidOrganization.NotFound","errorMessage":"The organization is not found."},{"errorCode":"InvalidPipeline.NotFound","errorMessage":"The pipeline is not found."},{"errorCode":"InvalidPipelineRun.NotFound","errorMessage":"The pipeline execution instance is not found."}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"success\\\": true,\\n  \\\"errorCode\\\": \\\"\\\\\\\"\\\\\\\"\\\",\\n  \\\"errorMessage\\\": \\\"\\\\\\\"\\\\\\\"\\\",\\n  \\\"pipelinId\\\": 0,\\n  \\\"requestId\\\": \\\"ASSDS-ASSASX-XSAXSA-XSAXSAXS\\\\n\\\"\\n}\",\"type\":\"json\"}]","title":"创建流水线"}