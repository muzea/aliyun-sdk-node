{"summary":"更改保护分支设置。 支持对于保护分支规则的详细设置，包括分支、推送规则、合并规则、要求合并前通过代码评审以及要求合并前通过自动化状态检查。","path":"/{repositoryId}/protect_branches/{id}","methods":["put"],"schemes":["http","https"],"security":[{"AK":[]}],"consumes":["application/json"],"produces":["application/json"],"operationType":"readAndWrite","deprecated":false,"systemTags":{},"parameters":[{"name":"organizationId","in":"query","schema":{"description":"企业标识，也称企业ID，字符串形式，可在云效访问链接中获取，如https://devops.aliyun.com/organization/【OrganizationId】","type":"string","required":false,"example":"f0b1e61db5961df5975a93f9129d2513"}},{"name":"accessToken","in":"query","schema":{"title":"accessToken（选填），使用AK方式调用时无需填accessToken","description":"个人访问令牌。 \n使用阿里云AK+SK或使用STS临时授权方式不需要传该字段\n\n","type":"string","required":false,"example":"f0b1e61db5961df5975a93f9129d2513"}},{"name":"repositoryId","in":"path","schema":{"description":"代码库ID","type":"integer","format":"int64","required":true,"example":"2835387"}},{"name":"id","in":"path","schema":{"description":"保护分支规则ID","type":"integer","format":"int64","required":true,"example":"19224"}},{"name":"body","in":"body","style":"json","schema":{"description":"请求Body","type":"object","properties":{"id":{"description":"保护分支规则ID","type":"integer","format":"int64","required":false,"example":"19224"},"branch":{"description":"代码分支名称（若不修改保护分支，则维持原来的分支名；若需要修改保护分支，则给予修改的分支名称）","type":"string","required":true,"example":"master"},"allowPushRoles":{"description":"允许推送的角色列表","type":"array","items":{"description":"40：管理员  \n30：开发者","type":"integer","format":"int32","required":false,"example":"[40, 30]"},"required":false},"allowPushUserIds":{"description":"允许推送的用户ID列表","type":"array","items":{"description":"阿里云账号ID","type":"string","required":false,"example":"[19258, 19262]"},"required":false},"allowMergeRoles":{"description":"允许合并的角色列表","type":"array","items":{"description":"40：管理员  \n30：开发者","type":"integer","format":"int32","required":false,"example":"[40, 30]"},"required":false},"allowMergeUserIds":{"description":"允许合并的用户ID列表","type":"array","items":{"description":"阿里云账号ID","type":"string","required":false,"example":"[19258, 19262]"},"required":false},"mergeRequestSetting":{"description":"合并前的代码评审设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","required":false,"example":"true"},"mrMode":{"description":"评审模式  \ngeneral - 普通   \ncodeowner - CodeOwner模式","type":"string","required":false,"example":"general"},"isAllowSelfApproval":{"description":"是否允许创建者通过代码评审\n可选值：true / false","type":"boolean","required":false,"example":"true"},"isRequireDiscussionProcessed":{"description":"是否要求评论全部已解决\n可选值：true / false","type":"boolean","required":false,"example":"true"},"isResetApprovalWhenNewPush":{"description":"是否在有新的提交时重置评审\n可选值：true / false","type":"boolean","required":false,"example":"false"},"minimumApproval":{"description":"评审通过的最少人数\n注：仅普通模式生效","type":"integer","format":"int32","required":false,"example":"1"},"allowMergeRequestRoles":{"description":"允许通过合并请求的角色列表","type":"array","items":{"description":"40：管理员（默认）  \n30：开发者","type":"integer","format":"int32","required":false,"example":"[40, 30]"},"required":false},"defaultAssignees":{"description":"默认评审者的ID列表","type":"array","items":{"description":"用户ID","type":"string","required":false,"example":"1234"},"required":false},"whiteList":{"description":"评审文件白名单\n注意：加入白名单的文件不受「评审通过的最少人数」限制，无需强制人工评审","type":"string","required":false,"example":"**.java"}},"required":false},"testSettingDTO":{"description":"合并前的自动化状态检查设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","required":false,"example":"false"},"codeGuidelinesDetection":{"description":"代码规约扫描","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","required":false,"example":"false"},"message":{"description":"描述信息","type":"string","required":false,"example":"test_code_guide_lines"}},"required":false},"sensitiveInfoDetection":{"description":"敏感信息扫描","type":"object","properties":{"enabled":{"description":"是否开启敏感信息扫描","type":"boolean","required":false,"example":"false"},"message":{"description":"描述信息","type":"string","required":false,"example":"test_code_sensitive_info"}},"required":false},"checkTaskQualityConfig":{"description":"代码质量检测","type":"object","properties":{"enabled":{"description":"是否开启代码质量检测","type":"boolean","required":false,"example":"false"},"bizNo":{"description":"任务流水号","type":"string","required":false,"example":"123456"},"taskName":{"description":"任务名称","type":"string","required":false,"example":"bz-task-quality"},"message":{"description":"信息","type":"string","required":false,"example":"test_task_quality"}},"required":false},"checkConfig":{"description":"MR卡点流水线配置","type":"object","properties":{"checkItems":{"description":"配置项列表","type":"array","items":{"description":"配置项","type":"object","properties":{"name":{"description":"流水线名称","type":"string","required":false,"example":"测试流水线"},"isRequired":{"description":"是否卡点","type":"boolean","required":false,"example":"false"}},"required":false},"required":false}},"required":false}},"required":false}},"required":true}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"Schema of Response","type":"object","properties":{"requestId":{"title":"Id of the request","description":"请求ID","type":"string","example":"A35869D5-BB29-5F84-A4DD-B09985EA2AFA"},"errorMessage":{"description":"错误信息","type":"string","example":"\"\""},"errorCode":{"description":"错误码","type":"string","example":"\t\nSYSTEM_UNKNOWN_ERROR\n"},"success":{"description":"调用是否成功","type":"boolean","example":"true"},"result":{"description":"返回详情结果\n\n","type":"object","properties":{"id":{"description":"保护分支规则ID","type":"integer","format":"int64","example":"123456"},"branch":{"description":"代码分支名称","type":"string","example":"master"},"allowPushRoles":{"description":"允许推送的角色列表","type":"array","items":{"description":"40：管理者  \n30：开发者","type":"integer","format":"int32","example":"[40, 30]"}},"allowPushUserIds":{"description":"允许推送的用户ID","type":"array","items":{"description":"用户ID","type":"integer","format":"int64","example":"[19258, 19262]"}},"allowMergeRoles":{"description":"允许合并的角色列表","type":"array","items":{"description":"40：管理者  \n30：开发者","type":"integer","format":"int32","example":"[40, 30]"}},"allowMergeUserIds":{"description":"允许合并的用户ID列表","type":"array","items":{"description":"用户ID","type":"integer","format":"int64","example":"[19258, 19262]"}},"mergeRequestSetting":{"description":"合并前的代码评审设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","example":"true"},"mrMode":{"description":"评审模式  \ngeneral：普通  \ncodeowner：CodeOwner模式","type":"string","example":"general"},"isAllowSelfApproval":{"description":"是否允许创建者通过代码评审","type":"boolean","example":"true"},"isRequireDiscussionProcessed":{"description":"是否要求评审全部已解决","type":"boolean","example":"true"},"isResetApprovalWhenNewPush":{"description":"是否在有新的提交时重置评审","type":"boolean","example":"false"},"minimumApproval":{"description":"评审通过的最少人数\n注：仅普通模式生效","type":"integer","format":"int32","example":"1"},"allowMergeRequestRoles":{"description":"允许通过合并请求的角色列表","type":"array","items":{"description":"40：管理员（默认）  \n30：开发者","type":"integer","format":"int32","example":"[40, 30]"}},"defaultAssignees":{"description":"默认评审者的ID列表","type":"array","items":{"description":"用户ID","type":"string","example":"1234"}},"whiteList":{"description":"评审文件白名单\n注意：加入白名单的文件不受「评审通过的最少人数」限制，无需强制人工评审","type":"string","example":"**.java"}}},"testSettingDTO":{"description":"合并前的自动化状态检查设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","example":"false"},"codeGuidelinesDetection":{"description":"代码规约扫描","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","example":"false"},"message":{"description":"描述信息","type":"string","example":"test_code_guide_lines"}}},"sensitiveInfoDetection":{"description":"敏感信息扫描","type":"object","properties":{"enabled":{"description":"同上","type":"boolean","example":"false"},"message":{"description":"同上","type":"string","example":"test_code_sensitive_info"}}},"checkTaskQualityConfig":{"description":"代码质量检测","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","example":"false"},"bizNo":{"description":"任务流水号","type":"string","example":"123456"},"taskName":{"description":"任务名称。","type":"string","example":"biz-task-quality"},"message":{"description":"信息","type":"string","example":"test_task_quality"}}},"checkConfig":{"description":"MR卡点流水线配置","type":"object","properties":{"checkItems":{"description":"配置项列表","type":"array","items":{"description":"配置项","type":"object","properties":{"name":{"description":"流水线名称","type":"string","example":"测试流水线"},"isRequired":{"description":"是否卡点","type":"boolean","example":"false"}}}}}}}}}}}}}},"errorCodes":{"403":[{"errorCode":"Forbidden.AccessDenied","errorMessage":"The user is not authorized to perform the operation."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"requestId\\\": \\\"A35869D5-BB29-5F84-A4DD-B09985EA2AFA\\\",\\n  \\\"errorMessage\\\": \\\"\\\\\\\"\\\\\\\"\\\",\\n  \\\"errorCode\\\": \\\"\\\\t\\\\nSYSTEM_UNKNOWN_ERROR\\\\n\\\",\\n  \\\"success\\\": true,\\n  \\\"result\\\": {\\n    \\\"id\\\": 123456,\\n    \\\"branch\\\": \\\"master\\\",\\n    \\\"allowPushRoles\\\": [\\n      0\\n    ],\\n    \\\"allowPushUserIds\\\": [\\n      0\\n    ],\\n    \\\"allowMergeRoles\\\": [\\n      0\\n    ],\\n    \\\"allowMergeUserIds\\\": [\\n      0\\n    ],\\n    \\\"mergeRequestSetting\\\": {\\n      \\\"isRequired\\\": true,\\n      \\\"mrMode\\\": \\\"general\\\",\\n      \\\"isAllowSelfApproval\\\": true,\\n      \\\"isRequireDiscussionProcessed\\\": true,\\n      \\\"isResetApprovalWhenNewPush\\\": false,\\n      \\\"minimumApproval\\\": 1,\\n      \\\"allowMergeRequestRoles\\\": [\\n        0\\n      ],\\n      \\\"defaultAssignees\\\": [\\n        \\\"1234\\\"\\n      ],\\n      \\\"whiteList\\\": \\\"**.java\\\"\\n    },\\n    \\\"testSettingDTO\\\": {\\n      \\\"isRequired\\\": false,\\n      \\\"codeGuidelinesDetection\\\": {\\n        \\\"enabled\\\": false,\\n        \\\"message\\\": \\\"test_code_guide_lines\\\"\\n      },\\n      \\\"sensitiveInfoDetection\\\": {\\n        \\\"enabled\\\": false,\\n        \\\"message\\\": \\\"test_code_sensitive_info\\\"\\n      },\\n      \\\"checkTaskQualityConfig\\\": {\\n        \\\"enabled\\\": false,\\n        \\\"bizNo\\\": \\\"123456\\\",\\n        \\\"taskName\\\": \\\"biz-task-quality\\\",\\n        \\\"message\\\": \\\"test_task_quality\\\"\\n      },\\n      \\\"checkConfig\\\": {\\n        \\\"checkItems\\\": [\\n          {\\n            \\\"name\\\": \\\"测试流水线\\\",\\n            \\\"isRequired\\\": false\\n          }\\n        ]\\n      }\\n    }\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<UpdateProtectedBranchesResponse>\\n    <requestId>A35869D5-BB29-5F84-A4DD-B09985EA2AFA</requestId>\\n    <errorMessage>\\\"\\\"</errorMessage>\\n    <errorCode>success</errorCode>\\n    <success>false</success>\\n    <result>\\n        <id>123456</id>\\n        <branch>master</branch>\\n        <allowPushRoles>40</allowPushRoles>\\n        <allowPushRoles>30</allowPushRoles>\\n        <allowPushUserIds>123456</allowPushUserIds>\\n        <allowMergeRoles>40</allowMergeRoles>\\n        <allowMergeRoles>30</allowMergeRoles>\\n        <allowMergeUserIds>123456</allowMergeUserIds>\\n        <mergeRequestSetting>\\n            <isRequired>true</isRequired>\\n            <mrMode>general</mrMode>\\n            <isAllowSelfApproval>true</isAllowSelfApproval>\\n            <isRequireDiscussionProcessed>true</isRequireDiscussionProcessed>\\n            <isResetApprovalWhenNewPush>false</isResetApprovalWhenNewPush>\\n            <minimumApproval>1</minimumApproval>\\n            <allowMergeRequestRoles>40</allowMergeRequestRoles>\\n            <allowMergeRequestRoles>30</allowMergeRequestRoles>\\n            <defaultAssignees>1234</defaultAssignees>\\n        </mergeRequestSetting>\\n        <testSettingDTO>\\n            <isRequired>false</isRequired>\\n            <codeGuidelinesDetection>\\n                <enabled>false</enabled>\\n                <message>test_code_guide_lines</message>\\n            </codeGuidelinesDetection>\\n            <sensitiveInfoDetection>\\n                <enabled>false</enabled>\\n                <message>test_code_sensitive_info</message>\\n            </sensitiveInfoDetection>\\n            <checkTaskQualityConfig>\\n                <enabled>false</enabled>\\n                <bizNo>123456</bizNo>\\n                <taskName>biz-task-quality</taskName>\\n                <message>test_task_quality</message>\\n            </checkTaskQualityConfig>\\n            <checkConfig>\\n                <checkItems>\\n                    <name>api测试-create</name>\\n                    <isRequired>false</isRequired>\\n                </checkItems>\\n            </checkConfig>\\n        </testSettingDTO>\\n    </result>\\n</UpdateProtectedBranchesResponse>\",\"errorExample\":\"\"}]","title":"更改保护分支设置","description":"organizationId 和 body中的 branch 参数为必填项。","requestParamsDescription":"如果只是修改个别字段，请查询后，直接修改查询结果，以查询结果作为参数进行更改。"}