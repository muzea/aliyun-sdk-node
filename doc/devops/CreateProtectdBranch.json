{"summary":"创建代码库保护分支。","path":"/repository/{repositoryId}/protect_branches","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"consumes":["application/json"],"produces":["application/json"],"operationType":"write","deprecated":false,"systemTags":{},"parameters":[{"name":"organizationId","in":"query","schema":{"title":"A short description of struct","description":"企业标识，也称企业id，字符串形式，可在云效访问链接中获取，如https://devops.aliyun.com/organization/【OrganizationId】","type":"string","required":true,"example":"60de7a6852743a5162b5f957"}},{"name":"accessToken","in":"query","schema":{"description":"个人访问令牌。 \n使用阿里云AK+SK或使用STS临时授权方式不需要传该字段\n\n","type":"string","required":false,"example":"f0b1e61db5961df5975a93f9129d2513"}},{"name":"repositoryId","in":"path","schema":{"description":"代码库ID","type":"integer","format":"int64","required":true,"example":"2813891"}},{"name":"body","in":"body","style":"json","schema":{"description":"请求Body","type":"object","properties":{"id":{"description":"保护分支规则ID","type":"integer","format":"int64","required":false,"example":"--"},"branch":{"description":"保护分支名称","type":"string","required":true,"example":"protectBranch"},"allowPushRoles":{"description":"允许推送角色列表","type":"array","items":{"description":"40：管理员  \n30：开发者","type":"integer","format":"int32","required":false,"example":"[40, 30]"},"required":false},"allowPushUserIds":{"description":"允许推送用户ID","type":"array","items":{"description":"阿里云账号ID","type":"string","required":false,"example":"2344667212345561"},"required":false},"allowMergeRoles":{"description":"允许合并角色列表","type":"array","items":{"description":"40：管理员  \n30：开发者","type":"integer","format":"int32","required":true,"example":"[40, 30]"},"required":true},"allowMergeUserIds":{"description":"允许合并用户ID","type":"array","items":{"description":"阿里云账号ID","type":"string","required":false,"example":"123345678912345"},"required":false},"mergeRequestSetting":{"description":"合并前的代码评审设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","required":false,"example":"true"},"mrMode":{"description":"评审模式\n- general：普通\n- codeowner：CodeOwner模式","type":"string","required":false,"example":"general"},"isAllowSelfApproval":{"description":"是否允许创建者通过代码评审","type":"boolean","required":false,"example":"true"},"isRequireDiscussionProcessed":{"description":"是否要求评论全部已解决","type":"boolean","required":false,"example":"true"},"isResetApprovalWhenNewPush":{"description":"是否在有新的提交时重置评审","type":"boolean","required":false,"example":"false"},"minimumApproval":{"description":"评审通过的最少人数\n> 仅普通模式生效","type":"integer","format":"int32","required":false,"example":"1"},"allowMergeRequestRoles":{"description":"允许合并角色列表","type":"array","items":{"description":"40：管理员（默认）  \n30：开发者","type":"integer","format":"int32","required":false,"example":"[40, 30]"},"required":false},"defaultAssignees":{"description":"默认评审人","type":"array","items":{"description":"阿里云账号ID","type":"string","required":false,"example":"1234567891234567"},"required":false},"whiteList":{"description":"评审文件白名单\n><notice>加入白名单的文件不受「评审通过的最少人数」限制，无需强制人工评审></notice>","type":"string","required":false,"example":"**.java"}},"required":false},"testSettingDTO":{"description":"合并前的自动化状态检查设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","required":false,"example":"false"},"codeGuidelinesDetection":{"description":"代码规约扫描","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","required":false,"example":"false"},"message":{"description":"描述信息","type":"string","required":false,"example":"test_code_guide_lines"}},"required":false},"sensitiveInfoDetection":{"description":"敏感信息扫描","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","required":false,"example":"false"},"message":{"description":"描述信息","type":"string","required":false,"example":"test_code_sensitive_info"}},"required":false},"checkTaskQualityConfig":{"description":"代码质量检测","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","required":false,"example":"false"},"bizNo":{"description":"任务流水号","type":"string","required":false,"example":"123456"},"taskName":{"description":"任务名称","type":"string","required":false,"example":"bz-task-quality"},"message":{"description":"信息","type":"string","required":false,"example":"test_task_quality"}},"required":false},"checkConfig":{"description":"MR卡点流水线配置","type":"object","properties":{"checkItems":{"description":"配置项","type":"array","items":{"description":"配置项","type":"object","properties":{"name":{"description":"流水线名称","type":"string","required":false,"example":"测试流水线"},"isRequired":{"description":"是否卡点","type":"boolean","required":false,"example":"false"}},"required":false},"required":false}},"required":false}},"required":false}},"required":true}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"Schema of Response","type":"object","properties":{"requestId":{"title":"Id of the request","description":"请求ID","type":"string","example":"C2F153F6-BB43-50C4-9F4F-40593203E19A"},"errorMessage":{"description":"错误信息","type":"string","example":"\"\""},"errorCode":{"description":"错误码","type":"string","example":"Openapi.RequestError"},"success":{"description":"调用是否成功","type":"boolean","example":"true"},"result":{"description":"返回结果","type":"object","properties":{"id":{"description":"保护分支规则ID","type":"integer","format":"int64","example":"5240"},"branch":{"description":"保护分支名称","type":"string","example":"protectBranch"},"allowPushRoles":{"description":"允许推送角色列表","type":"array","items":{"description":"40：管理者  \n30：开发者","type":"integer","format":"int32","example":"40"}},"allowPushUserIds":{"description":"允许推送用户ID列表","type":"array","items":{"description":"Codeup的用户ID","type":"integer","format":"int64","example":"19238"}},"allowMergeRoles":{"description":"允许合并角色列表","type":"array","items":{"description":"40：管理者  \n30：开发者","type":"integer","format":"int32","example":"40"}},"allowMergeUserIds":{"description":"允许合并用户ID","type":"array","items":{"description":"Codeup的用户ID","type":"integer","format":"int64","example":"19238"}},"mergeRequestSetting":{"description":"合并前的代码评审设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","example":"true"},"mrMode":{"description":"评审模式\n\n- general：普通\n- codeowner：CodeOwner模式","type":"string","example":"general"},"isAllowSelfApproval":{"description":"是否允许创建者通过代码评审","type":"boolean","example":"true"},"isRequireDiscussionProcessed":{"description":"是否要求评审全部已解决","type":"boolean","example":"true"},"isResetApprovalWhenNewPush":{"description":"是否在有新的提交时重置评审","type":"boolean","example":"false"},"minimumApproval":{"description":"评审通过的最少人数\n注：仅普通模式生效","type":"integer","format":"int32","example":"1"},"allowMergeRequestRoles":{"description":"允许合并请求角色列表","type":"array","items":{"description":"40：管理员（默认）  \n30：开发者","type":"integer","format":"int32","example":"40"}},"defaultAssignees":{"description":"默认评审人ID","type":"array","items":{"description":"云效用户ID","type":"string","example":"5f969843cd2214ba0e24327d"}},"whiteList":{"description":"评审文件白名单\n注意：加入白名单的文件不受「评审通过的最少人数」限制，无需强制人工评审","type":"string","example":"**.java"}}},"testSettingDTO":{"description":"合并前的自动化状态检查设置","type":"object","properties":{"isRequired":{"description":"是否开启","type":"boolean","example":"false"},"codeGuidelinesDetection":{"description":"代码规约扫描","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","example":"false"},"message":{"description":"描述信息","type":"string","example":"test_code_guide_lines"}}},"sensitiveInfoDetection":{"description":"敏感信息扫描","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","example":"false"},"message":{"description":"描述信息","type":"string","example":"test_code_sensitive_info"}}},"checkTaskQualityConfig":{"description":"代码质量检测","type":"object","properties":{"enabled":{"description":"是否开启","type":"boolean","example":"false"},"bizNo":{"description":"任务流水号","type":"string","example":"123456"},"taskName":{"description":"任务名称","type":"string","example":"biz-task-quality"},"message":{"description":"描述信息","type":"string","example":"test_task_quality"}}},"checkConfig":{"description":"MR卡点流水线配置","type":"object","properties":{"checkItems":{"description":"配置项列表","type":"array","items":{"description":"配置项","type":"object","properties":{"name":{"description":"流水线名称","type":"string","example":"测试流水线"},"isRequired":{"description":"是否卡点","type":"boolean","example":"false"}}}}}}}}}}}}}},"errorCodes":{"403":[{"errorCode":"Forbidden.AccessDenied","errorMessage":"The user is not authorized to perform the operation."},{"errorCode":"Forbidden.UserNotInCurrentOrganization","errorMessage":"The user is not in the organization and is not authorized to perform the operation."}]},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"requestId\\\": \\\"C2F153F6-BB43-50C4-9F4F-40593203E19A\\\",\\n  \\\"errorMessage\\\": \\\"\\\\\\\"\\\\\\\"\\\",\\n  \\\"errorCode\\\": \\\"Openapi.RequestError\\\",\\n  \\\"success\\\": true,\\n  \\\"result\\\": {\\n    \\\"id\\\": 5240,\\n    \\\"branch\\\": \\\"protectBranch\\\",\\n    \\\"allowPushRoles\\\": [\\n      40\\n    ],\\n    \\\"allowPushUserIds\\\": [\\n      19238\\n    ],\\n    \\\"allowMergeRoles\\\": [\\n      40\\n    ],\\n    \\\"allowMergeUserIds\\\": [\\n      19238\\n    ],\\n    \\\"mergeRequestSetting\\\": {\\n      \\\"isRequired\\\": true,\\n      \\\"mrMode\\\": \\\"general\\\",\\n      \\\"isAllowSelfApproval\\\": true,\\n      \\\"isRequireDiscussionProcessed\\\": true,\\n      \\\"isResetApprovalWhenNewPush\\\": false,\\n      \\\"minimumApproval\\\": 1,\\n      \\\"allowMergeRequestRoles\\\": [\\n        40\\n      ],\\n      \\\"defaultAssignees\\\": [\\n        \\\"5f969843cd2214ba0e24327d\\\"\\n      ],\\n      \\\"whiteList\\\": \\\"**.java\\\"\\n    },\\n    \\\"testSettingDTO\\\": {\\n      \\\"isRequired\\\": false,\\n      \\\"codeGuidelinesDetection\\\": {\\n        \\\"enabled\\\": false,\\n        \\\"message\\\": \\\"test_code_guide_lines\\\"\\n      },\\n      \\\"sensitiveInfoDetection\\\": {\\n        \\\"enabled\\\": false,\\n        \\\"message\\\": \\\"test_code_sensitive_info\\\"\\n      },\\n      \\\"checkTaskQualityConfig\\\": {\\n        \\\"enabled\\\": false,\\n        \\\"bizNo\\\": \\\"123456\\\",\\n        \\\"taskName\\\": \\\"biz-task-quality\\\",\\n        \\\"message\\\": \\\"test_task_quality\\\"\\n      },\\n      \\\"checkConfig\\\": {\\n        \\\"checkItems\\\": [\\n          {\\n            \\\"name\\\": \\\"测试流水线\\\",\\n            \\\"isRequired\\\": false\\n          }\\n        ]\\n      }\\n    }\\n  }\\n}\",\"type\":\"json\"}]","title":"创建保护分支"}