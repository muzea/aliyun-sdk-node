{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"DBClusterId","in":"query","schema":{"description":"集群ID。\n> 您可以调用[DescribeDBClusters](~~129857~~)接口查看目标地域下所有AnalyticDB MySQL集群的详情，包括集群ID。","type":"string","required":true,"docRequired":true,"example":"am-****************"}},{"name":"ProcessId","in":"query","schema":{"description":"任务ID。\n> 您可以调用[DescribeProcessList](~~612277~~)接口查看目标SQL的任务ID。","type":"string","required":true,"docRequired":true,"example":"202105271604431720161662490345*******"}}],"responses":{"200":{"schema":{"description":"详情。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"22D6DEF0-CBC7-4388-A41C-D5FD62******"},"StageList":{"description":"计划阶段的信息列表。","type":"array","items":{"description":"详情。","type":"object","properties":{"State":{"description":"该计划阶段的最终执行状态，取值范围如下：\n* FINISHED：完成。\n* CANCELED：取消。\n* ABORTED：中止。\n* FAILED：失败。","type":"string","example":"FINISHED"},"CPUTimeAvg":{"description":"该阶段的`CPU Time`在各个计算节点的平均值，单位为毫秒（ms）。","type":"integer","format":"int64","example":"5984"},"CPUTimeMax":{"description":"该阶段的`CPU Time`在各个计算节点的最大值，单位为毫秒（ms）。","type":"integer","format":"int64","example":"5984"},"OperatorCost":{"description":"该阶段内部总的算子耗时，等同于该阶段的CPU Time，可用于判断查询哪些部分消耗了较多的计算资源。单位为毫秒（ms）。","type":"integer","format":"int64","example":"5984"},"ScanTimeMax":{"description":"带数据扫描算子的阶段在各个存储节点读取数据耗时的最大值，单位为毫秒（ms）。","type":"integer","format":"int64","example":"0"},"InputSizeMax":{"description":"阶段在各个计算节点的输入数据量的最大值，单位为Byte。","type":"integer","format":"int64","example":"173"},"StageId":{"description":"阶段ID。","type":"integer","format":"int32","example":"1"},"ScanSizeMax":{"description":"带数据扫描算子的阶段在各个存储节点的扫描数据量的最大值，单位为Byte。","type":"integer","format":"int64","example":"0"},"CPUTimeMin":{"description":"该阶段的`CPU Time`在各个计算节点的最小值，单位为毫秒（ms）。","type":"integer","format":"int64","example":"47"},"ScanTimeMin":{"description":"带数据扫描算子的阶段在各个存储节点读取数据耗时的最小值，单位为毫秒（ms）。","type":"integer","format":"int64","example":"0"},"ScanSizeMin":{"description":"带数据扫描算子的阶段在各个存储节点的扫描数据量的最小值，单位为Byte。","type":"integer","format":"int64","example":"0"},"InputSizeMin":{"description":"阶段在各个计算节点的输入数据量的最小值，单位为Byte。","type":"integer","format":"int64","example":"173"},"PeakMemory":{"description":"执行目标SQL时的峰值内存，单位为Byte。","type":"integer","format":"int64","example":"74208"},"ScanTimeAvg":{"description":"带数据扫描算子的阶段在各个存储节点读取数据耗时的平均值，单位为毫秒（ms）。","type":"integer","format":"int64","example":"0"},"ScanSizeAvg":{"description":"带数据扫描算子的阶段在各个存储节点的扫描数据量的平均值，单位为Byte。","type":"integer","format":"int64","example":"0"},"InputSizeAvg":{"description":"阶段在各个计算节点的输入数据量的平均值，单位为Byte。","type":"integer","format":"int64","example":"173"}}}},"OriginInfo":{"description":"SQL Plan的详细原始数据。","type":"string","example":"{\\\"queryId\\\":\\\"20210527_160443_10581_hdhzr\\\",\\\"session\\\":{\\\"queryId\\\":\\\"20210527_160443_10581_hdhzr\\\",\\\"hasSharedStage\\\":false,\\\"parentId\\\":0}}"},"Detail":{"description":"目标SQL的详细执行信息。","type":"object","properties":{"SQL":{"description":"SQL语句。","type":"string","example":"INSERT OVERWRITE INTO hdfs_import_external\\nSELECT *\\nFROM adb_hdfs_import_source"},"OutputSize":{"description":"目标SQL语句的总输出数据量，单位为Byte。","type":"integer","format":"int64","example":"9"},"State":{"description":"目标SQL语句的最终执行状态，取值范围如下：\n* FINISHED：完成。\n* FAILED ：失败。","type":"string","example":"FINISHED"},"OutputRows":{"description":"目标SQL的总输出行数。","type":"integer","format":"int64","example":"1"},"User":{"description":"提交目标SQL语句的用户名。","type":"string","example":"test_acc"},"StartTime":{"description":"目标SQL语句的执行开始时间，格式为Unix时间戳，单位为毫秒。","type":"string","example":"1622102683243"},"TotalStage":{"description":"目标SQL中包含的总阶段个数。","type":"integer","format":"int64","example":"4"},"QueuedTime":{"description":"执行目标SQL的排队时间，单位为毫秒（ms）。","type":"integer","format":"int64","example":"0"},"TotalTime":{"description":"目标SQL的执行总耗时，单位为毫秒（ms）。","type":"integer","format":"int64","example":"2340"},"TotalTask":{"description":"目标SQL中包含的总任务个数。","type":"integer","format":"int64","example":"4"},"Database":{"description":"执行目标SQL的数据库名称。","type":"string","example":"adb_demo"},"PeakMemory":{"description":"执行目标SQL时的峰值内存，单位为Byte。","type":"integer","format":"int64","example":"441802"},"ClientIP":{"description":"提交目标SQL语句的客户端IP地址。","type":"string","example":"172.16.***.***"},"PlanningTime":{"description":"执行目标SQL时生成执行计划的时间，单位为毫秒（ms）。","type":"integer","format":"int64","example":"86"},"CPUTime":{"description":"执行目标SQL时，算子处理数据单元的总耗时，是多服务器多线程上的累计值。单位为毫秒（ms）。","type":"integer","format":"int64","example":"6100"}}}}}}},"errorCodes":{"404":[{"errorCode":"InvalidDBCluster.NotFound","errorMessage":"The DBClusterId provided does not exist in our records."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"22D6DEF0-CBC7-4388-A41C-D5FD62******\\\",\\n  \\\"StageList\\\": [\\n    {\\n      \\\"State\\\": \\\"FINISHED\\\",\\n      \\\"CPUTimeAvg\\\": 5984,\\n      \\\"CPUTimeMax\\\": 5984,\\n      \\\"OperatorCost\\\": 5984,\\n      \\\"ScanTimeMax\\\": 0,\\n      \\\"InputSizeMax\\\": 173,\\n      \\\"StageId\\\": 1,\\n      \\\"ScanSizeMax\\\": 0,\\n      \\\"CPUTimeMin\\\": 47,\\n      \\\"ScanTimeMin\\\": 0,\\n      \\\"ScanSizeMin\\\": 0,\\n      \\\"InputSizeMin\\\": 173,\\n      \\\"PeakMemory\\\": 74208,\\n      \\\"ScanTimeAvg\\\": 0,\\n      \\\"ScanSizeAvg\\\": 0,\\n      \\\"InputSizeAvg\\\": 173\\n    }\\n  ],\\n  \\\"OriginInfo\\\": \\\"{\\\\\\\\\\\\\\\"queryId\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"20210527_160443_10581_hdhzr\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"session\\\\\\\\\\\\\\\":{\\\\\\\\\\\\\\\"queryId\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"20210527_160443_10581_hdhzr\\\\\\\\\\\\\\\",\\\\\\\\\\\\\\\"hasSharedStage\\\\\\\\\\\\\\\":false,\\\\\\\\\\\\\\\"parentId\\\\\\\\\\\\\\\":0}}\\\",\\n  \\\"Detail\\\": {\\n    \\\"SQL\\\": \\\"INSERT OVERWRITE INTO hdfs_import_external\\\\\\\\nSELECT *\\\\\\\\nFROM adb_hdfs_import_source\\\",\\n    \\\"OutputSize\\\": 9,\\n    \\\"State\\\": \\\"FINISHED\\\",\\n    \\\"OutputRows\\\": 1,\\n    \\\"User\\\": \\\"test_acc\\\",\\n    \\\"StartTime\\\": \\\"1622102683243\\\",\\n    \\\"TotalStage\\\": 4,\\n    \\\"QueuedTime\\\": 0,\\n    \\\"TotalTime\\\": 2340,\\n    \\\"TotalTask\\\": 4,\\n    \\\"Database\\\": \\\"adb_demo\\\",\\n    \\\"PeakMemory\\\": 441802,\\n    \\\"ClientIP\\\": \\\"172.16.***.***\\\",\\n    \\\"PlanningTime\\\": 86,\\n    \\\"CPUTime\\\": 6100\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeSQLPlanResponse>\\n    <RequestId>22D6DEF0-CBC7-4388-A41C-D5FD62******</RequestId>\\n    <StageList>\\n        <ScanSizeMin>0</ScanSizeMin>\\n        <ScanSizeAvg>0</ScanSizeAvg>\\n        <StageId>0</StageId>\\n        <PeakMemory>264960</PeakMemory>\\n        <CPUTimeMax>47</CPUTimeMax>\\n        <ScanTimeMin>0</ScanTimeMin>\\n        <ScanTimeAvg>0</ScanTimeAvg>\\n        <InputSizeMax>1023</InputSizeMax>\\n        <InputSizeMin>1023</InputSizeMin>\\n        <InputSizeAvg>1023</InputSizeAvg>\\n        <ScanSizeMax>0</ScanSizeMax>\\n        <State>FINISHED</State>\\n        <OperatorCost>47</OperatorCost>\\n        <ScanTimeMax>0</ScanTimeMax>\\n        <CPUTimeMin>47</CPUTimeMin>\\n        <CPUTimeAvg>47</CPUTimeAvg>\\n    </StageList>\\n    <StageList>\\n        <ScanSizeMin>0</ScanSizeMin>\\n        <ScanSizeAvg>0</ScanSizeAvg>\\n        <StageId>1</StageId>\\n        <PeakMemory>74208</PeakMemory>\\n        <CPUTimeMax>5984</CPUTimeMax>\\n        <ScanTimeMin>0</ScanTimeMin>\\n        <ScanTimeAvg>0</ScanTimeAvg>\\n        <InputSizeMax>173</InputSizeMax>\\n        <InputSizeMin>173</InputSizeMin>\\n        <InputSizeAvg>173</InputSizeAvg>\\n        <ScanSizeMax>0</ScanSizeMax>\\n        <State>FINISHED</State>\\n        <OperatorCost>5984</OperatorCost>\\n        <ScanTimeMax>0</ScanTimeMax>\\n        <CPUTimeMin>5984</CPUTimeMin>\\n        <CPUTimeAvg>5984</CPUTimeAvg>\\n    </StageList>\\n    <StageList>\\n        <ScanSizeMin>0</ScanSizeMin>\\n        <ScanSizeAvg>0</ScanSizeAvg>\\n        <StageId>2</StageId>\\n        <PeakMemory>102634</PeakMemory>\\n        <CPUTimeMax>18</CPUTimeMax>\\n        <ScanTimeMin>0</ScanTimeMin>\\n        <ScanTimeAvg>0</ScanTimeAvg>\\n        <InputSizeMax>173</InputSizeMax>\\n        <InputSizeMin>173</InputSizeMin>\\n        <InputSizeAvg>173</InputSizeAvg>\\n        <ScanSizeMax>0</ScanSizeMax>\\n        <State>FINISHED</State>\\n        <OperatorCost>18</OperatorCost>\\n        <ScanTimeMax>0</ScanTimeMax>\\n        <CPUTimeMin>18</CPUTimeMin>\\n        <CPUTimeAvg>18</CPUTimeAvg>\\n    </StageList>\\n    <StageList>\\n        <ScanSizeMin>36</ScanSizeMin>\\n        <ScanSizeAvg>36</ScanSizeAvg>\\n        <StageId>3</StageId>\\n        <PeakMemory>0</PeakMemory>\\n        <CPUTimeMax>51</CPUTimeMax>\\n        <ScanTimeMin>10</ScanTimeMin>\\n        <ScanTimeAvg>10</ScanTimeAvg>\\n        <InputSizeMax>36</InputSizeMax>\\n        <InputSizeMin>36</InputSizeMin>\\n        <InputSizeAvg>36</InputSizeAvg>\\n        <ScanSizeMax>36</ScanSizeMax>\\n        <State>FINISHED</State>\\n        <OperatorCost>51</OperatorCost>\\n        <ScanTimeMax>10</ScanTimeMax>\\n        <CPUTimeMin>51</CPUTimeMin>\\n        <CPUTimeAvg>51</CPUTimeAvg>\\n    </StageList>\\n    <OriginInfo>{\\\"queryId\\\":\\\"20210527_160443_10581_hdhzr\\\",\\\"session\\\":{\\\"queryId\\\":\\\"20210527_160443_10581_hdhzr\\\",\\\"hasSharedStage\\\":false,\\\"parentId\\\":0}}</OriginInfo>\\n    <Detail>\\n        <TotalTask>4</TotalTask>\\n        <OutputSize>9</OutputSize>\\n        <User>test_acc</User>\\n        <TotalStage>4</TotalStage>\\n        <PeakMemory>441802</PeakMemory>\\n        <StartTime>1622102683243</StartTime>\\n        <ClientIP>172.16.***.***</ClientIP>\\n        <SQL>INSERT OVERWRITE INTO hdfs_import_external\\nSELECT *\\nFROM adb_hdfs_import_source</SQL>\\n        <CPUTime>6100</CPUTime>\\n        <QueuedTime>0</QueuedTime>\\n        <State>FINISHED</State>\\n        <Database>adb_demo</Database>\\n        <TotalTime>2340</TotalTime>\\n        <PlanningTime>86</PlanningTime>\\n        <OutputRows>1</OutputRows>\\n    </Detail>\\n</DescribeSQLPlanResponse>\",\"errorExample\":\"\"}]","title":"查询基础信息和计划信息","summary":"调用DescribeSQLPlan接口查询目标SQL，例如查询语句或ETL（Extract Transform Load）任务语句的计划信息。"}