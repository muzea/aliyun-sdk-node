{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"DBClusterId","in":"query","schema":{"description":"集群ID。\n> 您可以调用[DescribeDBClusters](~~129857~~)接口查看目标地域下所有AnalyticDB MySQL集群的详情，包括集群ID。","type":"string","required":true,"docRequired":true,"example":"am-bp1r053byu48p****"}},{"name":"StartTime","in":"query","schema":{"description":"查询开始时间，格式为Unix时间戳，单位：毫秒。\n> 仅支持查看14天内的数据。","type":"string","required":true,"docRequired":true,"example":"1632931200000"}},{"name":"EndTime","in":"query","schema":{"description":"查询结束时间，格式为Unix时间戳，单位：毫秒。\n\n> * 查询结束时间需晚于查询开始时间。\n> * 开始时间与结束时间的间隔不能超过24小时。","type":"string","required":true,"docRequired":true,"example":"1633017540000"}},{"name":"RegionId","in":"query","schema":{"description":"地域ID。\n> 您可以调用[DescribeRegions](~~143074~~)接口查看AnalyticDB MySQL版支持的地域和可用区信息，包括地域ID。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"QueryCondition","in":"query","schema":{"description":"指定SQL的查询条件，格式为JSON字符串，包含`Type`、`Value`、`Min`或`Max`等字段。其中`Type` 表示查询维度（当前仅支持3个取值：`maxCost`、`status`和`cost`），`Value`、`Min`或`Max`表示该维度下的查询范围。具体支持的取值范围如下：\n- ` {\"Type\":\"maxCost\",\"Value\":\"100\"}`：表示查看执行耗时最长的前100条SQL详情，当前`Value`的取值仅支持设置为100。\n- `{\"Type\":\"status\",\"Value\":\"finished\"}`：表示查看已完成的SQL详情。您也可以将`Value`设置为`running`或`failed`来查询正在执行或执行失败的SQL详情。\n- `{\"Type\":\"cost\",\"Min\":\"10\",\"Max\":\"200\"}`：表示查看执行耗时为10毫秒~200毫秒的SQL详情，您也可以自定义执行耗时的最大值与最小值，单位：毫秒。","type":"string","required":true,"docRequired":true,"example":"{\"Type\":\"status\",\"Value\":\"finished\"}"}},{"name":"Keyword","in":"query","schema":{"description":"查询关键字。","type":"string","required":false,"example":"select"}},{"name":"MinPeakMemory","in":"query","schema":{"description":"SQL语句的最小峰值内存，单位：Byte。","type":"integer","format":"int64","required":false,"example":"0"}},{"name":"MaxPeakMemory","in":"query","schema":{"description":"SQL语句的最大峰值内存，单位：Byte。","type":"integer","format":"int64","required":false,"example":"89000000"}},{"name":"MinScanSize","in":"query","schema":{"description":"SQL语句的最小扫描量，单位：Byte。","type":"integer","format":"int64","required":false,"example":"0"}},{"name":"MaxScanSize","in":"query","schema":{"description":"SQL语句的最大扫描量，单位：Byte。","type":"integer","format":"int64","required":false,"example":"104428198"}},{"name":"ResourceGroup","in":"query","schema":{"description":"SQL语句所属的资源组。\n> 您可以调用[DescribeDiagnosisDimensions](~~308210~~)接口查看符合指定检索条件的SQL语句所属的资源组、数据库名、用户名以及访问源地址信息。","type":"string","required":false,"example":"user_default"}},{"name":"UserName","in":"query","schema":{"description":"执行SQL语句的用户名。\n> 您可以调用[DescribeDiagnosisDimensions](~~308210~~)接口查看符合指定检索条件的SQL语句所属的资源组、数据库名、用户名以及访问源地址信息。","type":"string","required":false,"example":"test_user"}},{"name":"Database","in":"query","schema":{"description":"执行SQL语句的数据库。\n> 您可以调用[DescribeDiagnosisDimensions](~~308210~~)接口查看符合指定检索条件的SQL语句所属的资源组、数据库名、用户名以及访问源地址信息。","type":"string","required":false,"example":"adb_demo"}},{"name":"ClientIp","in":"query","schema":{"description":"访问源地址。\n> 您可以调用[DescribeDiagnosisDimensions](~~308210~~)接口查看符合指定检索条件的SQL语句所属的资源组、数据库名、用户名以及访问源地址信息。","type":"string","required":false,"example":"59.82.xx.xx"}},{"name":"Order","in":"query","schema":{"description":"根据指定字段对SQL语句进行排序，格式为JSON，是一个有序JSON数组，按输入数组的顺序进行复合排序，包含`Field`和`Type`两个字段，例如`[{\"Field\":\"StartTime\", \"Type\": \"desc\" }]`。其中：\n\n- `Field`表示需要排序的字段名，支持如下字段：\n    - `StartTime`：执行开始时间。\n    - `Status`：执行状态。\n    - `UserName`：用户名称。\n    - `Cost`：执行耗时。\n    - `PeakMemory`：峰值内存。\n    - `ScanSize`：扫描数据量。\n    - `Database`：数据库名称。\n    - `ClientIp`：访问源地址.\n    - `ResourceGroup`：资源组。\n    - `QueueTime`：排队耗时。\n    - `OutputRows`：输出行数。\n    - `OutputDataSize`：输出数据量。\n    - `ResourceCostRank`：SQL内部算子的耗时排名（仅当`QueryCondition`取值为`{\"Type\":\"status\",\"Value\":\"running\"}`时，支持使用该字段）。\n\n- `Type`表示排序类型，支持如下取值（取值均不区分大小写）：\n    - `Desc`：降序。\n    - `Asc`：升序。","type":"string","required":false,"example":"[{\"Field\":\"StartTime\", \"Type\": \"desc\" }]"}},{"name":"PageNumber","in":"query","schema":{"description":"页码，取值为大于0且不超过Integer数据类型的最大值。默认值为**1**。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"每页记录数，取值为**30**（默认值）、**50**或**100**。","type":"integer","format":"int32","required":false,"example":"30"}},{"name":"Lang","in":"query","schema":{"description":"设置下载文件的文件标题以及部分错误信息的语言，支持如下语言：\n- **zh**：简体中文（默认语言）。\n- **en**：英文。\n- **ja**：日文。\n- **zh-tw**：繁体中文。","type":"string","required":false,"example":"zh"}},{"name":"PatternId","in":"query","schema":{"description":"SQL Pattern的ID。\n\n> 您可以调用[DescribeSQLPatterns](~~321868~~)接口查看指定时间内目标AnalyticDB MySQL集群下所有的SQL Pattern列表信息，包括SQL Pattern的ID。","type":"string","required":false,"example":"5575924945138******"}}],"responses":{"200":{"schema":{"description":"详情。","type":"object","properties":{"PageNumber":{"description":"页数。","type":"integer","format":"int32","example":"1"},"PageSize":{"description":"本页记录数。","type":"integer","format":"int32","example":"30"},"TotalCount":{"description":"总记录数。","type":"integer","format":"int32","example":"1"},"Querys":{"description":"SQL语句详情列表。","type":"array","items":{"description":"详情。","type":"object","properties":{"SQL":{"description":"SQL语句详情。\n> 出于性能考虑，当前SQL语句最长支持显示5120个字符，超出限制的SQL语句会被截断。您可以调用[DownloadDiagnosisRecords](~~308212~~)接口下载符合指定条件的SQL语句的摘要信息，包括完整的SQL语句。","type":"string","example":"SELECT count(*)\\nFROM nation"},"SQLTruncatedThreshold":{"description":"SQL语句的截断阈值，固定为5120个字符。超过该长度的SQL语句会被截断。","type":"integer","format":"int64","example":"5120"},"Status":{"description":"SQL语句的状态，取值为：\n- **running**：执行中。\n- **finished**：已完成。\n- **failed**：执行失败。","type":"string","example":"finished"},"OutputDataSize":{"description":"返回数据量，单位：Byte。","type":"integer","format":"int64","example":"9"},"Cost":{"description":"查询的总耗时。单位：毫秒。\n> 该耗时指标是`QueuedTime`、`TotalPlanningTime`和`ExecutionTime`三个耗时指标的累加值。","type":"integer","format":"int64","example":"10"},"OutputRows":{"description":"返回行数。","type":"integer","format":"int64","example":"1"},"RcHost":{"description":"执行SQL语句的AnalyticDB MySQL前端节点IP和端口信息。","type":"string","example":"10.0.xx.xx:3004"},"ScanSize":{"description":"扫描数据量，单位：Byte。","type":"integer","format":"int64","example":"9"},"ProcessId":{"description":"查询ID。","type":"string","example":"2021093000414401000000023503151******"},"StartTime":{"description":"SQL语句的执行开始时间，格式为Unix时间戳，单位：毫秒。","type":"integer","format":"int64","example":"1632933704000"},"SQLTruncated":{"description":"查询结果的长度是否超过阈值（即是否被截断），取值如下：\n- **true**：查询结果的长度超过阈值。\n- **false**：查询结果的长度未超过阈值。","type":"boolean","example":"false"},"Database":{"description":"执行SQL语句的数据库名称。","type":"string","example":"adb_demo"},"ScanRows":{"description":"扫描行数。","type":"integer","format":"int64","example":"1"},"ResourceCostRank":{"description":"SQL语句内部算子的耗时排名。\n> 仅状态为执行中，即`Status`取值为`running`的SQL语句支持返回该字段。","type":"integer","format":"int32","example":"1"},"ClientIp":{"description":"访问源地址。","type":"string","example":"59.82.xx.xx"},"PeakMemory":{"description":"峰值内存，单位：Byte。","type":"integer","format":"int64","example":"16648"},"QueueTime":{"description":"排队耗时，单位：毫秒。","type":"integer","format":"int64","example":"0"},"ResourceGroup":{"description":"SQL语句所属的资源池。","type":"string","example":"user_default"},"UserName":{"description":"执行SQL语句的用户名。","type":"string","example":"test_user"},"ExecutionTime":{"description":"查询执行的耗时，单位：毫秒。","type":"integer","format":"int64","example":"6"},"TotalPlanningTime":{"description":"生成执行计划的耗时，单位：毫秒。","type":"integer","format":"int64","example":"4"},"EtlWriteRows":{"description":"ETL任务写表的行数。","type":"integer","format":"int64","example":"0"},"TotalStages":{"description":"查询生成的总Stage数量。","type":"integer","format":"int32","example":"2"}}}},"RequestId":{"description":"请求ID。","type":"string","example":"109462AF-B5FA-3D5A-9377-B27E5B******"}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"PageNumber\\\": 1,\\n  \\\"PageSize\\\": 30,\\n  \\\"TotalCount\\\": 1,\\n  \\\"Querys\\\": [\\n    {\\n      \\\"SQL\\\": \\\"SELECT count(*)\\\\\\\\nFROM nation\\\",\\n      \\\"SQLTruncatedThreshold\\\": 5120,\\n      \\\"Status\\\": \\\"finished\\\",\\n      \\\"OutputDataSize\\\": 9,\\n      \\\"Cost\\\": 10,\\n      \\\"OutputRows\\\": 1,\\n      \\\"RcHost\\\": \\\"10.0.xx.xx:3004\\\",\\n      \\\"ScanSize\\\": 9,\\n      \\\"ProcessId\\\": \\\"2021093000414401000000023503151******\\\",\\n      \\\"StartTime\\\": 1632933704000,\\n      \\\"SQLTruncated\\\": false,\\n      \\\"Database\\\": \\\"adb_demo\\\",\\n      \\\"ScanRows\\\": 1,\\n      \\\"ResourceCostRank\\\": 1,\\n      \\\"ClientIp\\\": \\\"59.82.xx.xx\\\",\\n      \\\"PeakMemory\\\": 16648,\\n      \\\"QueueTime\\\": 0,\\n      \\\"ResourceGroup\\\": \\\"user_default\\\",\\n      \\\"UserName\\\": \\\"test_user\\\",\\n      \\\"ExecutionTime\\\": 6,\\n      \\\"TotalPlanningTime\\\": 4,\\n      \\\"EtlWriteRows\\\": 0,\\n      \\\"TotalStages\\\": 2\\n    }\\n  ],\\n  \\\"RequestId\\\": \\\"109462AF-B5FA-3D5A-9377-B27E5B******\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeDiagnosisRecordsResponse>\\n    <PageNumber>1</PageNumber>\\n    <PageSize>30</PageSize>\\n    <TotalCount>1</TotalCount>\\n    <Querys>\\n        <SQL>SELECT count(*)\\\\nFROM nation</SQL>\\n        <SQLTruncatedThreshold>5120</SQLTruncatedThreshold>\\n        <Status>finished</Status>\\n        <OutputDataSize>9</OutputDataSize>\\n        <Cost>10</Cost>\\n        <OutputRows>1</OutputRows>\\n        <RcHost>10.0.xx.xx:3004</RcHost>\\n        <ScanSize>9</ScanSize>\\n        <ProcessId>2021093000414401000000023503151******</ProcessId>\\n        <StartTime>1632933704000</StartTime>\\n        <SQLTruncated>false</SQLTruncated>\\n        <Database>adb_demo</Database>\\n        <ScanRows>1</ScanRows>\\n        <ResourceCostRank>1</ResourceCostRank>\\n        <ClientIp>59.82.xx.xx</ClientIp>\\n        <PeakMemory>16648</PeakMemory>\\n        <QueueTime>0</QueueTime>\\n        <ResourceGroup>user_default</ResourceGroup>\\n        <UserName>test_user</UserName>\\n        <ExecutionTime>6</ExecutionTime>\\n        <TotalPlanningTime>4</TotalPlanningTime>\\n        <EtlWriteRows>0</EtlWriteRows>\\n        <TotalStages>2</TotalStages>\\n    </Querys>\\n    <RequestId>109462AF-B5FA-3D5A-9377-B27E5B******</RequestId>\\n</DescribeDiagnosisRecordsResponse>\",\"errorExample\":\"\"}]","title":"查询诊断记录","summary":"查看目标AnalyticDB MySQL版集群中符合指定检索条件的SQL语句摘要信息。"}