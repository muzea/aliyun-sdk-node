{"methods":["post","get"],"schemes":["http","https"],"tags":["Perth"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"DBClusterId","in":"query","schema":{"description":"AnalyticDB MySQL数仓版（3.0）集群ID。\n> 您可以调用[DescribeDBClusters](~~129857~~)接口查看目标地域下所有AnalyticDB MySQL数仓版（3.0）集群的集群ID。","type":"string","required":true,"docRequired":true,"example":"am-t4nj8619bz2w3****"}},{"name":"RegionId","in":"query","schema":{"description":"地域ID。\n> 您可以调用[DescribeRegions](~~143074~~)接口查看AnalyticDB MySQL版支持的地域和可用区信息，包括地域ID。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"StartTime","in":"query","schema":{"description":"查询开始时间，UTC时间，格式为：yyyy-MM-ddTHH:mmZ。\n> 仅当SQL审计状态为开启时，才能查询到SQL审计日志，且只支持查询30天内的SQL审计日志。如果中途关闭了SQL审计，再次打开时，仅能查询到再次打开后的SQL审计日志。\n","type":"string","required":false,"docRequired":true,"example":"2022-01-23T02:18Z"}},{"name":"EndTime","in":"query","schema":{"description":"查询结束时间，UTC时间，格式为：yyyy-MM-ddTHH:mmZ。\n\n> - 查询结束时间需晚于查询开始时间。\n> - 查询开始时间与查询结束时间的间隔不能超过24小时。","type":"string","required":false,"docRequired":true,"example":"2022-01-23T22:18Z"}},{"name":"DBName","in":"query","schema":{"description":"执行SQL的数据库名称。","type":"string","required":false,"example":"adb_demo"}},{"name":"QueryKeyword","in":"query","schema":{"description":"对查询包含目标关键字的SQL进行查询。","type":"string","required":false,"example":"adb"}},{"name":"SqlType","in":"query","schema":{"description":"SQL类型，取值：\n- **DELETE**\n- **SELECT**\n- **UPDATE**\n- **INSERT_INTO_SELECT**\n- **ALTER**\n- **DROP**\n- **CREATE**\n\n\n> 每次仅允许传入一种类型查询，若该参数为空，默认查询**SELECT**类型。","type":"string","required":false,"example":"SELECT"}},{"name":"Succeed","in":"query","schema":{"description":"目标SQL是否执行成功，取值说明：\n* **true**：执行成功。\n* **false**：执行失败。","type":"string","required":false,"example":"true"}},{"name":"HostAddress","in":"query","schema":{"description":"执行目标SQL的客户端IP地址和端口号。","type":"string","required":false,"example":"100.104.XX.XX:43908"}},{"name":"OrderType","in":"query","schema":{"description":"按SQL执行时间进行正序或倒序排序，取值说明：\n* **asc**：正序。\n* **desc**：倒序。","type":"string","required":false,"example":"asc"}},{"name":"User","in":"query","schema":{"description":"执行目标SQL的用户名。","type":"string","required":false,"example":"test_user"}},{"name":"Order","in":"query","schema":{"description":"根据指定字段进行排序，格式为JSON，是一个有序JSON数组，按输入数组的顺序进行复合排序，包含Field和Type两个字段。\n- Field表示需要排序的字段名，取值说明：\n    - HostAddress：连接数据库的客户端地址。\n    - Succeed：目标SQL是否执行成功。\n    - TotalTime：目标SQL的执行总耗时。\n    - DBName：执行目标SQL的数据库名称。\n    - SQLType：SQL类型。\n    - User：执行目标SQL的用户名。\n    - ExecuteTime：目标SQL的执行开始时间。\n- Type表示排序类型，取值说明：\n    - Desc：降序。\n    - Asc：升序。","type":"string","required":false,"example":"[{\"Field\":\"ExecuteTime\",\"Type\":\"Desc\"},{\"Field\":\"HostAddress\",\"Type\":\"Asc\"}]"}},{"name":"PageSize","in":"query","schema":{"description":"每页记录数，取值：\n- **10**\n- **30**\n- **50**\n- **100**\n> 本参数不填写时，默认为10。","type":"integer","format":"int32","required":false,"maximum":"100","minimum":"10","example":"10","default":"10"}},{"name":"PageNumber","in":"query","schema":{"description":"页码，取值为大于0且不超过Integer数据类型的最大值。默认值为**1**。","type":"integer","format":"int32","required":false,"maximum":"2147483647","minimum":"1","example":"1"}}],"responses":{"200":{"schema":{"description":"详情。","type":"object","properties":{"TotalCount":{"description":"总记录数。","type":"string","example":"1"},"PageSize":{"description":"每页记录数。","type":"string","example":"10"},"RequestId":{"description":"请求ID。","type":"string","example":"8A564B7F-8C00-43C0-8EC5-919FBB70573"},"PageNumber":{"description":"页码。","type":"string","example":"1"},"DBClusterId":{"description":"集群ID。","type":"string","example":"am-t4nj8619bz2w3****"},"Items":{"description":"SQL审计日志详情。","type":"array","items":{"description":"列表。","type":"object","properties":{"HostAddress":{"description":"执行目标SQL的客户端IP地址和端口号。","type":"string","example":"100.104.XX.XX:43908"},"Succeed":{"description":"目标SQL是否执行成功。取值说明：\n- **true**：执行成功。\n- **false**：执行失败。","type":"string","example":"true"},"SQLText":{"description":"SQL语句详情。","type":"string","example":"SELECT * FROM tb_courses"},"TotalTime":{"description":"目标SQL的执行时长，单位：毫秒（ms）。","type":"string","example":"216"},"ConnId":{"description":"此参数无效。","type":"string","example":"无"},"DBName":{"description":"执行目标SQL的数据库名称。","type":"string","example":"adb_test"},"SQLType":{"description":"目标SQL的类型。","type":"string","example":"SELECT"},"ExecuteTime":{"description":"目标SQL的执行开始时间，本地时间，格式为：yyyy-MM-dd HH:mm:ss。","type":"string","example":"2022-01-23 16:05:08"},"ProcessID":{"description":"任务ID。","type":"string","example":"202106081752021720161662490345362390"},"User":{"description":"执行目标SQL的用户名。","type":"string","example":"test_user"}}}}}}}},"errorCodes":{"404":[{"errorCode":"InvalidDBCluster.NotFound","errorMessage":"The DBClusterId provided does not exist in our records."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"TotalCount\\\": \\\"1\\\",\\n  \\\"PageSize\\\": \\\"10\\\",\\n  \\\"RequestId\\\": \\\"8A564B7F-8C00-43C0-8EC5-919FBB70573\\\",\\n  \\\"PageNumber\\\": \\\"1\\\",\\n  \\\"DBClusterId\\\": \\\"am-t4nj8619bz2w3****\\\",\\n  \\\"Items\\\": [\\n    {\\n      \\\"HostAddress\\\": \\\"100.104.XX.XX:43908\\\",\\n      \\\"Succeed\\\": \\\"true\\\",\\n      \\\"SQLText\\\": \\\"SELECT * FROM tb_courses\\\",\\n      \\\"TotalTime\\\": \\\"216\\\",\\n      \\\"ConnId\\\": \\\"无\\\",\\n      \\\"DBName\\\": \\\"adb_test\\\",\\n      \\\"SQLType\\\": \\\"SELECT\\\",\\n      \\\"ExecuteTime\\\": \\\"2022-01-23 16:05:08\\\",\\n      \\\"ProcessID\\\": \\\"202106081752021720161662490345362390\\\",\\n      \\\"User\\\": \\\"test_user\\\"\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeAuditLogRecordsResponse>\\n    <TotalCount>1</TotalCount>\\n    <PageSize>10</PageSize>\\n    <RequestId>8A564B7F-8C00-43C0-8EC5-919FBB70573</RequestId>\\n    <PageNumber>1</PageNumber>\\n    <DBClusterId>am-t4nj8619bz2w3****</DBClusterId>\\n    <Items>\\n        <HostAddress>100.104.XX.XX:43908</HostAddress>\\n        <Succeed>true</Succeed>\\n        <SQLText>SELECT * FROM tb_courses</SQLText>\\n        <TotalTime>216</TotalTime>\\n        <ConnId>无</ConnId>\\n        <DBName>adb_test</DBName>\\n        <SQLType>SELECT</SQLType>\\n        <ExecuteTime>2022-01-23 16:05:08</ExecuteTime>\\n        <ProcessID>202106081752021720161662490345362390</ProcessID>\\n        <User>test_user</User>\\n    </Items>\\n</DescribeAuditLogRecordsResponse>\",\"errorExample\":\"\"}]","title":"查询集群的SQL审计日志","summary":"调用DescribeAuditLogRecords接口查询AnalyticDB MySQL版集群的SQL审计日志。","description":"调用本接口查看AnalyticDB MySQL集群的SQL审计日志前，需要开启SQL审计。您可以调用[DescribeAuditLogConfig](~~190628~~)接口查询SQL审计的开启状态，如未开启，可调用[ModifyAuditLogConfig](~~190629~~)接口开启SQL审计。\n\n仅当SQL审计状态为开启时，才能查询到SQL审计日志，且只支持查询30天内的SQL审计日志。如果中途关闭了SQL审计，再次打开时，仅能查询到再次打开后的SQL审计日志。SQL审计日志不记录**INSERT INTO VALUES**、**REPLACE INTO VALUES**和**UPSERT INTO VALUES**操作。"}