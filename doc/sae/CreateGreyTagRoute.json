{"summary":"为Spring Cloud或Dubbo应用创建灰度规则。","path":"/pop/v1/sam/tagroute/greyTagRoute","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"produces":[],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"10251","abilityTreeNodes":["FEATUREsaeETR3ZD"]},"parameters":[{"name":"AppId","in":"query","schema":{"title":"应用ID","description":"应用ID。","type":"string","required":true,"example":"7802c49a-67bc-4167-8369-9a9c003c****"}},{"name":"Name","in":"query","schema":{"title":"规则名称","description":"规则名称。支持以小写字母开头，以数字或小写字母结尾，仅可包含小写字母、中文字符、数字及短划线（-）。不超过64个字符。","type":"string","required":true,"example":"dubbo-echo"}},{"name":"Description","in":"query","schema":{"title":"规则名称","description":"规则描述。不超过64个字符。","type":"string","required":false,"example":"灰度发布-地域灰度"}},{"name":"ScRules","in":"query","schema":{"title":"SpringCloud规则","description":"为Spring Cloud应用创建的灰度规则。当您的应用为Spring Cloud框架时必填，且无需填写**DubboRules**参数。","type":"string","required":false,"example":"[{\"condition\":\"OR\",\"items\":[{\"cond\":\"==\",\"name\":\"grey\",\"operator\":\"rawvalue\",\"type\":\"param\",\"value\":\"true\"},{\"cond\":\"==\",\"name\":\"grey\",\"operator\":\"rawvalue\",\"type\":\"cookie\",\"value\":\"true\"},{\"cond\":\"==\",\"name\":\"grey\",\"operator\":\"rawvalue\",\"type\":\"header\",\"value\":\"true\"}],\"path\":\"/post-echo/hi\"}]"}},{"name":"DubboRules","in":"query","schema":{"title":"Dubbo规则","description":"为Dubbo应用创建的灰度规则。当您的应用为Dubbo框架时必填，且无需填写**ScRules**参数。","type":"string","required":false,"example":"[{\"condition\":\"OR\",\"group\":\"DUBBO\",\"items\":[{\"cond\":\"==\",\"expr\":\".key1\",\"index\":0,\"operator\":\"rawvalue\",\"value\":\"value1\"},{\"cond\":\"==\",\"expr\":\".key2\",\"index\":0,\"operator\":\"rawvalue\",\"value\":\"value2\"}],\"methodName\":\"echo\",\"serviceName\":\"com.alibaba.edas.boot.EchoService\",\"version\":\"1.0.0\"}]"}},{"name":"AlbRules","in":"query","schema":{"title":"Alb灰度规则","description":"为配置好ALB网关路由的应用创建的灰度规则。","type":"string","required":false,"example":"[{\"condition\":\"AND\",\"items\":[{\"cond\":\"==\",\"name\":\"grey\",\"operator\":\"rawvalue\",\"type\":\"sourceIp\",\"value\":\"127.0.0.1\"},{\"cond\":\"==\",\"name\":\"grey\",\"operator\":\"rawvalue\",\"type\":\"cookie\",\"value\":\"true\"},{\"cond\":\"==\",\"name\":\"grey\",\"operator\":\"rawvalue\",\"type\":\"header\",\"value\":\"true\"}],\"path\":\"/post-echo/hi\"}]"}}],"responses":{"200":{"schema":{"description":"返回数据。","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"9D29CBD0-45D3-410B-9826-52F86F90****"},"Message":{"description":"调用结果的附加信息。","type":"string","example":"success"},"TraceId":{"description":"调用链ID，用于精确查询调用信息。","type":"string","example":"0a98a02315955564772843261e****"},"Data":{"description":"灰度规则信息。","type":"object","properties":{"GreyTagRouteId":{"description":"灰度规则ID，全局唯一。","type":"integer","format":"int64","example":"16"}}},"ErrorCode":{"description":"错误码。取值说明如下：\n\n- 请求成功：不返回**ErrorCode**字段。\n- 请求失败：返回**ErrorCode**字段。具体信息，请参见本文的**错误码**列表。","type":"string","example":"空"},"Code":{"description":"接口状态或POP错误码。取值说明如下：\n\n- **2xx**：成功。\n- **3xx**：重定向。\n- **4xx**：请求错误。\n- **5xx**：服务器错误。","type":"string","example":"200"},"Success":{"description":"查询变更单信息是否成功。取值说明如下：\n\n- **true**：查询成功。\n- **false**：查询失败。","type":"boolean","example":"true"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParameter.NotEmpty","errorMessage":"You must specify the parameter %s."},{"errorCode":"InvalidParameter.Obviously","errorMessage":"The specified parameter is invalid {%s}."},{"errorCode":"InvalidParameter.WithMessage","errorMessage":"The parameter is invalid {%s}: %s"},{"errorCode":"Application.ChangerOrderRunning","errorMessage":"An application change process is in progress. Please try again later."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"9D29CBD0-45D3-410B-9826-52F86F90****\\\",\\n  \\\"Message\\\": \\\"success\\\",\\n  \\\"TraceId\\\": \\\"0a98a02315955564772843261e****\\\",\\n  \\\"Data\\\": {\\n    \\\"GreyTagRouteId\\\": 16\\n  },\\n  \\\"ErrorCode\\\": \\\"空\\\",\\n  \\\"Code\\\": \\\"200\\\",\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateGreyTagRouteResponse>\\n    <RequestId>9D29CBD0-45D3-410B-9826-52F86F90****</RequestId>\\n    <Message>success</Message>\\n    <TraceId>0a98a02315955564772843261e****</TraceId>\\n    <Data>\\n        <GreyTagRouteId>16</GreyTagRouteId>\\n    </Data>\\n    <Code>200</Code>\\n    <Success>true</Success>\\n</CreateGreyTagRouteResponse>\",\"errorExample\":\"\"}]","title":"CreateGreyTagRoute","description":"> 目前一个应用只能配置一条灰度规则。","requestParamsDescription":"- **ScRules参数说明**\n\n|参数名称 |类型|示例 |描述 |\n| --- | --- | --- | --- |\n|condition|String|OR |灰度规则的条件模式，取值说明如下：<br />- **AND**：表示与，即同时满足条件列表中的所有条件。<br />-    **OR**：表示或，即满足条件列表中的任一条件。|\n|path|String  | /path|Spring Cloud应用灰度规则对应的路径。|\n|items |Array of items | |条件列表。|\n\n**items参数说明**\n\n|参数名称 |类型|示例 |描述 |\n| --- | --- | --- | --- |\n|name|String|test |参数名。|\n|cond |String | == |比较操作符。可取值：**>**、**<**、**>=**、**<=**、**==**以及**!=**。|\n|type | String| cookie |比较类型，取值说明如下：<br />- **param**：表示Parameter。<br />- **cookie**：表示Cookie。<br />- **header**：表示Header。 |\n|value|String | test|参数取值，根据**type**和**name**得到的值跟这个值进行比较。|\n|operator| String| rawvalue|运算符，取值说明如下：<br />- **rawvalue**：表示直接比较。<br />- **list**：表示白名单。<br />- **mod**：表示对100取模。<br />- **deterministic\\_proportional\\_steaming\\_division**：表示百分比。|\n\n- **DubboRules参数说明**\n\n|参数名称 |类型|示例 |描述 |\n| --- | --- | --- | --- |\n|condition|String|OR |灰度规则的条件模式，取值说明如下：<br />- **AND**：表示与，即同时满足条件列表中的所有条件。<br />- **OR**：表示或，即满足条件列表中的任一条件。|\n|methodName|String  |echo|Dubbo服务的方法名。|\n|serviceName| String|com.alibaba.edas.boot.EchoService|Dubbo服务名称。|\n|version |String | 1.0.0|Dubbo服务版本。|\n|items |Array of items | |条件列表。|\n|group|String|DUBBO|灰度规则对应的Dubbo服务的分组。|\n\n**items参数说明**\n\n|参数名称 |类型|示例 |描述 |\n| --- | --- | --- | --- |\n|index|Integer|0 |参数编号，0表示第一个参数。|\n|expr|String|.name|参数值获取表达式。取值说明如下：<br />- **留空**：表示直接取当前参数的值。<br />- **.name**：表示取参数的name属性，相当于args0.getName()。<br />- **.isEnabled()** ：表示取参数的enabled属性，相当于args0.isEnabled()。<br />- **[0]**：表示当前参数应是一个数组，取数组的第一个值，相当于args0[0]，注意开始没有英文句点（.）。<br />- **.get(0) **：表示当前参数应是一个List，取List的第一个值，相当于args0.get(0)。<br />- **.get(\"key\")**：表示当前参数是一个Map，获取key对应的值，相当于args0.get(\"key\")。|\n|cond |String | == |比较操作符。可取值：**>**、**<**、**>=**、**<=**、**==**以及**!=**。|\n|value|String | test|参数取值，根据**expr**和**index**得到的值跟这个值进行比较。|\n|operator| String| rawvalue|运算符，取值说明如下：<br />- **rawvalue**：表示直接比较。<br />- **list**：表示白名单。<br />- **mod**：表示对100取模。<br />- **deterministic\\_proportional\\_steaming\\_division**：表示百分比。|"}