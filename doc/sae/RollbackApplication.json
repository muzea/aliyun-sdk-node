{"path":"/pop/v1/sam/app/rollbackApplication","methods":["put"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"abilityTreeCode":"6389","abilityTreeNodes":["FEATUREsaeD9PL61"]},"parameters":[{"name":"AppId","in":"query","schema":{"description":"应用ID。","type":"string","required":true,"example":"017f39b8-dfa4-4e16-a84b-1dcee4b1****"}},{"name":"VersionId","in":"query","schema":{"description":"版本ID，需要调用[ListAppVersions](~~162054~~)接口查看。","type":"string","required":true,"example":"0026ff7f-2b57-4127-bdd0-9bf202bb9****"}},{"name":"BatchWaitTime","in":"query","schema":{"description":"分批等待时间，单位为秒。\n","type":"integer","format":"int32","required":false,"example":"10"}},{"name":"MinReadyInstances","in":"query","schema":{"description":"最小存活实例数。取值说明如下：\n\n- 如果设置为**0**，应用在升级过程中将会中断业务。\n- 如果设置为**-1**，最小存活实例数将使用系统推荐值，即取现有实例数的25%。如果当前为5个实例，5×25%=1.25，向上取整后，最小存活实例数为2。\n\n> 每次滚动部署最小存活的实例数建议≥1，保证业务不中断。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"MinReadyInstanceRatio","in":"query","schema":{"description":"最小存活实例数百分比。取值说明如下：\n\n - **-1**：初始化值，表示不采用百分比。\n - **0~100**：单位为百分比，向上取整。例如设置为**50**%，如果当前为5个实例，则最小存活实例数为3。\n\n> 当**MinReadyInstance**和**MinReadyInstanceRatio**同时传递时，且**MinReadyInstanceRatio**的取值非**-1**时，以**MinReadyInstanceRatio**参数为准。假设**MinReadyInstances**取值为**5**，**MinReadyInstanceRatio**取值为**50**，则会用**50**来计算最小存活实例数。\n","type":"integer","format":"int32","required":false,"example":"-1"}},{"name":"UpdateStrategy","in":"query","schema":{"description":"部署策略。当最小存活实例数等于1时，**UpdateStrategy**字段的值为\"\"。当最小存活实例数大于1时，示例如下：\n\n- 灰度1台+后续分2批+自动分批+分批间隔1分钟。\n  \n  `{\"type\":\"GrayBatchUpdate\",\"batchUpdate\":{\"batch\":2,\"releaseType\":\"auto\",\"batchWaitTime\":1},\"grayUpdate\":{\"gray\":1}}`\n\n- 灰度1台+后续分2批+手动分批。\n\n  `{\"type\":\"GrayBatchUpdate\",\"batchUpdate\":{\"batch\":2,\"releaseType\":\"manual\"},\"grayUpdate\":{\"gray\":1}}`\n  \n- 分2批+自动分批+分批间隔0分钟。\n\n  `{\"type\":\"BatchUpdate\",\"batchUpdate\":{\"batch\":2,\"releaseType\":\"auto\",\"batchWaitTime\":0}}`\n\n参数说明如下：\n\n- **type**：发布策略类型，可选灰度发布**GrayBatchUpdate**或分批发布**BatchUpdate**。\n- **batchUpdate**：分批发布策略。\n    - **batch**：发布批次。\n    - **releaseType**：分批间处理方式，可选自动**auto**或手动**manual**。\n    - **batchWaitTime**：批次内部署间隔时间，单位为秒。\n- **grayUpdate**：灰度后剩余批次，当**type**为**GrayBatchUpdate**时必填。\n","type":"string","required":false,"example":"{\"type\":\"GrayBatchUpdate\",\"batchUpdate\":{\"batch\":2,\"releaseType\":\"auto\",\"batchWaitTime\":1},\"grayUpdate\":{\"gray\":1}}"}},{"name":"AutoEnableApplicationScalingRule","in":"query","schema":{"description":"是否自动启用应用弹性伸缩策略。取值说明如下：\n\n- **true**：开启。\n- **false**：关闭。","type":"string","required":false,"example":"true"}}],"responses":{"200":{"schema":{"description":"返回数据","type":"object","properties":{"RequestId":{"description":"请求ID。\n","type":"string","example":"91F93257-7A4A-4BD3-9A7E-2F6EAE6D****"},"Message":{"description":"调用结果的附加信息。","type":"string","example":"success"},"TraceId":{"description":"调用链ID，用于精确查询调用信息。\n","type":"string","example":"0a98a02315955564772843261e****"},"Data":{"description":"返回结果。","type":"object","properties":{"ChangeOrderId":{"description":"变更流程ID。","type":"string","example":"01db03d3-3ee9-48b3-b3d0-dfce2d88****"},"IsNeedApproval":{"description":"RAM用户发布变更是否需要审批。取值说明如下：\n\n- **true**：需审批。\n- **false**：无需审批。","type":"boolean","example":"true"}}},"ErrorCode":{"description":"错误码。取值说明如下：\n\n- 请求成功：不返回**ErrorCode**字段。\n- 请求失败：返回**ErrorCode**字段。具体信息，请参见本文的**错误码**列表。\n","type":"string","example":"空"},"Code":{"description":"接口状态或POP错误码。取值说明如下：\n\n- **2xx**：成功。\n- **3xx**：重定向。\n- **4xx**：请求错误。\n- **5xx**：服务器错误。","type":"string","example":"200"},"Success":{"description":"回退历史版本是否成功。取值说明如下：\n\n- **true**：回退成功。\n- **false**：回退失败。\n","type":"boolean","example":"true"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidApplication.NotFound","errorMessage":"The current application does not exist."},{"errorCode":"InvalidParameter.NotEmpty","errorMessage":"You must specify the parameter %s."},{"errorCode":"InvalidParameter.Obviously","errorMessage":"The specified parameter is invalid {%s}."},{"errorCode":"InvalidParameter.WithMessage","errorMessage":"The parameter is invalid {%s}: %s"},{"errorCode":"NoComputeResourceQuota.Exceed","errorMessage":"Your compute resource is insufficient. Please contact us to raise the quota."},{"errorCode":"user.indebt","errorMessage":"The user has an outstanding payment."},{"errorCode":"NoComputeResourceQuota.App.Exceed","errorMessage":"You can create %s instances for each application.  Please submit a ticket to raise the quota."},{"errorCode":"NoComputeResourceQuota.User.Exceed","errorMessage":"Your account is limited to create %s instances.  Please submit a ticket to raise the quota."},{"errorCode":"System.Upgrading","errorMessage":"The system is being upgraded. Please try again later."},{"errorCode":"Application.ChangerOrderRunning","errorMessage":"An application change process is in progress. Please try again later."},{"errorCode":"Application.InvalidStatus","errorMessage":"The application status is abnormal. Please try again later."},{"errorCode":"Application.NotDeployYet","errorMessage":"The application has not been deployed. Please deploy it and try again."},{"errorCode":"rollback.error","errorMessage":"Failed to roll back."},{"errorCode":"Application.MissingJdk","errorMessage":"Your application must at least contain a JDK component."},{"errorCode":"JarApplication.MissingJdk","errorMessage":"A FatJar application must contain JDK."},{"errorCode":"PandoraApplication.MissingJdk","errorMessage":"The Pandora application is missing a JDK component."},{"errorCode":"WarApplication.MissingJdkWebcontainer","errorMessage":"A War application must contain JDK and Tomcat."},{"errorCode":"InvalidComponent.NotFound","errorMessage":"The current component (such as JDK, Tomcat, or EDASWebContainer) does not exist."},{"errorCode":"InvalidHostnameIp.Invalid","errorMessage":"The hostname and/or IP is invalid: Hostname [%s], IP [%s]."},{"errorCode":"InvalidInstanceSpecification.Unsupported","errorMessage":"The instance specification is not supported: CPU [%s], memory [%s]."},{"errorCode":"InvalidPackageType.NotFound","errorMessage":"The package type must be War, FatJar, or Image."},{"errorCode":"LogService.ConfigQuotaExceed","errorMessage":"The maximum number of Log Service configs is exceeded."},{"errorCode":"LogService.InternalError","errorMessage":"An exception occurred while calling Log Service. Please submit a ticket to solve the problem."},{"errorCode":"LogService.LogDirInvalid","errorMessage":"The log collection path is invalid."},{"errorCode":"LogService.NotAvailable","errorMessage":"Log Service is unavailable. Please activate Log Service first."},{"errorCode":"LogService.ProjectNumQuotaExceed","errorMessage":"The maximum number of Log Service projects is exceeded."},{"errorCode":"VolumnPath.Conflict","errorMessage":"Conflict between log collection directory and persistent storage directory."},{"errorCode":"MountConflict.ConfigMap","errorMessage":"Conflict detected for ConfigMap path %s."},{"errorCode":"NotFound.ConfigMap","errorMessage":"The ConfigMap object (ID: %s) does not exist."},{"errorCode":"NotFound.ConfigMapKey","errorMessage":"The key %s of ConfigMap object (ID: %s) does not exist."},{"errorCode":"MinReadyInstances.Not.Smaller.Replicas","errorMessage":"The minimum number of available instances must be less than the number of application instances."},{"errorCode":"MinReadyInstanceRatio.Invalid","errorMessage":"The ratio of minimum available instances must be between 0 and 100."},{"errorCode":"Package.Version.Too.Long","errorMessage":"The maximum length of package version is exceeded."},{"errorCode":"App.Package.Version.Exists","errorMessage":"The package version of application  already exists."},{"errorCode":"Slb.Occupied","errorMessage":"The SLB instance is occupied."},{"errorCode":"Slb.Tag.Not.Qualified","errorMessage":"The current SLB instance cannot be reused because it may have been occupied by %s."},{"errorCode":"InvalidParameter.FileName","errorMessage":"The application deployment package name is invalid. This name can contain only alphanumeric characters, hyphens (-), and underscores (_). For deploying java package, you can upload JAR files only if the selected deployment version supports JAR file. Otherwise, upload WAR files only. For deploying php package, you can upload ZIP files only if the selected deployment version supports ZIP file."},{"errorCode":"vswitch.not.exist","errorMessage":"The specified vSwitch does not exist."}],"404":[{"errorCode":"InvalidNamespaceId.NotFound","errorMessage":"The specified NamespaceId does not exist."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"91F93257-7A4A-4BD3-9A7E-2F6EAE6D****\\\",\\n  \\\"Message\\\": \\\"success\\\",\\n  \\\"TraceId\\\": \\\"0a98a02315955564772843261e****\\\",\\n  \\\"Data\\\": {\\n    \\\"ChangeOrderId\\\": \\\"01db03d3-3ee9-48b3-b3d0-dfce2d88****\\\",\\n    \\\"IsNeedApproval\\\": true\\n  },\\n  \\\"ErrorCode\\\": \\\"空\\\",\\n  \\\"Code\\\": \\\"200\\\",\\n  \\\"Success\\\": true\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<RollbackApplicationResponse>\\n    <RequestId>91F93257-7A4A-4BD3-9A7E-2F6EAE6D****</RequestId>\\n    <Message>success</Message>\\n    <TraceId>0a98a02315955564772843261e****</TraceId>\\n    <Data>\\n        <ChangeOrderId>01db03d3-3ee9-48b3-b3d0-dfce2d88****</ChangeOrderId>\\n        <IsNeedApproval>true</IsNeedApproval>\\n    </Data>\\n    <Code>200</Code>\\n    <Success>true</Success>\\n</RollbackApplicationResponse>\",\"errorExample\":\"\"}]","title":"回退应用历史版本","summary":"调用RollbackApplication接口回退应用历史版本。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}