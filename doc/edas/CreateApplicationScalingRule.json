{"path":"/pop/v1/eam/scale/application_scaling_rule","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create"},"parameters":[{"name":"AppId","in":"query","schema":{"description":"应用ID，可调用[ListApplication](~~149390~~)接口获取。","type":"string","required":false,"docRequired":true,"example":"78194c76-3dca-418e-a263-cccd1ab4****"}},{"name":"ScalingRuleName","in":"query","schema":{"description":"弹性伸缩策略的名称。支持以小写字母开头，允许小写字母、数字、中划线（-）组成，长度为1~32字符的字符串。","type":"string","required":false,"example":"cpu-trigger"}},{"name":"ScalingRuleType","in":"query","schema":{"description":"弹性伸缩策略类型，仅支持**trigger**类型。\n","type":"string","required":false,"example":"trigger"}},{"name":"ScalingRuleEnable","in":"query","schema":{"description":"是否启用弹性伸缩策略。\n\n- **true**：启用规则。\n\n- **false**：禁用规则。","type":"boolean","required":false,"example":"true"}},{"name":"ScalingRuleMetric","in":"query","schema":{"description":"此参数已废弃。","type":"string","required":false,"example":"1"}},{"name":"ScalingRuleTimer","in":"query","schema":{"description":"此参数已废弃。","type":"string","required":false,"example":"1"}},{"name":"ScalingRuleTrigger","in":"query","schema":{"description":"触发器策略。设置为ScalingRuleTriggerDTO的JSON格式，具体样式，请参见请求参数补充说明。","type":"string","required":false,"example":"ScalingRuleTriggerDTO{......}"}},{"name":"ScalingBehaviour","in":"query","schema":{"description":"配置自定义弹性行为，具体数据结构参考样例。","type":"string","required":false,"example":"{\n      \"scaleUp\": {\n            \"stabilizationWindowSeconds\": \"0\",\n            \"selectPolicy\": \"Max\",\n            \"policies\": [\n                  {\n                        \"type\": \"Pods\",\n                        \"value\": 5,\n                        \"periodSeconds\": 15\n                  }\n            ]\n      },\n      \"scaleDown\": {\n            \"stabilizationWindowSeconds\": \"300\",\n            \"selectPolicy\": \"Max\",\n            \"policies\": [\n                  {\n                        \"type\": \"Percent\",\n                        \"value\": 200,\n                        \"periodSeconds\": 15\n                  }\n            ]\n      }\n}"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"接口状态码。","type":"integer","format":"int32","example":"200"},"Message":{"description":"返回信息。","type":"string","example":"success"},"RequestId":{"description":"请求唯一标识ID。","type":"string","example":"a5281053-08e4-47a5-b2ab-5c0323de7b5a"},"AppScalingRule":{"description":"弹性伸缩策略。","type":"object","properties":{"UpdateTime":{"description":"更新弹性伸缩策略的时间戳。","type":"integer","format":"int64","example":"23212323123"},"CreateTime":{"description":"创建弹性伸缩策略的时间戳。","type":"integer","format":"int64","example":"23212323123"},"AppId":{"description":"弹性伸缩策略所属应用的应用ID。","type":"string","example":"78194c76-3dca-418e-a263-cccd1ab4****"},"LastDisableTime":{"description":"弹性伸缩策略最近一次被禁用的时间戳。","type":"integer","format":"int64","example":"23212323123"},"MaxReplicas":{"description":"此参数已废弃。","type":"integer","format":"int32","example":"1"},"ScaleRuleEnabled":{"description":"弹性伸缩策略的启用状态。\n\n- **true**：启用\n\n- **false**：禁用","type":"boolean","example":"true"},"ScaleRuleType":{"description":"规则类型，只支持trigger。","type":"string","example":"trigger"},"MinReplicas":{"description":"此参数已废弃。","type":"integer","format":"int32","example":"1"},"ScaleRuleName":{"description":"弹性伸缩的策略名称。","type":"string","example":"cpu"},"Metric":{"description":"此参数已废弃。","type":"object","properties":{"MinReplicas":{"description":"此参数已废弃。","type":"integer","format":"int32","example":"1"},"MaxReplicas":{"description":"此参数已废弃。","type":"integer","format":"int32","example":"1"},"Metrics":{"description":"此参数已废弃。","type":"array","items":{"type":"object","properties":{"MetricTargetAverageUtilization":{"description":"此参数已废弃。","type":"integer","format":"int32","example":"1"},"MetricType":{"description":"此参数已废弃。","type":"string","example":"cpu"}}}}}},"Trigger":{"description":"触发器配置。","type":"object","properties":{"MinReplicas":{"description":"最小副本数，不能低于0。","type":"integer","format":"int32","example":"2"},"MaxReplicas":{"description":"最大副本数，不能超过1000。","type":"integer","format":"int32","example":"122"},"Triggers":{"description":"触发器列表。","type":"array","items":{"description":"触发器列表。","type":"object","properties":{"Type":{"description":"触发器类型，只支持cron和app_metric。","type":"string","example":"cron"},"MetaData":{"description":"触发器元信息。","type":"string","example":"{\"dryRun\":true}"},"Name":{"description":"触发器名称。","type":"string","example":"cpu"}}}}}},"Behaviour":{"description":"弹性行为。","type":"object","properties":{"ScaleUp":{"description":"弹性扩容行为配置。","type":"object","properties":{"StabilizationWindowSeconds":{"description":"扩容冷却时间。取值范围[0, 3600]，单位为秒。默认为0秒。","type":"integer","format":"int32","example":"0"},"SelectPolicy":{"description":"弹性扩容步长策略，可选值Max、Min、Disable。","type":"string","example":"Max"},"Policies":{"description":"策略配置。","type":"array","items":{"description":"策略配置。","type":"object","properties":{"PeriodSeconds":{"description":"检查执行的周期，取值范围[0, 1800]，单位为秒。","type":"integer","format":"int32","example":"15"},"Type":{"description":"策略类型，可为Pods或Percent。","type":"string","example":"Pods"},"Value":{"description":"弹性行为的策略值，大于零的整数。若策略类型为Pods，则该值表示Pods数量；若策略类型为Percent，则该值表示百分比，允许超过100%。","type":"string","example":"10"}}}}}},"ScaleDown":{"description":"弹性缩容行为配置。","type":"object","properties":{"StabilizationWindowSeconds":{"description":"缩容冷却时间。取值范围[0, 3600]，单位为秒。默认为300秒。","type":"integer","format":"int32","example":"300"},"SelectPolicy":{"description":"弹性缩容步长策略，可选值Max、Min、Disable。","type":"string","example":"Max"},"Policies":{"description":"策略配置。","type":"array","items":{"description":"策略配置。","type":"object","properties":{"PeriodSeconds":{"description":"检查执行的周期，取值范围[0, 1800]，单位为秒。","type":"integer","format":"int32","example":"15"},"Type":{"description":"策略类型，可为Pods或Percent。","type":"string","example":"Pods"},"Value":{"description":"弹性行为的策略值，大于零的整数。若策略类型为Pods，则该值表示Pods数量；若策略类型为Percent，则该值表示百分比，允许超过100%。","type":"string","example":"10"}}}}}}}}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Code\\\": 200,\\n  \\\"Message\\\": \\\"success\\\",\\n  \\\"RequestId\\\": \\\"a5281053-08e4-47a5-b2ab-5c0323de7b5a\\\",\\n  \\\"AppScalingRule\\\": {\\n    \\\"UpdateTime\\\": 23212323123,\\n    \\\"CreateTime\\\": 23212323123,\\n    \\\"AppId\\\": \\\"78194c76-3dca-418e-a263-cccd1ab4****\\\",\\n    \\\"LastDisableTime\\\": 23212323123,\\n    \\\"MaxReplicas\\\": 1,\\n    \\\"ScaleRuleEnabled\\\": true,\\n    \\\"ScaleRuleType\\\": \\\"trigger\\\",\\n    \\\"MinReplicas\\\": 1,\\n    \\\"ScaleRuleName\\\": \\\"cpu\\\",\\n    \\\"Metric\\\": {\\n      \\\"MinReplicas\\\": 1,\\n      \\\"MaxReplicas\\\": 1,\\n      \\\"Metrics\\\": [\\n        {\\n          \\\"MetricTargetAverageUtilization\\\": 1,\\n          \\\"MetricType\\\": \\\"cpu\\\"\\n        }\\n      ]\\n    },\\n    \\\"Trigger\\\": {\\n      \\\"MinReplicas\\\": 2,\\n      \\\"MaxReplicas\\\": 122,\\n      \\\"Triggers\\\": [\\n        {\\n          \\\"Type\\\": \\\"cron\\\",\\n          \\\"MetaData\\\": \\\"{\\\\\\\"dryRun\\\\\\\":true}\\\",\\n          \\\"Name\\\": \\\"cpu\\\"\\n        }\\n      ]\\n    },\\n    \\\"Behaviour\\\": {\\n      \\\"ScaleUp\\\": {\\n        \\\"StabilizationWindowSeconds\\\": 0,\\n        \\\"SelectPolicy\\\": \\\"Max\\\",\\n        \\\"Policies\\\": [\\n          {\\n            \\\"PeriodSeconds\\\": 15,\\n            \\\"Type\\\": \\\"Pods\\\",\\n            \\\"Value\\\": \\\"10\\\"\\n          }\\n        ]\\n      },\\n      \\\"ScaleDown\\\": {\\n        \\\"StabilizationWindowSeconds\\\": 300,\\n        \\\"SelectPolicy\\\": \\\"Max\\\",\\n        \\\"Policies\\\": [\\n          {\\n            \\\"PeriodSeconds\\\": 15,\\n            \\\"Type\\\": \\\"Pods\\\",\\n            \\\"Value\\\": \\\"10\\\"\\n          }\\n        ]\\n      }\\n    }\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<Message>success</Message>\\n<RequestId>a5281053-08e4-47a5-b2ab-5c0323de7b5a</RequestId>\\n<AppScalingRule>\\n    <ScaleRuleEnabled>true</ScaleRuleEnabled>\\n    <LastDisableTime>23212323123</LastDisableTime>\\n    <AppId>78194c76-3dca-418e-a263-cccd1ab4****</AppId>\\n    <MinReplicas>1</MinReplicas>\\n    <MaxReplicas>1</MaxReplicas>\\n    <CreateTime>23212323123</CreateTime>\\n    <UpdateTime>23212323123</UpdateTime>\\n    <ScaleRuleName>cpu</ScaleRuleName>\\n    <ScaleRuleType>trigger</ScaleRuleType>\\n    <Metric>\\n        <MinReplicas>1</MinReplicas>\\n        <MaxReplicas>1</MaxReplicas>\\n        <Metrics>\\n            <MetricType>cpu</MetricType>\\n            <MetricTargetAverageUtilization>1</MetricTargetAverageUtilization>\\n        </Metrics>\\n    </Metric>\\n    <Trigger>\\n        <MinReplicas>2</MinReplicas>\\n        <MaxReplicas>122</MaxReplicas>\\n        <Triggers>\\n            <Type>cron</Type>\\n            <MetaData>{\\\"dryRun\\\":true}</MetaData>\\n            <Name>cpu</Name>\\n        </Triggers>\\n    </Trigger>\\n</AppScalingRule>\\n<Code>200</Code>\",\"errorExample\":\"\"}]","title":"创建应用弹性伸缩规则","summary":"调用CreateApplicationScalingRule接口创建应用的弹性伸缩规则。","requestParamsDescription":"## 请求参数补充说明\n```\npublic class ScalingRuleTriggerDTO {\n    /**\n     * 最大实例数，上限1000。\n     */\n    Integer maxReplicas;\n    /**\n     * 最小实例数，下限0。\n     */\n    Integer minReplicas;\n\n    /**\n     * 触发器列表，支持多个触发器。\n     */\n    List<Trigger> triggers;\n\n    @Data\n    @ToString\n    @Builder\n    @AllArgsConstructor\n    @NoArgsConstructor\n    public static class Trigger {\n        /**\n         * 触发器类型，支持cron（定时）, app_metric（应用监控）。\n         */\n        String type;\n\n        /**\n         * 触发器名称，必须以字母开头，允许数字、字母、短划线（-）或下划线（_）组成。最大长度30个字符。\n         */\n        String name;\n\n        /**\n          触发器元数据，string->string的map Json，不同类型的触发器支持的元数据不同。\n          1. cron\n           {\"period\":\"weekly\",\"dryRun\":\"false\",\"timerInDay\":[{\"atTime\":\"08:00\",\"targetReplicas\":2},{\"atTime\":\"20:00\",\"targetReplicas\":1}],\"timerInWeek\":[\"Sat\",\"Thu\"]}\n          * period周期：daily, weekly, monthly。\n          * dryRun: false是观测并扩缩，true是仅观测。\n          * timerInDay：描述每天的扩缩周期，指在什么时候开始维持多少副本数。\n         * timerInWeek：cron表达式的周，比如Fri。\n\n         2. app_metric\n         {\\\"metricName\\\":\\\"arms_appstat.incall_QPS\\\",\\\"dryRun\\\":\\\"false\\\",\\\"targetValAvg\\\":\\\"true\\\",\\\"targetAverageValue\\\":\\\"100\\\"}\n         \n         * metricName：\n              * arms_appstat.incall_QPS（qps）\n              * arms_appstat.incall_rt（rt）\n              * arms_appstat.system_CPU（cpu使用率）\n              * arms_appstat.system_MEM（内存使用率）\n         * dryRun同cron。\n        * targetValAvg：true为需要进行平均，false为不需要平均, 除了qps为true，其他均为false。\n        * targetAverageValue/targetValue： targetValAvg为true则为targetAverageValue，targetValAvg为false则为targetValue。\n        */\n        String metadata;\n    }\n}\n```","responseParamsDescription":" ","extraInfo":" "}