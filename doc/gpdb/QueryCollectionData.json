{"summary":"召回向量数据。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"create","abilityTreeCode":"182778","abilityTreeNodes":["FEATUREgpdbIPPRRA"]},"parameters":[{"name":"DBInstanceId","in":"query","schema":{"description":"实例ID。\n\n> 您可以调用[DescribeDBInstances](~~86911~~)接口查看目标地域下所有的AnalyticDB PostgreSQL实例的详情，包括实例ID。","type":"string","required":true,"example":"gp-xxxxxxxxx"}},{"name":"Collection","in":"query","schema":{"description":"集合名。\n\n> 您可以通过[ListCollections](~~2401503~~)接口查看列表。","type":"string","required":true,"example":"document"}},{"name":"Namespace","in":"query","schema":{"description":"命名空间。\n\n> 您可以通过[ListNamespaces](~~2401502~~)查看列表。","type":"string","required":false,"example":"mynamespace","default":"public"}},{"name":"NamespacePassword","in":"query","schema":{"description":"命名空间对应的密码。","type":"string","required":true,"example":"testpassword"}},{"name":"Content","in":"query","schema":{"description":"用于全文检索的内容。即此值为空时，仅使用向量检索；不为空时，使用向量和全文双路检索。\n\n> 和Vector参数不能同时为空。","type":"string","required":false,"example":"hello_world"}},{"name":"Filter","in":"query","schema":{"description":"过滤器。","type":"string","required":false,"example":"response > 200"}},{"name":"TopK","in":"query","schema":{"description":"设置返回top结果数量。","type":"integer","format":"int64","required":true,"minimum":"0","example":"10"}},{"name":"Vector","in":"query","style":"json","schema":{"description":"向量数据，长度和[CreateCollection](~~2401497~~)接口的维度一致。\n> 当vector为空时，只返回全文检索结果。","type":"array","items":{"description":"向量数据。","type":"number","format":"double","required":false,"example":"1.234"},"required":false}},{"name":"RegionId","in":"query","schema":{"description":"实例所在地域ID。","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"Metrics","in":"query","schema":{"description":"检索时的相似度算法。取值说明：\n- **l2**：欧氏距离。\n- **ip**：点积（内积）距离。\n- **cosine**：余弦相似度。\n\n> 此值为空时，则使用构建索引时指定的算法。","type":"string","required":false,"example":"cosine","enum":["ip","l2","cosine"]}},{"name":"IncludeValues","in":"query","schema":{"description":"是否返回向量数据。取值说明：\n- **true**：返回向量数据。\n- **false**：不返回向量数据，用于全文检索场景。","type":"boolean","required":false,"example":"true","default":"true"}},{"name":"HybridSearch","in":"query","schema":{"description":"双路召回算法，默认为空(即直接将向量和全文的分数比较并排序)。\n\n可选值：\n\n- RRF：倒数排序融合(Reciprocal rank fusion)，有一个参数k控制融合效果，详见HybridSearchArgs配置；\n- Weight：比重排序，采用一个参数alpha控制向量和全文的分数比重，然后再排序，参数详见HybridSearchArgs配置；\n- Cascaded：先全文检索再在其基础上进行向量检索；","type":"string","required":false,"example":"RRF"}},{"name":"HybridSearchArgs","in":"query","style":"json","schema":{"description":"双路召回的算法参数。目前支持RRF和Weight两种：\n\n- RRF：指定计算分数的算法的`1/(k+rank_i)`中的k常数，范围大于1的正整数，格式为：\n```\n{ \n   \"RRF\": {\n    \"k\": 60\n   }\n}\n```\n\n- Weight: 计算公式`alpha * vector_score + (1-alpha) * text_score`，参数alpha表示向量和全文的检索分数比重，范围为0～1，其中0表示只全文，1表示只向量：\n```\n{ \n   \"Weight\": {\n    \"alpha\": 0.5\n   }\n}\n```","type":"object","required":false,"additionalProperties":{"type":"object","additionalProperties":{"type":"any","description":"参数值。","example":"{ \n   \"Weight\": {\n    \"alpha\": 0.5\n   }\n}"},"description":"双路召回的参数名。"}}},{"name":"OrderBy","in":"query","schema":{"description":"默认为空，表示排序的依据字段。不支持双路召回场景。\n\n字段必须属于metadata或表里的默认字段比如id，格式支持：\n- 单个字段，如chunk_id；\n- 多个字段，用逗号连接，如block_id, chunk_id；\n- 支持反序，如: block_id DESC, chunk_id DESC；","type":"string","required":false,"example":"chunk_id"}},{"name":"Offset","in":"query","schema":{"description":"默认为空，表示分页查询时的检索起点。不支持双路召回场景。\n\n范围必须>=0。当此值不为空时，会返回Total表示总的命中数。此参数配合TopK使用，比如要分页20检索chunk_id 0~44的chunks，则要请求3次：\n- Offset=0,TopK=20返回chunk_id 0~19\n- Offset=20,TopK=20返回chunk_id 20~39\n- Offset=30,TopK=20返回chunk_id 40~44","type":"integer","format":"int32","required":false,"example":"0"}},{"name":"IncludeMetadataFields","in":"query","schema":{"description":"默认为空，表示要返回的metadata字段，多个字段用逗号分隔。","type":"string","required":false,"example":"title,content"}}],"responses":{"200":{"schema":{"description":"召回结果。","type":"object","properties":{"Matches":{"type":"object","properties":{"match":{"description":"数据列表。","type":"array","items":{"description":"单条记录。","type":"object","properties":{"Id":{"description":"向量数据的唯一ID。","type":"string","example":"doca-1234"},"Metadata":{"description":"元数据。","type":"object","additionalProperties":{"type":"string","example":"{\"title\":\"test title\", \"content\":  \"test content\"}","description":"元数据内容。"}},"Values":{"type":"object","properties":{"value":{"description":"向量数据列表。","type":"array","items":{"description":"向量数据。","type":"number","format":"double","example":"1.234"}}}},"Score":{"description":"此条数据的相似度分数，其分数算法和创建索引时指定的算法`(l2/ip/cosine)`相关。","type":"number","format":"double","example":"0.12345"}}}}}},"RequestId":{"description":"请求ID。","type":"string","example":"ABB39CC3-4488-4857-905D-2E4A051D0521"},"Status":{"description":"状态，取值说明：\n- **success**：成功。\n- **fail**：失败。","type":"string","example":"success"},"Message":{"description":"请求失败时的详细信息。","type":"string","example":"0.1234"},"Total":{"description":"当请求Offset不为0时才返回，返回值为该检索条件的命中总数。","type":"integer","format":"int32","example":"100"}}}}},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"Matches\\\": {\\n    \\\"match\\\": [\\n      {\\n        \\\"Id\\\": \\\"doca-1234\\\",\\n        \\\"Metadata\\\": {\\n          \\\"key\\\": \\\"{\\\\\\\"title\\\\\\\":\\\\\\\"test title\\\\\\\", \\\\\\\"content\\\\\\\":  \\\\\\\"test content\\\\\\\"}\\\"\\n        },\\n        \\\"Values\\\": {\\n          \\\"value\\\": [\\n            1.234\\n          ]\\n        },\\n        \\\"Score\\\": 0.12345\\n      }\\n    ]\\n  },\\n  \\\"RequestId\\\": \\\"ABB39CC3-4488-4857-905D-2E4A051D0521\\\",\\n  \\\"Status\\\": \\\"success\\\",\\n  \\\"Message\\\": \\\"0.1234\\\",\\n  \\\"Total\\\": 100\\n}\",\"type\":\"json\"}]","title":"召回向量数据"}