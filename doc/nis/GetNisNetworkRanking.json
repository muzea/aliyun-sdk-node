{"summary":"支持通过排序算法和数据处理能力，对流经不同云网络资源的流量进行排名分析，以及对阿里云性能观测的探测指标进行排序，帮助您快速识别网络瓶颈、优化资源配置和提升整体网络效能。","methods":["get","post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"none","riskType":"none","abilityTreeCode":"222984","abilityTreeNodes":["FEATUREnetana5MCZ6K","FEATUREnetanaOV20CD","FEATUREnetanaB9LIVJ","FEATUREnetanaCEA895"]},"parameters":[{"name":"RegionNo","in":"query","schema":{"title":"资源所在地域。","description":"资源所在地域。","type":"string","required":true,"example":"cn-beijing"}},{"name":"ResourceType","in":"query","schema":{"title":"按流量转发所使用的阿里云网络资源类型进行分析，枚举如下：\nAccessInternetIPV4：所有阿里云公网类型IPV4。\nAccessInternetIPV4Limited：所有受地域限速的阿里云公网类型IPV4。\nElasticIP: 弹性公网EIP（IPV4）。\nPublicIpEcs:  绑定在ECS的固定公网IP（IPV4）。\nPublicIpClb:  绑定在CLB的固定公网IP（IPV4）。\nGA：全球加速。\nNAT：通过SNAT的访问公网流量。\nTR：流经云企业网转发路由器的流量。\nTRAttachment：流经云企业网连接实例的流量，包括地域内连接和跨地域连接。\nVBR：流经边界路由器的流量。\nGA：流经全球加速的流量。\nECR：流经ECR的流量。\nVPC：流经VPC的流量。\nInternetProbing: 公网探测数据。\nIntranetProbing: 内网探测数据。","description":"按流量转发所使用的阿里云网络资源类型进行分析，取值：\n- AccessInternetIpV4：所有阿里云公网类型IPV4。\n- AccessInternetIpV4Limited：所有受地域限速的阿里云公网类型IPV4。\n- ElasticIP: 弹性公网EIP（IPV4）。\n- PublicIpEcs:  绑定在ECS的固定公网IP（IPV4）。\n- PublicIpClb:  绑定在CLB的固定公网IP（IPV4）。\n- GA：全球加速。\n- NAT：通过SNAT的访问公网流量。\n- TR：流经云企业网转发路由器的流量。\n- TRAttachment：流经云企业网连接实例的流量，包括地域内连接和跨地域连接。\n- VBR：流经边界路由器的流量。\n- GA：流经全球加速的流量。\n- InternetProbing: 公网探测质量数据。\n- IntranetProbing: 内网探测质量数据。","type":"string","required":true,"example":"AccessInternetIpV4","enum":["AccessInternetIpV4","AccessInternetIpV4Limited","ElasticIP","PublicIpEcs","PublicIpClb","NAT","TR","TRAttachment","VBR","GA","InternetProbing","IntranetProbing"]}},{"name":"Direction","in":"query","schema":{"title":"基于阿里云资源的网络流量方向：\nin：流入资源的流量方向。\nout：流出资源的流量方向。\n跨域流量分析因只采集出向流量，所以传入in也以out处理。\n地域内性能观测和地域间性能观测因需在Filter内指定源或目的，所以可以任意指定Direction。","description":"基于阿里云资源的网络流量方向，取值：\n\n- in：流入资源的流量方向。\n- out：流出资源的流量方向。\n\n><notice>跨域流量分析因只采集出向流量，所以传入in也以out处理。\n地域内性能观测和地域间性能观测因需在Filter内指定源或目的，所以指定Direction无效。></notice>","type":"string","required":true,"example":"in","enum":["in","out"]}},{"name":"GroupBy","in":"query","schema":{"title":"指定指标排名的维度，通用枚举如下：\n Tuple1：表示一元组，按资源端IP粒度聚合流量进行分析。\n Tuple2：表示二元组，按流的源目IP聚合进行分析。\n Tuple5：表示五元组，按流的源目IP、端口和协议进行分析。\n Protocol: 按协议类型维度进行聚合分析。\n SourcePort: 按源端口维度进行聚合分析。\n DestinationPort: 按目的端口维度进行聚合分析。\n InstanceId：按云上实例ID进行聚合分析。\n在公网流量分析场景，支持按互联网位置分布进行聚合排序，枚举值有：\n IpPair：按源和目的IP进行聚合分析。\n Country：按客户端国家维度进行聚合分析。\n City：按客户端城市维度进行聚合分析。\n ISP：按客户端运营商维度进行聚合分析。\n ASN：按客户端运营商ASN维度进行聚合分析。\n CityASN：按客户端城市和运营商维度进行聚合分析。\n在跨域流量分析场景，支持的枚举有：\n RegionPair：按云企业网联通的两端Region进行聚合分析。\n在NAT流量分析场景，支持的枚举有：\n IP：按ECS私网IP维度聚合分析。\n在公网探测场景，支持的枚举有：\n CountryIsp：按探测国家和探测运营商进行聚合分析。\n Province：按探测省份进行聚合分析。\n ProvinceIsp:按探测省份和探测运营商进行聚合分析。\n在云上内网探测场景，支持的枚举有：\n RegionPair：按探测地域对进行聚合分析。\n ZonePair：按某个地域内可用区对进行聚合分析。","description":"指定指标排名的维度，各场景取值：\n <br>完整流数据排名分析：\n\n- Tuple1：表示一元组，提供云端IP粒度完整流数据排名分析。 \n- Tuple2：表示二元组，提供源和目的IP粒度完整流数据排名分析。 \n- Tuple5：表示五元组，提供源和目的IP、端口、协议粒度完整流数据排名分析。\n\n 流量统计排名分析： \n\n- Protocol: 按协议类型统计流量。\n- SourcePort: 按源端口统计流量。\n- DestinationPort: 按目的端口统计流量。\n- InstanceId：按云上资源ID统计流量。\n- IpPair：按源和目的IP对统计流量。\n- Country：按客户端国家来源统计流量。\n- City：按客户端城市来源统计流量。\n- ISP：按客户端运营商来源统计流量。\n- ASN：按客户端运营商ASN来源统计流量。\n- CityASN：按客户端城市和运营商ASN来源统计流量。\n- RegionPair：按云企业网跨地域访问统计流量。\n\n网络访问性能排名分析： \n\n- CountryIsp：指定Region访问互联网国家和运营商性能排名。 \n- Province：指定Region访问国内省份性能排名。\n- ProvinceIsp: 指定Region访问国内省份和运营商性能排名。\n- RegionPair：阿里云跨地域互访性能排名。 \n- ZonePair：指定地域内可用区互访性能排名。","type":"string","required":true,"example":"Protocol","enum":["Tuple1","Tuple2","Tuple5","Protocol","SourcePort","DestinationPort","Country","City","ASN","CityASN","RegionPair","InstanceId","CountryIsp","ZonePair","ISP","IpPair","Province","ProvinceIsp"]}},{"name":"OrderBy","in":"query","schema":{"title":"指定公网流量进行排名的指标。大小写敏感。\n  bps：每秒比特数。\n  pps：每秒包数。\n  ByteCount：累计字节数。\n  PacketCount：累计包数。\n公网场景特有参数：\n  rtt：tcp协议建立连接时的往返延迟。\n  RetransmitRate：重传率。\n区域级限速场景特有参数：\n  RatelimitDropPps：限速丢包速率。\nNAT场景特有参数：\n  ActiveSessionCount：并发会话数。\n  NewSessionPerSecond：每秒新建会话数。","description":"指定公网流量进行排名的指标。大小写敏感，取值：\n  \n- bps：每秒比特数。\n-   pps：每秒包数。\n-   ByteCount：累计字节数。\n-   PacketCount：累计包数。\n-   rtt：tcp协议建立连接时的往返延迟。\n-   RetransmitRate：重传率。\n-   RatelimitDropPps：限速丢包速率。\n-   ActiveSessionCount：并发会话数。\n-   NewSessionPerSecond：每秒新建会话数。","type":"string","required":true,"example":"bps","enum":["rtt","bps","pps","RetransmitRate","ActiveSessionCount","NewSessionPerSecond","RatelimitDropPps","ByteCount","PacketCount"]}},{"name":"Filter","in":"query","style":"json","schema":{"title":"支持进一步指定流量的过滤条件，进行聚焦性流量分析。","description":"支持进一步指定流量的过滤条件，进行聚焦性流量分析。","type":"array","items":{"description":"查询资源时的筛选条件列表。","type":"object","properties":{"Name":{"description":"过滤条件的名字。","type":"string","required":false,"example":"instanceId"},"Value":{"description":"过滤条件的值。","type":"string","required":false,"example":"lb-2zxxxxz1d"}},"required":false},"required":false}},{"name":"BeginTime","in":"query","schema":{"title":"起始时间戳，单位毫秒。未指定时默认查最近1小时。","description":"起始时间戳，单位**ms**。未指定时默认查最近1小时。","type":"integer","format":"int64","required":false,"maximum":"253402271999000","minimum":"0","example":"1684373600099"}},{"name":"EndTime","in":"query","schema":{"title":"结束时间戳，单位毫秒。未指定时默认查最近1小时。只指定了BeginTime时查BeginTime之后的1小时。","description":"结束时间戳，单位**ms**。未指定时默认查最近1小时。只指定了BeginTime时查BeginTime之后的1小时。","type":"integer","format":"int64","required":false,"maximum":"253402271999000","minimum":"0","example":"1684379093000"}},{"name":"Sort","in":"query","schema":{"title":"排序方式，\nasc：按正序排序。\ndesc：按逆序排序。","description":"排序方式，默认desc，取值：\n\n- asc：按正序排序。\n- desc：按逆序排序。","type":"string","required":false,"example":"desc","default":"desc","enum":["asc","desc"]}},{"name":"TopN","in":"query","schema":{"title":"展示排序靠前的数据。默认值：10。表示默认展示排序前 10 的数据。最大值：100。","description":"展示排序靠前的数据。默认值：**10**。表示默认展示排序前 10 的数据。最大值：**100**。","type":"integer","format":"int32","required":false,"maximum":"100","minimum":"1","example":"10","default":"10"}},{"name":"UseCrossAccount","in":"query","schema":{"title":"是否使用多账号访问模式","description":"是否使用多账号访问模式，保留参数，目前不支持。","type":"boolean","required":false,"example":"false","default":"false"}},{"name":"AccountIds","in":"query","style":"repeatList","schema":{"title":"显式传递子账号ID","description":"显式传递子账号ID。","type":"array","items":{"description":"成员账号ID列表。","type":"string","required":false,"example":"[\\\"118639953821****\\\"]"},"required":false,"maxItems":10}}],"responses":{"200":{"schema":{"title":"RpcResponse<ArrayList<PublicFlowlogMetricModel>>","description":"RpcResponse<ArrayList<PublicFlowlogMetricModel>>","type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":"A7F0D6EC-E19E-58AC-AC9F-08036763960F"},"Data":{"description":"云网络指标排名数据集合。","type":"array","items":{"description":"云网络指标排名单行数据。","type":"object","properties":{"RegionNo":{"title":"阿里云地域ID。","description":"阿里云地域ID。","type":"string","example":"cn-shenzhen"},"InstanceId":{"title":"各场景下表示对应的云上资源实例ID，如跨域流量分析场景表示CenID，公网场景表示EipId、EcsId、ClbId等。","description":"各场景下表示对应的云上资源实例ID，如跨域流量分析场景表示CenID，公网场景表示EipId、EcsId、ClbId等。","type":"string","example":"eip-sample*"},"BandwidthPackageId":{"title":"带宽包实例ID。","description":"带宽包实例ID。","type":"string","example":"cbwp-sample*"},"SourceIp":{"title":"源端IP。","description":"源端IP。","type":"string","example":"42.120.XX.XX"},"SourcePort":{"title":"源端端口。","description":"源端端口。","type":"string","example":"443"},"SourceIsp":{"title":"源端运营商。","description":"源端运营商。","type":"string","example":"移动"},"DestinationIp":{"title":"目的端IP。","description":"目的端IP。","type":"string","example":"2.2.XX.XX"},"DestinationPort":{"title":"目的端端口。","description":"目的端端口。","type":"string","example":"80"},"DestinationIsp":{"title":"目的端运营商。","description":"目的端运营商。","type":"string","example":"阿里云"},"Protocol":{"title":"网络协议。","description":"网络协议。","type":"string","example":"6"},"Country":{"title":"客户端所在国家。","description":"客户端所在国家。","type":"string","example":"中国"},"Province":{"title":"客户端所在省份/州。","description":"客户端所在省份/州。","type":"string","example":"四川省"},"City":{"title":"客户端所在的城市。","description":"客户端所在的城市。","type":"string","example":"成都市"},"Isp":{"title":"客户端运营商。","description":"客户端运营商。","type":"string","example":"移动"},"Asn":{"title":"客户端运营商的自治系统编号。","description":"客户端运营商的自治系统编号。","type":"string","example":"129103"},"IP":{"title":"IP地址。","description":"IP地址。","type":"string","example":"120.238.XX.XX"},"DestinationRegionNo":{"title":"目的端地域ID。","description":"目的端地域ID。","type":"string","example":"cn-hangzhou"},"VbrId":{"title":"边界路由器实例ID。","description":"边界路由器实例ID。","type":"string","example":"vbr-sample*"},"AttachmentId":{"title":"转发路由器链接ID。","description":"转发路由器链接ID。","type":"string","example":"tr-sample*"},"SourceZone":{"title":"探测的源可用区。","description":"探测的源可用区。","type":"string","example":"cn-hangzhou-a"},"DestinationZone":{"title":"探测的目的可用区。","description":"探测的目的可用区。","type":"string","example":"cn-hangzhou-b"},"ByteCount":{"description":"流量数(Byte)。","type":"number","format":"double","example":"1024"},"PacketCount":{"description":"流量包数。","type":"number","format":"double","example":"66"},"RTT":{"description":"延迟，单位**ms**。","type":"number","format":"double","example":"23"},"RetransmitRate":{"description":"TCP报文的重传率。","type":"number","format":"double","example":"0.1"},"InBps":{"description":"入方向带宽，单位：bps。","type":"number","format":"double","example":"10"},"InPps":{"description":"入方向包速率。单位：个/秒。","type":"number","format":"double","example":"3"},"OutBps":{"description":"出方向带宽，单位：bps。","type":"number","format":"double","example":"88"},"OutPps":{"description":"出方向包速率。单位：个/秒。","type":"number","format":"double","example":"8"},"NewSessionPerSecond":{"description":"新建连接数。单位：个/秒。","type":"number","format":"double","example":"18"},"ActiveSessionCount":{"description":"并发连接数。单位：个。","type":"number","format":"double","example":"66"}}}}}}}},"errorCodes":{"400":[{"errorCode":"IllegalParam.BeginTimeAndEndTime","errorMessage":"It only supports querying data for up to 24 hours: %s."},{"errorCode":"OperationFailed.DataTooMuch","errorMessage":"Too much data has been queried under the specified conditions. Shorten the query time, specify more precise filtering conditions, or try again later."},{"errorCode":"IllegalParam.OrderBy","errorMessage":"The specified param of orderBy (%s) is invalid."},{"errorCode":"IllegalParam.ResourceType","errorMessage":"The specified resourceType (%s) is invalid."},{"errorCode":"IllegalParam.GroupBy","errorMessage":"The specified param of GroupBy (%s) is invalid."},{"errorCode":"IllegalParam.Direction","errorMessage":"The specified direction (%s) is invalid."},{"errorCode":"IllegalParam.Filter.InstanceId","errorMessage":"The specified InstanceId(%s) is illegal."},{"errorCode":"IllegalParam.BeginTimeAndEndTime5M","errorMessage":"It only supports querying data for up to 5 minute when TupleType is 5 and the CloudIp and OtherIp are both empty: %s."}],"404":[{"errorCode":"ResourceNotFound.InstanceId","errorMessage":"The specified InstanceId(%s) does not exist."},{"errorCode":"ResourceNotFound.IpSets","errorMessage":"The specified instance does not exist or does not have any acceleration region."}]},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"A7F0D6EC-E19E-58AC-AC9F-08036763960F\\\",\\n  \\\"Data\\\": [\\n    {\\n      \\\"RegionNo\\\": \\\"cn-shenzhen\\\",\\n      \\\"InstanceId\\\": \\\"eip-sample*\\\",\\n      \\\"BandwidthPackageId\\\": \\\"cbwp-sample*\\\",\\n      \\\"SourceIp\\\": \\\"42.120.XX.XX\\\",\\n      \\\"SourcePort\\\": \\\"443\\\",\\n      \\\"SourceIsp\\\": \\\"移动\\\",\\n      \\\"DestinationIp\\\": \\\"2.2.XX.XX\\\",\\n      \\\"DestinationPort\\\": \\\"80\\\",\\n      \\\"DestinationIsp\\\": \\\"阿里云\\\",\\n      \\\"Protocol\\\": \\\"6\\\",\\n      \\\"Country\\\": \\\"中国\\\",\\n      \\\"Province\\\": \\\"四川省\\\",\\n      \\\"City\\\": \\\"成都市\\\",\\n      \\\"Isp\\\": \\\"移动\\\",\\n      \\\"Asn\\\": \\\"129103\\\",\\n      \\\"IP\\\": \\\"120.238.XX.XX\\\",\\n      \\\"DestinationRegionNo\\\": \\\"cn-hangzhou\\\",\\n      \\\"VbrId\\\": \\\"vbr-sample*\\\",\\n      \\\"AttachmentId\\\": \\\"tr-sample*\\\",\\n      \\\"SourceZone\\\": \\\"cn-hangzhou-a\\\",\\n      \\\"DestinationZone\\\": \\\"cn-hangzhou-b\\\",\\n      \\\"ByteCount\\\": 1024,\\n      \\\"PacketCount\\\": 66,\\n      \\\"RTT\\\": 23,\\n      \\\"RetransmitRate\\\": 0.1,\\n      \\\"InBps\\\": 10,\\n      \\\"InPps\\\": 3,\\n      \\\"OutBps\\\": 88,\\n      \\\"OutPps\\\": 8,\\n      \\\"NewSessionPerSecond\\\": 18,\\n      \\\"ActiveSessionCount\\\": 66\\n    }\\n  ]\\n}\",\"type\":\"json\"}]","title":"获取云网络指标排名","description":"支持分析场景： \n\n- NAT网关SNAT IP流量分析场景\n- 公网流量分析场景\n- 跨域流量分析场景\n- 混合云流量分析场景\n- 公网性能观测大盘场景\n- 跨可用区内网性能观测大盘场景\n- 跨地域内网性能观测大盘场景\n###### 各场景的具体使用方式请参见[此文档](https://help.aliyun.com/document_detail/2833347.html)。"}