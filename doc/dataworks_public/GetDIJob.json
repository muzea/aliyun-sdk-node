{"summary":"查看数据集成新版任务，当前支持的任务类型包括：MySQL到Hologres整库实时解决方案。","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get","abilityTreeCode":"154572","abilityTreeNodes":["FEATUREdideQHGTK4"]},"parameters":[{"name":"DIJobId","in":"formData","schema":{"description":"任务ID。","type":"integer","format":"int64","required":true,"example":"11588"}},{"name":"WithDetails","in":"formData","schema":{"description":"是否返回详细配置信息，详细配置信息包括TransformationRules、TableMappings、JobSettings。默认返回。","type":"boolean","required":false,"example":"true"}}],"responses":{"200":{"schema":{"description":"响应。","type":"object","properties":{"Data":{"description":"任务信息。","type":"object","properties":{"ProjectId":{"description":"工作空间的ID。","type":"integer","format":"int64","example":"22"},"DIJobId":{"description":"任务ID。","type":"integer","format":"int64","example":"11588"},"JobName":{"description":"任务名称。","type":"string","example":"mysql_to_holo_sync_445"},"Description":{"description":"描述信息。","type":"string","example":"mysql同步到hologres"},"MigrationType":{"description":"同步类型，可选的枚举值有：\n- FullAndRealtimeIncremental（全量和实时增量）\n- RealtimeIncremental（实时增量）\n- Full（全量）\n- OfflineIncremental（离线增量）\n- FullAndOfflineIncremental（全量+离线增量）","type":"string","enumValueTitles":{},"example":"FullAndRealtimeIncremental"},"SourceDataSourceType":{"description":"源端数据源类型，枚举值：MySQL。","type":"string","enumValueTitles":{},"example":"MySQL"},"DestinationDataSourceType":{"description":"目标端数据源类型，枚举值：Hologres、Hive。","type":"string","enumValueTitles":{},"example":"Hologres"},"SourceDataSourceSettings":{"description":"源端数据源设置，目前仅支持单个数据源。","type":"array","items":{"description":"源端数据源设置。","type":"object","properties":{"DataSourceName":{"description":"数据源名称。","type":"string","example":"mysql_datasource_1"},"DataSourceProperties":{"description":"数据源属性。","type":"object","additionalProperties":{"type":"string","description":"源端数据源属性。 MySQL数据源支持的属性名称包括：TimeZone（时区），Encoding（编码）。","example":"TimeZone"}}}}},"DestinationDataSourceSettings":{"description":"目标端数据源设置，目前仅支持单个数据源。","type":"array","items":{"description":"目标端数据源设置。","type":"object","properties":{"DataSourceName":{"description":"数据源名称。","type":"string","example":"holo_datasource_1"},"DataSourceProperties":{"description":"数据源属性。","type":"object","additionalProperties":{"type":"string","example":"TimeZone","description":"目标端数据源属性。Hologres数据源暂无属性可设置。"}}}}},"ResourceSettings":{"description":"资源设置。","type":"object","properties":{"OfflineResourceSettings":{"description":"离线同步资源。","type":"object","properties":{"ResourceGroupIdentifier":{"description":"离线同步使用的数据集成资源组标识。","type":"string","example":"S_res_group_111_222"}}},"RealtimeResourceSettings":{"description":"实时同步资源。","type":"object","properties":{"ResourceGroupIdentifier":{"description":"实时同步使用的数据集成资源组标识。","type":"string","example":"S_res_group_111_222"}}},"RequestedCu":{"type":"number","format":"float"}}},"TransformationRules":{"description":"同步对象转换规则定义列表，列表中每个元素为一条转换规则定义。","type":"array","items":{"description":"同步对象转换规则定义。","type":"object","properties":{"RuleActionType":{"description":"动作类型，可选的枚举值：\n- DefinePrimaryKey（定义主键）\n- Rename（重命名）\n- AddColumn（增加列）\n- HandleDml（DML处理）\n- DefineIncrementalCondition（定义增量条件）\n- DefineCycleScheduleSettings（定义周期调度设置）\n- DefineRuntimeSettings（定义高级配置参数）\n- DefinePartitionKey（定义分区列）","type":"string","enumValueTitles":{},"example":"Rename"},"RuleExpression":{"description":"规则表达式，json string格式。\n\n- 重命名规则（Rename）示例： `{\"expression\":\"${srcDatasourceName}_${srcDatabaseName}_0922\",\"variables\":\\[{\"variableName\":\"srcDatabaseName\",\"variableRules\":\\[{\"from\":\"fromdb\",\"to\":\"todb\"}\\]}\\]}`\n\n  - expression：为重命名转换规则表达式，表达式内支持变量包括：\n    - ${srcDatasourceName}（源端数据源名）\n    - ${srcDatabaseName}（源端库名）\n    - ${srcTableName}（源端表名）\n  - variables：为重命名转换规则表达式中各变量的生成规则，参数默认值为对应含义在源端的原始值，可按需定义一组字符串替换规则对原始值进行改写。\n    - variableName：变量名，不含${}。\n    - variableRules：变量生成规则组，按顺序串行执行替换，from原始字符串；to替换后字符串。\n\n- 在目标端增加指定列并赋值规则（AddColumn）示例：` {\"columns\":\\[{\"columnName\":\"my_add_column\",\"columnValueType\":\"Constant\",\"columnValue\":\"123\"}\\]}`\n\n  如不指定，默认规则为不加列不复制。\n  - columnName：附加的列名称。\n  - columnValueType：附加的列取值类型，包括Constant（常量）、Variable（变量）。\n  - columnValue：附加的列取值。\n    - 当valueType=Constant时，value为自定义常量，String类型。\n    - 当valueType=Variable时，value为内置变量。内置变量可选值包括：EXECUTE_TIME（执行时间，Long类型）、DB_NAME_SRC（源端数据库名称，String类型）、DATASOURCE_NAME_SRC（源端数据源名称，String类型）、TABLE_NAME_SRC（源端表名，String类型）、DB_NAME_DEST（目标端数据库名称，String类型）、DATASOURCE_NAME_DEST（目标端数据源名称，String类型）、TABLE_NAME_DEST（目标端表名，String类型）、DB_NAME_SRC_TRANSED（转换后的数据库名称，String类型）。\n\n- 指定目标端表的主键列列名（DefinePrimaryKey）示例：` {\"columns\":\\[\"ukcolumn1\",\"ukcolumn2\"\\]}`\n\n  如不指定默认使用源端主键列。\n  - 当目标端为已有表：数据集成系统不会修改目标端表结构，如果指定的主键列不在目标端的列集合中，任务启动会报错提示。\n  - 当目标端为自动建表：数据集成系统会自动创建目标端表结构，表结构包含定义的主键列。当指定的主键列不在目标端的列集合中时，任务启动会报错提示。\n\n- DML处理规则（HandleDml）示例： `{\"dmlPolicies\":\\[{\"dmlType\":\"Delete\",\"dmlAction\":\"Filter\",\"filterCondition\":\"id > 1\"}\\]}`\n\n  如不指定，默认规则为Insert、Update、Delete均为Normal。\n  - dmlType：DML操作类型，Insert（插入）、Update（更新）、Delete（删除）。\n  - dmlAction：DML处理策略，Normal（正常处理）、Ignore（忽略）、Filter（有条件的正常处理，当dmlType=Update/Delete时使用）、LogicalDelete（逻辑删除）。\n  - filterCondition：DML过滤条件，当dmlAction=Filter时使用。","type":"string","example":"{\"expression\":\"${srcDatasoureName}_${srcDatabaseName}\"}"},"RuleName":{"description":"规则名称，当动作类型和动作作用的目标类型相同时，规则名称需保证唯一性。","type":"string","example":"rename_rule_1"},"RuleTargetType":{"description":"动作作用的目标类型，可选的数据类型有：\n- Table（表）\n- Schema（schema）","type":"string","enumValueTitles":{},"example":"Table"}}}},"TableMappings":{"description":"同步对象转换映射列表，列表中每个元素描述了一组源端同步对象选择规则列表和在该组同步对象上应用的同步对象转换规则列表。","type":"array","items":{"description":"同步对象转换映射。","type":"object","properties":{"SourceObjectSelectionRules":{"description":"源端对象选择规则，支持多条。","type":"array","items":{"description":"每条规则可选择待同步源端对象的不同对象类型，如选择源端数据库、源端数据表。","type":"object","properties":{"Expression":{"description":"表达式。","type":"string","example":"mysql_table_1"},"ObjectType":{"description":"对象类型，可选的枚举值有：\n- Table（表）\n- Database（数据库）","type":"string","enumValueTitles":{},"example":"Table"}}}},"TransformationRules":{"description":"源端对象上应用的转换规则列表。","type":"array","items":{"description":"源端对象上应用的转换规则。","type":"object","properties":{"RuleActionType":{"description":"动作类型，可选的枚举值：\n- DefinePrimaryKey（定义主键）\n- Rename（重命名）\n- AddColumn（增加列）\n- HandleDml（DML处理）\n- DefineIncrementalCondition（定义增量条件）\n- DefineCycleScheduleSettings（定义周期调度设置）\n- DefineRuntimeSettings（定义高级配置参数）\n- DefinePartitionKey（定义分区列）","type":"string","enumValueTitles":{},"example":"Rename"},"RuleName":{"description":"规则名称，在一种动作类型+动作作用的目标类型下规则名称唯一。","type":"string","example":"rename_rule_1"},"RuleTargetType":{"description":"动作作用的目标类型，可选的枚举值有：\n- Table（表）\n- Schema（schema）","type":"string","enumValueTitles":{},"example":"Table"}}}}}}},"JobSettings":{"description":"同步任务维度的设置，含DDL处理策略、源端和目标端列数据类型映射策略、任务运行时参数等。","type":"object","properties":{"ColumnDataTypeSettings":{"description":"列类型映射，支持多值。","type":"array","items":{"description":"列类型映射。","type":"object","properties":{"SourceDataType":{"description":"源端类型。","type":"string","example":"bigint"},"DestinationDataType":{"description":"目标端类型。","type":"string","example":"text"}}}},"DdlHandlingSettings":{"description":"DDL处理设置，支持多值。","type":"array","items":{"description":"DDL处理设置。","type":"object","properties":{"Action":{"description":"处理动作，可选的枚举值：\n- Ignore（忽略）\n- Critical（报错）\n- Normal（正常处理）","type":"string","enumValueTitles":{},"example":"Critical"},"Type":{"description":"DDL类型，可选的枚举值：\n- RenameColumn（重命名列）\n- ModifyColumn（更新列）\n- CreateTable（新建表）\n- TruncateTable（清空表）\n- DropTable（删除表）\n- DropColumn（删除列）\n- AddColumn（新增列）","type":"string","enumValueTitles":{},"example":"AddColumn"}}}},"RuntimeSettings":{"description":"运行时设置，支持多值。","type":"array","items":{"description":"运行时设置。","type":"object","properties":{"Name":{"description":"设置名称，可选的枚举值：\n- runtime.offline.speed.limit.mb（离线批量任务限流大小，当runtime.offline.speed.limit.enable=true时有效）\n- runtime.offline.speed.limit.enable（离线批量任务是否开启限流）\n- dst.offline.connection.max（离线批量任务写端最大连接数）\n- runtime.offline.concurrent（离线批量同步任务并发度）\n- dst.realtime.connection.max（实时任务写端最大连接数）\n- runtime.enable.auto.create.schema（是否自动在目标端创建schema）\n- src.offline.datasource.max.connection（离线批量任务源端最大连接数）\n- runtime.realtime.concurrent（实时任务并发度）","type":"string","enumValueTitles":{},"example":"runtime.offline.concurrent"},"Value":{"description":"设置取值。","type":"string","example":"1"}}}},"CycleScheduleSettings":{"description":"周期调度设置。","type":"object","properties":{"CycleMigrationType":{"description":"需要周期调度的同步类型。取值范围：\n- Full：全量\n- OfflineIncremental：离线增量","type":"string","example":"Full"},"ScheduleParameters":{"description":"调度参数。","type":"string","example":"bizdate=$bizdate"}}},"ChannelSettings":{"description":"通道相关任务设置，Json String形式。","type":"string","example":"{\"structInfo\":\"MANAGED\",\"storageType\":\"TEXTFILE\",\"writeMode\":\"APPEND\",\"partitionColumns\":[{\"columnName\":\"pt\",\"columnType\":\"STRING\",\"comment\":\"\"}],\"fieldDelimiter\":\"\"}\n"}}},"CreatedTime":{"description":"创建时间戳，单位秒。","type":"integer","format":"int64","example":"1671516776"},"CreatedUid":{"description":"创建者用户ID。","type":"string","example":"100000001"},"UpdatedTime":{"description":"最近一次更新时间戳，单位秒。","type":"integer","format":"int64","example":"1673859985"},"UpdatedUid":{"description":"最近一次更新者用户ID。","type":"string","example":"100000001"},"StartedTime":{"description":"最近一次启动时间戳，单位秒。","type":"integer","format":"int64","example":"1673859999"},"StartedUid":{"description":"最近一次启动者用户ID。","type":"string","example":"100000001"},"JobStatus":{"description":"同步状态，可选的枚举值：\n- Finished（运行成功已结束）\n- Initialized（初始化完成）\n- Stopped（已停止）\n- Failed（运行失败）\n- Running（运行中）\n- Stopping（停止中）","type":"string","enumValueTitles":{},"example":"Finished"},"ErrorMessage":{"description":"错误信息，当JobStatus=Failed时使用。","type":"string","example":"error details xxx"},"RunStats":{"description":"运行统计信息","type":"object","additionalProperties":{"type":"string","description":"运行统计信息详情。\n- StructureMigrationTotalTables：结构同步表总数\n- StructureMigrationSuccessTables：结构同步表成功数\n- StructureMigrationFailedTables：结构同步表失败数\n- StructureMigrationStatus：结构同步状态，Waiting、Running、Finished、Failed、Stopped\n- StructureMigrationErrorMessage：结构同步错误信息\n- FullMigrationTotalTables：全量同步表总数\n- FullMigrationSuccessTables：全量同步表成功数\n- FullMigrationFailedTables：全量同步表失败数\n- FullMigrationStatus：全量同步状态\n- FullMigrationErrorMessage：全量同步错误信息\n- RealtimeMigrationMaxDelay：实时同步延迟时长，单位毫秒\n- RealtimeMigrationStatus：实时同步状态\n- RealtimeMigrationErrorMessage：实时已同步错误信息","example":"StructureMigrationTotalTables"}}}},"RequestId":{"description":"请求ID。","type":"string","example":"0000-ABCD-EFG****"}}}}},"errorCodes":{"429":[{"errorCode":"Throttling.Api","errorMessage":"The request for this resource has exceeded your available limit."},{"errorCode":"Throttling.System","errorMessage":"The DataWorks system is busy. Try again later."},{"errorCode":"Throttling.User","errorMessage":"Your request is too frequent. Try again later."}],"500":[{"errorCode":"InternalError.System","errorMessage":"An internal system error occurred. Try again later."},{"errorCode":"InternalError.UserId.Missing","errorMessage":"An internal system error occurred. Try again later."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Data\\\": {\\n    \\\"ProjectId\\\": 22,\\n    \\\"DIJobId\\\": 11588,\\n    \\\"JobName\\\": \\\"mysql_to_holo_sync_445\\\",\\n    \\\"Description\\\": \\\"mysql同步到hologres\\\",\\n    \\\"MigrationType\\\": \\\"FullAndRealtimeIncremental\\\",\\n    \\\"SourceDataSourceType\\\": \\\"MySQL\\\",\\n    \\\"DestinationDataSourceType\\\": \\\"Hologres\\\",\\n    \\\"SourceDataSourceSettings\\\": [\\n      {\\n        \\\"DataSourceName\\\": \\\"mysql_datasource_1\\\",\\n        \\\"DataSourceProperties\\\": {\\n          \\\"key\\\": \\\"TimeZone\\\"\\n        }\\n      }\\n    ],\\n    \\\"DestinationDataSourceSettings\\\": [\\n      {\\n        \\\"DataSourceName\\\": \\\"holo_datasource_1\\\",\\n        \\\"DataSourceProperties\\\": {\\n          \\\"key\\\": \\\"TimeZone\\\"\\n        }\\n      }\\n    ],\\n    \\\"ResourceSettings\\\": {\\n      \\\"OfflineResourceSettings\\\": {\\n        \\\"ResourceGroupIdentifier\\\": \\\"S_res_group_111_222\\\"\\n      },\\n      \\\"RealtimeResourceSettings\\\": {\\n        \\\"ResourceGroupIdentifier\\\": \\\"S_res_group_111_222\\\"\\n      },\\n      \\\"RequestedCu\\\": 0\\n    },\\n    \\\"TransformationRules\\\": [\\n      {\\n        \\\"RuleActionType\\\": \\\"Rename\\\",\\n        \\\"RuleExpression\\\": \\\"{\\\\\\\"expression\\\\\\\":\\\\\\\"${srcDatasoureName}_${srcDatabaseName}\\\\\\\"}\\\",\\n        \\\"RuleName\\\": \\\"rename_rule_1\\\",\\n        \\\"RuleTargetType\\\": \\\"Table\\\"\\n      }\\n    ],\\n    \\\"TableMappings\\\": [\\n      {\\n        \\\"SourceObjectSelectionRules\\\": [\\n          {\\n            \\\"Expression\\\": \\\"mysql_table_1\\\",\\n            \\\"ObjectType\\\": \\\"Table\\\"\\n          }\\n        ],\\n        \\\"TransformationRules\\\": [\\n          {\\n            \\\"RuleActionType\\\": \\\"Rename\\\",\\n            \\\"RuleName\\\": \\\"rename_rule_1\\\",\\n            \\\"RuleTargetType\\\": \\\"Table\\\"\\n          }\\n        ]\\n      }\\n    ],\\n    \\\"JobSettings\\\": {\\n      \\\"ColumnDataTypeSettings\\\": [\\n        {\\n          \\\"SourceDataType\\\": \\\"bigint\\\",\\n          \\\"DestinationDataType\\\": \\\"text\\\"\\n        }\\n      ],\\n      \\\"DdlHandlingSettings\\\": [\\n        {\\n          \\\"Action\\\": \\\"Critical\\\",\\n          \\\"Type\\\": \\\"AddColumn\\\"\\n        }\\n      ],\\n      \\\"RuntimeSettings\\\": [\\n        {\\n          \\\"Name\\\": \\\"runtime.offline.concurrent\\\",\\n          \\\"Value\\\": \\\"1\\\"\\n        }\\n      ],\\n      \\\"CycleScheduleSettings\\\": {\\n        \\\"CycleMigrationType\\\": \\\"Full\\\",\\n        \\\"ScheduleParameters\\\": \\\"bizdate=$bizdate\\\"\\n      },\\n      \\\"ChannelSettings\\\": \\\"{\\\\\\\"structInfo\\\\\\\":\\\\\\\"MANAGED\\\\\\\",\\\\\\\"storageType\\\\\\\":\\\\\\\"TEXTFILE\\\\\\\",\\\\\\\"writeMode\\\\\\\":\\\\\\\"APPEND\\\\\\\",\\\\\\\"partitionColumns\\\\\\\":[{\\\\\\\"columnName\\\\\\\":\\\\\\\"pt\\\\\\\",\\\\\\\"columnType\\\\\\\":\\\\\\\"STRING\\\\\\\",\\\\\\\"comment\\\\\\\":\\\\\\\"\\\\\\\"}],\\\\\\\"fieldDelimiter\\\\\\\":\\\\\\\"\\\\\\\"}\\\\n\\\"\\n    },\\n    \\\"CreatedTime\\\": 1671516776,\\n    \\\"CreatedUid\\\": \\\"100000001\\\",\\n    \\\"UpdatedTime\\\": 1673859985,\\n    \\\"UpdatedUid\\\": \\\"100000001\\\",\\n    \\\"StartedTime\\\": 1673859999,\\n    \\\"StartedUid\\\": \\\"100000001\\\",\\n    \\\"JobStatus\\\": \\\"Finished\\\",\\n    \\\"ErrorMessage\\\": \\\"error details xxx\\\",\\n    \\\"RunStats\\\": {\\n      \\\"key\\\": \\\"StructureMigrationTotalTables\\\"\\n    }\\n  },\\n  \\\"RequestId\\\": \\\"0000-ABCD-EFG****\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GetDIJobResponse>\\n    <Data>\\n        <ProjectId>22</ProjectId>\\n        <DIJobId>11588</DIJobId>\\n        <JobName>mysql_to_holo_sync_445</JobName>\\n        <Description>mysql同步到hologres</Description>\\n        <MigrationType>FullAndRealtimeIncremental</MigrationType>\\n        <SourceDataSourceType>MySQL</SourceDataSourceType>\\n        <DestinationDataSourceType>Hologres</DestinationDataSourceType>\\n        <SourceDataSourceSettings>\\n            <DataSourceName>mysql_datasource_1</DataSourceName>\\n            <DataSourceProperties>\\n                <key>TimeZone</key>\\n            </DataSourceProperties>\\n        </SourceDataSourceSettings>\\n        <DestinationDataSourceSettings>\\n            <DataSourceName>holo_datasource_1</DataSourceName>\\n            <DataSourceProperties>\\n                <key>TimeZone</key>\\n            </DataSourceProperties>\\n        </DestinationDataSourceSettings>\\n        <ResourceSettings>\\n            <OfflineResourceSettings>\\n                <ResourceGroupIdentifier>S_res_group_111_222</ResourceGroupIdentifier>\\n            </OfflineResourceSettings>\\n            <RealtimeResourceSettings>\\n                <ResourceGroupIdentifier>S_res_group_111_222</ResourceGroupIdentifier>\\n            </RealtimeResourceSettings>\\n        </ResourceSettings>\\n        <TransformationRules>\\n            <RuleActionType>Rename</RuleActionType>\\n            <RuleExpression>{\\\"expression\\\":\\\"${srcDatasoureName}_${srcDatabaseName}\\\"}</RuleExpression>\\n            <RuleName>rename_rule_1</RuleName>\\n            <RuleTargetType>Table</RuleTargetType>\\n        </TransformationRules>\\n        <TableMappings>\\n            <SourceObjectSelectionRules>\\n                <Expression>mysql_table_1</Expression>\\n                <ObjectType>Table</ObjectType>\\n            </SourceObjectSelectionRules>\\n            <TransformationRules>\\n                <RuleActionType>Rename</RuleActionType>\\n                <RuleName>rename_rule_1</RuleName>\\n                <RuleTargetType>Table</RuleTargetType>\\n            </TransformationRules>\\n        </TableMappings>\\n        <JobSettings>\\n            <ColumnDataTypeSettings>\\n                <SourceDataType>bigint</SourceDataType>\\n                <DestinationDataType>text</DestinationDataType>\\n            </ColumnDataTypeSettings>\\n            <DdlHandlingSettings>\\n                <Action>Critical</Action>\\n                <Type>AddColumn</Type>\\n            </DdlHandlingSettings>\\n            <RuntimeSettings>\\n                <Name>runtime.offline.concurrent</Name>\\n                <Value>1</Value>\\n            </RuntimeSettings>\\n        </JobSettings>\\n        <CreatedTime>1671516776</CreatedTime>\\n        <CreatedUid>100000001</CreatedUid>\\n        <UpdatedTime>1673859985</UpdatedTime>\\n        <UpdatedUid>100000001</UpdatedUid>\\n        <StartedTime>1673859999</StartedTime>\\n        <StartedUid>100000001</StartedUid>\\n        <JobStatus>Finished</JobStatus>\\n        <ErrorMessage>error details xxx</ErrorMessage>\\n        <RunStats>\\n            <key>StructureMigrationTotalTables</key>\\n        </RunStats>\\n    </Data>\\n    <RequestId>0000-ABCD-EFG****</RequestId>\\n</GetDIJobResponse>\",\"errorExample\":\"\"}]","title":"查看数据集成新版任务"}