{"summary":"更新数据集成新版任务，当前支持的任务类型包括：MySQL到Hologres整库实时解决方案。","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"write","deprecated":false,"systemTags":{"operationType":"update","abilityTreeCode":"155160","abilityTreeNodes":["FEATUREdideQHGTK4"]},"parameters":[{"name":"DIJobId","in":"formData","schema":{"description":"任务ID。","type":"integer","format":"int64","required":false,"example":"11588"}},{"name":"Description","in":"formData","schema":{"description":"任务描述。","type":"string","required":false,"example":"mysql同步到hologres"}},{"name":"ResourceSettings","in":"formData","style":"json","schema":{"description":"资源设置。","type":"object","properties":{"OfflineResourceSettings":{"description":"离线同步资源。","type":"object","properties":{"ResourceGroupIdentifier":{"description":"离线同步使用的数据集成资源组标识。","type":"string","required":false,"example":"S_res_group_111_222"}},"required":false},"RealtimeResourceSettings":{"description":"实时同步资源。","type":"object","properties":{"ResourceGroupIdentifier":{"description":"实时同步使用的数据集成资源组标识。","type":"string","required":false,"example":"S_res_group_111_222"}},"required":false},"RequestedCu":{"type":"number","format":"float","required":false}},"required":false}},{"name":"TransformationRules","in":"formData","style":"json","schema":{"description":"同步对象转换规则定义列表，列表中每个元素为一条转换规则定义。","type":"array","items":{"description":"同步对象转换规则定义。","type":"object","properties":{"RuleName":{"description":"规则名称，当动作类型和动作作用的目标类型相同时，规则名称需保证唯一性。","type":"string","required":false,"example":"rename_rule_1"},"RuleActionType":{"description":"动作类型，可选的枚举值：\n- DefinePrimaryKey（定义主键）\n- Rename（重命名）\n- AddColumn（增加列）\n- HandleDml（DML处理）","type":"string","required":false,"enumValueTitles":{"DefinePrimaryKey":"定义主键","Rename":"重命名","AddColumn":"增加列","HandleDml":"DML处理"},"example":"Rename"},"RuleTargetType":{"description":"动作作用的目标类型，可选的枚举值：\n- Table（表）\n- Schema（schema）","type":"string","required":false,"enumValueTitles":{"Table":"表","Schema":"schema"},"example":"Table"},"RuleExpression":{"description":"规则表达式，json string格式。\n\n重命名规则（Rename）示例： {\"expression\":\"${srcDatasourceName}_${srcDatabaseName}_0922\",\"variables\":\\[{\"variableName\":\"srcDatabaseName\",\"variableRules\":\\[{\"from\":\"fromdb\",\"to\":\"todb\"}\\]}\\]}\n\nexpression：为重命名转换规则表达式，表达式内支持变量包括：${srcDatasourceName}（源端数据源名）、${srcDatabaseName}（源端库名）、${srcTableName}（源端表名）。\nvariables：为重命名转换规则表达式中各变量的生成规则，参数默认值为对应含义在源端的原始值，可按需定义一组字符串替换规则对原始值进行改写。variableName：变量名，不含${}。variableRules：变量生成规则组，按顺序串行执行替换，from原始字符串；to替换后字符串。\n在目标端增加指定列并赋值规则（AddColumn）示例： {\"columns\":\\[{\"columnName\":\"my_add_column\",\"columnValueType\":\"Constant\",\"columnValue\":\"123\"}\\]}\n\n如不指定，默认规则为不加列不复制。\ncolumnName：附加的列名称。\ncolumnValueType：附加的列取值类型，包括Constant（常量）、Variable（变量）。\ncolumnValue：附加的列取值。当valueType=Constant时，value为自定义常量，String类型。当valueType=Variable时，value为内置变量。内置变量可选值包括：EXECUTE_TIME（执行时间，Long类型）、DB_NAME_SRC（源端数据库名称，String类型）、DATASOURCE_NAME_SRC（源端数据源名称，String类型）、TABLE_NAME_SRC（源端表名，String类型）、DB_NAME_DEST（目标端数据库名称，String类型）、DATASOURCE_NAME_DEST（目标端数据源名称，String类型）、TABLE_NAME_DEST（目标端表名，String类型）、DB_NAME_SRC_TRANSED（转换后的数据库名称，String类型）。\n指定目标端表的主键列列名（DefinePrimaryKey）示例： {\"columns\":\\[\"ukcolumn1\",\"ukcolumn2\"\\]}\n\n如不指定默认使用源端主键列。\n当目标端为已有表：数据集成系统不会修改目标端表结构，如果指定的主键列不在目标端的列集合中，任务启动会报错提示。\n当目标端为自动建表：数据集成系统会自动创建目标端表结构，表结构包含定义的主键列。当指定的主键列不在目标端的列集合中时，任务启动会报错提示。\nDML处理规则（HandleDml）示例： {\"dmlPolicies\":\\[{\"dmlType\":\"Delete\",\"dmlAction\":\"Filter\",\"filterCondition\":\"id > 1\"}\\]}\n\n如不指定，默认规则为Insert、Update、Delete均为Normal\ndmlType：DML操作类型，Insert（插入）、Update（更新）、Delete（删除）\ndmlAction：DML处理策略，Normal（正常处理）、Ignore（忽略）、Filter（有条件的正常处理，当dmlType=Update/Delete时使用）、LogicalDelete（逻辑删除）\nfilterCondition：DML过滤条件，当dmlAction=Filter时使用","type":"string","required":false,"example":"{\"expression\":\"${srcDatasoureName}_${srcDatabaseName}\"}"}},"required":false},"required":false}},{"name":"TableMappings","in":"formData","style":"json","schema":{"description":"同步对象转换映射列表，列表中每个元素描述了一组源端同步对象选择规则列表和在该组同步对象上应用的同步对象转换规则列表。","type":"array","items":{"description":"同步对象转换映射。","type":"object","properties":{"SourceObjectSelectionRules":{"description":"源端对象选择规则，支持多条。","type":"array","items":{"description":"每条规则可选择待同步源端对象的不同对象类型，如选择源端数据库、源端数据表。","type":"object","properties":{"ObjectType":{"description":"对象类型，可选的枚举值：\n- Table（表）\n- Database（数据库）","type":"string","required":false,"enumValueTitles":{"Table":"表","Database":"数据库"},"example":"Table"},"Expression":{"description":"表达式。","type":"string","required":false,"example":"mysql_table_1"}},"required":false},"required":false},"TransformationRules":{"description":"源端对象上应用的转换规则列表。","type":"array","items":{"description":"源端对象上应用的转换规则。","type":"object","properties":{"RuleName":{"description":"规则名称，在一种动作类型+动作作用的目标类型下规则名称唯一。","type":"string","required":false,"example":"rename_rule_1"},"RuleActionType":{"description":"动作类型，可选的枚举值：\n- DefinePrimaryKey（定义主键）\n- Rename（重命名）\n- AddColumn（增加列）\n- HandleDml（DML处理）","type":"string","required":false,"enumValueTitles":{"DefinePrimaryKey":"定义主键","Rename":"重命名","AddColumn":"增加列","HandleDml":"DML处理"},"example":"Rename"},"RuleTargetType":{"description":"动作作用的目标类型，可选的枚举值;\n- Table（表）\n- Schema（schema）","type":"string","required":false,"enumValueTitles":{"Table":"表","Schema":"schema"},"example":"Table"}},"required":false},"required":false}},"required":false},"required":false}},{"name":"JobSettings","in":"formData","style":"json","schema":{"description":"同步任务维度的设置，含DDL处理策略、源端和目标端列数据类型映射策略、任务运行时参数等。","type":"object","properties":{"DdlHandlingSettings":{"description":"DDL处理设置，支持多值。","type":"array","items":{"description":"DDL处理设置。","type":"object","properties":{"Type":{"description":"DDL类型，可选的枚举值;\n- RenameColumn（重命名列）\n- ModifyColumn（更新列）\n- CreateTable（新建表）\n- TruncateTable（清空表）\n- DropTable（删除表）\n- DropColumn（删除列）\n- AddColumn（新增列）","type":"string","required":false,"enumValueTitles":{"RenameColumn":"重命名列","ModifyColumn":"更新列","CreateTable":"新建表","TruncateTable":"清空表","DropTable":"删除表","DropColumn":"删除列","AddColumn":"新增列"},"example":"AddColumn"},"Action":{"description":"处理动作，可选的枚举值：\n- Ignore（忽略）\n- Critical（报错）\n- Normal（正常处理）","type":"string","required":false,"enumValueTitles":{"Ignore":"忽略","Critical":"报错","Normal":"正常处理"},"example":"Critical"}},"required":false},"required":false},"ColumnDataTypeSettings":{"description":"列类型映射，支持多值。","type":"array","items":{"description":"列类型映射。","type":"object","properties":{"SourceDataType":{"description":"源端类型。","type":"string","required":false,"example":"bigint"},"DestinationDataType":{"description":"目标端类型。","type":"string","required":false,"example":"text"}},"required":false},"required":false},"RuntimeSettings":{"description":"运行时设置，支持多值。","type":"array","items":{"description":"运行时设置。","type":"object","properties":{"Name":{"description":"设置名称，可选的枚举值：\n\t\n- runtime.offline.speed.limit.mb（离线批量任务限流大小，当runtime.offline.speed.limit.enable=true时有效）\n- runtime.offline.speed.limit.enable（离线批量任务是否开启限流）\n- dst.offline.connection.max（离线批量任务写端最大连接数）\n- runtime.offline.concurrent（离线批量同步任务并发度）\n- dst.realtime.connection.max（实时任务写端最大连接数）\n- runtime.enable.auto.create.schema（是否自动在目标端创建schema）\n- src.offline.datasource.max.connection（离线批量任务源端最大连接数）\n- runtime.realtime.concurrent（实时任务并发度）","type":"string","required":false,"enumValueTitles":{"runtime.offline.speed.limit.mb":"离线批量任务限流大小，当runtime.offline.speed.limit.enable=true时有效","runtime.offline.speed.limit.enable":"离线批量任务是否开启限流","dst.offline.connection.max":"离线批量任务写端最大连接数","runtime.offline.concurrent":"离线批量同步任务并发度","dst.realtime.connection.max":"实时任务写端最大连接数","runtime.enable.auto.create.schema":"是否自动在目标端创建schema","src.offline.datasource.max.connection":"离线批量任务源端最大连接数","runtime.realtime.concurrent":"实时任务并发度"},"example":"runtime.offline.concurrent"},"Value":{"description":"设置取值。","type":"string","required":false,"example":"1"}},"required":false},"required":false},"CycleScheduleSettings":{"type":"object","properties":{"ScheduleParameters":{"type":"string","required":false}},"required":false},"ChannelSettings":{"type":"string","required":false}},"required":false}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"响应。","type":"object","properties":{"RequestId":{"title":"Id of the request","description":"请求ID。","type":"string","example":"AAC30B35-820D-5F3E-A42C-E96BB6379325"}}}}},"errorCodes":{"429":[{"errorCode":"Throttling.Api","errorMessage":"The request for this resource has exceeded your available limit."},{"errorCode":"Throttling.System","errorMessage":"The DataWorks system is busy. Try again later."},{"errorCode":"Throttling.User","errorMessage":"Your request is too frequent. Try again later."}],"500":[{"errorCode":"InternalError.System","errorMessage":"An internal system error occurred. Try again later."},{"errorCode":"InternalError.UserId.Missing","errorMessage":"An internal system error occurred. Try again later."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"AAC30B35-820D-5F3E-A42C-E96BB6379325\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<UpdateDIJobResponse>\\n    <RequestId>AAC30B35-820D-5F3E-A42C-E96BB6379325</RequestId>\\n</UpdateDIJobResponse>\",\"errorExample\":\"\"}]","title":"更新数据集成新版任务"}