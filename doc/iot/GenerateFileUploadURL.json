{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"create"},"parameters":[{"name":"IotInstanceId","in":"query","schema":{"description":"实例ID。\n\n您可在物联网平台控制台的**实例概览**页面，查看当前实例的**ID**。若有ID值，必须传入该ID值，否则调用会失败。\n\n> 如果公共实例没有ID值，请参见[如何获取实例ID](~~267533~~)。","type":"string","required":false,"example":"iot-cn-0pp1n8t****"}},{"name":"FileSuffix","in":"query","schema":{"description":"文件扩展名。可选：**bin**、**apk**、**tar**、**gz**、**tar.gz**、**zip**、**gzip**。\n","type":"string","required":true,"example":"bin"}},{"name":"BizCode","in":"query","schema":{"description":"文件所属的业务场景编码。\n\n设备任务文件使用**DEVICE_JOB_FILE**。","type":"string","required":true,"example":"DEVICE_JOB_FILE"}},{"name":"FileName","in":"query","schema":{"description":"文件名称。名称不可包含短划线（-）、英文句号（.）、星号（*）、正斜线（/）、井号（#）、百分号（%）、and（&）、at（@）、反斜线（\\），长度不可超过64个字符。\n\n如果不传入该参数，系统将为文件自动生成随机字符串作为文件名称。","type":"string","required":false,"example":"file1"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"调用失败时，返回的错误码。更多信息，请参见[错误码](~~87387~~)。","type":"string","example":"iot.system.SystemException"},"ErrorMessage":{"description":"调用失败时，返回的出错信息。","type":"string","example":"系统异常"},"RequestId":{"description":"阿里云为该请求生成的唯一标识符。","type":"string","example":"E55E50B7-40EE-4B6B-8BBE-D3ED55CCF565"},"Success":{"description":"表示是否调用成功。\n- **true**：调用成功。\n- **false**：调用失败。","type":"boolean","example":"true"},"Data":{"description":"调用成功时，返回的文件上传信息。详情参见以下参数信息。","type":"object","properties":{"Key":{"description":"调用OSS的PostObject接口上传对象（即文件）的名称，包含OSS对象的完整路径。","type":"string","example":"subpath/65dfcda0473be29836dfde585472****/ck2nfzljo00023g7kysg0****.suffix"},"OssAccessKeyId":{"description":"OSS Bucket拥有者的AccessKey ID。\n\n该OSS Bucket将存储文件。","type":"string","example":"cS8uRRy54Rsz****"},"Signature":{"description":"根据**AccessKey Secret**和**Policy**计算出的签名信息。调用OSS API时，OSS验证该签名信息，从而确认Post请求的合法性。","type":"string","example":"v6lViO4FBvfquajQjg20K5hK****"},"Host":{"description":"OSS的接入域名。","type":"string","example":"https://iotx-bucket-name.oss-***.aliyuncs.com"},"Policy":{"description":"OSS通过该参数验证请求表单域的合法性。","type":"string","example":"eyJleHBpcmF****"},"ObjectStorage":{"description":"对象存储类型。默认为OSS。","type":"string","example":"OSS"}}}}}}},"errorCodes":{},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Code\\\": \\\"iot.system.SystemException\\\",\\n  \\\"ErrorMessage\\\": \\\"系统异常\\\",\\n  \\\"RequestId\\\": \\\"E55E50B7-40EE-4B6B-8BBE-D3ED55CCF565\\\",\\n  \\\"Success\\\": true,\\n  \\\"Data\\\": {\\n    \\\"Key\\\": \\\"subpath/65dfcda0473be29836dfde585472****/ck2nfzljo00023g7kysg0****.suffix\\\",\\n    \\\"OssAccessKeyId\\\": \\\"cS8uRRy54Rsz****\\\",\\n    \\\"Signature\\\": \\\"v6lViO4FBvfquajQjg20K5hK****\\\",\\n    \\\"Host\\\": \\\"https://iotx-bucket-name.oss-***.aliyuncs.com\\\",\\n    \\\"Policy\\\": \\\"eyJleHBpcmF****\\\",\\n    \\\"ObjectStorage\\\": \\\"OSS\\\"\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GenerateFileUploadURLResponse>\\n<RequestId>E55E50B7-40EE-4B6B-8BBE-D3ED55CCF565</RequestId>\\n<Data>\\n    <Policy>eyJleHBpcmF****</Policy>\\n    <Signature>v6lViO4FBvfquajQjg20K5hK****</Signature>\\n    <ObjectStorage>OSS</ObjectStorage>\\n    <Host>https://iotx-bucket-name.oss-***.aliyuncs.com</Host>\\n    <OssAccessKeyId>cS8uRRy54Rsz****</OssAccessKeyId>\\n    <Key>subpath/65dfcda0473be29836dfde585472****/ck2nfzljo00023g7kysg0****.suffix</Key>\\n</Data>\\n<Success>true</Success>\\n</GenerateFileUploadURLResponse>\",\"errorExample\":\"\"}]","title":"生成文件上传到OSS的信息","summary":"调用该接口生成文件上传到OSS的信息。","description":"## 使用说明\n\n该接口为阿里云物联网平台中，设备管理相关业务通用的文件上传接口，文件上传完成后，请按照对应业务接口的要求传递文件的信息。\n\n步骤如下：\n\n1. 调用本接口生成文件上传到对象存储（OSS）的信息。\n本接口的返回参数是调用OSS [PostObject](~~31988~~)上传文件的请求参数，包含**Key**、**OSSAccessKeyId**、**Signature**和**Policy**。\n\n2. 请在本接口返回结果后的1分钟之内，使用[OSS SDK](~~52834~~)调用[PostObject](~~31988~~)接口上传文件。上传文件的代码示例，请参见下文“返回参数的用途”。\n\n    > 本接口返回的参数信息有效期为1分钟，请在1分钟内上传文件。上传的文件大小不能超过1,000 MB。\n\n\n3. 文件上传完成后，请在60分钟内，调用对应业务接口，否则上传的文件将被系统定期自动清理。\n\n例如，创建自定义类型的设备任务时，如果需要传入设备文件，请先使用该接口上传文件，再把相关的文件信息作为请求参数，来调用[CreateJob](~~198574~~)接口。\n    \n\n## 限制说明\n\n单个阿里云账号调用该接口的每秒请求数（QPS）最大限制为5。\n\n  > RAM用户共享阿里云账号配额。\n","requestParamsDescription":"调用API时，除了本文介绍的该API的特有请求参数，还需传入公共请求参数。公共请求参数说明，请参见[公共参数文档](~~30561~~)。","responseParamsDescription":"## 返回参数的用途\n\n调用OSS [PostObject](~~31988~~)接口时，使用本接口的返回参数值作为请求参数值，将您编辑好的文件上传到对象存储（OSS）。\n\n关于上传文件的SDK示例，请参见[文件上传](~~84788~~)。\n\n以下是向对象存储OSS上传文件的Java代码示例。\n\n- 在pom.xml中添加以下依赖。\n```<dependency>\n  <groupId>org.apache.httpcomponents</groupId>\n  <artifactId>httpclient</artifactId>\n  <version>4.5.3</version>\n</dependency>\n\n<dependency>\n  <groupId>org.apache.httpcomponents</groupId>\n  <artifactId>httpmime</artifactId>\n  <version>4.5.10</version>\n</dependency>\n```\n\n- 上传文件的代码如下。\n```\npublic static boolean postObject(String key,\n                                  String host,\n                                  String policy,\n                                  String ossAccessKeyId,\n                                  String signature,\n                                  String data) throws IOException {\n  CloseableHttpClient httpClient = HttpClients.createDefault();\n  HttpPost uploadFile = new HttpPost(host);\n\n  MultipartEntityBuilder builder = MultipartEntityBuilder.create();\n  builder.addTextBody(\"key\", key, ContentType.TEXT_PLAIN);\n  builder.addTextBody(\"policy\", policy, ContentType.TEXT_PLAIN);\n  builder.addTextBody(\"OSSAccessKeyId\", ossAccessKeyId, ContentType.TEXT_PLAIN);\n  builder.addTextBody(\"signature\", signature, ContentType.TEXT_PLAIN);\n  builder.addTextBody(\"success_action_status\", \"200\", ContentType.TEXT_PLAIN);\n  builder.addBinaryBody(\"file\", data.getBytes());\n\n  HttpEntity multipart = builder.build();\n  uploadFile.setEntity(multipart);\n  CloseableHttpResponse response = httpClient.execute(uploadFile);\n\n  if (response.getStatusLine().getStatusCode() == 200) {\n    return true;\n  }\n\n  return false;\n}\n```","extraInfo":" "}