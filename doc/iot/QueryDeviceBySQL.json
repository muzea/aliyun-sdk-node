{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"get"},"parameters":[{"name":"IotInstanceId","in":"query","schema":{"description":"实例ID。您可在物联网平台控制台的**实例概览**页面，查看当前实例的**ID**。\n\n><notice>\n- 若有ID值，必须传入该**ID**值，否则调用会失败。\n- 若无**实例概览**页面或**ID**值，则无需传入。\n\n></notice>\n\n实例的更多信息，请参见[实例概述](~~356505~~)。","type":"string","required":false,"example":"iot-cn-0pp1n8t****"}},{"name":"SQL","in":"query","schema":{"description":"查询设备的类SQL语句。具体要求和示例见下文请求参数补充说明。","type":"string","required":true,"example":"SELECT * FROM device where product_key = \"a1*********\" limit 100, 20"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"调用失败时，返回的错误码。更多信息，请参见[错误码](~~87387~~)。","type":"string","example":"iot.system.SystemException"},"ErrorMessage":{"description":"调用失败时，返回的出错信息。","type":"string","example":"系统异常"},"RequestId":{"description":"阿里云为该请求生成的唯一标识符。","type":"string","example":"E55E50B7-40EE-4B6B-8BBE-D3ED55CCF565"},"TotalCount":{"description":"当SELECT子句为`SELECT count(*) FROM device`时，返回的count计数。","type":"integer","format":"int64","example":"100"},"Success":{"description":"是否调用成功。\n- **true**：调用成功。\n- **false**：调用失败。","type":"boolean","example":"true"},"Data":{"description":"调用成功时，返回的设备信息。","type":"array","items":{"type":"object","properties":{"Status":{"description":"设备状态。返回值：\n\n- **ONLINE**：在线。\n- **OFFLINE**：离线。\n- **UNACTIVE**：未激活。\n- **DISABLE**：已禁用。\n","type":"string","example":"ONLINE"},"ProductKey":{"description":"设备所属产品**ProductKey**。","type":"string","example":"a1BwAGV****\t"},"DeviceName":{"description":"设备名称。","type":"string","example":"light"},"GmtCreate":{"description":"设备创建时间，GMT格式。","type":"string","example":"2020-04-04 16:38:17.000"},"Nickname":{"description":"设备的备注名称。","type":"string","example":"智能灯设备"},"ActiveTime":{"description":"设备激活时间，GMT格式。","type":"string","example":"2020-04-04 16:38:18.607"},"GmtModified":{"description":"设备信息最后一次更新时间，GMT格式。","type":"string","example":"2020-04-04 16:38:19.000"},"IotId":{"description":"设备ID。物联网平台为该设备颁发的ID，设备的唯一标识符。","type":"string","example":"Q7uOhVRdZRRlDnTLv****00100\t"},"Groups":{"description":"设备分组信息。","type":"array","items":{"type":"object","properties":{"GroupId":{"description":"分组ID。","type":"string","example":"a1d21d2fas"}}}},"Tags":{"description":"设备标签信息。","type":"array","items":{"type":"object","properties":{"TagName":{"description":"标签名。","type":"string","example":"Color"},"TagValue":{"description":"标签值。","type":"string","example":"Red"}}}},"OTAModules":{"description":"设备的模块固件信息列表。","type":"array","items":{"type":"object","properties":{"ModuleName":{"description":"OTA模块名称。\n","type":"string","example":"SomeSampleModule"},"FirmwareVersion":{"description":"OTA模块版本号。","type":"string","example":"a1-dads2-dad2"}}}}}}}}}}},"errorCodes":{},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Code\\\": \\\"iot.system.SystemException\\\",\\n  \\\"ErrorMessage\\\": \\\"系统异常\\\",\\n  \\\"RequestId\\\": \\\"E55E50B7-40EE-4B6B-8BBE-D3ED55CCF565\\\",\\n  \\\"TotalCount\\\": 100,\\n  \\\"Success\\\": true,\\n  \\\"Data\\\": [\\n    {\\n      \\\"Status\\\": \\\"ONLINE\\\",\\n      \\\"ProductKey\\\": \\\"a1BwAGV****\\\\t\\\",\\n      \\\"DeviceName\\\": \\\"light\\\",\\n      \\\"GmtCreate\\\": \\\"2020-04-04 16:38:17.000\\\",\\n      \\\"Nickname\\\": \\\"智能灯设备\\\",\\n      \\\"ActiveTime\\\": \\\"2020-04-04 16:38:18.607\\\",\\n      \\\"GmtModified\\\": \\\"2020-04-04 16:38:19.000\\\",\\n      \\\"IotId\\\": \\\"Q7uOhVRdZRRlDnTLv****00100\\\\t\\\",\\n      \\\"Groups\\\": [\\n        {\\n          \\\"GroupId\\\": \\\"a1d21d2fas\\\"\\n        }\\n      ],\\n      \\\"Tags\\\": [\\n        {\\n          \\\"TagName\\\": \\\"Color\\\",\\n          \\\"TagValue\\\": \\\"Red\\\"\\n        }\\n      ],\\n      \\\"OTAModules\\\": [\\n        {\\n          \\\"ModuleName\\\": \\\"SomeSampleModule\\\",\\n          \\\"FirmwareVersion\\\": \\\"a1-dads2-dad2\\\"\\n        }\\n      ]\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<QueryDeviceBySQLResponse>\\n<RequestId>501CFABA-2C48-468D-B88C-3AA8E3B3A8F3</RequestId>\\n<Data>\\n    <Status>OFFLINE</Status>\\n    <IotId>ii1*******</IotId>\\n    <GmtCreate>2020-04-04 16:38:17.000</GmtCreate>\\n    <ActiveTime>2020-04-04 16:38:18.607</ActiveTime>\\n    <GmtModified>2020-04-04 16:38:19.000</GmtModified>\\n    <ProductKey>a1*********</ProductKey>\\n    <DeviceName>testDevcieae7f3a</DeviceName>\\n</Data>\\n<Data>\\n    <Status>UNACTIVE</Status>\\n    <IotId>5wt*******</IotId>\\n    <GmtCreate>2020-04-04 16:37:32.000</GmtCreate>\\n    <Groups>\\n        <GroupId>Ix4*******</GroupId>\\n    </Groups>\\n    <Groups>\\n        <GroupId>Xrn*******</GroupId>\\n    </Groups>\\n    <Groups>\\n        <GroupId>J9l*******</GroupId>\\n    </Groups>\\n    <OTAModules>\\n        <ModuleName>SomeSampleModule</ModuleName>\\n        <FirmwareVersion>a1-dads2-dad2</FirmwareVersion>\\n    </OTAModules>\\n    <OTAModules>\\n        <ModuleName>SampleModule</ModuleName>\\n        <FirmwareVersion>a1-dads2-dad1</FirmwareVersion>\\n    </OTAModules>\\n    <GmtModified>2020-04-04 16:37:32.000</GmtModified>\\n    <ProductKey>a1*********</ProductKey>\\n    <DeviceName>testDevcie676a22</DeviceName>\\n</Data>\\n<Success>true</Success>\\n</QueryDeviceBySQLResponse>\",\"errorExample\":\"\"}]","title":"通过类SQL语句搜索设备","summary":"通过类SQL语句快速搜索满足指定条件的设备。","description":"## 使用说明\n\n- 仅支持搜索华东2（上海）<props=\"china\"><ph>、华北2（北京）、华南1（深圳）</ph></props><props=\"intl\"><ph>、日本（东京）</ph></props>地域企业版实例中的设备。\n- 调用该接口，单次最多查询到10,000个设备。使用说明，请参见下文SQL语句的`LIMIT`子句说明。\n\n\n## QPS限制\n\n单个阿里云账号调用该接口的每秒请求数（QPS）最大限制为10。\n\n > RAM用户共享阿里云账号配额。\n","requestParamsDescription":"使用QueryDeviceBySQL进行设备高级搜索时，类SQL语句由SELECT子句、WHERE子句、ORDER BY子句（可选）、LIMIT子句（可选）组成。长度限制400个字符。\n示例：\n`SELECT * FROM device WHERE product_key = \"a1*********\" order by active_time limit 0,10`\n|SQL子句|说明 |\n|------------- |------------   |\n|SELECT子句|`SELECT [field]/[count(*)] FROM device`<br>其中field为需要获取的字段，请参见下面的检索字段说明。也可填\\*，获取所有字段。<br>如果需要获取count计数，则填count(*)。|\n|WHERE子句|`WHERE [condition1] AND [condition2]`<br>最多使用5个condition，且不支持嵌套，请参见下面的检索字段说明、运算符说明。<br>连接词支持AND、OR，最多使用5个连接词。|\n|ORDER BY子句（可选）|ORDER BY子句用于实现自定义排序，可自定义排序的字段包括gmt\\_create、gmt\\_modified、active\\_time。<br>该子句可不填，不填时随机排序。|\n|LIMIT子句（可选）|LIMIT子句用于控制查询的偏移量，有两种用法，参见下表“LIMIT子句使用方法”。<br>如果不填LIMIT子句，则默认为`limit 20`。|\n\nLIMIT子句使用方法：\n|方法|说明 |\n|------------- |------------   |\n|limit k|限制k<=50，即单页最大为50。示例：  <br>`SELECT * FROM device WHERE product_key = \"a1*****\" limit 10`|\n|limit n,k|限制n\\+k<=10000且k<=50，即最大偏移量为10000且单页最大为50。示例：  <br>`SELECT * FROM device WHERE product_key = \"a1*****\" limit 40,10`|\n\n\n\n**检索字段说明**\n\n|字段名|类型 |说明|\n|------------- |------------   |------------   |\n|product_key|text|设备所属产品ProductKey。|\n|iot_id|text|设备标识符。默认返回iot_id。|\n|name|text|设备名称。|\n|active_time|date|设备激活时间。格式为yyyy-MM-dd HH:mm:ss.SSS，精确到毫秒。|\n|nickname|text|设备备注名称。|\n|gmt_create|date|设备创建时间。格式为yyyy-MM-dd HH:mm:ss.SSS，精确到毫秒。|\n|gmt_modified|date|设备信息最后一次更新时间。格式为yyyy-MM-dd HH:mm:ss.SSS，精确到毫秒。|\n|status|text|设备状态，取值：<br>ONLINE：在线。<br>OFFLINE：离线。<br>UNACTIVE：未激活。<br>DISABLE：已禁用。|\n|group.group_id|text|设备分组ID。|\n|tag.tag_name|text|设备标签名。|\n|tag.tag_value|text|设备标签值。|\n|ota\\_module.name|text|OTA模块名称。<br>与ota\\_module.version配合使用，用于指定设备当前OTA版本号对应的OTA模块。<br>ota\\_module.version可不传入，不传入时，将不能根据模块名称检索设备。|\n|ota\\_module.version|text|OTA固件版本。|\n\n**运算符说明**\n\n|运算符|支持的字段数值类型|\n| ------------- |------------   |\n|=|number、date、text|\n|!=|number、date、text|\n|> |number、date|\n|<|number、date|\n|LIKE|text|\n\n其中：\n- =和!=：使用时，支持检索字段值取值为null。\n- LIKE：使用时，支持前缀匹配，不支持后缀匹配或通配符匹配。前缀不得少于4个字符，且不能包含任何特殊字符，例如反斜线（\\）、正斜线（/）、and（&）、加号（+）、短划线（-）、感叹号（!）、半角圆括号（()）、半角冒号（:）、波浪线（~）、大括号（{}）、星号（*）、半角问号（?）等。前缀填写完成后，必须固定以`%` 结尾。\n\n     示例：`SELECT * FROM device where product_key = \"a1*********\" and name LIKE \"test%\" limit 10`  \n\n\n调用API时，除了本文介绍的该API的特有请求参数，还需传入公共请求参数。公共请求参数说明，请参见[公共参数文档](~~30561~~)。\n","responseParamsDescription":" ","extraInfo":" "}