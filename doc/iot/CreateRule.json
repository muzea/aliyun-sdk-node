{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"create"},"parameters":[{"name":"IotInstanceId","in":"query","schema":{"description":"实例ID。您可在物联网平台控制台的**实例概览**页面，查看当前实例的**ID**。\n\n><notice>\n- 若有ID值，必须传入该ID值，否则调用会失败。\n- 若无**实例概览**页面或ID值，则无需传入。\n\n></notice>\n\n实例的更多信息，请参见[实例概述](~~356505~~)。","type":"string","required":false,"example":"iot-cn-0pp1n8t****"}},{"name":"Select","in":"query","schema":{"description":"要执行的SQL SELECT语句。具体内容参照[SQL表达式](~~30554~~)。\n\n> 此处传入的是SELECT下的内容。例如，如果SELECT语句为`SELECT a,b,c`，则此处传入`a,b,c`。","type":"string","required":false,"example":"deviceName() as deviceName, items.Humidity.value as Humidity, items.Temperature.value as Temperature"}},{"name":"ShortTopic","in":"query","schema":{"description":"应用该规则的具体Topic，格式一般为：`${deviceName}/topicShortName`。其中，`${deviceName}`是具体设备的名称，`topicShortName`是Topic短名称。\n\n- 基础通信Topic或物模型通信Topic的ShortTopic，格式一般为：`${deviceName}/topicShortName`。其中，`${deviceName}`可以使用通配符`+`代替，表示产品下所有设备名称。`topicShortName`取值如下：\n\n    - `/thing/event/property/post `设备上报的属性消息。\n    - `/thing/event/${tsl.event.identifier}/post`设备上报的事件消息，`${}`中是产品物模型中事件identifier。\n    - `/thing/lifecycle` 设备生命周期变更消息。\n    - `/thing/downlink/reply/message`设备响应云端指令的结果消息。\n    - `/thing/list/found`网关上报发现子设备消息。\n    - `/thing/topo/lifecycle`设备拓扑关系变更消息。\n    - `/thing/event/property/history/post`设备历史属性上报消息。\n    - `/thing/event/${tsl.event.identifier}/history/post`设备历史事件上报消息，`${}`中是产品物模型中事件identifier。\n    - `/ota/upgrade`设备OTA升级状态通知消息。\n    - `/ota/version/post`设备OTA模块版本号上报消息。\n    - `/thing/deviceinfo/update`设备标签变更消息。\n    - `/edge/driver/${driver_id}/point_post`物联网边缘计算的透传模式Topic消息，`${}`中是物联网边缘计算的设备接入驱动ID。\n\n OTA升级批次状态通知Topic也属于基础通信Topic，ShortTopic格式为：`${packageId}/${jobId}/ota/job/status`。其中，`${packageId}`是升级包ID，`${jobId}`是升级批次ID。\n- 自定义Topic的ShortTopic，如：`${deviceName}/user/get`。\n\n  调用[QueryProductTopic](~~69647~~)接口，可以查看产品下的所有自定义Topic类。\n\n    指定自定义Topic时，可以使用通配符`+`和`#`。\n    - `${deviceName}`可以使用通配符`+`代替，表示产品下所有设备；\n    - 之后字段可以用`/user/#`，`#`表示`/user`层级之后的所有层级名称。\n    使用通配符，请参见[Topic类中的通配符](~~85539~~)。\n- 设备状态变化通知Topic的ShortTopic：`${deviceName}`。\n\n 可以直接使用通配符`+`，表示产品下所有设备的状态变化通知。","type":"string","required":false,"example":"+/thing/event/property/post"}},{"name":"Where","in":"query","schema":{"description":"规则的触发条件。具体内容参照[SQL表达式](~~30554~~)。\n\n> 此处传入的是**Where**中的内容。例如，如果**Where**语句为`Where a>10`，则此处传入`a>10`。","type":"string","required":false,"example":"Temperature>35"}},{"name":"ProductKey","in":"query","schema":{"description":"应用该规则的产品ProductKey。","type":"string","required":false,"example":"a1T27vz****"}},{"name":"Name","in":"query","schema":{"description":"规则名称。支持中文、英文字母、日文、数字、下划线（_）和短划线（-），长度为1~30个字符，一个中文或日文占2个字符。","type":"string","required":true,"example":"iot_test1"}},{"name":"RuleDesc","in":"query","schema":{"description":"规则的描述信息。长度限制为100个字符，一个中文字符计为1个字符。","type":"string","required":false,"example":"rule test"}},{"name":"DataType","in":"query","schema":{"description":"规则处理的数据格式，需与待处理的设备数据格式一致。取值：\n\n- **JSON**（默认）：JSON数据。\n- **BINARY**：二进制数据。\n\n> 若选择为**BINARY**，**TopicType**不能选择为0（基础通信Topic或物模型通信Topic），且不支持将数据转发至<props=\"china\"><ph>实例内的时序数据存储、时序数据库、</ph></props>表格存储和云数据库RDS版。","type":"string","required":false,"example":"JSON"}},{"name":"TopicType","in":"query","schema":{"description":"- **0**：**ShortTopic**参数描述中的基础通信Topic或物模型通信Topic，包含OTA升级批次状态通知Topic。\n- **1**：自定义Topic。\n- **2**：设备状态变化通知Topic：`/as/mqtt/status/${productKey}/${deviceName}`。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"ResourceGroupId","in":"query","schema":{"description":"资源组ID。\n\n><notice>\n- 目前，物联网平台仅支持实例维度的资源组管理。请求参数**ResourceGroupId**配置已无效，无需再传入。\n- 历史调用本API设置的资源组仍有效。\n\n></notice>\n","type":"string","required":false,"example":"rg-acfmxazb4ph****"}},{"name":"Topic","in":"query","schema":{"description":"待添加规则的完整Topic。\n\n如果传入此参数，无需再传入参数**ShortTopic**和**TopicType**。","type":"string","required":false,"example":"/sys/g18l***/device1/thing/event/property/post"}}],"responses":{"200":{"schema":{"type":"object","properties":{"Code":{"description":"调用失败时，返回的错误码。更多信息，请参见[错误码](~~87387~~)。","type":"string","example":"iot.system.SystemException"},"ErrorMessage":{"description":"调用失败时，返回的出错信息。","type":"string","example":"系统异常"},"RequestId":{"description":"阿里云为该请求生成的唯一标识符。","type":"string","example":"E4C0FF92-2A86-41DB-92D3-73B60310D25E"},"Success":{"description":"是否调用成功。\n- **true**：调用成功。\n- **false**：调用失败。","type":"boolean","example":"true"},"RuleId":{"description":"调用成功时，规则引擎为该规则生成的规则ID，作为该规则的标识符。\n\n> 请妥善保管该信息。在调用和规则相关的接口时，您可能需要提供对应的规则ID。","type":"integer","format":"int64","example":"100000"}}}}},"errorCodes":{},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"Code\\\": \\\"iot.system.SystemException\\\",\\n  \\\"ErrorMessage\\\": \\\"系统异常\\\",\\n  \\\"RequestId\\\": \\\"E4C0FF92-2A86-41DB-92D3-73B60310D25E\\\",\\n  \\\"Success\\\": true,\\n  \\\"RuleId\\\": 100000\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\r\\n<CreateRuleResponse>\\r\\n    <RequestId>E4C0FF92-2A86-41DB-92D3-73B60310D25E</RequestId>\\r\\n    <RuleId>100000</RuleId>\\r\\n    <Success>true</Success>\\r\\n</CreateRuleResponse>\",\"errorExample\":\"\"}]","title":"对指定Topic新建一个规则","summary":"调用该接口对指定Topic新建一个规则。","description":"## 使用说明\n调用该接口时，请求参数**ProductKey**必须传入。\n\n## QPS限制\n单个阿里云账号调用该接口的每秒请求数（QPS）最大限制为50。\n\n > 单个阿里云账号下的所有RAM用户共享该阿里云账号的配额。\n","requestParamsDescription":"调用API时，除了本文介绍的该API的特有请求参数，还需传入公共请求参数。公共请求参数说明，请参见[公共参数文档](~~30561~~)。\n\n> 如需启动规则，请求中需包含ProductKey、ShortTopic、Select三个参数的信息。","responseParamsDescription":" ","extraInfo":" "}