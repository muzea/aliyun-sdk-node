{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"Topic","in":"query","schema":{"description":"需查询的消息的Topic。","type":"string","required":true,"docRequired":true,"example":"test-mq_topic"}},{"name":"Key","in":"query","schema":{"description":"需查询的消息的Message Key。","type":"string","required":true,"docRequired":true,"example":"messageKey1"}},{"name":"InstanceId","in":"query","schema":{"description":"需查询的消息所对应的实例ID。","type":"string","required":false,"docRequired":true,"example":"MQ_INST_111111111111_DOxxxxxx"}}],"responses":{"200":{"schema":{"description":"返回结果。","type":"object","properties":{"RequestId":{"description":"公共参数，每个请求的ID都是唯一的，可用于排查和定位问题。","type":"string","example":"A07E3902-B92E-44A6-B6C5-6AA111111****"},"Data":{"type":"object","properties":{"OnsRestMessageDo":{"description":"查询结果列表。","type":"array","items":{"type":"object","properties":{"StoreSize":{"description":"消息大小。","type":"integer","format":"int32","example":"406"},"ReconsumeTimes":{"description":"消息重试消费的次数。","type":"integer","format":"int32","example":"1"},"StoreTimestamp":{"description":"被Broker存储的时间戳。","type":"integer","format":"int64","example":"1570760999811"},"InstanceId":{"description":"实例ID。","type":"string","example":"MQ_INST_111111111111_DOxxxxxx"},"MsgId":{"description":"消息ID，即Message ID。","type":"string","example":"1E0578FE110F18B4AAC235C05F2*****"},"StoreHost":{"description":"存储该消息的服务器实例。","type":"string","example":"11.193.***.***:10911"},"Topic":{"description":"消息的Topic。","type":"string","example":"test-mq_topic"},"PropertyList":{"type":"object","properties":{"MessageProperty":{"description":"消息属性列表。","type":"array","items":{"type":"object","properties":{"Value":{"description":"消息属性的取值。","type":"string","example":"TagA"},"Name":{"description":"消息属性。取值说明如下：\n\n- **TRACE_ON**：是否有消息轨迹\n- **KEYS**：消息的Key属性\n- **TAGS**：消息的Tag属性\n- **INSTANCE_ID**：消息所在的实例的ID\n\n更多概念信息请参见[名词解释](~~29533~~)。","type":"string","example":"TAGS"}}}}}},"BornTimestamp":{"description":"生成时间戳。","type":"integer","format":"int64","example":"1570760999721"},"BodyCRC":{"description":"消息体CRC校验值。","type":"integer","format":"int32","example":"914112295"},"BornHost":{"description":"生成该消息的客户端实例。","type":"string","example":"42.120.***.***:59270"}}}}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"A07E3902-B92E-44A6-B6C5-6AA111111****\\\",\\n  \\\"Data\\\": {\\n    \\\"OnsRestMessageDo\\\": [\\n      {\\n        \\\"StoreSize\\\": 406,\\n        \\\"ReconsumeTimes\\\": 1,\\n        \\\"StoreTimestamp\\\": 1570760999811,\\n        \\\"InstanceId\\\": \\\"MQ_INST_111111111111_DOxxxxxx\\\",\\n        \\\"MsgId\\\": \\\"1E0578FE110F18B4AAC235C05F2*****\\\",\\n        \\\"StoreHost\\\": \\\"11.193.***.***:10911\\\",\\n        \\\"Topic\\\": \\\"test-mq_topic\\\",\\n        \\\"PropertyList\\\": {\\n          \\\"MessageProperty\\\": [\\n            {\\n              \\\"Value\\\": \\\"TagA\\\",\\n              \\\"Name\\\": \\\"TAGS\\\"\\n            }\\n          ]\\n        },\\n        \\\"BornTimestamp\\\": 1570760999721,\\n        \\\"BodyCRC\\\": 914112295,\\n        \\\"BornHost\\\": \\\"42.120.***.***:59270\\\"\\n      }\\n    ]\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<OnsMessageGetByKeyResponse>\\n<Data>\\n    <MsgId>1E0578FE110F18B4AAC235C05F2*****</MsgId>\\n    <InstanceId>MQ_INST_111111111111_DOxxxxxx</InstanceId>\\n    <ReconsumeTimes>1</ReconsumeTimes>\\n    <BornHost>42.120.**.**:64646</BornHost>\\n    <BodyCRC>914112295</BodyCRC>\\n    <StoreHost>11.220.***.***:10911</StoreHost>\\n    <StoreTimestamp>1570761026708</StoreTimestamp>\\n    <BornTimestamp>1570761026630</BornTimestamp>\\n    <Topic>test-mq_topic</Topic>\\n    <StoreSize>407</StoreSize>\\n    <PropertyList>\\n        <MessageProperty>\\n            <Name>TAGS</Name>\\n            <Value>TagA</Value>\\n        </MessageProperty>\\n    </PropertyList>\\n</Data>\\n<RequestId>A07E3902-B92E-44A6-B6C5-6AA111111****</RequestId>\\n</OnsMessageGetByKeyResponse>\",\"errorExample\":\"\"}]","title":"根据Message Key查询消息","summary":"根据 Topic 和 Message Key 模糊查询消息信息列表。","description":"><notice>阿里云提供的OpenAPI属于管控类API，用于管理和查询阿里云服务的相关资源。仅推荐在管控链路集成，消息收发的核心数据链路中严禁依赖OpenAPI实现，否则可能会导致链路产生风险。></notice>\n\n- 使用本接口根据Message Key查询消息的方式属于模糊查询。由于业务方的Key可能不唯一，所以查询结果可能为多条。\n\n- 本接口用在业务方无法获取Message ID的场景，在该场景下的调用步骤如下所示：\n\n    1. 调用本接口模糊查询得到Message ID列表。\n\n    2. 调用**OnsMessageGetByMsgId**接口精确查询。**OnsMessageGetByMsgId**接口的详细信息，请参见[OnsMessageGetByMsgId](~~29607~~)。","responseParamsDescription":" ","extraInfo":"## 控制台操作\n除了调用**OnsMessageGetByKey**接口，您还可以通过云消息队列 RocketMQ 版控制台查看消息的详细信息。具体操作，请参见[消息查询](~~29540~~)。"}