{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{},"parameters":[{"name":"QueryId","in":"query","schema":{"description":"需要提取轨迹查询结果的任务ID。","type":"string","required":true,"docRequired":true,"example":"272967562652883649157096685****"}},{"name":"InstanceId","in":"query","schema":{"description":"需查询的消息所对应的实例ID。","type":"string","required":false,"example":"MQ_INST_111111111111_DOxxxxxx"}},{"name":"Topic","in":"query","schema":{"description":"需查询的消息的Topic。","type":"string","required":false,"example":"test"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"公共参数，每个请求的ID都是唯一的，可用于排查和定位问题。","type":"string","example":"84EE24D2-851F-40D6-B99E-4D6AB909****"},"TraceData":{"description":"该查询任务的结果明细。","type":"object","properties":{"Status":{"description":"该查询任务的结果。取值说明如下：\n\n- **finish**：查询完成\n- **working**：查询中\n- **removed**：任务已删除","type":"string","example":"finish"},"MsgKey":{"description":"该查询任务对应的Message Key。","type":"string","example":"ORDERID_100"},"UpdateTime":{"description":"该查询任务的最后更新时间。","type":"integer","format":"int64","example":"1570966877000"},"CreateTime":{"description":"该查询任务的创建时间。","type":"integer","format":"int64","example":"1570966857000"},"Topic":{"description":"该查询任务的Topic。","type":"string","example":"test"},"UserId":{"description":"查询用户ID。","type":"string","example":"27296756265288****"},"InstanceId":{"description":"实例ID。","type":"string","example":"MQ_INST_111111111111_DOxxxxxx"},"MsgId":{"description":"该查询任务对应的Message ID。","type":"string","example":"1E05791C117818B4AAC23B1BB0CE****"},"TraceList":{"type":"object","properties":{"TraceMapDo":{"description":"该查询任务的匹配轨迹列表。","type":"array","items":{"type":"object","properties":{"Status":{"description":"发送状态。取值说明如下：\n\n- **SEND_SUCCESS**：发送成功\n- **SEND_FAILED**：发送失败\n- **SEND_ROLLBACK**：事务消息回滚\n- **SEND_UNKNOWN**：事务消息未提交\n- **SEND_DELAY**：定时（延时）消息定时中","type":"string","example":"SEND_SUCCESS"},"MsgKey":{"description":"消息的Key ，即Message Key。","type":"string","example":"ORDERID_100"},"PubTime":{"description":"消息发送时间。","type":"integer","format":"int64","example":"1570850870478"},"SubList":{"type":"object","properties":{"SubMapDo":{"description":"消息的消费轨迹列表。","type":"array","items":{"type":"object","properties":{"ClientList":{"type":"object","properties":{"SubClientInfoDo":{"description":"该Group ID客户端消费记录的明细列表。","type":"array","items":{"type":"object","properties":{"Status":{"description":"消费状态。取值说明如下：\n\n- **CONSUME_FAILED**：消费失败\n- **CONSUME_SUCCESS**：消费成功\n- **CONSUME_NOT_RETURN**：消费未返回结果\n- **SEND_UNKNOWN**：事务消息未提交\n- **SEND_DELAY**：定时（延时）消息定时中","type":"string","example":"CONSUME_SUCCESS"},"SubTime":{"description":"消费开始时间戳。","type":"integer","format":"int64","example":"1570851590511"},"ReconsumeTimes":{"description":"本次消费的投递轮次。","type":"integer","format":"int32","example":"1"},"SubGroupName":{"description":"该客户端所属的Group ID。","type":"string","example":"GID_test"},"ClientHost":{"description":"消费客户端的客户端地址。","type":"string","example":"30.5.**.**"},"CostTime":{"description":"本次消费耗时，单位毫秒。","type":"integer","format":"int32","example":"43"}}}}}},"FailCount":{"description":"该Group ID消费失败次数统计。","type":"integer","format":"int32","example":"0"},"SubGroupName":{"description":"消费方Group ID。","type":"string","example":"GID_test"},"SuccessCount":{"description":"该Group ID消费成功次数统计。","type":"integer","format":"int32","example":"1"}}}}}},"Topic":{"description":"消息的Topic。","type":"string","example":"test"},"CostTime":{"description":"发送耗时，单位毫秒。","type":"integer","format":"int32","example":"24"},"Tag":{"description":"消息的Tag，即Message Tag。","type":"string","example":"TagA"},"MsgId":{"description":"消息的ID，即Message ID。","type":"string","example":"0BC1F01800002A9F000000531246****"},"PubGroupName":{"description":"发送方客户端配置的Group ID。","type":"string","example":"GID_test"},"BornHost":{"description":"消息发送方的客户端地址。","type":"string","example":"30.5.**.**"}}}}}},"QueryId":{"description":"查询任务ID。","type":"string","example":"272967562652883649157096685****"}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"84EE24D2-851F-40D6-B99E-4D6AB909****\\\",\\n  \\\"TraceData\\\": {\\n    \\\"Status\\\": \\\"finish\\\",\\n    \\\"MsgKey\\\": \\\"ORDERID_100\\\",\\n    \\\"UpdateTime\\\": 1570966877000,\\n    \\\"CreateTime\\\": 1570966857000,\\n    \\\"Topic\\\": \\\"test\\\",\\n    \\\"UserId\\\": \\\"27296756265288****\\\",\\n    \\\"InstanceId\\\": \\\"MQ_INST_111111111111_DOxxxxxx\\\",\\n    \\\"MsgId\\\": \\\"1E05791C117818B4AAC23B1BB0CE****\\\",\\n    \\\"TraceList\\\": {\\n      \\\"TraceMapDo\\\": [\\n        {\\n          \\\"Status\\\": \\\"SEND_SUCCESS\\\",\\n          \\\"MsgKey\\\": \\\"ORDERID_100\\\",\\n          \\\"PubTime\\\": 1570850870478,\\n          \\\"SubList\\\": {\\n            \\\"SubMapDo\\\": [\\n              {\\n                \\\"ClientList\\\": {\\n                  \\\"SubClientInfoDo\\\": [\\n                    {\\n                      \\\"Status\\\": \\\"CONSUME_SUCCESS\\\",\\n                      \\\"SubTime\\\": 1570851590511,\\n                      \\\"ReconsumeTimes\\\": 1,\\n                      \\\"SubGroupName\\\": \\\"GID_test\\\",\\n                      \\\"ClientHost\\\": \\\"30.5.**.**\\\",\\n                      \\\"CostTime\\\": 43\\n                    }\\n                  ]\\n                },\\n                \\\"FailCount\\\": 0,\\n                \\\"SubGroupName\\\": \\\"GID_test\\\",\\n                \\\"SuccessCount\\\": 1\\n              }\\n            ]\\n          },\\n          \\\"Topic\\\": \\\"test\\\",\\n          \\\"CostTime\\\": 24,\\n          \\\"Tag\\\": \\\"TagA\\\",\\n          \\\"MsgId\\\": \\\"0BC1F01800002A9F000000531246****\\\",\\n          \\\"PubGroupName\\\": \\\"GID_test\\\",\\n          \\\"BornHost\\\": \\\"30.5.**.**\\\"\\n        }\\n      ]\\n    },\\n    \\\"QueryId\\\": \\\"272967562652883649157096685****\\\"\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<OnsTraceGetResultResponse>\\n<TraceData>\\n    <MsgId>1E05791C117818B4AAC23B1BB0CE****</MsgId>\\n    <Status>finish</Status>\\n    <TraceList>\\n        <TraceMapDo>\\n            <BornHost>30.5.**.**</BornHost>\\n            <MsgId>0BC1F01800002A9F000000531246****</MsgId>\\n            <Status>SEND_SUCCESS</Status>\\n            <CostTime>24</CostTime>\\n            <PubTime>1570850870478</PubTime>\\n            <Tag>TagA</Tag>\\n            <Topic>test</Topic>\\n            <MsgKey>ORDERID_100</MsgKey>\\n            <PubGroupName>GID_test</PubGroupName>\\n            <SubList>\\n                <SubMapDo>\\n                    <ClientList>\\n                        <SubClientInfoDo>\\n                            <Status>CONSUME_SUCCESS</Status>\\n                            <CostTime>43</CostTime>\\n                            <ClientHost>30.5.**.**</ClientHost>\\n                            <ReconsumeTimes>1</ReconsumeTimes>\\n                            <SubTime>1570851590511</SubTime>\\n                            <SubGroupName>GID_test</SubGroupName>\\n                        </SubClientInfoDo>\\n                    </ClientList>\\n                    <SuccessCount>1</SuccessCount>\\n                    <FailCount>0</FailCount>\\n                    <SubGroupName>GID_test</SubGroupName>\\n                </SubMapDo>\\n            </SubList>\\n        </TraceMapDo>\\n    </TraceList>\\n    <CreateTime>1570966857000</CreateTime>\\n    <InstanceId>MQ_INST_111111111111_DOxxxxxx</InstanceId>\\n    <Topic>test</Topic>\\n    <UpdateTime>1570966877000</UpdateTime>\\n    <QueryId>272967562652883649157096685****</QueryId>\\n    <UserId>27296756265288****</UserId>\\n</TraceData>\\n<RequestId>84EE24D2-851F-40D6-B99E-4D6AB909****</RequestId>\\n</OnsTraceGetResultResponse>\",\"errorExample\":\"\"}]","title":"获取轨迹查询结果","summary":"通过传入轨迹查询任务的ID获取之前的轨迹查询结果。","description":"><notice>阿里云提供的OpenAPI属于管控类API，用于管理和查询阿里云服务的相关资源。仅推荐在管控链路集成，消息收发的核心数据链路中严禁依赖OpenAPI实现，否则可能会导致链路产生风险。></notice>\n\n- 若您已根据Message ID或者Message Key创建了轨迹查询任务，并得到了查询任务的ID。您可调用本接口根据查询任务ID获取对应的轨迹结果的明细。轨迹查询任务通过[OnsTraceQueryByMsgId](~~445322~~)或[OnsTraceQueryByMsgKey](~~445324~~)接口创建，返回数据中的**QueryId**即为本接口中需要传入的查询任务ID。\n- 因为消息轨迹查询任务耗时较多，创建任务后立即根据该接口获取结果可能为空，若遇到此情况，建议等待一段时间再重试。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":"## 控制台操作\n除了调用**OnsTraceGetResult**接口，您还可以通过云消息队列 RocketMQ 版控制台查看消息轨迹的查询结果。具体操作，请参见[查询消息轨迹](~~43357~~)。"}