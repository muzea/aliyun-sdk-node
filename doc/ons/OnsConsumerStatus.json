{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"GroupId","in":"query","schema":{"description":"需要查询的消费端Group ID。","type":"string","required":true,"docRequired":true,"example":"GID_test_group_id"}},{"name":"Detail","in":"query","schema":{"description":"是否查询详细信息。取值说明如下：\n\n- **true**：要查询详细信息，即可获取返回参数**ConsumerConnectionInfoList**和**DetailInTopicList**信息。\n\n- **false**：默认值，不查询详细信息，即返回参数**ConsumerConnectionInfoList**和**DetailInTopicList**为空。","type":"boolean","required":false,"example":"true"}},{"name":"NeedJstack","in":"query","schema":{"description":"是否打印Jstack信息。取值说明如下：\n- **true**：要打印Jstack信息，可在**Jstack**返回参数中获取堆栈信息。\n >如需打印Jstack信息，请确保您的入参**Detail**设置为**true**。\n\n- **false**：默认值，不打印Jstack信息，**Jstack**返回参数为空。\n","type":"boolean","required":false,"example":"true"}},{"name":"InstanceId","in":"query","schema":{"description":"需查询的Group ID所对应的实例ID。","type":"string","required":false,"docRequired":true,"example":"MQ_INST_111111111111_DOxxxxxx"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"公共参数，每个请求的ID都是唯一的，可用于排查和定位问题。","type":"string","example":"10EDC518-10E7-4B34-92FB-171235FA****"},"Data":{"description":"查询结果。","type":"object","properties":{"ConsumeTps":{"description":"总消费TPS。","type":"number","format":"float","example":"0"},"ConsumeModel":{"description":"消费模型。取值说明如下：\n\n-  **CLUSTERING**：集群消费模式\n\n- **BROADCASTING**：广播消费模式\n\n两种订阅模式的详细信息，请参见[集群消费和广播消费](~~43163~~)。","type":"string","example":"CLUSTERING"},"ConnectionSet":{"type":"object","properties":{"ConnectionDo":{"description":"该集群当前在线客户端信息。","type":"array","items":{"type":"object","properties":{"RemoteIP":{"description":"宿主机IP地址或公网IP地址。","type":"string","example":"42.120.74.**"},"Version":{"description":"消费端版本。","type":"string","example":"V4_3_6_SNAPSHOT"},"ClientAddr":{"description":"该消费实例的地址和端口。","type":"string","example":"30.5.121.**"},"Language":{"description":"消费端语言。","type":"string","example":"JAVA"},"ClientId":{"description":"消费实例的ID。","type":"string","example":"30.5.121.**@25560#-1999745829#-1737591554#458773089270275"}}}}}},"TotalDiff":{"description":"集群总的消费堆积。","type":"integer","format":"int64","example":"197"},"ConsumerConnectionInfoList":{"type":"object","properties":{"ConsumerConnectionInfoDo":{"description":"该集群在线客户端详细信息，包含Jstack、消费RT时间等信息。如需获取详细信息，请确保将**Detail**请求参数设置为**true**。否则返回值为空。","type":"array","items":{"description":"test，此内容不推送到icms","type":"object","properties":{"ConsumeModel":{"description":"消费模型。取值说明如下：\n\n-  **CLUSTERING**：集群消费模式\n\n- **BROADCASTING**：广播消费模式\n\n两种订阅模式的详细信息，请参见[集群消费和广播消费](~~43163~~)。","type":"string","example":"CLUSTERING"},"RunningDataList":{"type":"object","properties":{"ConsumerRunningDataDo":{"description":"实时状态统计。","type":"array","items":{"type":"object","properties":{"Rt":{"description":"消费RT时间，单位：毫秒。","type":"number","format":"float","example":"0"},"Topic":{"description":"订阅的Topic名称。","type":"string","example":"test-mq_topic"},"FailedCountPerHour":{"description":"每小时内消费失败的消息数统计。","type":"integer","format":"int64","example":"0"},"OkTps":{"description":"消费消息成功的TPS统计。","type":"number","format":"float","example":"0"},"FailedTps":{"description":"消费消息失败的TPS统计。","type":"number","format":"float","example":"0"}}}}}},"SubscriptionSet":{"type":"object","properties":{"SubscriptionData":{"description":"订阅关系集合。","type":"array","items":{"type":"object","properties":{"SubString":{"description":"订阅该Topic的子类别Tag表达式。","type":"string","example":"*"},"SubVersion":{"description":"订阅关系版本号，为自增Long型。","type":"integer","format":"int64","example":"1570701364301"},"Topic":{"description":"订阅的Topic名称。","type":"string","example":"test-mq_topic"},"TagsSet":{"type":"object","properties":{"Tag":{"description":"订阅的Tag集合。","type":"array","items":{"description":"订阅的Tag集合。","type":"string","example":"ff"}}}}}}}}},"Jstack":{"type":"object","properties":{"ThreadTrackDo":{"description":"Jstack堆栈信息。如需获取Jstack信息，请确保将**NeedJstack**入参设置为**true**。否则返回值为空。","type":"array","items":{"description":"test——此内容不发布icms","type":"object","properties":{"TrackList":{"type":"object","properties":{"Track":{"description":"Jstack堆栈信息字符串。","type":"array","items":{"description":"Jstack堆栈信息字符串。","type":"string","example":"TID: 52 STATE: WAITING"}}}},"Thread":{"description":"线程名称。","type":"string","example":"ConsumeMessageThread_0"}}}}}},"LastTimeStamp":{"description":"最后消费时间。\n\n该参数值的格式为毫秒级Unix时间戳。","type":"integer","format":"int64","example":"1570701368114"},"StartTimeStamp":{"description":"消费开始时间。\n\n该参数值的格式为毫秒级Unix时间戳。","type":"integer","format":"int64","example":"1570701361528"},"Language":{"description":"客户端语言。","type":"string","example":"JAVA"},"ClientId":{"description":"消费实例的ID。","type":"string","example":"30.5.**.**@25560#-1999745829#-1737591554#458773089270275"},"Connection":{"description":"连接信息。","type":"string","example":"**"},"Version":{"description":"客户端版本号。","type":"string","example":"V4_3_6"},"ConsumeType":{"description":"消费者消费消息的模式。取值说明如下：\n- **PUSH**：云消息队列 RocketMQ 版服务端主动向消费者推送消息。\n- **PULL**：消费者主动向云消息队列 RocketMQ 版服务端拉取消息。","type":"string","example":"PUSH"},"ThreadCount":{"description":"消费线程数。","type":"integer","format":"int32","example":"20"}}}}}},"InstanceId":{"description":"实例ID。","type":"string","example":"MQ_INST_111111111111_DOxxxxxx"},"DetailInTopicList":{"type":"object","properties":{"DetailInTopicDo":{"description":"各个Topic的消费情况。如需获取详细信息，请确保将**Detail**请求参数设置为**true**。否则返回值为空。","type":"array","items":{"type":"object","properties":{"DelayTime":{"description":"指定Topic的消费延迟时间。单位：毫秒。","type":"integer","format":"int64","example":"0"},"TotalDiff":{"description":"该Topic消费总堆积数。","type":"integer","format":"int64","example":"0"},"LastTimestamp":{"description":"最后消费时间。\n\n该参数值的格式为毫秒级Unix时间戳。","type":"integer","format":"int64","example":"1570701259403"},"Topic":{"description":"Topic名称。","type":"string","example":"test-mq_topic"}}}}}},"SubscriptionSame":{"description":"订阅关系是否一致。","type":"boolean","example":"true"},"DelayTime":{"description":"指定Group ID所订阅的所有Topic中的最大消费延时时间。单位：毫秒。","type":"integer","format":"int64","example":"100857"},"LastTimestamp":{"description":"最后消费时间。\n\n该参数值的格式为毫秒级Unix时间戳。","type":"integer","format":"int64","example":"1566883844954"},"Online":{"description":"是否在线。","type":"boolean","example":"true"},"RebalanceOK":{"description":"客户端Rebalance是否正常。取值说明如下：\n\n- **true**：正常\n\n- **false**：不正常","type":"boolean","example":"true"}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"10EDC518-10E7-4B34-92FB-171235FA****\\\",\\n  \\\"Data\\\": {\\n    \\\"ConsumeTps\\\": 0,\\n    \\\"ConsumeModel\\\": \\\"CLUSTERING\\\",\\n    \\\"ConnectionSet\\\": {\\n      \\\"ConnectionDo\\\": [\\n        {\\n          \\\"RemoteIP\\\": \\\"42.120.74.**\\\",\\n          \\\"Version\\\": \\\"V4_3_6_SNAPSHOT\\\",\\n          \\\"ClientAddr\\\": \\\"30.5.121.**\\\",\\n          \\\"Language\\\": \\\"JAVA\\\",\\n          \\\"ClientId\\\": \\\"30.5.121.**@25560#-1999745829#-1737591554#458773089270275\\\"\\n        }\\n      ]\\n    },\\n    \\\"TotalDiff\\\": 197,\\n    \\\"ConsumerConnectionInfoList\\\": {\\n      \\\"ConsumerConnectionInfoDo\\\": [\\n        {\\n          \\\"ConsumeModel\\\": \\\"CLUSTERING\\\",\\n          \\\"RunningDataList\\\": {\\n            \\\"ConsumerRunningDataDo\\\": [\\n              {\\n                \\\"Rt\\\": 0,\\n                \\\"Topic\\\": \\\"test-mq_topic\\\",\\n                \\\"FailedCountPerHour\\\": 0,\\n                \\\"OkTps\\\": 0,\\n                \\\"FailedTps\\\": 0\\n              }\\n            ]\\n          },\\n          \\\"SubscriptionSet\\\": {\\n            \\\"SubscriptionData\\\": [\\n              {\\n                \\\"SubString\\\": \\\"*\\\",\\n                \\\"SubVersion\\\": 1570701364301,\\n                \\\"Topic\\\": \\\"test-mq_topic\\\",\\n                \\\"TagsSet\\\": {\\n                  \\\"Tag\\\": [\\n                    \\\"ff\\\"\\n                  ]\\n                }\\n              }\\n            ]\\n          },\\n          \\\"Jstack\\\": {\\n            \\\"ThreadTrackDo\\\": [\\n              {\\n                \\\"TrackList\\\": {\\n                  \\\"Track\\\": [\\n                    \\\"TID: 52 STATE: WAITING\\\"\\n                  ]\\n                },\\n                \\\"Thread\\\": \\\"ConsumeMessageThread_0\\\"\\n              }\\n            ]\\n          },\\n          \\\"LastTimeStamp\\\": 1570701368114,\\n          \\\"StartTimeStamp\\\": 1570701361528,\\n          \\\"Language\\\": \\\"JAVA\\\",\\n          \\\"ClientId\\\": \\\"30.5.**.**@25560#-1999745829#-1737591554#458773089270275\\\",\\n          \\\"Connection\\\": \\\"**\\\",\\n          \\\"Version\\\": \\\"V4_3_6\\\",\\n          \\\"ConsumeType\\\": \\\"PUSH\\\",\\n          \\\"ThreadCount\\\": 20\\n        }\\n      ]\\n    },\\n    \\\"InstanceId\\\": \\\"MQ_INST_111111111111_DOxxxxxx\\\",\\n    \\\"DetailInTopicList\\\": {\\n      \\\"DetailInTopicDo\\\": [\\n        {\\n          \\\"DelayTime\\\": 0,\\n          \\\"TotalDiff\\\": 0,\\n          \\\"LastTimestamp\\\": 1570701259403,\\n          \\\"Topic\\\": \\\"test-mq_topic\\\"\\n        }\\n      ]\\n    },\\n    \\\"SubscriptionSame\\\": true,\\n    \\\"DelayTime\\\": 100857,\\n    \\\"LastTimestamp\\\": 1566883844954,\\n    \\\"Online\\\": true,\\n    \\\"RebalanceOK\\\": true\\n  }\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<OnsConsumerStatusResponse>\\n<data>\\n    <connectionSet>\\n        <bizVersion>V4_3_6</bizVersion>\\n        <clientAddr>30.5.***.*</clientAddr>\\n        <clientId>30.5.***.*@97730#-1999745829#-1737591554#729272961762836</clientId>\\n        <language>JAVA</language>\\n        <version>V4_3_6</version>\\n    </connectionSet>\\n    <consumeModel>CLUSTERING</consumeModel>\\n    <consumeTps>0</consumeTps>\\n    <consumerConnectionInfoList>\\n        <bizVersion>V4_3_6</bizVersion>\\n        <clientId>30.5.***.*@97730#-1999745829#-1737591554#729272961762836</clientId>\\n        <consumeType>PUSH</consumeType>\\n        <jstack>\\n            <thread>ConsumeMessageThread_4</thread>\\n            <trackList>TID: 44 STATE: WAITING</trackList>\\n            <trackList>sun.misc.Unsafe.park(Native Method)</trackList>\\n            <trackList>java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)</trackList>\\n            <trackList>java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)</trackList>\\n            <trackList>java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)</trackList>\\n            <trackList>java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)</trackList>\\n            <trackList>java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)</trackList>\\n            <trackList>java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</trackList>\\n            <trackList>java.lang.Thread.run(Thread.java:748)</trackList>\\n        </jstack>\\n        <language>JAVA</language>\\n        <lastTimeStamp>1570701368114</lastTimeStamp>\\n        <runningDataList>\\n            <failedCountPerHour>0</failedCountPerHour>\\n            <failedTps>0</failedTps>\\n            <okTps>0</okTps>\\n            <rt>0</rt>\\n            <topic>test-mq_topic</topic>\\n        </runningDataList>\\n        <startTimeStamp>1570701361528</startTimeStamp>\\n        <subscriptionSet>\\n            <subString>*</subString>\\n            <subVersion>1570701364301</subVersion>\\n            <topic>test-mq_topic</topic>\\n        </subscriptionSet>\\n        <threadCount>20</threadCount>\\n        <version>V4_3_6</version>\\n    </consumerConnectionInfoList>\\n    <delayTime>0</delayTime>\\n    <detailInTopicList>\\n        <delayTime>0</delayTime>\\n        <lastTimestamp>1570701259403</lastTimestamp>\\n        <topic>test-mq_topic</topic>\\n        <totalDiff>0</totalDiff>\\n    </detailInTopicList>\\n    <instanceId>MQ_INST_111111111111_DOxxxxxx</instanceId>\\n    <lastTimestamp>1570701368114</lastTimestamp>\\n    <online>true</online>\\n    <rebalanceOK>true</rebalanceOK>\\n    <subscriptionSame>true</subscriptionSame>\\n    <totalDiff>0</totalDiff>\\n</data>\\n<requestId>10EDC518-10E7-4B34-92FB-171235FA****</requestId>\\n</OnsConsumerStatusResponse>\",\"errorExample\":\"\"}]","title":"查询Group ID消费状态","summary":"查询指定Group ID详细状态数据：订阅关系检查、消费TPS统计、负载均衡状态、消费端连接。","description":"><notice>阿里云提供的OpenAPI属于管控类API，用于管理和查询阿里云服务的相关资源。仅推荐在管控链路集成，消息收发的核心数据链路中严禁依赖OpenAPI实现，否则可能会导致链路产生风险。></notice>\n\n- 本接口一般用于在粗略判断消费堆积以及客户端在线状态后，需要排查消费异常原因的场景。可以根据返回结果判断出指定Group ID的订阅关系是否一致、负载均衡是否正常以及获取在线客户端的Jstack信息等。\n- 使用本接口需要调用大量后端接口以完成数据聚合，因此查询速度慢，不建议频繁调用。\n","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":"## 控制台操作\n除了调用**OnsConsumerStatus**接口，您还可以通过云消息队列 RocketMQ 版控制台查看Group ID的详细数据。具体操作，请参见[查看消费者状态](~~94312~~)。"}