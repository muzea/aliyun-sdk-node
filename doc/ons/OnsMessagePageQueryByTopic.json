{"summary":"分页查询指定时间段内指定Topic内存在的所有消息。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"read","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"Topic","in":"query","schema":{"description":"需查询的消息的Topic名称。","type":"string","required":true,"docRequired":true,"example":"test-mq_topic"}},{"name":"BeginTime","in":"query","schema":{"description":"查询范围的起始时间戳，单位：毫秒。\n通过**TaskId**进行后续取消息时，该参数设置的值不生效，默认以第一次查询时输入的起始时间为准。","type":"integer","format":"int64","required":true,"docRequired":true,"example":"1570723200000"}},{"name":"EndTime","in":"query","schema":{"description":"查询范围的终止时间戳，单位：毫秒。\n通过**TaskId**进行后续取消息时，该参数设置的值不生效，默认以第一次查询时输入的终止时间为准。","type":"integer","format":"int64","required":true,"docRequired":true,"example":"1570809600000"}},{"name":"TaskId","in":"query","schema":{"description":"查询任务的ID，首次查询不需要输入，后续取消息必须传入，根据前一次的返回结果取出该字段。","type":"string","required":false,"example":"0BC1310300002A9F000021E4D7A48346"}},{"name":"CurrentPage","in":"query","schema":{"description":"当前取第几页消息，从1开始递增，最大值为50，取消息时不可超过最大页数。","type":"integer","format":"int32","required":true,"docRequired":true,"example":"2"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询，每页最多显示的消息数量，默认是20，最小5条，最多50条。\n通过**TaskId**进行后续取消息时，该参数设置的值不生效，默认以第一次查询时输入的每页消息数量为准。","type":"integer","format":"int32","required":false,"example":"5"}},{"name":"InstanceId","in":"query","schema":{"description":"需查询的消息所对应的实例ID。","type":"string","required":false,"docRequired":true,"example":"MQ_INST_111111111111_DOxxxxxx"}}],"responses":{"200":{"schema":{"description":"查询结果。","type":"object","properties":{"RequestId":{"description":"公共参数，每个请求的ID都是唯一的，可用于排查和定位问题。","type":"string","example":"5DC2A47E-2B31-4722-96C8-FA59C9*****"},"MsgFoundDo":{"description":"查询结果。","type":"object","properties":{"CurrentPage":{"description":"当前位于第几页。","type":"integer","format":"int64","example":"1"},"MsgFoundList":{"type":"object","properties":{"OnsRestMessageDo":{"description":"当前页的消息集合，该类型与[OnsMessageGetByMsgId](~~29607~~)的返回结果一致。","type":"array","items":{"type":"object","properties":{"StoreSize":{"description":"消息大小。单位：KB。","type":"integer","format":"int32","example":"406"},"ReconsumeTimes":{"description":"消息重试消费的次数。","type":"integer","format":"int32","example":"1"},"StoreTimestamp":{"description":"消息被服务端存储的时间戳，单位：毫秒。","type":"integer","format":"int64","example":"1570760999811"},"InstanceId":{"description":"实例ID。","type":"string","example":"MQ_INST_111111111111_DOxxxxxx"},"MsgId":{"description":"消息ID，即Message ID。","type":"string","example":"1E0578FE110F18B4AAC235C05F2*****"},"StoreHost":{"description":"存储该消息的服务器实例。","type":"string","example":"11.193.***.***:10911"},"Topic":{"description":"消息的Topic。","type":"string","example":"test-mq_topic"},"PropertyList":{"type":"object","properties":{"MessageProperty":{"description":"消息属性列表。","type":"array","items":{"type":"object","properties":{"Value":{"description":"消息属性的取值。","type":"string","example":"TagA"},"Name":{"description":"消息属性。取值说明如下：\n\n- **TRACE_ON**：是否有消息轨迹。\n- **KEYS**：消息的Key属性。\n- **TAGS**：消息的Tag属性。\n- **INSTANCE_ID**：消息所在的实例的ID。\n\n更多概念信息，请参见[名词解释](~~29533~~)。","type":"string","example":"TAGS"}}}}}},"BornTimestamp":{"description":"消息生成的时间戳，单位：毫秒。","type":"integer","format":"int64","example":"1570760999721"},"BodyCRC":{"description":"消息体CRC校验值。","type":"integer","format":"int32","example":"914112295"},"BornHost":{"description":"生成该消息的客户端实例。","type":"string","example":"42.120.***.***:59270"}}}}}},"MaxPageCount":{"description":"查询结果最大页数。","type":"integer","format":"int64","example":"400"},"TaskId":{"description":"第一次新建查询时，返回的查询任务ID，用于后续取消息。","type":"string","example":"0BC1310300002A9F000021E4D7A48346"}}}}}}},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"5DC2A47E-2B31-4722-96C8-FA59C9*****\\\",\\n  \\\"MsgFoundDo\\\": {\\n    \\\"CurrentPage\\\": 1,\\n    \\\"MsgFoundList\\\": {\\n      \\\"OnsRestMessageDo\\\": [\\n        {\\n          \\\"StoreSize\\\": 406,\\n          \\\"ReconsumeTimes\\\": 1,\\n          \\\"StoreTimestamp\\\": 1570760999811,\\n          \\\"InstanceId\\\": \\\"MQ_INST_111111111111_DOxxxxxx\\\",\\n          \\\"MsgId\\\": \\\"1E0578FE110F18B4AAC235C05F2*****\\\",\\n          \\\"StoreHost\\\": \\\"11.193.***.***:10911\\\",\\n          \\\"Topic\\\": \\\"test-mq_topic\\\",\\n          \\\"PropertyList\\\": {\\n            \\\"MessageProperty\\\": [\\n              {\\n                \\\"Value\\\": \\\"TagA\\\",\\n                \\\"Name\\\": \\\"TAGS\\\"\\n              }\\n            ]\\n          },\\n          \\\"BornTimestamp\\\": 1570760999721,\\n          \\\"BodyCRC\\\": 914112295,\\n          \\\"BornHost\\\": \\\"42.120.***.***:59270\\\"\\n        }\\n      ]\\n    },\\n    \\\"MaxPageCount\\\": 400,\\n    \\\"TaskId\\\": \\\"0BC1310300002A9F000021E4D7A48346\\\"\\n  }\\n}\",\"type\":\"json\"}]","title":"查询Topic内所有消息","description":"><notice>阿里云提供的OpenAPI属于管控类API，用于管理和查询阿里云服务的相关资源。仅推荐在管控链路集成，消息收发的核心数据链路中严禁依赖OpenAPI实现，否则可能会导致链路产生风险。></notice>\n\n- 按Topic查询消息的方式属于范围查询，查询结果会通过分页的方式展示给调用方，仅适用于没有任何搜索条件（Message ID和Message Key）的查询场景。\n- 根据Topic查询消息应尽可能缩短查询的时间区间，否则匹配的消息过多，将无法定位问题。调用流程如下所示：\n  \n    1. 传入Topic、起止时间以及每页的消息数量，进行分页查询。如果有消息，默认返回第一页的消息、总页数和查询任务ID。 \n    2. 根据返回的结果中的查询任务ID，进行后续取消息，取消息时传入查询任务ID以及当前页数。此时输入的起止时间和每页消息数量不生效，默认以第一次查询时输入的参数值为准。","responseParamsDescription":" "}