{"summary":"查询命令助手执行命令的列表和状态。","methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"operationType":"readAndWrite","deprecated":false,"systemTags":{"operationType":"get"},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"地域ID。您可以调用[ListRegions](~~189315~~)查询可用地域。","type":"string","required":true,"example":"cn-hangzhou"}},{"name":"InstanceId","in":"query","schema":{"description":"指定的轻量应用服务器的实例ID。","type":"string","required":false,"example":"ace0706b2ac4454d984295a94213****"}},{"name":"CommandId","in":"query","schema":{"description":"命令ID。您可以通过接口[DescribeCommands](~~64843~~)查询所有可用的CommandId。 ","type":"string","required":false,"example":"c-sh02yh0932w****"}},{"name":"InvokeId","in":"query","schema":{"description":"命令执行ID。","type":"string","required":false,"example":"t-hz02p9545t6****"}},{"name":"CommandName","in":"query","schema":{"description":"命令名称。如果同时设置了InstanceId参数，则该参数不生效。","type":"string","required":false,"example":"testName"}},{"name":"InvocationStatus","in":"query","schema":{"description":"命令执行的总执行状态，总执行状态取决于本次调用的全部实例的共同执行状态，可能值：\n-  Pending：系统正在校验或发送命令。存在至少一台实例的命令执行状态为Pending，则总执行状态为Pending。\n-  Running：命令正在实例上运行。存在至少一台实例的命令执行状态为Running，则总执行状态为Running。\n-  Success：各个实例上的命令执行状态均为Stopped或Success，且至少一个实例的命令执行状态是Success，则总执行状态为Success。\n    -  立即运行的任务：命令执行完成，且退出码为0。\n-  Failed：各个实例上的命令执行状态均为Stopped或Failed，则总执行状态为Failed。实例上的命令执行状态一项或多项为以下状态时，返回值均为Failed状态：\n    - 命令校验失败（Invalid）\n    - 命令发送失败（Aborted）\n    - 命令执行完成但退出码非0（Failed）\n    - 命令执行超时（Timeout）\n    - 命令执行异常（Error）\n-  Stopping：正在停止任务。存在至少一台实例的命令执行状态为Stopping，则总执行状态为Stopping。\n-  Stopped：任务已停止。所有实例的命令执行状态是Stopped，则总执行状态为Stopped。实例上的命令执行状态为以下状态时，返回值均为Stopped状态：\n    - 任务已取消（Cancelled）\n    - 任务已终止（Terminated）\n-  PartialFailed：部分实例执行成功且部分实例执行失败。各个实例的命令执行状态均为Success、Failed或Stopped，则总执行状态为PartialFailed。\n> 返回参数中的`InvokeStatus`与该参数意义相似，但建议您查看该返回值。","type":"string","required":false,"example":"Success"}},{"name":"CommandType","in":"query","schema":{"description":"命令类型。可能值：\n\n- RunBatScript：适用于Windows实例的Bat命令。\n- RunPowerShellScript：适用于Windows实例的PowerShell命令。\n- RunShellScript：适用于Linux实例Shell命令。","type":"string","required":false,"example":"RunPowerShellScript"}},{"name":"PageNumber","in":"query","schema":{"description":"当前页码。起始值：1。默认值：1。","type":"string","required":false,"example":"1"}},{"name":"PageSize","in":"query","schema":{"description":"分页查询时设置的每页行数。\n\n最大值：50。\n\n默认值：10。","type":"string","required":false,"example":"10"}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"Schema of Response","type":"object","properties":{"RequestId":{"title":"Id of the request","description":"请求ID。","type":"string","example":"30637AD6-D977-4833-A54C-CC89483E****"},"TotalCount":{"description":"总条数。","type":"integer","format":"int32","example":"10"},"PageNumber":{"description":"查询结果的页码。","type":"integer","format":"int32","example":"1"},"PageSize":{"description":"分页查询时设置的每页行数。","type":"integer","format":"int32","example":"10"},"CommandInvocations":{"description":"命令执行列表。","type":"array","items":{"description":"命令执行信息结构体。","type":"object","properties":{"InvokeId":{"description":"命令执行ID。","type":"string","example":"t-hz0373jyzxt****"},"CreationTime":{"description":"命令创建时间。","type":"string","example":"2023-04-27T10:11:58"},"CommandId":{"description":"命令ID。","type":"string","example":"c-hy0338xh28r****"},"InvocationStatus":{"description":"命令执行的状态。可能值：\n\n- Pending：系统正在校验或发送命令。\n- Invalid：指定命令类型或参数有误。\n- Aborted：向实例发送命令失败。实例必须在运行中，且命令可以1分钟内发送完成。\n- Running：命令正在实例上执行。\n- Success：命令执行完成，且退出码为0。\n- Failed：命令执行完成，且退出码非0。\n- Error：命令执行时发生异常无法继续。\n- Timeout：命令执行超时。\n- Cancelled：命令的执行动作已经取消，命令未曾启动。\n- Stopping：正在停止执行的命令。\n- Terminated：命令执行时被终止。","type":"string","example":"Success"},"CommandName":{"description":"命令名称。","type":"string","example":"testCommandName"},"CommandType":{"description":"命令类型。","type":"string","example":"RunShellScript"},"CommandDescription":{"description":"命令描述。","type":"string","example":"testDescription"},"Username":{"description":"执行命令的用户名称。","type":"string","example":"root"},"WorkingDir":{"description":"命令执行的路径。","type":"string","example":"c:\\wwwroot"},"Timeout":{"description":"超时时间，单位为秒（s）。","type":"integer","format":"int64","example":"60"},"CommandContent":{"description":"命令内容。","type":"string","example":"echo 123"},"Parameters":{"description":"命令中包含自定义参数。如果没有参数，默认为{}.","type":"string","example":"{}"},"InvokeInstances":{"description":"执行目标实例列表。","type":"array","items":{"description":"执行目标实例信息结构体。","type":"object","properties":{"InstanceId":{"description":"轻量应用服务器的实例ID。","type":"string","example":"2445f4aecdac4b71ba2c7e3a7ccf****"},"StartTime":{"description":"命令在实例中开始执行的时间。","type":"string","example":"2023-05-09T03:32:24Z"},"FinishTime":{"description":"命令进程的结束时间。","type":"string","example":"2023-04-03T02:42:29Z"},"InvocationStatus":{"description":"单台实例的命令进度状态，可能值：\n- Pending：系统正在校验或发送命令。\n- Invalid：指定命令类型或参数有误。\n- Aborted：向实例发送命令失败。实例必须在运行中，且命令可以1分钟内发送完成。\n- Running：命令正在实例上运行。\n- Success：\n    - 单次执行的命令：命令执行完成，且退出码为0。\n    - 定时执行的命令：上一次运行成功且退出码为0，且指定的时间已结束。\n- Failed：\n    -  单次执行的命令：命令执行完成，且退出码非0。\n    -  定时执行的命令：上一次运行成功且退出码非0，且指定的时间将中止。\n- Error：命令执行时发生异常无法继续。\n- Timeout：命令执行超时。\n- Cancelled：命令的执行动作已经取消，命令未曾启动。\n- Stopping：正在停止任务。\n- Terminated：命令运行时被终止。","type":"string","example":"Running"},"Output":{"description":"命令执行后的输出信息。","type":"string","example":"OutputMsg"},"ExitCode":{"description":"命令的退出码。\n\n- Linux实例为Shell命令的退出码。\n- Windows实例为Bat或者PowerShell命令的退出码。","type":"integer","format":"int64","example":"0"},"ErrorInfo":{"description":"命令的下发失败或执行失败原因的详情，可能值：\n\n- 空：命令执行正常。\n- the specified instance does not exists：指定的实例不存在或已释放。\n- the instance has released when create task：执行命令期间，该实例被释放。\n- the instance is not running when create task：命令执行时，该实例不在运行中。\n- the command is not applicable：命令不适用于指定的实例。\n- the specified account does not exists：指定的账号不存在。\n- the specified directory does not exists：指定的目录不存在。\n- the cron job expression is invalid：指定的周期表达式不合法。\n- the aliyun service is not running on the instance：云助手客户端未运行。\n- the aliyun service in the instance does not response：云助手客户端无响应。\n- the aliyun service in the instance is upgrading now：云助手客户端正在升级中。\n- the aliyun service in the instance need upgrade：云助手客户端需要升级。\n- the command delivery has been timeout：发送命令超时。\n- the command execution has been timeout：命令执行超时。\n- the command execution got an exception：命令执行发生异常。\n- the command execution has been interrupted：命令执行被中断。\n- the command execution exit code is not zero：命令执行结束，退出码非0。","type":"string","enumValueTitles":{},"example":"the specified instance does not exists"},"ErrorCode":{"description":"命令的下发失败或执行失败原因的代码，可能值：\n\n- 空：命令执行正常。\n- InstanceNotExists：指定的实例不存在或已释放。\n- InstanceReleased：执行命令期间，该实例被释放。\n- InstanceNotRunning：命令执行时，该实例不在运行中。\n- CommandNotApplicable：命令不适用于指定的实例。\n- AccountNotExists：指定的账号不存在。\n- DirectoryNotExists：指定的目录不存在。\n- BadCronExpression：指定的周期表达式不合法。\n- ClientNotRunning：云助手客户端未运行。\n- ClientNotResponse：云助手客户端无响应。\n- ClientIsUpgrading：云助手客户端正在升级中。\n- ClientNeedUpgrade：云助手客户端需要升级。\n- DeliveryTimeout：发送命令超时。\n- ExecutionTimeout：命令执行超时。\n- ExecutionException：命令执行发生异常。\n- ExecutionInterrupted：命令执行被中断。\n- ExitCodeNonzero：命令执行结束，退出码非0。","type":"string","example":"InstanceNotExists"}}}}}}}}}}},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"30637AD6-D977-4833-A54C-CC89483E****\\\",\\n  \\\"TotalCount\\\": 10,\\n  \\\"PageNumber\\\": 1,\\n  \\\"PageSize\\\": 10,\\n  \\\"CommandInvocations\\\": [\\n    {\\n      \\\"InvokeId\\\": \\\"t-hz0373jyzxt****\\\",\\n      \\\"CreationTime\\\": \\\"2023-04-27T10:11:58\\\",\\n      \\\"CommandId\\\": \\\"c-hy0338xh28r****\\\",\\n      \\\"InvocationStatus\\\": \\\"Success\\\",\\n      \\\"CommandName\\\": \\\"testCommandName\\\",\\n      \\\"CommandType\\\": \\\"RunShellScript\\\",\\n      \\\"CommandDescription\\\": \\\"testDescription\\\",\\n      \\\"Username\\\": \\\"root\\\",\\n      \\\"WorkingDir\\\": \\\"c:\\\\\\\\wwwroot\\\",\\n      \\\"Timeout\\\": 60,\\n      \\\"CommandContent\\\": \\\"echo 123\\\",\\n      \\\"Parameters\\\": \\\"{}\\\",\\n      \\\"InvokeInstances\\\": [\\n        {\\n          \\\"InstanceId\\\": \\\"2445f4aecdac4b71ba2c7e3a7ccf****\\\",\\n          \\\"StartTime\\\": \\\"2023-05-09T03:32:24Z\\\",\\n          \\\"FinishTime\\\": \\\"2023-04-03T02:42:29Z\\\",\\n          \\\"InvocationStatus\\\": \\\"Running\\\",\\n          \\\"Output\\\": \\\"OutputMsg\\\",\\n          \\\"ExitCode\\\": 0,\\n          \\\"ErrorInfo\\\": \\\"the specified instance does not exists\\\",\\n          \\\"ErrorCode\\\": \\\"InstanceNotExists\\\"\\n        }\\n      ]\\n    }\\n  ]\\n}\",\"type\":\"json\"}]","title":"查询命令执行列表和状态"}