{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"get"},"parameters":[{"name":"RegionId","in":"query","schema":{"description":"地域ID。","type":"string","required":true,"docRequired":true,"example":"cn-hangzhou"}},{"name":"InvokeId","in":"query","schema":{"description":"脚本进程执行ID。","type":"string","required":false,"example":"t-hz0jdfwd9f****"}},{"name":"CommandType","in":"query","schema":{"description":"脚本类型。取值范围：\n\n- RunBatScript\n- RunPowerShellScript","type":"string","required":false,"example":"RunPowerShellScript"}},{"name":"InvokeStatus","in":"query","schema":{"description":"脚本执行的总执行状态。总执行状态取决于创建执行中的一台或多台云桌面的共同执行状态。取值范围：\n\n- Running：一旦有进行中的脚本进程，总的执行状态就为进行中。\n\n- Finished：所有云桌面全部完成执行。或者手动停止部分云桌面的脚本进程，其余云桌面全部执行完成。\n\n- Failed：所有云桌面全部执行失败。\n\n- PartialFailed：部分云桌面有执行失败的脚本进程，则总执行状态为部分失败。\n\n- Stopped：停止执行脚本。\n\n默认值：Running。","type":"string","required":false,"example":"Finished"}},{"name":"DesktopId","in":"query","schema":{"description":"云桌面ID。如果指定了云桌面，则查询该桌面所有的脚本执行记录。","type":"string","required":false,"example":"ecd-7w78ozhjcwa3u****"}},{"name":"IncludeOutput","in":"query","schema":{"description":"是否在结果中返回脚本运行的输出信息。取值范围：\n\n- true：返回。\n\n- false：不返回。\n\n默认值：false。","type":"boolean","required":false,"example":"false"}},{"name":"ContentEncoding","in":"query","schema":{"description":"返回数据的编码方式。取值范围：\n\n- PlainText：返回原始脚本内容和输出信息。\n\n- Base64：返回Base64编码后的脚本内容和输出信息。\n\n默认值：Base64。","type":"string","required":false,"example":"PlainText"}},{"name":"MaxResults","in":"query","schema":{"description":"分页查询时每页行数。    \n\n- 最大值：50。\n- 默认值：10。","type":"integer","format":"int32","required":false,"docRequired":false,"maximum":"50","minimum":"0","example":"10"}},{"name":"NextToken","in":"query","schema":{"description":"查询凭证（Token），取值为上一次API调用返回的NextToken参数值。","type":"string","required":false,"example":"AAAAAV3MpHK1AP0pfERHZN5pu6nmB7qrRFJ8vmttjxPL****"}},{"name":"EndUserId","in":"query","allowEmptyValue":true,"schema":{"description":"用户ID。","type":"string","required":false,"example":"test1"}},{"name":"DesktopIds","in":"query","style":"repeatList","schema":{"description":"云桌面ID列表。DesktopId即将弃用，请使用当前字段传递DesktopId列表信息。","type":"array","items":{"description":"云桌面ID","type":"string","required":false,"example":"ecd-84mztzatmipf2****"},"required":false,"maxItems":500}}],"responses":{"200":{"schema":{"description":"返回对象。","type":"object","properties":{"NextToken":{"description":"本次调用返回的查询凭证值。","type":"string","example":"AAAAAV3MpHK1AP0pfERHZN5pu6nmB7qrRFJ8vmttjxPL****"},"RequestId":{"description":"请求ID。","type":"string","example":"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E"},"Invocations":{"description":"脚本执行记录数组。","type":"array","items":{"description":"脚本执行记录对象。","type":"object","properties":{"InvokeId":{"description":"执行ID。","type":"string","example":"t-hz0jdfwd9f****"},"CommandContent":{"description":"脚本内容，以Base64编码后传输。","type":"string","example":"cnBtIC1xYSB8IGdyZXAgdnNm****"},"CommandType":{"description":"脚本类型。","type":"string","example":"RunPowerShellScript"},"InvocationStatus":{"description":"脚本执行的总执行状态，总执行状态取决于本次调用的全部云桌面的共同执行状态，可能值：\n\n- Pending：系统正在校验或发送命令。存在至少一台云桌面的脚本执行状态为Pending，则总执行状态为Pending。\n- Running：命令正在云桌面上运行。存在至少一台云桌面的脚本执行状态为Running，则总执行状态为Running。\n- Success：各个云桌面上的脚本执行状态均为Stopped或Success，且至少一个云桌面的脚本执行状态是Success，则总执行状态为Success。\n- Failed：各个云桌面上的脚本执行状态均为Stopped或Failed，则总执行状态为Failed。云桌面上的脚本执行状态一项或多项为以下状态时，返回值均为Failed状态：\n    - 命令校验失败（Invalid）\n    - 命令发送失败（Aborted）\n    - 命令执行完成但退出码非0（Failed）\n    - 命令执行超时（Timeout）\n    - 命令执行异常（Error）\n- Stopping：正在停止任务。存在至少一台实例的脚本执行状态为Stopping，则总执行状态为Stopping。\n- Stopped：任务已停止。所有实例的脚本执行状态是Stopped，则总执行状态为Stopped。实例上的脚本执行状态为以下状态时，返回值均为Stopped状态：\n    - 任务已取消（Cancelled）\n    - 任务已终止（Terminated）\n- PartialFailed：部分实例执行成功且部分实例执行失败。各个实例的脚本执行状态均为Success、Failed或Stopped，则总执行状态为PartialFailed。","type":"string","example":"Pending"},"CreationTime":{"description":"任务的创建时间。","type":"string","example":"2020-12-19T09:15:46Z"},"EndUserId":{"description":"终端用户ID。","type":"string","example":"User1"},"InvokeDesktops":{"description":"执行目标云桌面数组。","type":"array","items":{"description":"执行目标云桌面对象。","type":"object","properties":{"InvocationStatus":{"description":"单台云桌面的脚本进度状态。","type":"string","example":"Success"},"Output":{"description":"脚本进程的输出信息。\n\n- 如果请参IncludeOutput设置为false，则不返回Output。\n- 如果请参ContentEncoding设置为Base64，则Output为Base64编码后的输出信息。","type":"string","example":"OutPutTestmsg"},"CreationTime":{"description":"脚本进程的创建时间。","type":"string","example":"2020-12-20T06:15:54Z"},"UpdateTime":{"description":"任务状态的更新时间。","type":"string","example":"2020-12-25T06:15:56Z"},"Repeats":{"description":"命令在该桌面上执行的次数。","type":"integer","format":"int32","example":"0"},"DesktopId":{"description":"云桌面ID。","type":"string","example":"ecd-7w78ozhjcwa3u****"},"Dropped":{"description":"Output字段中文字长度超出24 KB后，截断丢弃的文字长度。","type":"integer","format":"int32","example":"0"},"StartTime":{"description":"脚本进程在桌面中开始执行的时间。","type":"string","example":"2020-12-20T06:15:55Z"},"StopTime":{"description":"如果调用了[stopInvocation](~~196957~~)，表示调用的时间。","type":"string","example":"2020-12-25T09:15:47Z"},"FinishTime":{"description":"脚本进程的结束时间。","type":"string","example":"2020-12-20T06:15:56Z"},"ExitCode":{"description":"脚本进程的退出代码。","type":"integer","format":"int64","example":"0"},"ErrorCode":{"description":"命令的下发失败或执行失败原因的代码，可能值：\n\n- 空：命令运行正常。\n- InstanceNotExists：指定的云桌面不存在或已释放。\n- InstanceReleased：执行任务期间，该云桌面被释放。\n- InstanceNotRunning：创建任务时，该云桌面不在运行中。\n- CommandNotApplicable：命令不适用于指定的云桌面。\n- ClientNotRunning：云助手客户端未运行。\n- ClientNotResponse：云助手客户端无响应。\n- ClientIsUpgrading：云助手客户端正在升级中。\n- ClientNeedUpgrade：云助手客户端需要升级。\n- DeliveryTimeout：发送命令超时。\n- ExecutionTimeout：命令运行超时。\n- ExecutionException：命令运行发生异常。\n- ExecutionInterrupted：命令运行任务中断。\n- ExitCodeNonzero：命令执行结束，退出码非0。","type":"string","example":"InstanceNotExists"},"ErrorInfo":{"description":"命令的下发失败或执行失败原因的详情，可能值：\n\n- 空：命令运行正常。\n- the specified instance does not exists：指定的云桌面不存在或已释放。\n- the instance has released when create task：执行任务期间，该云桌面被释放。\n- the instance is not running when create task：创建任务时，该云桌面不在运行中。\n- the command is not applicable：命令不适用于指定的云桌面。\n- the aliyun service is not running on the instance：云助手客户端未运行。\n- the aliyun service in the instance does not response：云助手客户端无响应。\n- the aliyun service in the instance is upgrading now：云助手客户端正在升级中。\n- the aliyun service in the instance need upgrade：云助手客户端需要升级。\n- the command delivery has been timeout：发送命令超时。\n- the command execution has been timeout：命令运行超时。\n- the command execution got an exception：命令运行发生异常。\n- the command execution has been interrupted：命令运行任务中断。\n- the command execution exit code is not zero：命令执行结束，退出码非0。","type":"string","example":"The specified instance does not exist."},"DesktopName":{"description":"云桌面名称。","type":"string","example":"demo1234"}}}}}}}}}}},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"NextToken\\\": \\\"AAAAAV3MpHK1AP0pfERHZN5pu6nmB7qrRFJ8vmttjxPL****\\\",\\n  \\\"RequestId\\\": \\\"473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E\\\",\\n  \\\"Invocations\\\": [\\n    {\\n      \\\"InvokeId\\\": \\\"t-hz0jdfwd9f****\\\",\\n      \\\"CommandContent\\\": \\\"cnBtIC1xYSB8IGdyZXAgdnNm****\\\",\\n      \\\"CommandType\\\": \\\"RunPowerShellScript\\\",\\n      \\\"InvocationStatus\\\": \\\"Pending\\\",\\n      \\\"CreationTime\\\": \\\"2020-12-19T09:15:46Z\\\",\\n      \\\"EndUserId\\\": \\\"User1\\\",\\n      \\\"InvokeDesktops\\\": [\\n        {\\n          \\\"InvocationStatus\\\": \\\"Success\\\",\\n          \\\"Output\\\": \\\"OutPutTestmsg\\\",\\n          \\\"CreationTime\\\": \\\"2020-12-20T06:15:54Z\\\",\\n          \\\"UpdateTime\\\": \\\"2020-12-25T06:15:56Z\\\",\\n          \\\"Repeats\\\": 0,\\n          \\\"DesktopId\\\": \\\"ecd-7w78ozhjcwa3u****\\\",\\n          \\\"Dropped\\\": 0,\\n          \\\"StartTime\\\": \\\"2020-12-20T06:15:55Z\\\",\\n          \\\"StopTime\\\": \\\"2020-12-25T09:15:47Z\\\",\\n          \\\"FinishTime\\\": \\\"2020-12-20T06:15:56Z\\\",\\n          \\\"ExitCode\\\": 0,\\n          \\\"ErrorCode\\\": \\\"InstanceNotExists\\\",\\n          \\\"ErrorInfo\\\": \\\"The specified instance does not exist.\\\",\\n          \\\"DesktopName\\\": \\\"demo1234\\\"\\n        }\\n      ]\\n    }\\n  ]\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<DescribeInvocationsResponse>\\n    <NextToken>AAAAAV3MpHK1AP0pfERHZN5pu6nmB7qrRFJ8vmttjxPL****</NextToken>\\n    <RequestId>473469C7-AA6F-4DC5-B3DB-A3DC0DE3C83E</RequestId>\\n    <Invocations>\\n        <CreationTime>2020-12-19T09:15:46Z</CreationTime>\\n        <CommandContent>cnBtIC1xYSB8IGdyZXAgdnNm****</CommandContent>\\n        <InvocationStatus>Pending</InvocationStatus>\\n        <CommandType>RunPowerShellScript</CommandType>\\n        <InvokeId>t-hz0jdfwd9f****</InvokeId>\\n    </Invocations>\\n    <Invocations>\\n        <InvokeDesktops>\\n            <Dropped>0</Dropped>\\n            <InvocationStatus>Success</InvocationStatus>\\n            <ErrorInfo>the specified instance does not exists</ErrorInfo>\\n            <ExitCode>0</ExitCode>\\n            <StartTime>2020-12-20T06:15:55Z</StartTime>\\n            <DesktopId>ecd-7w78ozhjcwa3u****</DesktopId>\\n            <Repeats>0</Repeats>\\n            <FinishTime>2020-12-20T06:15:56Z</FinishTime>\\n            <Output>OutPutTestmsg</Output>\\n            <UpdateTime>2020-12-25T06:15:56Z</UpdateTime>\\n            <CreationTime>2020-12-20T06:15:54Z</CreationTime>\\n            <ErrorCode>InstanceNotExists</ErrorCode>\\n            <StopTime>2020-12-25T09:15:47Z</StopTime>\\n        </InvokeDesktops>\\n    </Invocations>\\n</DescribeInvocationsResponse>\",\"errorExample\":\"\"}]","title":"查询云助手脚本的执行列表和状态","summary":"用于查询云助手脚本的执行列表和状态。","description":"- 当您执行命令后，不代表命令一定成功执行，并且一定有预期的命令效果。您需要通过接口返回值来查看实际执行结果，以实际输出结果为准。\n- 您可以查询最近2周的执行信息，执行信息的保留上限为10万条。","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":" "}