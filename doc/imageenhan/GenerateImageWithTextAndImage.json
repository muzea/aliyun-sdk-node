{"summary":"本文介绍文本和参考图到图像生成GenerateImageWithTextAndImage的语法及示例。","methods":["post"],"schemes":["http","https"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{},"parameters":[{"name":"Text","in":"formData","schema":{"description":"文本内容。支持中英文，中文不超过75个字，英文不超过75个字母，超过部分会自动截断。\n建议文本内容尽可能详细准确，详细的文本描述内容有助于获得更佳的图片生成效果。","type":"string","required":true,"example":"大雪中的雪人精灵，4K，摄影"}},{"name":"Resolution","in":"formData","schema":{"description":"生成的图像分辨率。支持512*512、1024*1024、1024*768、768*1024、720*1280、1280*720像素，默认1024*1024像素。","type":"string","required":false,"example":"1024*1024"}},{"name":"Number","in":"formData","schema":{"description":"图片生成数量。支持1~4张，默认1张。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"RefImageUrl","in":"formData","schema":{"description":"参考图地址。参考图分辨率请尽量和需要生成的图像分辨率接近，生成过程会先按照参数`AspectRatioMode`设定的模式，将参考图缩放裁剪到`resolution`参数指定的分辨率，再参考缩放裁剪后的图片进行图像生成，供用户参考。\n推荐使用上海地域的OSS链接，对于文件在本地或者非上海地域OSS链接的情况，请参见[文件URL处理](~~155645~~)。","type":"string","required":true,"example":"https://viapi-test.oss-cn-shanghai.aliyuncs.com/viapi-3.0domepic/imageenhan/GenerateImageWithTextAndImage/GenerateImageWithTextAndImage11.jpg","isFileTransferUrl":true}},{"name":"Similarity","in":"formData","schema":{"description":"参考程度。值在0～1之间，默认值为0.2。\n- 0：完全不参考参考图，只基于文本生成图像。\n- 1：完全复制参考图。","type":"number","format":"float","required":false,"example":"0.2"}},{"name":"AspectRatioMode","in":"formData","schema":{"description":"图像缩放裁剪模式。包括center_crop和resize，默认为center_crop。\n- center_crop：最大限度保留图像中心部分，将边缘进行裁剪。\n- resize：将图像拉伸到最终分辨率。","type":"string","required":false,"example":"center_crop"}}],"responses":{"200":{"schema":{"title":"Schema of Response","description":"Schema of Response","type":"object","properties":{"RequestId":{"title":"Id of the request","description":"请求ID。","type":"string","example":"141fb6d1-28e8-4d93-8165-d966f7092e6a"},"Data":{"description":"返回的结果数据内容。该数据需要在异步任务执行成功后，通过调用[GetAsyncJobResult](~~607824~~)接口，对其Result字段进行JSON反序列化之后得到。","type":"object","properties":{"ImageUrls":{"description":"输出图像的URL。","type":"array","items":{"description":"输出图像的URL。\n\n> 该URL地址为临时地址，有效期为30分钟，过期后将无法访问。若需要长时间或者永久保存文件，请在30分钟内访问URL地址，下载文件转存到自己的OSS或者其他存储空间。","type":"string","example":"http://vibktprfx-prod-prod-gen-model-cn-shanghai.oss-cn-shanghai.aliyuncs.com/text2image/cv_diffusion_text-to-image-synthesis_results/images/8df0b0588fe011ed9f3dde652e7536a6_1.jpg?Expires=1673244813&OSSAccessKeyId=LTAI4FoLmvQ9urWXgSRp****&Signature=6cjXWuOYMpBLD8V1%2BJOq8zvSBb****"}}}},"Message":{"description":"提交异步任务后的提示信息。","type":"string","example":"该调用为异步调用，任务已提交成功，请以requestId的值作为jobId参数调用同类目下GetAsyncJobResult接口查询任务执行状态和结果。"}}}}},"errorCodes":{"400":[{"errorCode":"ParameterError","errorMessage":"The parameter is invalid. Please check again."}],"403":[{"errorCode":"AuthFailed","errorMessage":"An error occurred while performing authorization. Please check your RAM configuration."}],"408":[{"errorCode":"Timeout","errorMessage":"The request has timed out."}],"503":[{"errorCode":"ServiceUnavailable","errorMessage":"The service is unavailable."}]},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\"141fb6d1-28e8-4d93-8165-d966f7092e6a\\\",\\n  \\\"Data\\\": {\\n    \\\"ImageUrls\\\": [\\n      \\\"http://vibktprfx-prod-prod-gen-model-cn-shanghai.oss-cn-shanghai.aliyuncs.com/text2image/cv_diffusion_text-to-image-synthesis_results/images/8df0b0588fe011ed9f3dde652e7536a6_1.jpg?Expires=1673244813&OSSAccessKeyId=LTAI4FoLmvQ9urWXgSRp****&Signature=6cjXWuOYMpBLD8V1%2BJOq8zvSBb****\\\"\\n    ]\\n  },\\n  \\\"Message\\\": \\\"该调用为异步调用，任务已提交成功，请以requestId的值作为jobId参数调用同类目下GetAsyncJobResult接口查询任务执行状态和结果。\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<GenerateImageWithTextAndImageResponse>\\n    <RequestId>141fb6d1-28e8-4d93-8165-d966f7092e6a</RequestId>\\n    <Message>该调用为异步调用，任务已提交成功，请以requestId的值作为jobId参数调用同类目下GetAsyncJobResult接口查询任务执行状态和结果。</Message>\\n</GenerateImageWithTextAndImageResponse>\",\"errorExample\":\"\"}]","title":"文本和参考图到图像生成","description":"## 服务说明\n由于产品业务和安全合规调整，图文生图服务将于2023年06月19日起停止更新，后续不再支持新用户开通接入服务。同时，图文生图API服务计划于2023年09月30日完成服务下线，请老用户提前做好服务迁移计划。2023年06月19日之后，会继续支持老用户，老用户如果对图文生图API服务使用有疑问，可通过搜索钉钉群（23109592）加入阿里云视觉智能开放平台咨询群联系我们。\n\n\n## 功能描述\n依托达摩院自研文生图大模型，输入文本和参考图，可以基于文本描述和原图的相似度生成目标图，使得生成的图片更可控。\n\n> 阿里云视觉智能开放平台视觉AI能力API接入、接口使用或问题咨询等，请通过钉钉群（23109592）加入阿里云视觉智能开放平台咨询群联系我们。\n\n## 应用场景\n- 图片设计：根据原图和参考图及其相似度参数，帮助设计师基于参考图快速可控的输出符合预期的图片。\n- 内容创作：在较为广泛的电商主图、人物、背景、封面、动漫、游戏等创意内容的创作过程中，通过文字和相似度对参考图进行二次生成。\n\n## 特色优势\n- 效果可控：生成效果可以通过prompt和参考图、相似度进行调节，使得生成效果更符合预期。\n- 生成效果佳：在非现实、朋克机甲等类型的图片生成效果佳。\n\n## 输入限制\n- 支持的图片类型：JPEG、PNG、JPG、BMP、WEBP、GIF。\n- 图片大小不超过10 MB。\n- 不限制图片分辨率。\n\n## 计费说明\n关于图文生图的计费方式及报价，请参见[计费介绍](~~202482~~)。\n\n## 调用步骤\n该能力为异步能力，需分两步进行调用。\n第一步调用GenerateImageWithTextAndImage接口提交任务，请求成功后，得到一个任务ID。\n第二步调用[GetAsyncJobResult](~~607824~~)接口查询结果，根据任务ID查询任务执行状态和结果。如果任务还在处理中，可稍等一段时间后再进行查询。","responseParamsDescription":"## 查询结果\n该接口为异步接口，当前并未返回真实的请求结果，您需要通过返回的RequestId调用GetAsyncJobResult接口来获取该接口的真实请求结果。详情请参见[GetAsyncJobResult](~~607824~~)。\n\n## SDK参考\n阿里云视觉AI图像生产类目下的图文生图能力推荐使用SDK调用，支持多种编程语言，调用时请选择AI类目为图像生产（imageenhan）的SDK包，文件参数通过SDK调用可支持本地文件及任意URL，具体可参见[SDK总览](~~145033~~)。","extraInfo":"## 错误码\n关于图文生图的错误码，详情请参见[常见错误码](~~145023~~)。\n\n## 版权说明\n\n- ⽣成图⽚归属于谁？\n我们为您提供的是图⽚⽣成技术服务，在您购买产品并⽀付调⽤API技术服务费后，⽣成图⽚的著作\n权将永久归您所有。您可⽤于商业⽤途，并⾃⾏负责⽣成图⽚的使⽤⻛险及合规问题，我们对此不承\n担任何法律责任。\n\n- 图⽚是如何⽣成的？\n图⽚与您输⼊的内容有关，并通过深度合成算法⾃动⽣成，本服务算法是根据开源数据集及互联⽹的\n公开信息积累训练⽽成。因此，我们对⽣成图⽚的准确性、完整性和功能性不做任何保证，亦不承担\n任何法律责任。\n\n- 图⽚引发不适该怎么办？\n本服务⽣成的所有内容均由AI模型⾃动⽣成，我们在训练过程中已通过将训练数据持续过滤来提升\n内容理解和⽣成的准确性，但仍不排除其中有部分信息存在⼀定的敏感性、不合理或导致理解歧义的\n问题存在，可能会引发您的不适。\n您可以通过钉钉群（23109592）联系我们，我们将及时联系您并采取合理有效的处理措施。\n\n## 安全声明\n- 请确保上传的图片或文件来源符合相应的法律法规。\n- 通过体验调试上传的临时文件有效期为1小时，在24小时后会被系统自动清理删除。"}