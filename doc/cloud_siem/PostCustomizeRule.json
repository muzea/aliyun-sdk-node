{"summary":"添加或者更新自定义规则。","methods":["get","post"],"schemes":["https","http"],"security":[{"AK":[]}],"deprecated":false,"systemTags":{"operationType":"create","riskType":"none","chargeType":"free"},"parameters":[{"name":"Id","in":"formData","schema":{"title":"自定义规则ID。","description":"自定义规则ID。","type":"integer","format":"int64","required":false,"example":"123456789"}},{"name":"RuleName","in":"formData","schema":{"title":"规则名称。","description":"规则名称。","type":"string","required":false,"example":"waf_scan"}},{"name":"RuleDesc","in":"formData","schema":{"title":"规则描述。","description":"规则描述。","type":"string","required":false,"example":"this rule is for waf scan"}},{"name":"ThreatLevel","in":"formData","schema":{"title":"威胁等级。取值：\n- serious：高危\n- suspicious：中危\n- remind：低危","description":"威胁等级。取值：\n- serious：高危\n- suspicious：中危\n- remind：低危","type":"string","required":false,"example":"remind"}},{"name":"AttCk","in":"formData","schema":{"title":"att&ck。","description":"att&ck。","type":"string","required":false,"example":"T1595.002 Vulnerability Scanning\n"}},{"name":"AlertType","in":"formData","schema":{"title":"威胁类型。","description":"威胁类型。","type":"string","required":false,"example":"WEBSHELL"}},{"name":"AlertTypeMds","in":"formData","schema":{"title":"威胁类型美杜莎code。","description":"威胁类型美杜莎Code。","type":"string","required":false,"example":"${siem_rule_type_process_abnormal_command}"}},{"name":"LogType","in":"formData","schema":{"title":"规则对应的日志类型。","description":"规则对应的日志类型。","type":"string","required":false,"example":"ALERT_ACTIVITY"}},{"name":"LogTypeMds","in":"formData","schema":{"title":"规则对应的日志类型美杜莎code。","description":"规则对应的日志类型美杜莎Code。","type":"string","required":false,"example":"${security_event_config.event_name.webshellName_clientav}"}},{"name":"LogSource","in":"formData","schema":{"title":"规则对应的日志源。","description":"规则对应的日志源。","type":"string","required":false,"example":"cloud_siem_aegis_sas_alert"}},{"name":"LogSourceMds","in":"formData","schema":{"title":"规则对应的日志源美杜莎code。","description":"规则对应的日志源美杜莎Code。","type":"string","required":false,"example":"${sas.cloudsiem.prod.cloud_siem_aegis_sas_alert}"}},{"name":"RuleCondition","in":"formData","schema":{"title":"规则查询条件json。","description":"规则查询条件json。","type":"string","required":false,"example":"[[{\"not\":false,\"left\":\"alert_name\",\"operator\":\"=\",\"right\":\"WEBSHELL\"}]]"}},{"name":"RuleGroup","in":"formData","schema":{"title":"日志聚合字段,json数组格式。","description":"日志聚合字段，json数组格式。","type":"string","required":false,"example":"[\"asset_id\"]"}},{"name":"RuleThreshold","in":"formData","schema":{"title":"规则阈值配置json。","description":"规则阈值配置json。","type":"string","required":false,"example":"{\"aggregateFunction\":\"count\",\"aggregateFunctionName\":\"count\",\"field\":\"activity_name\",\"operator\":\"&lt;=\",\"value\":1}"}},{"name":"QueryCycle","in":"formData","schema":{"title":"规则窗口长度。","description":"规则窗口长度。","type":"string","required":false,"example":"{\"time\":\"1\",\"unit\":\"HOUR\"}"}},{"name":"EventTransferSwitch","in":"formData","schema":{"title":"告警是否转换事件开关。 取值：\n- 0：不转换\n- 1：转换","description":"告警是否转换事件开关。取值：\n- 0：不转换\n- 1：转换","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"EventTransferType","in":"formData","schema":{"title":"事件生成方式。 取值：\n- default:默认内置方式\n- singleToSingle：每个告警生成一个事件\n- allToSingle：周期内告警生成一个事件","description":"事件生成方式。取值：\n- default：默认内置方式\n- singleToSingle：每个告警生成一个事件\n- allToSingle：周期内告警生成一个事件","type":"string","required":false,"example":"allToSingle"}},{"name":"EventTransferExt","in":"formData","schema":{"title":"事件生成扩展信息 当eventTransferType值为allToSingle该字段有值 表示告警聚合窗口的周期长度以及周期单位。","description":"事件生成扩展信息，当eventTransferType值为allToSingle时，该字段有值，表示告警聚合窗口的周期长度以及周期单位。","type":"string","required":false,"example":"{\"time\":\"1\",\"unit\":\"MINUTE\"}"}},{"name":"RoleType","in":"formData","schema":{"description":"视图类型。\n\n- 0：当前阿里云账号视图。\n- 1：企业下所有账号的视图。","type":"integer","format":"int32","required":false,"example":"1"}},{"name":"RoleFor","in":"formData","schema":{"description":"管理员切换成其他成员视角的用户ID。","type":"integer","format":"int64","required":false,"example":"113091674488****"}},{"name":"RegionId","in":"formData","schema":{"title":"威胁分析的数据管理中心所在地。您需要根据资产所在地域，选择管理中心所在地。取值：\n- cn-hangzhou：资产属于中国内地与中国香港\n- ap-southeast-1：资产属于海外地域","description":"威胁分析的数据管理中心所在地。您需要根据资产所在地域，选择管理中心所在地。取值：\n- cn-hangzhou：资产属于中国内地与中国香港\n- ap-southeast-1：资产属于海外地域","type":"string","required":false,"example":"cn-hangzhou"}}],"responses":{"200":{"schema":{"title":"BaseResponse<CloudSiemCustomizeRule>","description":"BaseResponse<CloudSiemCustomizeRule>","type":"object","properties":{"Data":{"title":"请求返回值。","description":"请求返回值。","type":"object","properties":{"Id":{"title":"自定义规则ID。","description":"自定义规则id。","type":"integer","format":"int64","example":"123456789"},"GmtCreate":{"title":"自定义规则创建时间。","description":"自定义规则创建时间。","type":"string","example":"2021-01-06 16:37:29"},"GmtModified":{"title":"自定义规则最后更新时间。","description":"自定义规则最后更新时间。","type":"string","example":"2021-01-06 16:37:29"},"Aliuid":{"title":"siem主账号ID。","description":"购买威胁分析产品的阿里云账号ID。","type":"integer","format":"int64","example":"127608589417****"},"RuleName":{"title":"规则名称。","description":"规则名称。","type":"string","example":"waf_scan"},"RuleDesc":{"title":"规则描述。","description":"规则描述。","type":"string","example":"this rule is for waf scan"},"RuleType":{"title":"规则类型。 取值：\n- predefine：预定义\n- customize：自定义","description":"规则类型。取值：\n- predefine：预定义\n- customize：自定义","type":"string","example":"customize"},"ThreatLevel":{"title":"威胁等级。取值：\n- serious：高危\n- suspicious：中危\n- remind：低危","description":"威胁等级。取值：\n- serious：高危\n- suspicious：中危\n- remind：低危","type":"string","example":"remind"},"AlertType":{"title":"威胁类型。","description":"威胁类型。","type":"string","example":"WEBSHELL"},"AlertTypeMds":{"title":"威胁类型美杜莎code。","description":"威胁类型美杜莎Code。","type":"string","example":"${siem_rule_type_process_abnormal_command}"},"LogType":{"title":"规则对应的日志类型。","description":"规则对应的日志类型。","type":"string","example":"ALERT_ACTIVITY"},"LogTypeMds":{"title":"规则对应的日志类型美杜莎code。","description":"规则对应的日志类型美杜莎Code。","type":"string","example":"${security_event_config.event_name.webshellName_clientav}"},"LogSource":{"title":"规则对应的日志源。","description":"规则对应的日志源。","type":"string","example":"cloud_siem_aegis_sas_alert"},"LogSourceMds":{"title":"规则对应的日志源美杜莎code。","description":"规则对应的日志源美杜莎code。","type":"string","example":"${sas.cloudsiem.prod.cloud_siem_aegis_sas_alert}"},"RuleCondition":{"title":"规则查询条件json(需要对html转义字符进行反向转义)。","description":"规则查询条件json（需要对html转义字符进行反向转义）。","type":"string","example":"[[{&quot;not&quot;:false,&quot;left&quot;:&quot;alert_name&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;right&quot;:&quot;WEBSHELL&quot;}]]"},"RuleGroup":{"title":"日志聚合字段,json数组格式(需要对html转义字符进行反向转义)。","description":"日志聚合字段,json数组格式（需要对html转义字符进行反向转义）。","type":"string","example":"[&quot;asset_id&quot;]"},"RuleThreshold":{"title":"规则阈值配置json(需要对html转义字符进行反向转义)。","description":"规则阈值配置json（需要对html转义字符进行反向转义）。","type":"string","example":"{&quot;aggregateFunction&quot;:&quot;count&quot;,&quot;aggregateFunctionName&quot;:&quot;count&quot;,&quot;field&quot;:&quot;activity_name&quot;,&quot;operator&quot;:&quot;&lt;=&quot;,&quot;value&quot;:1}"},"QueryCycle":{"title":"规则窗口长度(需要对html转义字符进行反向转义)。","description":"规则窗口长度（需要对html转义字符进行反向转义）。","type":"string","example":"{&quot;time&quot;:&quot;1&quot;,&quot;unit&quot;:&quot;HOUR&quot;}"},"AttCk":{"title":"告警附加字段attck","description":"告警附加字段attck","type":"string","example":"T1595.002 Vulnerability Scanning"},"EventTransferSwitch":{"title":"告警是否转换事件开关。 取值：\n- 0：不转换\n- 1：转换","description":"告警是否转换事件开关。取值：\n- 0：不转换\n- 1：转换","type":"integer","format":"int32","example":"1"},"EventTransferType":{"title":"事件生成方式。 取值：\n- default:默认内置方式\n- singleToSingle：每个告警生成一个事件\n- allToSingle：周期内告警生成一个事件","description":"事件生成方式。取值：\n- default：默认内置方式\n- singleToSingle：每个告警生成一个事件\n- allToSingle：周期内告警生成一个事件","type":"string","example":"allToSingle"},"EventTransferExt":{"title":"事件生成扩展信息 当eventTransferType值为allToSingle该字段有值 表示告警聚合窗口的周期长度以及周期单位(需要对html转义字符进行反向转义)。","description":"事件生成扩展信息，当eventTransferType值为allToSingle时，该字段有值，表示告警聚合窗口的周期长度以及周期单位，（需要对html转义字符进行反向转义）。","type":"string","example":"{&quot;time&quot;:&quot;1&quot;,&quot;unit&quot;:&quot;MINUTE&quot;}"},"Status":{"title":"规则状态。 取值：\n- 0：初始状态\n- 10：模拟数据测试\n- 15：业务数据测试中\n- 20：业务数据测试结束\n- 100：规则上线","description":"规则状态。取值：\n- 0：初始状态\n- 10：模拟数据测试\n- 15：业务数据测试中\n- 20：业务数据测试结束\n- 100：规则上线","type":"integer","format":"int32","example":"0"},"DataType":{"description":"自动化响应规则条件字段数据类型。","type":"integer","format":"int32","example":"varchar"}},"example":"123456"},"Success":{"title":"请求是否成功。取值：\n- true：成功\n- false：失败","description":"请求是否成功。取值：\n- true：成功\n- false：失败","type":"boolean","example":"true"},"Code":{"title":"请求状态码。","description":"请求状态码。","type":"integer","format":"int32","example":"200"},"Message":{"title":"请求返回消息。","description":"请求返回消息。","type":"string","example":"success"},"RequestId":{"title":"请求id。","description":"请求ID。","type":"string","example":"9AAA9ED9-78F4-5021-86DC-D51C7511****"}}}}},"errorCodes":{"400":[{"errorCode":"CloudSiemCustomizeRuleUpdateExcepiton","errorMessage":"this customize rule can only update in init status."},{"errorCode":"CloudSiemCustomizeRuleConditionExceedExcepiton","errorMessage":"the number of rule conditions cannot exceed 100."},{"errorCode":"CloudSiemCustomizeRuleDuplicateRuleNameExcepiton","errorMessage":"the rule name is duplicated."}],"500":[{"errorCode":"InternalError","errorMessage":"The request processing has failed due to some unknown error."}]},"staticInfo":{"returnType":"synchronous"},"responseDemo":"[{\"errorExample\":\"\",\"example\":\"{\\n  \\\"Data\\\": {\\n    \\\"Id\\\": 123456789,\\n    \\\"GmtCreate\\\": \\\"2021-01-06 16:37:29\\\",\\n    \\\"GmtModified\\\": \\\"2021-01-06 16:37:29\\\",\\n    \\\"Aliuid\\\": 0,\\n    \\\"RuleName\\\": \\\"waf_scan\\\",\\n    \\\"RuleDesc\\\": \\\"this rule is for waf scan\\\",\\n    \\\"RuleType\\\": \\\"customize\\\",\\n    \\\"ThreatLevel\\\": \\\"remind\\\",\\n    \\\"AlertType\\\": \\\"WEBSHELL\\\",\\n    \\\"AlertTypeMds\\\": \\\"${siem_rule_type_process_abnormal_command}\\\",\\n    \\\"LogType\\\": \\\"ALERT_ACTIVITY\\\",\\n    \\\"LogTypeMds\\\": \\\"${security_event_config.event_name.webshellName_clientav}\\\",\\n    \\\"LogSource\\\": \\\"cloud_siem_aegis_sas_alert\\\",\\n    \\\"LogSourceMds\\\": \\\"${sas.cloudsiem.prod.cloud_siem_aegis_sas_alert}\\\",\\n    \\\"RuleCondition\\\": \\\"[[{&quot;not&quot;:false,&quot;left&quot;:&quot;alert_name&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;right&quot;:&quot;WEBSHELL&quot;}]]\\\",\\n    \\\"RuleGroup\\\": \\\"[&quot;asset_id&quot;]\\\",\\n    \\\"RuleThreshold\\\": \\\"{&quot;aggregateFunction&quot;:&quot;count&quot;,&quot;aggregateFunctionName&quot;:&quot;count&quot;,&quot;field&quot;:&quot;activity_name&quot;,&quot;operator&quot;:&quot;&lt;=&quot;,&quot;value&quot;:1}\\\",\\n    \\\"QueryCycle\\\": \\\"{&quot;time&quot;:&quot;1&quot;,&quot;unit&quot;:&quot;HOUR&quot;}\\\",\\n    \\\"AttCk\\\": \\\"T1595.002 Vulnerability Scanning\\\",\\n    \\\"EventTransferSwitch\\\": 1,\\n    \\\"EventTransferType\\\": \\\"allToSingle\\\",\\n    \\\"EventTransferExt\\\": \\\"{&quot;time&quot;:&quot;1&quot;,&quot;unit&quot;:&quot;MINUTE&quot;}\\\",\\n    \\\"Status\\\": 0,\\n    \\\"DataType\\\": 0\\n  },\\n  \\\"Success\\\": true,\\n  \\\"Code\\\": 200,\\n  \\\"Message\\\": \\\"success\\\",\\n  \\\"RequestId\\\": \\\"9AAA9ED9-78F4-5021-86DC-D51C7511****\\\"\\n}\",\"type\":\"json\"}]","title":"添加或者更新自定义规则"}