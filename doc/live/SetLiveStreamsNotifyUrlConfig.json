{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"update"},"parameters":[{"name":"DomainName","in":"query","schema":{"description":"您的推流域名。","type":"string","required":true,"example":"demo.aliyundoc.com"}},{"name":"NotifyUrl","in":"query","schema":{"description":"直播流信息推送到的URL地址。","type":"string","required":true,"example":"http://guide.aliyundoc.com/notify"}},{"name":"NotifyReqAuth","in":"query","schema":{"description":"是否开启鉴权。取值：\n\n- **yes**：开启。如果选择取值为**yes**，必须同时设置请求参数NotifyAuthKey。\n- **no**：不开启。\n\n> 不填默认为**no**。\n\n鉴权逻辑请参考下文的**推流回调鉴权说明**。","type":"string","required":false,"example":"yes","default":"no","enum":["yes","no"]}},{"name":"NotifyAuthKey","in":"query","schema":{"description":"鉴权key。\n\n> 当请求参数NotifyReqAuth取值为**yes**时，本参数必填。\n\n取值要求：\n\n- 16~64个字符。\n\n- 支持大写字母、小写字母、数字。","type":"string","required":false,"example":"123456"}}],"responses":{"200":{"schema":{"type":"object","properties":{"RequestId":{"description":"请求ID。","type":"string","example":" 40A4F36D-A7CC-473A-88E7-154F92242566"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidParam","errorMessage":"Parameter invalid."},{"errorCode":"ConfigAlreadyExists","errorMessage":"Config has already exist."}],"500":[{"errorCode":"InternalError","errorMessage":"The request processing has failed due to backend service exception."}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"RequestId\\\": \\\" 40A4F36D-A7CC-473A-88E7-154F92242566\\\"\\n}\",\"errorExample\":\"{\\n    \\\"Code\\\":\\\"InternalError\\\",\\n    \\\"HostId\\\":\\\"live.aliyuncs.com\\\",\\n    \\\"Message\\\":\\\"The request processing has failed due to some unknown error.\\\",\\n    \\\"RequestId\\\":\\\"6EBD1AC4-C34D-4AE1-963E-B688A228BE31\\\"\\n}\"},{\"type\":\"xml\",\"example\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<SetLiveStreamsNotifyUrlConfigResponse>\\n\\t<RequestId>4C747C97-7ECD-4C61-8A92-67AD806331FF</RequestId>\\n</SetLiveStreamsNotifyUrlConfigResponse>\\t\",\"errorExample\":\"{\\n    \\\"RequestId\\\":\\\"4C747C97-7ECD-4C61-8A92-67AD806331FF\\\"\\n}\"}]","title":"设置推流回调通知地址配置","summary":"设置推流回调配置。","description":"## 使用说明\n本接口支持配置推流域名的回调地址及其鉴权信息。\n\n## QPS限制\n本接口的单用户QPS限制为15次/秒。超过限制，API调用会被限流，这可能会影响您的业务，请合理调用。更多信息，请参见[QPS限制](~~343507~~)。\n","requestParamsDescription":" ","responseParamsDescription":" ","extraInfo":"## 回调逻辑说明\n直播推流状态回调中开播（publish）状态回调逻辑：\n\nRTMP推流在阿里云直播服务收到On Publish消息后2秒内，如果推流端不主动断开，阿里云直播服务就会发推流成功回调。\n\n假设您有推流域名A和播流域名B，如果您的域名B使用拉流直播（固定拉流和触发回源拉流）需要回调，请在域名A配置推流回调。配置后域名B的拉流回调逻辑与上一条一致，建联后默认2秒无主动断开即认为拉流成功。\n> 建议业务方不仅根据回调通知判断推流、拉流接入正常，同时配合在线流列表查询推流正常后，再下发直播流播放地址给业务方。\n\n## 推流回调鉴权说明\n推流回调鉴权功能默认关闭，用户可在配置推流回调地址时启用鉴权。启用功能后，鉴权逻辑如下：\n\n1. 阿里云视频直播发起回调请求时在HTTP(S)请求头中带上`ALI-LIVE-TIMESTAMP`和`ALI-LIVE-SIGNATURE`字段，供回调消息接收服务端进行签名认证。其中，`ALI-LIVE-SIGNATURE`的值由如下计算而得：\n`ALI-LIVE-SIGNATURE=MD5SUM（MD5CONTENT)`\n`MD5CONTENT=<回调域名>|<ALI-LIVE-TIMESTAMP取值>|<鉴权KEY>`\n\n2. 回调消息接收服务端接收回调消息时，将回调域名、ALI-LIVE-TIMESTAMP取值、鉴权Key进行拼接后计算MD5值，得到加密字符串，再将计算出的加密字符串与视频直播发起的HTTP(S)请求头中的ALI-LIVE-SIGNATURE字段值进行对比。如果不一致，则请求非法。\n\n## 特殊错误码\n|错误代码  |描述  |HTTP 状态码  |语义 |\n|------------|--------|---------|------|\n|InternalError          |The request processing has failed due to some unknown error.  |500   |后台发生未知错误。 |\n|InvalidDomain.NotFound | The domain provided does not exist in our records.   |404     |当前账户下未查到域名。 |\n|IllegalOperation     |Illegal domain operate is not permitted.   |403     |不支持当前操作，如：非直播类域名。 |\n|InvalidNotifyUrl.Malformed |Specified parameter NotifyUrl is not valid.   |400     |回调地址不是一个合法的HTTP地址。 |\n|InvalidNotifyUrl.Unsafe |Specified NotifyUrl is not safe.   |400     |非安全的NotifyUrl值。 |\n"}