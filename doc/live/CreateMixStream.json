{"methods":["post","get"],"schemes":["http","https"],"security":[{"AK":[]}],"systemTags":{"operationType":"create"},"parameters":[{"name":"DomainName","in":"query","schema":{"description":"主播流域名。\n><notice>目前仅支持华东2（cn-shanghai）和华北2（cn-beijing）两个区域的域名。\n></notice>","type":"string","required":true,"example":"example.com"}},{"name":"LayoutId","in":"query","schema":{"description":"布局ID。取值：  \n- **MixStreamLayout-1-1**\n- **MixStreamLayout-2-1**\n- **MixStreamLayout-2-2**\n- **MixStreamLayout-2-3**\n- **MixStreamLayout-3-1**\n- ** MixStreamLayout-3-2**\n- **MixStreamLayout-4-1**\n- **USERDEFINED**（非上述预设布局，固定取值**USERDEFINED**）\n> 更多信息请参见[合流预设布局参考](~~199361~~)","type":"string","required":true,"example":"MixStreamLayout-1-1"}},{"name":"InputStreamList","in":"query","schema":{"description":"合流输入列表。JSON数组。\n\n参考下方的**InputStreamConfig**。","type":"string","required":true,"example":"[{\"LayoutChildId\":1,\"ResourceType\":\"live\",\"ResourceValue\":\"rtmp://example.net/live/f2139ec2b8d6a191068cd****ea9064d?auth_key=1600947017-0-0-0b5645fe35d21a65ab92b394bd4d****\",\"LayoutConfig\":{\"FillMode\":\"fit\",\"PositionRefer\":\"topLeft\",\"FillPositionNormalized\":[0,0],\"FillSizeNormalized\":[1,1]}}]"}},{"name":"OutputConfig","in":"query","schema":{"description":"合流输出配置。格式为JSON字符串。\n\n参考下方的**OutputConfig**。","type":"string","required":true,"example":"{\"AppName\":\"liveApp****\",\"StreamName\":\"9a78fb3f5c508be0122746f677a3****\",\"MixStreamTemplate\":\"lp_hd_v\",\"ExpireDuration\":\"86400\"}"}},{"name":"CallbackConfig","in":"query","schema":{"description":"回调地址。JSON数组。\n当事件产生时，直播服务端会向该地址发起HTTP POST请求，具体内容将通过HTTP Body送达。","type":"string","required":false,"example":"{\"CallbackUrl\":\"http://aliyundoc.com\"}"}}],"responses":{"200":{"schema":{"type":"object","properties":{"MixStreamId":{"description":"合流任务ID。可作为查询合流任务列表和删除合流任务的请求参数。","type":"string","example":"5b2a046e-74d7-385e-253f-8a5b87e4****"},"RequestId":{"description":"请求ID。","type":"string","example":"0D715397-2E66-4AE1-694h-C546628AD145"}}}}},"errorCodes":{"400":[{"errorCode":"InvalidUserId.Malformed","errorMessage":"%s"},{"errorCode":"InvalidParameter.Malformed","errorMessage":"%s"},{"errorCode":"MissingParameter","errorMessage":"%s"}],"401":[{"errorCode":"IllegalOperation","errorMessage":"%s"}],"403":[{"errorCode":"MixStreamAlreadyExist","errorMessage":"%s"},{"errorCode":"MixStreamNotExist","errorMessage":"%s"},{"errorCode":"UserQuotaExceed","errorMessage":"%s"}],"404":[{"errorCode":"InvalidDomainName.NotFound","errorMessage":"%s"}],"500":[{"errorCode":"InternalError","errorMessage":"%s"}]},"responseDemo":"[{\"type\":\"json\",\"example\":\"{\\n  \\\"MixStreamId\\\": \\\"5b2a046e-74d7-385e-253f-8a5b87e4****\\\",\\n  \\\"RequestId\\\": \\\"0D715397-2E66-4AE1-694h-C546628AD145\\\"\\n}\",\"errorExample\":\"\"},{\"type\":\"xml\",\"example\":\"<CreateMixStreamResponse>\\n    <MixStreamId>5b2a046e-74d7-385e-253f-8a5b87e4****</MixStreamId>\\n    <RequestId>0D715397-2E66-4AE1-694h-C546628AD145</RequestId>\\n</CreateMixStreamResponse>\",\"errorExample\":\"\"}]","title":"创建合流任务","summary":"调用CreateMixStream创建合流任务。","description":"## 使用说明\n调用本接口创建合流任务，目前本接口支持的布局类型为预设布局和自定义布局。\n\n如果您在使用合流服务过程有任何问题或建议，欢迎通过钉钉搜索群号34935990加入合流服务开发者群。\n\n## QPS限制\n本接口的单用户QPS限制为10次/秒。超过限制，API调用会被限流，这可能会影响您的业务，请合理调用。更多信息，请参见[QPS限制](~~343507~~)。\n","requestParamsDescription":"### InputStreamConfig\n\n|名称       |类型     |描述  |\n| ------------- |------------   | ----- |\n|ResourceType|String|资源类型。<br>**live**：直播流地址。 <br>**url**：文件流地址。 |\n|ResourceValue|String|资源地址。<br>如果ResourceType为live，则为直播流地址。直播流地址支持RTMP、FLV和ARTC协议，不支持HLS协议。 <br>如果ResourceType为url，则为文件流地址。 |\n|LayoutChildId|String|布局方格对应ID（也代表合流的叠加顺序）。 |\n|LayoutConfig |LayoutConfig[] |JSON数组，代表所在位置、填充方式等布局信息。<br>如果使用预设布局，则此参数可以不填。<br>如果设置了该值，则忽略LayoutChildId对应的预设布局信息。|\n\n### LayoutConfig\n\n|名称       |类型     |必选     |描述  |\n| ------------- |------------   |------------   | ----- |\n|FillSizeNormalized|JSON浮点数组|必选|表示该Layer元素需要填充的尺寸大小。 <br>[w,h]：w、h取值范围[0-1]。其中宽高都是进行了归一化计算。<br>例如：[0.2,0.3]代表水平占比20%，垂直占比30%。 |\n|FillPositionNormalized|浮点数数组|必选|表示该Layer元素填充区位置归一化值。 <br>[x,y]：x、y的取值范围[0-1]。<br>例如：[0.1,0.1]代表左上角水平偏移10%， 垂直偏移10%。 |\n|PositionRefer|字符串|可选|设置元素的position参考坐标值。 <br>建议设置topLeft，代表左上角。|\n|FillMode|字符串|可选|设置元素填充方式。 <br>**none**：不填充。 <br>**fit**：缩放填充保证最长的边达到边界，而最短的边可能需要加黑边。 <br>**fill**：先按照宽和高的最大比例值进行等比缩放，然后进行crop，保证全部填充。 <br>建议设置为fit。 |\n\n### OutputConfig\n\n|名称       |类型     |必选     |描述  |\n| ------------- |------------   |------------   | ----- |\n|AppName |String |是 |输出App名。不支持#、?等特殊字符。 |\n|StreamName |String |是 |输出流名。不支持#、?等特殊字符。 |\n|MixStreamTemplate |String |是 |合流输出规格模板ID （在传参时仅传模板ID，例如lp_ld）。<br>支持：<br>lp_ld（分辨率：640x360），<br>lp_sd（分辨率：854x480），<br>lp_hd（分辨率：1280x720），<br>lp_ud（分辨率：1920x1080），<br>lp_ld_v（分辨率：640x360），<br>lp_sd_v（分辨率：854x480），<br>lp_hd_v（分辨率：1280x720），<br>lp_ud_v（分辨率：1920x1080） ，<br>lp_ld_v_optm（分辨率：640x360），<br>lp_sd_v_optm（分辨率：854x480），<br>lp_hd_v_optm（分辨率：1280x720），<br>lp_ud_v_optm（分辨率：1920x1080）。<br>_v表示竖屏模板，_optm表示低延迟模板，括号里表示模板的分辨率。|\n|ExpireDuration|Long|可选|任务过期时间。单位：秒。取值范围：**1**~**31536000**（1年）。<br>如果不设置默认7天过期清理任务。 |","responseParamsDescription":" ","extraInfo":"## 增加合流事件回调示例\n- 合流创建成功\n```\n{\n\"EventMessage\":\n    {\n        \"StreamName\":\"liveStream****\",//合流输出流名\n        \"Message\":\"\",\n        \"DomainName\":\"example.com\",\n        \"MixstreamId\":\"5b2a046e-74d7-385e-253f-8a5b87e4****\",//合流任务ID\n        \"Code\":\"Success\",\n        \"AppName\":\"liveApp****\"//合流输出App名\n    },\n\"EventType\":\"MixstreamStartCallback\",\n\"MessageMd5\":\"7c7b1d9480ae892lkasjdflkasjbd****\",\n\"CasterId\":\"\"}\n ```\n- 合流创建失败\n```\n{\"EventMessage\":\n    {\n    \"StreamName\":\"liveStream****\",\n    \"Message\":\"MixStreamAlreadyExist\",\n    \"DomainName\":\"example.com\",\n    \"Code\":\"Error\",\n    \"AppName\":\"liveApp****\"\n    },\n\"EventType\":\"MixstreamStartCallback\",\n\"MessageMd5\":\"7c7b1d9480ae892lkasjdflkasjbd****\",\n\"CasterId\":\"\"\n}\n```\n\n### SDK示例\n详细示例，请参见[合流代码示例](https://help.aliyun.com/document_detail/199362.html)。"}